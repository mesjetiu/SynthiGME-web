var du=Object.defineProperty;var Yr=o=>e=>{var t=o[e];if(t)return t();throw new Error("Module not found in bundle: "+e)};var Xe=(o,e)=>()=>(o&&(e=o(o=0)),e);var Ot=(o,e)=>{for(var t in e)du(o,t,{get:e[t],enumerable:!0})};function Ni(){return typeof window<"u"&&typeof window.__LOG_LEVEL__=="number"?window.__LOG_LEVEL__:pu}function W(o){let e=`[${o}]`;return{debug(...t){Ni()>=Ii.DEBUG&&console.log(e,...t)},log(...t){Ni()>=Ii.INFO&&console.log(e,...t)},info(...t){Ni()>=Ii.INFO&&console.log(e,...t)},warn(...t){Ni()>=Ii.WARN&&console.warn(e,...t)},error(...t){Ni()>=Ii.ERROR&&console.error(e,...t)}}}var Ii,hu,pu,lp,be=Xe(()=>{Ii={NONE:0,ERROR:1,WARN:2,INFO:3,DEBUG:4},hu=1,pu=hu;lp=W("App")});function Bi(){if(typeof navigator>"u")return!1;let o=navigator.userAgent||"";return/Android|iPhone|iPad|iPod|webOS|BlackBerry|IEMobile|Opera Mini/i.test(o)||"ontouchstart"in window&&navigator.maxTouchPoints>1}var U,v,Di,Te=Xe(()=>{U="synthigme-",v={LANGUAGE:`${U}language`,DSP_ENABLED:`${U}dsp-enabled`,DSP_START_ENABLED:`${U}dsp-start-enabled`,AUDIO_ROUTING:`${U}audio-routing`,AUDIO_ROUTING_MULTICHANNEL:`${U}audio-routing-multichannel`,INPUT_ROUTING:`${U}input-routing`,INPUT_ROUTING_MULTICHANNEL:`${U}input-routing-multichannel`,STEREO_BUS_ROUTING:`${U}stereo-bus-routing`,STEREO_BUS_ROUTING_MULTICHANNEL:`${U}stereo-bus-routing-multichannel`,OUTPUT_MODE:`${U}output-mode`,OUTPUT_DEVICE:`${U}output-device`,INPUT_DEVICE:`${U}input-device`,MIC_PERMISSION_DENIED:`${U}mic-permission-denied`,AUDIO_LATENCY:`${U}audio-latency`,RECORDING_TRACKS:`${U}recording-tracks`,RECORDING_ROUTING:`${U}recording-routing`,RECORDING_FORMAT:`${U}recording-format`,RECORDING_BITRATE:`${U}recording-bitrate`,LAST_STATE:`${U}last-state`,RESOLUTION:`${U}resolution`,REMEMBER_RESOLUTION:`${U}remember-resolution`,AUTOSAVE_INTERVAL:`${U}autosave-interval`,SAVE_ON_EXIT:`${U}save-on-exit`,RESTORE_ON_START:`${U}restore-on-start`,ASK_BEFORE_RESTORE:`${U}ask-before-restore`,KEYBOARD_SHORTCUTS:`${U}keyboard-shortcuts`,WAKE_LOCK_ENABLED:`${U}wake-lock-enabled`,SHOW_INACTIVE_PINS:`${U}show-inactive-pins`,SHARP_RASTERIZE_ENABLED:`${U}sharp-rasterize-enabled`,PATCH_INCLUDE_VISUAL:`${U}patch-include-visual`,PIP_STATE:`${U}pip-state`,VIEWPORT_STATE:`${U}viewport-state`,REMEMBER_VISUAL_LAYOUT:`${U}remember-visual-layout`,PANEL_NOTES:`${U}panel-notes`,OPTIMIZATIONS_DEBUG:`${U}optimizations-debug`,DORMANCY_ENABLED:`${U}dormancy-enabled`,DORMANCY_DEBUG:`${U}dormancy-debug`,FILTER_BYPASS_ENABLED:`${U}filter-bypass-enabled`,FILTER_BYPASS_DEBUG:`${U}filter-bypass-debug`,LATENCY_MODE:`${U}latency-mode`,VOLTAGE_SOFT_CLIP_ENABLED:`${U}voltage-soft-clip-enabled`,VOLTAGE_PIN_TOLERANCE_ENABLED:`${U}voltage-pin-tolerance-enabled`,VOLTAGE_THERMAL_DRIFT_ENABLED:`${U}voltage-thermal-drift-enabled`,FADER_LINEAR_RESPONSE:`${U}fader-linear-response`,KNOB_STYLE:`${U}knob-style`,TOOLTIP_SHOW_VOLTAGE:`${U}tooltip-show-voltage`,TOOLTIP_SHOW_AUDIO_VALUES:`${U}tooltip-show-audio-values`,MULTITOUCH_CONTROLS:`${U}multitouch-controls`,SINGLE_FINGER_PAN:`${U}single-finger-pan`,QUICKBAR_VISIBLE:`${U}quickbar-visible`,CONFIRM_SYNTH_RESET:`${U}confirm-synth-reset`,OSC_ENABLED:`${U}osc-enabled`,OSC_MODE:`${U}osc-mode`,OSC_PREFIX:`${U}osc-prefix`,OSC_UNICAST_TARGETS:`${U}osc-unicast-targets`,OSC_SUPERCOLLIDER_SEND:`${U}osc-supercollider-send`,OSC_SUPERCOLLIDER_PORT:`${U}osc-supercollider-port`,OSC_PORT:`${U}osc-port`,OSC_SUPERCOLLIDER_RECEIVE:`${U}osc-supercollider-receive`,OSC_LOG_VISIBLE:`${U}osc-log-visible`,TELEMETRY_ENABLED:`${U}telemetry-enabled`,TELEMETRY_ID:`${U}telemetry-id`,TELEMETRY_QUEUE:`${U}telemetry-queue`,GLOW_PRESET:`${U}glow-preset`,SIGNAL_FLOW_ENABLED:`${U}signal-flow-enabled`,SIGNAL_FLOW_REQUIRE_MODIFIER:`${U}signal-flow-require-modifier`},Di={"15s":15e3,"30s":3e4,"1m":6e4,"5m":3e5,off:0}});function bu(o){let e=0;for(let t=0;t<o.length;t++){let n=o.charCodeAt(t);e=(e<<5)-e+n,e|=0}return e.toString(36)}function pa(o,e,t,n){let i=e||`${o}:${t||""}:${n||""}`;return bu(i)}function ma(o){let e=Ts.get(o);return e&&Date.now()-e<da?!0:(Ts.set(o,Date.now()),!1)}function yu(){let o=Date.now();for(let[e,t]of Ts)o-t>da*10&&Ts.delete(e)}function ga(o){la.length>=gu&&la.shift(),la.push(o);for(let e of ca)try{e(o)}catch(t){console.error("[ErrorHandler] Error en listener:",t)}}function vu(o,e,t,n,i){ha++;let s=i?.stack||"",a=pa(o,s,e,t);if(ma(a))return;let r={ts:Date.now(),message:String(o),stack:s,source:e,line:t,col:n,type:"error",hash:a};ua.error("Error no capturado:",o,e?`(${e}:${t}:${n})`:""),ga(r)}function _u(o){ha++;let e=o.reason,t=e instanceof Error?e.message:String(e||"Promise rejection"),n=e instanceof Error?e.stack:"",i=pa(t,n);if(ma(i))return;let s={ts:Date.now(),message:t,stack:n,source:"",line:0,col:0,type:"unhandledrejection",hash:i};ua.error("Promise no capturada:",t),ga(s)}function Zr(){Xr||typeof window>"u"||(window.onerror=vu,window.addEventListener("unhandledrejection",_u),fu=setInterval(yu,da*20),Xr=!0,ua.info("Handlers globales de errores instalados"))}function Jr(o){return typeof o!="function"?()=>{}:(ca.add(o),()=>ca.delete(o))}function Qr(o,e={}){ha++;let t=e.stack||"",n=e.source||"",i=pa(o,t,n);if(ma(i))return;let s={ts:Date.now(),message:String(o),stack:t,source:n,line:0,col:0,type:e.type||"manual",hash:i};ga(s)}var ua,gu,da,la,Ts,ca,ha,Xr,fu,Ms=Xe(()=>{be();ua=W("ErrorHandler"),gu=50,da=1e3,la=[],Ts=new Map,ca=new Set,ha=0,Xr=!1,fu=null});var al={};Ot(al,{_testing:()=>Tu,flush:()=>Is,init:()=>zs,isEnabled:()=>Ds,setEnabled:()=>Vi,trackError:()=>ol,trackEvent:()=>ut});function nl(){return typeof window<"u"&&window.electronAPI?"electron":"web"}function ku(){if(typeof navigator>"u")return"unknown";let o=navigator.userAgent||"";return/Android/i.test(o)?"Android":/iPhone|iPad|iPod/i.test(o)?"iOS":/Windows/i.test(o)?"Windows":/Mac/i.test(o)?"macOS":/Linux/i.test(o)?"Linux":"unknown"}function wu(){if(typeof navigator>"u")return"unknown";if(nl()==="electron")return"Electron";let o=navigator.userAgent||"";return/Firefox\//i.test(o)?"Firefox":/Edg\//i.test(o)?"Edge":/Chrome\//i.test(o)?"Chrome":/Safari\//i.test(o)?"Safari":"other"}function Lu(){let o={};try{typeof screen<"u"&&(o.screen=`${screen.width}x${screen.height}`),o.lang=localStorage.getItem(v.LANGUAGE)||navigator?.language||"unknown",o.outputMode=localStorage.getItem(v.OUTPUT_MODE)||"stereo";let e=window._synthApp?.engine?.audioContext;e&&(o.audioState=e.state,o.sampleRate=e.sampleRate),o.uptime=Math.round((Date.now()-xu)/1e3)}catch{}return o}function Au(){try{let o=localStorage.getItem(v.TELEMETRY_ID);return o||(o=typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():`${Date.now()}-${Math.random().toString(36).slice(2)}`,localStorage.setItem(v.TELEMETRY_ID,o)),o}catch{return"no-storage"}}function Ds(){if(!ii)return!1;try{return localStorage.getItem(v.TELEMETRY_ENABLED)==="true"}catch{return!1}}function Vi(o){try{localStorage.setItem(v.TELEMETRY_ENABLED,String(!!o)),o&&!Fi&&zs()}catch{}}function Bs(){try{let o=localStorage.getItem(v.TELEMETRY_QUEUE);if(!o)return[];let e=JSON.parse(o);return Array.isArray(e)?e:[]}catch{return[]}}function ba(o){try{let e=o.slice(-Su);localStorage.setItem(v.TELEMETRY_QUEUE,JSON.stringify(e))}catch{}}function ya(){try{localStorage.removeItem(v.TELEMETRY_QUEUE)}catch{}}function il(o,e={}){return{id:Au(),v:Cu,env:nl(),os:ku(),browser:wu(),type:o,data:e,ctx:Lu(),ts:Date.now()}}async function sl(o){if(!ii||o.length===0)return!1;try{return(await fetch(ii,{method:"POST",body:JSON.stringify({events:o}),redirect:"follow",credentials:"omit"})).ok}catch{return!1}}function Ru(o){if(!(!ii||o.length===0))try{let e=new Blob([JSON.stringify({events:o})],{type:"text/plain"});navigator.sendBeacon(ii,e)}catch{}}async function Is(){if(!Ds())return;let e=[...Bs(),...sn];if(sn=[],e.length===0)return;await sl(e)?(ya(),fa.debug(`Flush: ${e.length} eventos enviados`)):(ba(e),fa.debug("Flush fallido, eventos guardados offline"))}function ut(o,e={}){if(!Ds()||Ns>=el)return;let t=il(o,e);sn.push(t),Ns++,typeof navigator<"u"&&!navigator.onLine&&(ba([...Bs(),...sn]),sn=[])}function ol(o){zi>=tl||(zi++,ut("error",{message:o.message,type:o.type,source:o.source||"",line:o.line||0,col:o.col||0,stack:o.stack||"",errorCount:zi}))}function zs(){if(!Fi&&Ds()){Fi=!0;try{sessionStorage.getItem("telemetry_session_started")||(ut("session_start"),sessionStorage.setItem("telemetry_session_started","1"))}catch{ut("session_start")}setTimeout(()=>Is().catch(()=>{}),3e3),Os=Jr(ol),Ps=setInterval(Is,Eu),typeof document<"u"&&document.addEventListener("visibilitychange",()=>{if(document.visibilityState==="hidden"){let e=[...Bs(),...sn];sn=[],e.length>0&&(Ru(e),ya())}}),typeof window<"u"&&window.addEventListener("online",()=>{Is().catch(()=>{})}),fa.info("Telemetr\xEDa inicializada")}}var fa,ii,Cu,el,Eu,Su,tl,sn,Ns,zi,Ps,Fi,Os,xu,Tu,Pn=Xe(()=>{be();Te();Ms();fa=W("Telemetry"),ii="https://script.google.com/macros/s/AKfycbwCVnpOnyDLPBurXAJwAu5c6ItTxCRH7J7yIDbqv0AjCuf_QDHgWZkOhtRt87AECKfj3Q/exec",Cu="0.7.0-20260227.092510",el=20,Eu=3e4,Su=50,tl=6,sn=[],Ns=0,zi=0,Ps=null,Fi=!1,Os=null;xu=Date.now();Tu={get initialized(){return Fi},get sessionEventCount(){return Ns},get autoErrorCount(){return zi},get eventQueue(){return sn},get ENDPOINT_URL(){return ii},get MAX_EVENTS_PER_SESSION(){return el},get MAX_AUTO_ERRORS(){return tl},buildPayload:il,sendBatch:sl,loadOfflineQueue:Bs,saveOfflineQueue:ba,clearOfflineQueue:ya,reset(){Ps!==null&&(clearInterval(Ps),Ps=null),Os&&(Os(),Os=null),Fi=!1,sn=[],Ns=0,zi=0}}});var Rl={};Ot(Rl,{DEFAULT_LOCALE:()=>Nt,LANGUAGE_NAMES:()=>Yu,SUPPORTED_LOCALES:()=>di});var di,Nt,Yu,Fa=Xe(()=>{di=["en","es","fr","de","it","pt","cs"],Nt="en",Yu={en:"English",es:"Espa\xF1ol",fr:"Fran\xE7ais",de:"Deutsch",it:"Italiano",pt:"Portugu\xEAs",cs:"\u010Ce\u0161tina"}});var Tl={};Ot(Tl,{default:()=>Ku});var Ku,Ml=Xe(()=>{Ku={"settings.language.en":"English","settings.language.es":"Espa\xF1ol","settings.language.fr":"Fran\xE7ais","settings.language.de":"Deutsch","settings.language.it":"Italiano","settings.language.pt":"Portugu\xEAs","settings.language.cs":"\u010Ce\u0161tina","splash.loading":"Na\u010D\xEDt\xE1n\xED","app.windowTitle":"Synthi GME (emul\xE1tor EMS Synthi 100 z Cuency, \u0160pan\u011Blsko)","common.yes":"Ano","common.no":"Ne","common.cancel":"Zru\u0161it","common.ok":"OK","settings.title":"Nastaven\xED","settings.close":"Zav\u0159\xEDt nastaven\xED","settings.tab.general":"Obecn\xE9","settings.tab.audio":"Zvuk","settings.tab.advanced":"Pokro\u010Dil\xE9","settings.tab.osc":"OSC","settings.tab.about":"O aplikaci","settings.tab.select":"Vybrat sekci","settings.tab.interface":"Rozhran\xED","settings.display.inactivePins":"Neaktivn\xED kol\xEDky","settings.display.inactivePins.description":"Kol\xEDky matice, kter\xE9 nepropojuj\xED \u017E\xE1dn\xFD zdroj s \u017E\xE1dn\xFDm c\xEDlem, jsou pova\u017Eov\xE1ny za neaktivn\xED. Ve v\xFDchoz\xEDm nastaven\xED se zobrazuj\xED ztlumen\xE9 a nelze je klikat.","settings.display.inactivePins.show":"Zobrazit neaktivn\xED kol\xEDky jako aktivn\xED","settings.display.pip":"Vizu\xE1ln\xED rozlo\u017Een\xED","settings.display.pip.description":"Vizu\xE1ln\xED rozlo\u017Een\xED zahrnuje polohu a velikost plovouc\xEDch panel\u016F a polohu p\u0159ibl\xED\u017Een\xED a posunut\xED hlavn\xEDho pl\xE1tna. P\u0159i aktivaci je toto rozlo\u017Een\xED obnoveno p\u0159i op\u011Btovn\xE9m otev\u0159en\xED aplikace.","settings.display.pip.remember":"Zapamatovat si vizu\xE1ln\xED rozlo\u017Een\xED mezi relacemi","settings.display.paramInfo":"Informace o parametrech","settings.display.paramInfo.description":"Zobrazte roz\u0161\xED\u0159en\xE9 technick\xE9 informace v tipech ovl\xE1dac\xEDch prvk\u016F. Tyto hodnoty by nebyly viditeln\xE9 v p\u016Fvodn\xEDm hardwaru Synthi.","settings.display.paramInfo.voltage":"Zobrazit elektrick\xE9 hodnoty (V, Vp-p, \u03A9)","settings.display.paramInfo.audio":"Zobrazit zvukov\xE9 hodnoty (frekvence, zisk)","settings.display.faderResponse":"Odezva v\xFDstupn\xEDch fader\u016F","settings.display.faderResponse.description":"P\u016Fvodn\xED Synthi m\xE1 logaritmickou odezvu, kde v\u011Bt\u0161ina zm\u011Bn hlasitosti nast\xE1v\xE1 na konci dr\xE1hy faderu. Povolte line\xE1rn\xED odezvu pro snaz\u0161\xED ovl\xE1d\xE1n\xED na \xFAkor autenticity.","settings.display.faderResponse.linear":"Line\xE1rn\xED odezva zisku (snaz\u0161\xED ovl\xE1d\xE1n\xED)","settings.display.knobStyle":"Vzhled oto\u010Dn\xFDch knofl\xEDk\u016F","settings.display.knobStyle.description":"Vyberte si mezi autentick\xFDm designem Synthi 100 (SVG s barevn\xFDmi st\u0159edy a stupnicov\xFDm krou\u017Ekem) nebo zjednodu\u0161en\xFDm CSS designem.","settings.display.knobStyle.svg":"Autentick\xFD Synthi 100 (SVG knofl\xEDky se stupnic\xED)","settings.display.knobStyle.css":"Zjednodu\u0161en\xFD (CSS knofl\xEDky)","settings.display.glow":"Efekt z\xE1\u0159e ovl\xE1dac\xEDch prvk\u016F","settings.display.glow.description":"Pulzuj\xEDc\xED z\xE1\u0159e kolem knofl\xEDk\u016F, posuvn\xEDk\u016F, pad\u016F a pin\u016F p\u0159i zm\u011Bn\u011B jejich hodnoty. U\u017Eite\u010Dn\xE9 pro \u017Eiv\xE9 v\xFDkony, aby publikum vid\u011Blo, co se upravuje. Z\xE1\u0159e se aktivuje p\u0159i interakci, na\u010D\xEDt\xE1n\xED patch\u016F, OSC zpr\xE1v\xE1ch a resetech.","settings.display.glow.performance":"Performance: maxim\xE1ln\xED viditelnost pro \u017Eiv\xE9 show","settings.display.glow.standard":"Standardn\xED: viditeln\xFD a vyv\xE1\u017Een\xFD efekt","settings.display.glow.subtle":"Jemn\xFD: sotva viditeln\xFD, pro osobn\xED pou\u017Eit\xED","settings.display.glow.off":"Vypnuto: \u017E\xE1dn\xFD efekt z\xE1\u0159e","settings.display.sharpRasterize":"Ostrost zoomu","settings.display.sharpRasterize.description":"P\u0159i zv\u011Bt\u0161ov\xE1n\xED prohl\xED\u017Ee\u010D natahuje mezipam\u011B\u0165ov\xE9 textury, kter\xE9 vypadaj\xED rozmazan\u011B. Adaptivn\xED rasterizace p\u0159ekresl\xED rozhran\xED v pln\xE9m rozli\u0161en\xED po ukon\u010Den\xED interakce, co\u017E vytvo\u0159\xED ostr\xFD obraz. B\u011Bhem p\u0159ekreslen\xED m\u016F\u017Ee doj\xEDt k kr\xE1tk\xE9 pauze.","settings.display.sharpRasterize.enable":"Povolit adaptivn\xED rasterizaci","settings.display.touchInteraction":"Dotykov\xE1 interakce","settings.display.touchInteraction.description":"Mo\u017Enosti dotykov\xFDch gest na mobiln\xEDch za\u0159\xEDzen\xEDch a tabletech. Upravte chov\xE1n\xED posunu a v\xEDceprstov\xE9ho ovl\xE1d\xE1n\xED podle sv\xFDch pot\u0159eb.","settings.display.touchInteraction.singleFingerPan":"Posouvat pl\xE1tno jedn\xEDm prstem","settings.display.touchInteraction.singleFingerPan.description":"P\u0159eta\u017Een\xEDm na pozad\xED pl\xE1tna jedn\xEDm prstem posunete zobrazen\xED. P\u0159i deaktivaci pou\u017Eijte gesto sev\u0159en\xED dv\u011Bma prsty.","settings.display.touchInteraction.multitouch":"V\xEDcedotykov\xE9 ovl\xE1d\xE1n\xED","settings.display.touchInteraction.multitouch.description":"Ovl\xE1dejte v\xEDce knofl\xEDk\u016F a posuvn\xEDk\u016F sou\u010Dasn\u011B r\u016Fzn\xFDmi prsty. P\u0159i deaktivaci reaguje na dotek pouze jeden ovl\xE1dac\xED prvek, \u010D\xEDm\u017E se zabr\xE1n\xED necht\u011Bn\xFDm zm\u011Bn\xE1m p\u0159i gestech zoomu/posunu.","settings.osc.title":"OSC komunikace","settings.osc.description":"OSC (Open Sound Control) umo\u017E\u0148uje v\xEDce instanc\xED SynthiGME synchronizovat se v re\xE1ln\xE9m \u010Dase p\u0159es m\xEDstn\xED s\xED\u0165. Kdy\u017E se ovl\xE1dac\xED prvek na jedn\xE9 instanci p\u0159esune, v\u0161echny p\u0159ipojen\xE9 instance zm\u011Bnu zobraz\xED.","settings.osc.enable":"Povolit OSC","settings.osc.electronOnly":"OSC je dostupn\xE9 pouze v desktopov\xE9 aplikaci (Electron).","settings.osc.mode":"Re\u017Eim komunikace","settings.osc.mode.peer":"Peer-to-peer (pos\xEDlat a p\u0159ij\xEDmat)","settings.osc.mode.master":"Master (pouze pos\xEDl\xE1n\xED)","settings.osc.mode.slave":"Slave (pouze p\u0159ij\xEDm\xE1n\xED)","settings.osc.prefix":"P\u0159edpona adresy","settings.osc.prefix.description":"V\u0161echny zpr\xE1vy OSC pou\u017E\xEDvaj\xED tuto p\u0159edponu. Budou se synchronizovat pouze instance se stejnou p\u0159edponou.","settings.osc.supercollider":"SuperCollider","settings.osc.supercollider.send":"Poslat do SuperCollider","settings.osc.supercollider.send.description":"Pos\xEDl\xE1 zpr\xE1vy OSC do SuperCollider na localhost (127.0.0.1:57120).","settings.osc.supercollider.receive":"P\u0159ij\xEDmat ze SuperCollider","settings.osc.supercollider.receive.description":"P\u0159ij\xEDm\xE1 zpr\xE1vy OSC z SuperCollider pro \u0159\xEDzen\xED SynthiGME.","settings.osc.supercollider.port":"SC port","settings.osc.port":"Port poslouch\xE1n\xED","settings.osc.port.description":"UDP port, kde SynthiGME p\u0159ij\xEDm\xE1 zpr\xE1vy OSC. Zm\u011B\u0148te, pokud jin\xFD program (nap\u0159. SuperCollider) pou\u017E\xEDv\xE1 v\xFDchoz\xED port.","settings.osc.port.note":"(Vy\u017Eaduje restart OSC)","settings.osc.targets":"C\xEDle Unicast","settings.osc.targets.description":"P\u0159idejte konkr\xE9tn\xED IP adresy pro aplikace, kter\xE9 nepodporuj\xED multicast (jako SuperCollider).","settings.osc.targets.add":"P\u0159idat c\xEDl","settings.osc.targets.ip":"IP adresa","settings.osc.targets.port":"Port","settings.osc.targets.remove":"Odstranit","settings.osc.log":"Protokol zpr\xE1v","settings.osc.log.show":"Zobrazit plovouc\xED okno protokolu","settings.osc.status":"Stav","settings.osc.status.stopped":"Zastaveno","settings.osc.status.running":"B\u011B\u017E\xED","settings.osc.status.error":"Chyba","osc.log.title":"OSC protokol","osc.log.filter.all":"V\u0161e","osc.log.filter.in":"Vstup","osc.log.filter.out":"V\xFDstup","osc.log.pause":"Pozastavit","osc.log.resume":"Pokra\u010Dovat","osc.log.clear":"Vymazat","osc.log.close":"Zav\u0159\xEDt","osc.log.noMessages":"Zat\xEDm \u017E\xE1dn\xE9 zpr\xE1vy...","osc.log.messageCount":"{count} zpr\xE1v","settings.about.description":"Webov\xE1 verze modul\xE1rn\xEDho syntez\xE1toru Synthi GME, inspirovan\xE1 EMS Synthi 100 z Gabinete de M\xFAsica Electroac\xFAstica (GME) v Cuence. Narozena jako Fin\xE1ln\xED projekt Mistra v Sound Art na Universitat de Barcelona (2019/2020), tato webov\xE1 verze sleduje stejn\xFD pedagogick\xFD a experiment\xE1ln\xED c\xEDl s bezprobl\xE9movou distribuc\xED.","settings.about.info":"Informace","settings.about.version":"Verze:","settings.about.author":"Autor:","settings.about.license":"Licence:","settings.about.links":"Odkazy","settings.about.repository":"GitHub repozit\xE1\u0159","settings.about.issues":"Nahl\xE1sit chybu / Kontakt","settings.about.telegram":"P\u0159ipojte se k na\u0161\xED skupin\u011B na Telegramu","settings.about.originalProject":"P\u016Fvodn\xED projekt (SuperCollider)","settings.about.credits":"Kredity","settings.about.credits.development":"V\xFDvoj a design rozhran\xED:","settings.about.credits.appIcons":"Ikony aplikace:","settings.about.credits.uiIcons":"Ikony UI:","settings.about.credits.inspiration":"Inspirov\xE1no:","settings.language":"Jazyk","settings.scale":"M\u011B\u0159\xEDtko vykreslov\xE1n\xED","settings.scale.description":'Vy\u0161\u0161\xED m\u011B\u0159\xEDtko = ostr\u011Bj\u0161\xED obraz, ale v\u011Bt\u0161\xED vyu\u017Eit\xED prost\u0159edk\u016F. Resetuje se na 1\xD7 p\u0159i restartov\xE1n\xED, pokud nen\xED povolena mo\u017Enost "Zapamatovat".',"settings.scale.current":"Aktu\xE1ln\xED m\u011B\u0159\xEDtko:","settings.scale.remember":"Zapamatovat si p\u0159i restartov\xE1n\xED","settings.updates":"Aktualizace","settings.updates.version":"Aktu\xE1ln\xED verze:","settings.updates.check":"Zkontrolovat aktualizace","settings.updates.checking":"Kontrola...","settings.updates.available":"Dostupn\xE1 nov\xE1 verze!","settings.updates.pendingInstall":"Nov\xE1 verze je p\u0159ipravena k instalaci","settings.updates.install":"Instalovat aktualizaci","settings.updates.installAndReload":"Instalovat a znovu na\u010D\xEDst","settings.updates.installing":"Instalace...","settings.updates.upToDate":"Jste aktu\xE1ln\xED \u2713","settings.updates.error":"Chyba p\u0159i kontrole aktualizac\xED","settings.autosave":"Automatick\xE9 ukl\xE1d\xE1n\xED","settings.autosave.description":"Automaticky ulo\u017Eit aktu\xE1ln\xED stav periodicky","settings.autosave.interval":"Interval ukl\xE1d\xE1n\xED","settings.autosave.interval.off":"Deaktivov\xE1no","settings.autosave.interval.30s":"Ka\u017Ed\xFDch 30 sekund","settings.autosave.interval.1m":"Ka\u017Edou 1 minutu","settings.autosave.interval.5m":"Ka\u017Ed\xFDch 5 minut","settings.autosave.interval.10m":"Ka\u017Ed\xFDch 10 minut","settings.autosave.onExit":"Ulo\u017Eit p\u0159i zav\u0159en\xED","settings.autosave.onExit.description":"Ulo\u017Eit aktu\xE1ln\xED stav p\u0159i zav\u0159en\xED aplikace","settings.autosave.restoreOnStart":"Obnovit p\u0159i spu\u0161t\u011Bn\xED","settings.autosave.restoreOnStart.description":"Zeptat se na obnoven\xED posledn\xEDho ulo\u017Een\xE9ho stavu p\u0159i otev\u0159en\xED aplikace","settings.autosave.askBeforeRestore":"Zeptat se p\u0159ed obnoven\xEDm","settings.autosave.askBeforeRestore.description":"Zobrazit potvrzovac\xED dialog p\u0159ed obnoven\xEDm (lze zm\u011Bnit z dialogu)","settings.wakelock":"Udr\u017Eet obrazovku v probuzen\xED","settings.wakelock.description":"Br\xE1n\xED vypnut\xED obrazovky, kdy\u017E je aplikace otev\u0159en\xE1","settings.wakelock.unsupported":"Nen\xED v tomto prohl\xED\u017Ee\u010Di podporov\xE1no","settings.shortcuts":"Kl\xE1vesov\xE9 zkratky","settings.shortcuts.description":"Kliknut\xEDm na zkratku ji zm\u011B\u0148te. Stiskn\u011Bte novou kombinaci kl\xE1ves.","settings.shortcuts.knobModifiers":"Oto\u010Dn\xE9 knofl\xEDky: podr\u017Ete Ctrl/Cmd pro 10x rychlej\u0161\xED pohyb, Shift pro 10x jemn\u011Bj\u0161\xED ovl\xE1d\xE1n\xED.","settings.shortcuts.mute":"Ztlumit/Zru\u0161it ztlumen\xED","settings.shortcuts.record":"Nahr\xE1vat/Zastavit","settings.shortcuts.patches":"Otev\u0159\xEDt patches","settings.shortcuts.settings":"Otev\u0159\xEDt nastaven\xED","settings.shortcuts.fullscreen":"P\u0159epnout na celou obrazovku","settings.shortcuts.reset":"Resetovat syntez\xE1tor","settings.shortcuts.showPanelHints":"Zobrazit \u010D\xEDsla panel\u016F (podr\u017Eet)","settings.shortcuts.signalFlow":"Zv\xFDraznit tok sign\xE1lu (podr\u017Eet)","settings.shortcuts.panel1":"Panel 1","settings.shortcuts.panel2":"Panel 2","settings.shortcuts.panel3":"Panel 3","settings.shortcuts.panel4":"Panel 4","settings.shortcuts.panel5":"Panel 5","settings.shortcuts.panel6":"Panel 6","settings.shortcuts.panelOutput":"V\xFDstupn\xED panel","settings.shortcuts.overview":"P\u0159ehled (v\u0161echny panely)","settings.shortcuts.press":"Stiskn\u011Bte kl\xE1vesu...","settings.shortcuts.none":"\u017D\xE1dn\xFD","settings.shortcuts.conflict":"Ji\u017E p\u0159i\u0159azeno k: {action}","settings.shortcuts.reserved":"Tato kl\xE1vesa je vyhrazena","settings.shortcuts.resetDefaults":"Resetovat zkratky","settings.signalFlow":"Tok sign\xE1lu","settings.signalFlow.description":"Vizu\xE1ln\u011B zv\xFDrazn\xED zdroj (azurov\xE1) a c\xEDl (purpurov\xE1) p\u0159ipojen\xED p\u0159i najet\xED na moduly nebo aktivn\xED piny. Na desktopu vy\u017Eaduje podr\u017Een\xED modifika\u010Dn\xED kl\xE1vesy.","settings.signalFlow.noModifier":"Aktivovat bez modifika\u010Dn\xED kl\xE1vesy (doporu\u010Deno na tabletech)","settings.signalFlow.enabled":"Zobrazit tok sign\xE1lu p\u0159i najet\xED","toast.autosave":"Stav automaticky ulo\u017Een","toast.autosave.exit":"Stav ulo\u017Een p\u0159ed zav\u0159en\xEDm","toast.restored":"P\u0159edchoz\xED stav obnoven","audio.title":"Nastaven\xED zvuku","audio.close":"Zav\u0159\xEDt nastaven\xED","audio.device.output":"V\xFDstupn\xED za\u0159\xEDzen\xED:","audio.device.input":"Vstupn\xED za\u0159\xEDzen\xED:","audio.device.default":"V\xFDchoz\xED za\u0159\xEDzen\xED","audio.device.loading":"Na\u010D\xEDt\xE1n\xED za\u0159\xEDzen\xED...","audio.device.error":"Chyba p\u0159i na\u010D\xEDt\xE1n\xED za\u0159\xEDzen\xED","audio.device.system":"Syst\xE9m","audio.mode.title":"Re\u017Eim v\xFDstupu","audio.mode.stereo":"Stereo","audio.mode.multichannel":"V\xEDcekan\xE1lov\xFD (12ch)","audio.mode.multichannel.desc":"12 nez\xE1visl\xFDch kan\xE1l\u016F p\u0159es PipeWire. Sm\u011Brovat v qpwgraph.","audio.mode.unavailable":"(Vy\u017Eaduje Electron + PipeWire)","audio.outputs.title":"V\xFDstupy \u2192 Syst\xE9m","audio.outputs.channels":"Zji\u0161t\u011Bn\xE9 kan\xE1ly:","audio.outputs.description":"Sm\u011Brovat logick\xE9 v\xFDstupy Synthi na fyzick\xE9 v\xFDstupy syst\xE9mu.","audio.outputs.more":"+{count} v\xEDce \u0159\xE1dk\u016F (proch\xE1zejte a zobrazte)","audio.outputs.reset":"Obnovit v\xFDchoz\xED","audio.inputs.title":"Syst\xE9m \u2192 Vstupn\xED zesilova\u010De","audio.inputs.channels":"Vstupn\xED kan\xE1ly:","audio.inputs.description":"Sm\u011Brovat fyzick\xE9 vstupy syst\xE9mu na Vstupn\xED zesilova\u010De Synthi.","audio.inputs.enable":"Povolit zvukov\xFD vstup","audio.inputs.permission":"Vy\u017Eaduje povolen\xED mikrofonu.","audio.inputs.enabled":"\u2713 Vstup povolen","audio.inputs.multichannel.title":"PipeWire \u2192 Vstupn\xED zesilova\u010De","audio.inputs.multichannel.description":"Sm\u011Brovat 8 vstupn\xEDch kan\xE1l\u016F PipeWire na Vstupn\xED zesilova\u010De.","audio.inputs.multichannel.labels":"input_amp_{n}","audio.inputs.reset":"Obnovit v\xFDchoz\xED","audio.latency.title":"Latence","audio.latency.description":"Upravte zvukov\xFD buffer. Ni\u017E\u0161\xED = rychlej\u0161\xED odezva, ale vy\u0161\u0161\xED riziko prask\xE1n\xED.","audio.latency.webAudio":"Web Audio Buffer:","audio.latency.multichannel":"V\xEDcekan\xE1lov\xFD buffer:","audio.latency.interactive":"~10ms (Interaktivn\xED)","audio.latency.balanced":"~25ms (Vyv\xE1\u017Een\xFD)","audio.latency.playback":"~50ms (P\u0159ehr\xE1v\xE1n\xED)","audio.latency.safe":"~100ms (Bezpe\u010Dn\xFD)","audio.latency.maximum":"~200ms (Maximum)","audio.latency.veryLow":"velmi n\xEDzk\xE1","audio.latency.low":"n\xEDzk\xE1","audio.latency.normal":"norm\xE1ln\xED","audio.latency.high":"vysok\xE1","audio.latency.veryHigh":"velmi vysok\xE1","audio.latency.total":"Odhadovan\xE1 celkov\xE1 latence:","audio.latency.restartRequired":"\u26A0\uFE0F Restartujte app pro proveden\xED zm\u011Bn","audio.latency.reconnectRequired":"\u26A0\uFE0F Vypn\u011Bte a znovu zapn\u011Bte za\u0159\xEDzen\xED","audio.permission.denied.title":"P\u0159\xEDstup k mikrofonu odep\u0159en","audio.permission.denied.message":"Povolte mikrofon v nastaven\xED prohl\xED\u017Ee\u010De nebo syst\xE9mu, abyste mohli pou\u017E\xEDvat zvukov\xE9 vstupy.","audio.permission.retry":"Zkusit znovu","audio.channel.mono":"Mono","audio.channel.stereo":"Stereo","audio.channel.quad":"Kvadrafonn\xED","audio.channel.surround":"5.1 Surround","quickbar.open":"Otev\u0159\xEDt rychl\xE9 akce","quickbar.close":"Zav\u0159\xEDt rychl\xE9 akce","quickbar.pan.lock":"Uzamknout posun","quickbar.pan.unlock":"Odemknout posun","quickbar.zoom.lock":"Uzamknout p\u0159ibl\xED\u017Een\xED","quickbar.zoom.unlock":"Odemknout p\u0159ibl\xED\u017Een\xED","quickbar.settings":"Nastaven\xED (S)","quickbar.patches":"Patches (P)","quickbar.pip":"Plovouc\xED panely","quickbar.audio":"Nastaven\xED zvuku (A)","quickbar.emergency":"Resetovat m\u011B\u0159\xEDtko na 1\xD7 (nouzov\xFD re\u017Eim)","quickbar.emergency.applied":"M\u011B\u0159\xEDtko resetov\xE1no na 1\xD7","quickbar.mute":"Ztlumit zvuk (M)","quickbar.unmute":"Zru\u0161it ztlumen\xED zvuku (M)","toast.mute":"Zvuk ztlumen","toast.unmute":"Zvuk aktivn\xED","toast.dspEnabled":"Zvukov\xFD engine povolen","toast.dspDisabled":"Zvukov\xFD engine zak\xE1z\xE1n","toast.dspRequired":"Zvukov\xFD engine je zak\xE1z\xE1n. Povolte jej v nastaven\xED zvuku.","quickbar.fullscreen":"Cel\xE1 obrazovka (F)","quickbar.fullscreen.exit":"Ukon\u010Dit celou obrazovku (Esc)","quickbar.reset":"Resetovat syntez\xE1tor (Shift+I)","synth.reset.confirm":"Jste si jisti, \u017Ee chcete resetovat syntez\xE1tor na po\u010D\xE1te\u010Dn\xED hodnoty?","common.dontAskAgain":"Znovu se neptat","settings.synth.confirmReset":"P\u0159i resetov\xE1n\xED syntez\xE1toru po\u017E\xE1dat o potvrzen\xED","quickbar.oscOn":"OSC povoleno - Kliknut\xEDm zaka\u017Ete","quickbar.oscOff":"OSC zak\xE1z\xE1no - Kliknut\xEDm povolte","quickbar.oscError":"Chyba p\u0159i povolov\xE1n\xED OSC","quickbar.undo":"Zp\u011Bt (Ctrl+Z)","quickbar.redo":"Znovu (Ctrl+U)","toast.undo":"Zm\u011Bna vr\xE1cena","toast.redo":"Zm\u011Bna obnovena","quickbar.record":"Nahr\xE1vat zvuk (R)","quickbar.stopRecording":"Zastavit nahr\xE1v\xE1n\xED (R)","quickbar.recordSettings":"Nastaven\xED nahr\xE1v\xE1n\xED","recording.title":"Nastaven\xED nahr\xE1v\xE1n\xED","recording.close":"Close recording settings","recording.tracks.label":"Po\u010Det stop","recording.tracks.mono":"1 (Mono)","recording.tracks.stereo":"2 (Stereo)","recording.tracks.tracks":"stopy","recording.track":"Stopa","recording.routing.title":"Sm\u011Brov\xE1n\xED nahr\xE1vac\xEDch stop","recording.routing.description":"Vyberte, kter\xE9 v\xFDstupy se nahr\xE1vaj\xED na ka\u017Edou stopu","recording.format.label":"Form\xE1t","recording.format.wav":"WAV (bezeztr\xE1tov\xFD, v\xEDcestop\xFD)","recording.format.webmOpus":"WebM/Opus (komprimovan\xFD, stereo)","recording.format.wavDesc":"Bezeztr\xE1tov\xFD 16-bit PCM. A\u017E 12 stop s vlastn\xEDm sm\u011Brov\xE1n\xEDm. Velk\xE9 soubory.","recording.format.webmOpusDesc":"Vysoce kvalitn\xED komprimovan\xFD zvuk. Pouze stereo. Mnohem men\u0161\xED soubory, ide\xE1ln\xED pro sd\xEDlen\xED.","recording.bitrate.label":"Kvalita (bitrate)","recording.bitrate.recommended":"doporu\u010Deno","recording.overlay.recording":"Prob\xEDh\xE1 nahr\xE1v\xE1n\xED","settings.recording":"Zvukov\xFD z\xE1znam","settings.recording.description":"Zaznamenat zvukov\xFD v\xFDstup do WAV (bezeztr\xE1tov\xFD) nebo WebM/Opus (komprimovan\xFD)","settings.recording.configure":"Konfigurovat nahr\xE1v\xE1n\xED","toast.recordingStarted":"Nahr\xE1v\xE1n\xED zah\xE1jeno","toast.recordingSaved":"Nahr\xE1v\xE1n\xED ulo\u017Eeno: {filename}","toast.recordingEmpty":"\u017D\xE1dn\xFD zvuk nahran\xFD","toast.recordingError":"Chyba nahr\xE1v\xE1n\xED","settings.reset":"Obnovit v\xFDchoz\xED nastaven\xED","settings.reset.description":"Odstran\xED v\u0161echny ulo\u017Een\xE9 p\u0159edvolby a obnov\xED v\xFDchoz\xED hodnoty. Str\xE1nka se znovu na\u010Dte.","settings.reset.button":"Obnovit v\xFDchoz\xED hodnoty","settings.reset.confirm":"Jste si jisti, \u017Ee chcete obnovit v\u0161echna nastaven\xED na v\xFDchoz\xED hodnoty? Str\xE1nka se znovu na\u010Dte.","settings.optimizations":"Optimalizace v\xFDkonu","settings.optimizations.description":"Tyto mo\u017Enosti sni\u017Euj\xED zat\xED\u017Een\xED CPU vypnut\xEDm zpracov\xE1n\xED zvuku, kdy\u017E nen\xED pot\u0159eba. Zvl\xE1\u0161t\u011B u\u017Eite\u010Dn\xE9 na mobiln\xEDch za\u0159\xEDzen\xEDch.","settings.optimizations.debugGlobal":"Zobrazit debug upozorn\u011Bn\xED pro v\u0161echny optimalizace","settings.dsp":"Zvukov\xFD engine (DSP)","settings.dsp.description":"Povol\xED nebo zak\xE1\u017Ee zvukov\xFD engine. P\u0159i zak\xE1z\xE1n\xED aplikace funguje jako OSC kontroler bez zpracov\xE1n\xED zvuku.","settings.dsp.enabled":"Zvukov\xFD engine povolen","settings.dsp.startEnabled":"Povolit zvuk p\u0159i spu\u0161t\u011Bn\xED","settings.dormancy":"Dormance modulu","settings.dormancy.description":"Automaticky ztlumuje moduly, kter\xE9 nejsou propojeny v matici.","settings.dormancy.enabled":"Povolit syst\xE9m dormance","settings.dormancy.debug":"Pouze lad\u011Bn\xED dormance","settings.filterBypass":"Obejit\xED filtru","settings.filterBypass.description":"Obch\xE1z\xED LP/HP filtry v\xFDstupn\xEDch kan\xE1l\u016F a filtr colour \u0161umu v neutr\xE1ln\xED poloze, \u010D\xEDm\u017E sni\u017Euje zat\xED\u017Een\xED CPU.","settings.filterBypass.enabled":"Povolit obejit\xED filtru","settings.filterBypass.debug":"Pouze lad\u011Bn\xED obejit\xED filtru","settings.latencyMode":"Re\u017Eim latence","settings.latencyMode.description":'Upravuje velikost zvukov\xE9ho bufferu. Pou\u017E\xEDvejte "P\u0159ehr\xE1v\xE1n\xED" na mobilech pro stabilitu, "Interaktivn\xED" na desktopu pro n\xEDzkou latenci.',"settings.latencyMode.interactive":"Interaktivn\xED (~10 ms)","settings.latencyMode.balanced":"Vyv\xE1\u017Een\xFD (~25 ms)","settings.latencyMode.playback":"P\u0159ehr\xE1v\xE1n\xED (~50 ms)","settings.latencyMode.safe":"Bezpe\u010Dn\xFD (100 ms)","settings.latencyMode.maximum":"Maximum (200 ms)","settings.latencyMode.restartRequired":"Re\u017Eim latence ulo\u017Een. Restartujte aplikaci, aby se zm\u011Bny projevily.","settings.voltageEmulation":"Emulace nap\u011Bt\xED","settings.voltageEmulation.description":"Emuluje elektrick\xE9 chov\xE1n\xED verze Synthi 100 Cuenca/Datanomics (1982). Tyto mo\u017Enosti ovliv\u0148uj\xED p\u0159esnost analogov\xFDch sign\xE1l\u016F.","settings.voltageEmulation.softClip":"M\u011Bkk\xE9 o\u0159\xEDznut\xED","settings.voltageEmulation.softClip.description":"M\u011Bkce nasycuje sign\xE1ly tanh(), kter\xE9 p\u0159ekro\u010Duj\xED vstupn\xED limity ka\u017Ed\xE9ho modulu (typicky 8V p-p).","settings.voltageEmulation.pinTolerance":"Tolerance kol\xEDku","settings.voltageEmulation.pinTolerance.description":"Aplikuje realistickou variaci podle typu kol\xEDku: \u0161ed\xE1 \xB10,5%, b\xEDl\xE1 \xB110%. Ka\u017Ed\xE9 p\u0159ipojen\xED m\xE1 svou vlastn\xED reprodukovatelnou toleranci.","settings.voltageEmulation.thermalDrift":"Tepeln\xE1 drift","settings.voltageEmulation.thermalDrift.description":"Simuluje pomal\xFD drift (\xB10,1%) oscil\xE1tor\u016F CEM 3340 zp\u016Fsoben\xFD zm\u011Bnami teploty.","menu.file":"Soubor","menu.file.patches":"Patches\u2026","menu.file.language":"Jazyk","menu.file.reload":"Znovu na\u010D\xEDst","menu.file.reload.confirm":"Znovu na\u010D\xEDst aplikaci? Neulo\u017Een\xE9 zm\u011Bny budou ztraceny.","menu.file.quit":"Ukon\u010Dit","menu.file.quit.confirm":"Ukon\u010Dit aplikaci?","menu.preferences":"P\u0159edvolby","menu.preferences.settings":"V\u0161echna nastaven\xED\u2026","menu.view":"Zobrazen\xED","menu.view.quickbar":"Zobrazit rychlou li\u0161tu","menu.view.fullscreen":"Cel\xE1 obrazovka","menu.view.zoomIn":"P\u0159ibl\xED\u017Eit","menu.view.zoomOut":"Odd\xE1lit","menu.view.zoomReset":"Obnovit p\u0159ibl\xED\u017Een\xED","menu.view.inactivePins":"Zobrazit neaktivn\xED piny","menu.view.tooltipVoltage":"Elektronick\xE9 parametry v tooltipech","menu.view.tooltipAudioRate":"Audio info v tooltipech","menu.view.linearFaders":"Line\xE1rn\xED odezva fader\u016F","menu.view.sharpRasterize":"Adaptivn\xED rasterizace (ostr\xFD zoom)","menu.view.devTools":"N\xE1stroje pro v\xFDvoj\xE1\u0159e","menu.audio":"Zvuk","menu.audio.mute":"Ztlumit","menu.audio.unmute":"Zru\u0161it ztlumen\xED","menu.audio.record":"Nahr\xE1vat","menu.audio.stopRecording":"Zastavit nahr\xE1v\xE1n\xED","menu.audio.audioSettings":"Nastaven\xED zvuku a nahr\xE1v\xE1n\xED\u2026","menu.audio.preventSleep":"Zabr\xE1nit usp\xE1n\xED syst\xE9mu","menu.audio.dsp":"DSP (zvukov\xFD engine)","menu.panels":"Panely","menu.panels.detachHeader":"Odpojit panely","menu.panels.detachAll":"Odpojit v\u0161e","menu.panels.attachAll":"Vr\xE1tit v\u0161e","menu.panels.lockPan":"Uzamknout posun","menu.panels.lockZoom":"Uzamknout p\u0159ibl\xED\u017Een\xED","menu.panels.rememberVisualLayout":"Zapamatovat vizu\xE1ln\xED rozlo\u017Een\xED","menu.panels.singleFingerPan":"Posun jedn\xEDm prstem","menu.panels.multitouchControls":"V\xEDcedotykov\xE9 ovl\xE1d\xE1n\xED","menu.advanced":"Pokro\u010Dil\xE9","menu.advanced.debugGlobal":"Debug upozorn\u011Bn\xED (v\u0161e)","menu.advanced.dormancy":"Dormance modul\u016F","menu.advanced.dormancyDebug":"Lad\u011Bn\xED dormance","menu.advanced.filterBypass":"Obejit\xED filtru","menu.advanced.filterBypassDebug":"Lad\u011Bn\xED obejit\xED filtru","menu.advanced.softClip":"M\u011Bkk\xE9 o\u0159\xEDznut\xED","menu.advanced.pinTolerance":"Tolerance kol\xEDku","menu.advanced.thermalDrift":"Tepeln\xE1 drift","menu.advanced.resetSynth":"Resetovat syntez\xE1tor\u2026","menu.advanced.settings":"V\u0161echna nastaven\xED\u2026","menu.osc":"OSC","menu.osc.enable":"Povolit OSC","menu.osc.sendToSC":"Odeslat do SuperCollideru","menu.osc.receiveFromSC":"P\u0159ijmout ze SuperCollideru","menu.osc.showLog":"Zobrazit OSC protokol","menu.osc.settings":"Nastaven\xED OSC\u2026","menu.help":"N\xE1pov\u011Bda","menu.help.about":"O Synthi GME\u2026","menu.help.repository":"GitHub repozit\xE1\u0159","menu.help.reportBug":"Nahl\xE1sit chybu\u2026","menu.help.checkUpdates":"Zkontrolovat aktualizace\u2026","toast.reset":"Syntez\xE1tor resetov\xE1n na v\xFDchoz\xED","toast.resolution":"M\u011B\u0159\xEDtko: {factor}\xD7","toast.resolution.mobileWarning":"M\u011B\u0159\xEDtko: {factor}\xD7 \u26A0\uFE0F M\u016F\u017Ee zp\u016Fsobit probl\xE9my s v\xFDkonem","toast.pan.locked":"Posun uzam\u010Den","toast.pan.unlocked":"Posun odem\u010Den","toast.zoom.locked":"P\u0159ibl\xED\u017Een\xED uzam\u010Deno","toast.zoom.unlocked":"P\u0159ibl\xED\u017Een\xED odem\u010Deno","pip.detach":"Odpojit panel","pip.detachAll":"Odpojit v\u0161e","pip.attach":"Vr\xE1tit panel","pip.attachAll":"Vr\xE1tit v\u0161e","pip.close":"Zav\u0159\xEDt","pip.zoomIn":"P\u0159ibl\xED\u017Eit","pip.zoomOut":"Odd\xE1lit","pip.maximize":"Maximalizovat","pip.minimize":"Minimalizovat","pip.lock":"Zamknout","pip.unlock":"Odemknout","pip.fitPanel":"P\u0159izp\u016Fsobit panel","pip.placeholderHint":"Dlouh\xFD stisk nebo prav\xE9 tla\u010D\xEDtko pro mo\u017Enosti","panel.oscillators1":"Oscil\xE1tory 1-3","panel.oscilloscope":"Osciloskop","panel.oscillators2":"Oscil\xE1tory 4-6","panel.oscillators3":"Oscil\xE1tory 7-9","panel.audioMatrix":"Zvukov\xE1 matice","panel.controlMatrix":"\u0158\xEDd\xEDc\xED matice","panel.output":"V\xFDstup","contextMenu.resetPanel":"Resetovat panel","contextMenu.resetModule":"Resetovat {name}","contextMenu.resetControl":"Resetovat {name}","notes.add":"P\u0159idat pozn\xE1mku","notes.delete":"Smazat pozn\xE1mku","notes.placeholder":"Pi\u0161te sem...","notes.color":"Zm\u011Bnit barvu","notes.color.yellow":"\u017Dlut\xE1","notes.color.pink":"R\u016F\u017Eov\xE1","notes.color.blue":"Modr\xE1","notes.color.green":"Zelen\xE1","notes.color.orange":"Oran\u017Eov\xE1","notes.color.purple":"Fialov\xE1","notes.fontUp":"Zv\u011Bt\u0161it velikost p\xEDsma","notes.fontDown":"Zmen\u0161it velikost p\xEDsma","notes.ctx.cut":"Vyjmout","notes.ctx.copy":"Kop\xEDrovat","notes.ctx.paste":"Vlo\u017Eit","notes.ctx.bold":"Tu\u010Dn\xE9","notes.ctx.italic":"Kurz\xEDva","notes.ctx.edit":"Upravit","notes.ctx.copyNote":"Kop\xEDrovat pozn\xE1mku","notes.ctx.cutNote":"Vyjmout pozn\xE1mku","notes.ctx.pasteNote":"Vlo\u017Eit pozn\xE1mku","notes.ctx.alignLeft":"Zarovnat vlevo","notes.ctx.alignCenter":"Zarovnat na st\u0159ed","notes.ctx.alignRight":"Zarovnat vpravo","orientation.hint":"Oto\u010Dte za\u0159\xEDzen\xED na \u0161\xED\u0159ku, abyste m\u011Bli lep\u0161\xED z\xE1\u017Eitek","orientation.blocker":"Oto\u010Dte za\u0159\xEDzen\xED na re\u017Eim na \u0161\xED\u0159ku","orientation.blocker.dismiss":"Zav\u0159\xEDt","update.available":"K dispozici je nov\xE1 verze. Chcete ji nyn\xED instalovat a znovu na\u010D\xEDst?","update.installNow":"Instalovat nyn\xED","update.later":"Pozd\u011Bji","error.fullscreen":"Nelze p\u0159epnout na celou obrazovku.","patches.title":"Patches","patches.close":"Zav\u0159\xEDt patches","patches.saveCurrent":"Ulo\u017Eit aktu\xE1ln\xED","patches.saveNew":"Ulo\u017Eit nov\xFD","patches.overwrite":"P\u0159epsat","patches.confirmOverwrite":'P\u0159epsat patch "{name}"?',"patches.overwritten":"Patch p\u0159eps\xE1n","patches.includeVisual":"Zahrnout vizu\xE1ln\xED rozlo\u017Een\xED","patches.hasVisual":"Zahrnuje vizu\xE1ln\xED rozlo\u017Een\xED","patches.search":"Hledat...","patches.empty":"Zat\xEDm nejsou ulo\u017Eeny \u017E\xE1dn\xE9 patches","patches.load":"Na\u010D\xEDst","patches.export":"Exportovat","patches.import":"Importovat","patches.delete":"Smazat","patches.rename":"P\u0159ejmenovat","patches.confirmDelete":'Smazat patch "{name}"?',"patches.confirmLoad":'Na\u010D\xEDst patch "{name}"? Neulo\u017Een\xE9 zm\u011Bny budou ztraceny.',"patches.saved":"Patch ulo\u017Een","patches.loaded":"Patch na\u010Dten","patches.loadedName":'"{name}" na\u010Dten',"patches.deleted":"Patch smaz\xE1n","patches.renamed":"Patch p\u0159ejmenov\xE1n","patches.exported":"Patch exportov\xE1n","patches.imported":"Patch importov\xE1n","patches.errorLoading":"Chyba p\u0159i na\u010D\xEDt\xE1n\xED patchu","patches.errorSaving":"Chyba p\u0159i ukl\xE1d\xE1n\xED patchu","patches.errorRenaming":"Chyba p\u0159i p\u0159ejmenov\xE1n\xED patchu","patches.namePrompt":"N\xE1zev patchu","patches.renamePrompt":"Nov\xFD n\xE1zev","patches.defaultName":"Nov\xFD patch","patches.init":"Init (v\xFDchoz\xED)","patches.lastSession":"Obnovit posledn\xED relaci?","patches.lastSession.yes":"Obnovit","patches.lastSession.no":"Za\u010D\xEDt znovu","patches.lastSession.remember":"Pamatovat si mou volbu","patches.versionWarning":"Tento patch byl vytvo\u0159en se star\u0161\xED verz\xED","matrix.source.inputAmp":"Vstup {channel}","matrix.source.outputBus":"V\xFDstupn\xED sb\u011Brnice {bus}","matrix.source.noiseGen":"\u0160um {index}","matrix.source.panel3Osc.sineSaw":"Osc {osc} (sin+saw)","matrix.source.panel3Osc.triPulse":"Osc {osc} (tri+pul)","matrix.source.joystick":"Joystick {side} {axis}","matrix.dest.outputBus":"V\xFDstup {bus}","matrix.dest.oscilloscope.Y":"Scope Y","matrix.dest.oscilloscope.X":"Scope X","matrix.dest.oscFreqCV":"Osc {osc} Freq CV","matrix.dest.oscSync":"Osc {osc} Sync","matrix.dest.oscPWM":"Osc {osc} PWM","matrix.dest.outputLevelCV":"V\xFDstup {bus} Level CV","matrix.tooltip.format":"{source} \u2192 {dest}","matrix.tooltip.unknownSource":"\u0158\xE1dek {row}","matrix.tooltip.unknownDest":"Sloupec {col}","pinColor.title":"Typ kol\xEDku","pinColor.recommended":"Doporu\u010Deno","pinColor.standard":"Standard","pinColor.special":"Zvl\xE1\u0161tn\xED","pinColor.white":"B\xEDl\xFD (standard)","pinColor.grey":"\u0160ed\xFD (p\u0159esnost)","pinColor.green":"Zelen\xFD (zeslaben\xFD)","pinColor.red":"\u010Cerven\xFD (rozsah)","pinColor.blue":"Modr\xFD (pos\xEDlen\xED)","pinColor.yellow":"\u017Dlut\xFD (st\u0159edn\xED zisk)","pinColor.cyan":"Azurov\xFD (m\u011Bkk\xFD)","pinColor.purple":"Purpurov\xFD (jemn\xFD)","telemetry.consent.title":"Anonymn\xED hl\xE1\u0161en\xED","telemetry.consent.message":"Pomozte zlep\u0161it SynthiGME zas\xEDl\xE1n\xEDm anonymn\xEDch hl\xE1\u0161en\xED o chyb\xE1ch a relac\xEDch. Nejsou shroma\u017E\u010Fov\xE1ny \u017E\xE1dn\xE9 osobn\xED \xFAdaje. Toto m\u016F\u017Eete kdykoli zm\u011Bnit v Nastaven\xED.","telemetry.consent.accept":"Povolit","telemetry.consent.decline":"Ne, d\u011Bkuji","menu.advanced.telemetry":"Anonymn\xED hl\xE1\u0161en\xED","settings.telemetry":"Anonymn\xED hl\xE1\u0161en\xED","settings.telemetry.label":"Zas\xEDlat anonymn\xED hl\xE1\u0161en\xED","settings.telemetry.description":"Zas\xEDl\xE1 anonymn\xED hl\xE1\u0161en\xED o chyb\xE1ch a relac\xEDch pro zlep\u0161en\xED SynthiGME. Nejsou shroma\u017E\u010Fov\xE1ny \u017E\xE1dn\xE9 osobn\xED \xFAdaje, hudebn\xED obsah ani podrobnosti o pou\u017E\xEDv\xE1n\xED. Toto m\u016F\u017Eete kdykoli zm\u011Bnit."}});var Pl={};Ot(Pl,{default:()=>Xu});var Xu,Ol=Xe(()=>{Xu={"settings.language.en":"English","settings.language.es":"Espa\xF1ol","settings.language.fr":"Fran\xE7ais","settings.language.de":"Deutsch","settings.language.it":"Italiano","settings.language.pt":"Portugu\xEAs","settings.language.cs":"\u010Ce\u0161tina","splash.loading":"Laden","app.windowTitle":"Synthi GME (Emulator des EMS Synthi 100 aus Cuenca, Spanien)","common.yes":"Ja","common.no":"Nein","common.cancel":"Abbrechen","common.ok":"OK","settings.title":"Einstellungen","settings.close":"Einstellungen schlie\xDFen","settings.tab.general":"Allgemein","settings.tab.audio":"Audio","settings.tab.advanced":"Erweitert","settings.tab.osc":"OSC","settings.tab.about":"\xDCber","settings.tab.select":"Abschnitt ausw\xE4hlen","settings.tab.interface":"Oberfl\xE4che","settings.display.inactivePins":"Inaktive Pins","settings.display.inactivePins.description":"Matrix-Pins, die keine Quelle mit einem Ziel verbinden, gelten als inaktiv. Standardm\xE4\xDFig werden sie gedimmt und k\xF6nnen nicht angeklickt werden.","settings.display.inactivePins.show":"Inaktive Pins als aktiv anzeigen","settings.display.pip":"Visuelles Layout","settings.display.pip.description":"Das visuelle Layout umfasst Position und Gr\xF6\xDFe der schwebenden Bedienfelder sowie die Zoom- und Scroll-Position der Hauptansicht. Bei Aktivierung wird dieses Layout beim erneuten \xD6ffnen der Anwendung wiederhergestellt.","settings.display.pip.remember":"Visuelles Layout zwischen Sitzungen speichern","settings.display.paramInfo":"Parameterinformationen","settings.display.paramInfo.description":"Erweiterte technische Informationen in Steuerelement-Tooltips anzeigen. Diese Werte w\xE4ren auf der urspr\xFCnglichen Synthi-Hardware nicht sichtbar.","settings.display.paramInfo.voltage":"Elektrische Werte anzeigen (V, Vp-p, \u03A9)","settings.display.paramInfo.audio":"Audiowerte anzeigen (Frequenz, Verst\xE4rkung)","settings.display.faderResponse":"Antwort der Ausgangsfader","settings.display.faderResponse.description":"Das Original-Synthi hat eine logarithmische Reaktion, bei der die meisten Lautst\xE4rke\xE4nderungen am Ende des Faderweges auftreten. Aktivieren Sie die lineare Reaktion f\xFCr eine einfachere Steuerung auf Kosten der Authentizit\xE4t.","settings.display.faderResponse.linear":"Lineare Verst\xE4rkungsantwort (einfachere Steuerung)","settings.display.knobStyle":"Erscheinungsbild der Regler","settings.display.knobStyle.description":"W\xE4hlen Sie zwischen dem authentischen Synthi-100-Design (SVG mit farbigen Zentren und Skalenring) oder einem vereinfachten CSS-Design.","settings.display.knobStyle.svg":"Authentisches Synthi 100 (SVG-Regler mit Skala)","settings.display.knobStyle.css":"Vereinfacht (CSS-Regler)","settings.display.glow":"Leuchteffekt der Bedienelemente","settings.display.glow.description":"Pulsierender Leuchteffekt um Regler, Schieberegler, Pads und Pins wenn sich ihr Wert \xE4ndert. N\xFCtzlich f\xFCr Live-Auftritte, damit das Publikum sehen kann, was angepasst wird. Der Leuchteffekt aktiviert sich bei Interaktion, Patch-Laden, OSC-Nachrichten und Resets.","settings.display.glow.performance":"Performance: maximale Sichtbarkeit f\xFCr Live-Shows","settings.display.glow.standard":"Standard: sichtbarer und ausgewogener Effekt","settings.display.glow.subtle":"Dezent: kaum sichtbar, f\xFCr den pers\xF6nlichen Gebrauch","settings.display.glow.off":"Aus: kein Leuchteffekt","settings.display.sharpRasterize":"Zoom-Sch\xE4rfe","settings.display.sharpRasterize.description":"Beim Zoomen streckt der Browser zwischengespeicherte Texturen, die unscharf aussehen. Adaptive Rasterisierung rendert die Oberfl\xE4che nach Ende der Interaktion in voller Aufl\xF6sung neu und erzeugt ein scharfes Bild. W\xE4hrend des Neurenderings kann es zu einer kurzen Pause kommen.","settings.display.sharpRasterize.enable":"Adaptive Rasterisierung aktivieren","settings.display.touchInteraction":"Touch-Interaktion","settings.display.touchInteraction.description":"Optionen f\xFCr Touch-Gesten auf Mobilger\xE4ten und Tablets. Passen Sie das Schwenk- und Mehrfinger-Steuerungsverhalten an Ihre Performance-Bed\xFCrfnisse an.","settings.display.touchInteraction.singleFingerPan":"Leinwand mit einem Finger verschieben","settings.display.touchInteraction.singleFingerPan.description":"Ziehen Sie mit einem Finger \xFCber den Canvas-Hintergrund, um zu schwenken. Deaktiviert, verwenden Sie die Zwei-Finger-Pinch-Geste zum Navigieren.","settings.display.touchInteraction.multitouch":"Multitouch-Steuerung","settings.display.touchInteraction.multitouch.description":"Bewegen Sie mehrere Regler und Schieberegler gleichzeitig mit verschiedenen Fingern. Deaktiviert reagiert nur ein Regler gleichzeitig auf Ber\xFChrung, um versehentliche \xC4nderungen w\xE4hrend Zoom-/Schwenkgesten zu vermeiden.","settings.osc.title":"OSC-Kommunikation","settings.osc.description":"OSC (Open Sound Control) erm\xF6glicht die Synchronisierung mehrerer SynthiGME-Instanzen in Echtzeit \xFCber das lokale Netzwerk. Wenn ein Regler auf einer Instanz bewegt wird, spiegeln alle verbundenen Instanzen die \xC4nderung wider.","settings.osc.enable":"OSC aktivieren","settings.osc.electronOnly":"OSC ist nur in der Desktop-Anwendung (Electron) verf\xFCgbar.","settings.osc.mode":"Kommunikationsmodus","settings.osc.mode.peer":"Peer-to-Peer (Senden und Empfangen)","settings.osc.mode.master":"Master (nur Senden)","settings.osc.mode.slave":"Slave (nur Empfangen)","settings.osc.prefix":"Adressprefix","settings.osc.prefix.description":"Alle OSC-Meldungen verwenden dieses Pr\xE4fix. Nur Instanzen mit demselben Pr\xE4fix werden synchronisiert.","settings.osc.supercollider":"SuperCollider","settings.osc.supercollider.send":"An SuperCollider senden","settings.osc.supercollider.send.description":"Sendet OSC-Nachrichten an SuperCollider auf localhost (127.0.0.1:57120).","settings.osc.supercollider.receive":"Von SuperCollider empfangen","settings.osc.supercollider.receive.description":"Empf\xE4ngt OSC-Nachrichten von SuperCollider, um SynthiGME zu steuern.","settings.osc.supercollider.port":"SC-Port","settings.osc.port":"Lauschport","settings.osc.port.description":"UDP-Port, auf dem SynthiGME OSC-Meldungen empf\xE4ngt. \xC4ndern Sie, wenn ein anderes Programm (z. B. SuperCollider) den Standardport verwendet.","settings.osc.port.note":"(Erfordert Neustart von OSC)","settings.osc.targets":"Unicast-Ziele","settings.osc.targets.description":"F\xFCgen Sie spezifische IP-Adressen f\xFCr Anwendungen hinzu, die Multicast nicht unterst\xFCtzen (wie SuperCollider).","settings.osc.targets.add":"Ziel hinzuf\xFCgen","settings.osc.targets.ip":"IP-Adresse","settings.osc.targets.port":"Port","settings.osc.targets.remove":"Entfernen","settings.osc.log":"Nachrichtenprotokoll","settings.osc.log.show":"Schwebendes Protokollfenster anzeigen","settings.osc.status":"Status","settings.osc.status.stopped":"Gestoppt","settings.osc.status.running":"Wird ausgef\xFChrt","settings.osc.status.error":"Fehler","osc.log.title":"OSC-Protokoll","osc.log.filter.all":"Alle","osc.log.filter.in":"Eingang","osc.log.filter.out":"Ausgang","osc.log.pause":"Pause","osc.log.resume":"Fortsetzen","osc.log.clear":"L\xF6schen","osc.log.close":"Schlie\xDFen","osc.log.noMessages":"Noch keine Nachrichten...","osc.log.messageCount":"{count} Nachrichten","settings.about.description":"Webport des modularen Synthesizers Synthi GME, inspiriert vom EMS Synthi 100 des Gabinete de M\xFAsica Electroac\xFAstica (GME) in Cuenca. Als Abschlussprojekt des Masters in Sound Art an der Universitat de Barcelona (2019/2020) entwickelt, verfolgt diese Webversion das gleiche p\xE4dagogische und experimentelle Ziel mit reibungsloser Verbreitung.","settings.about.info":"Informationen","settings.about.version":"Version:","settings.about.author":"Autor:","settings.about.license":"Lizenz:","settings.about.links":"Links","settings.about.repository":"GitHub-Repository","settings.about.issues":"Bug melden / Kontakt","settings.about.telegram":"Treten Sie unserer Telegram-Gruppe bei","settings.about.originalProject":"Originalprojekt (SuperCollider)","settings.about.credits":"Danksagungen","settings.about.credits.development":"Entwicklung und Interface-Design:","settings.about.credits.appIcons":"App-Symbole:","settings.about.credits.uiIcons":"UI-Symbole:","settings.about.credits.inspiration":"Inspiriert von:","settings.language":"Sprache","settings.scale":"Rendering-Skalierung","settings.scale.description":'H\xF6here Skalierung = sch\xE4rferes Bild, aber mehr Ressourcennutzung. Setzt sich beim Neustart auf 1\xD7 zur\xFCck, es sei denn, "Merken" ist aktiviert.',"settings.scale.current":"Aktuelle Skalierung:","settings.scale.remember":"Beim Neustart merken","settings.updates":"Aktualisierungen","settings.updates.version":"Aktuelle Version:","settings.updates.check":"Auf Aktualisierungen pr\xFCfen","settings.updates.checking":"Wird \xFCberpr\xFCft...","settings.updates.available":"Neue Version verf\xFCgbar!","settings.updates.pendingInstall":"Eine neue Version kann installiert werden","settings.updates.install":"Aktualisierung installieren","settings.updates.installAndReload":"Installieren und erneut laden","settings.updates.installing":"Wird installiert...","settings.updates.upToDate":"Du bist auf dem neuesten Stand \u2713","settings.updates.error":"Fehler beim \xDCberpr\xFCfen auf Aktualisierungen","settings.autosave":"Automatisches Speichern","settings.autosave.description":"Aktuellen Status regelm\xE4\xDFig automatisch speichern","settings.autosave.interval":"Speicherintervall","settings.autosave.interval.off":"Deaktiviert","settings.autosave.interval.30s":"Alle 30 Sekunden","settings.autosave.interval.1m":"Jede 1 Minute","settings.autosave.interval.5m":"Alle 5 Minuten","settings.autosave.interval.10m":"Alle 10 Minuten","settings.autosave.onExit":"Beim Beenden speichern","settings.autosave.onExit.description":"Aktuellen Status beim Schlie\xDFen der App speichern","settings.autosave.restoreOnStart":"Bei Start wiederherstellen","settings.autosave.restoreOnStart.description":"Beim \xD6ffnen der App zum Wiederherstellen des letzten gespeicherten Status auffordern","settings.autosave.askBeforeRestore":"Vor dem Wiederherstellen fragen","settings.autosave.askBeforeRestore.description":"Best\xE4tigungsdialog vor dem Wiederherstellen anzeigen (kann im Dialog ge\xE4ndert werden)","settings.wakelock":"Bildschirm aktiv halten","settings.wakelock.description":"Verhindert, dass sich der Bildschirm ausschaltet, w\xE4hrend die App offen ist","settings.wakelock.unsupported":"In diesem Browser nicht unterst\xFCtzt","settings.shortcuts":"Tastatak\xFCrzel","settings.shortcuts.description":"Klicken Sie auf einen Tastaturkurzbefehl, um ihn zu \xE4ndern. Dr\xFCcken Sie die neue Tastenkombination.","settings.shortcuts.knobModifiers":"Kn\xF6pfe: Halten Sie Strg/Befehl f\xFCr 10x schnellere Bewegung, Umschalt f\xFCr 10x feinere Kontrolle.","settings.shortcuts.mute":"Stummschalten/Aktivieren","settings.shortcuts.record":"Aufnahme/Stopp","settings.shortcuts.patches":"Patches \xF6ffnen","settings.shortcuts.settings":"Einstellungen \xF6ffnen","settings.shortcuts.fullscreen":"Vollbild umschalten","settings.shortcuts.reset":"Synth zur\xFCcksetzen","settings.shortcuts.showPanelHints":"Panelnummern anzeigen (halten)","settings.shortcuts.signalFlow":"Signalfluss hervorheben (halten)","settings.shortcuts.panel1":"Bedienfeld 1","settings.shortcuts.panel2":"Bedienfeld 2","settings.shortcuts.panel3":"Bedienfeld 3","settings.shortcuts.panel4":"Bedienfeld 4","settings.shortcuts.panel5":"Bedienfeld 5","settings.shortcuts.panel6":"Bedienfeld 6","settings.shortcuts.panelOutput":"Ausgabe-Bedienfeld","settings.shortcuts.overview":"\xDCbersicht (alle Bedienfelder)","settings.shortcuts.press":"Dr\xFCcken Sie eine Taste...","settings.shortcuts.none":"Keine","settings.shortcuts.conflict":"Bereits zugewiesen zu: {action}","settings.shortcuts.reserved":"Diese Taste ist reserviert","settings.shortcuts.resetDefaults":"Tastatak\xFCrzel zur\xFCcksetzen","settings.signalFlow":"Signalfluss","settings.signalFlow.description":"Hebt visuell den Ursprung (Cyan) und das Ziel (Magenta) von Verbindungen hervor, wenn Module oder aktive Pins \xFCberfahren werden. Auf Desktop muss die Modifizierertaste gehalten werden.","settings.signalFlow.noModifier":"Ohne Modifizierertaste aktivieren (empfohlen auf Tablets)","settings.signalFlow.enabled":"Signalfluss beim \xDCberfahren anzeigen","toast.autosave":"Status automatisch gespeichert","toast.autosave.exit":"Status vor dem Beenden gespeichert","toast.restored":"Vorheriger Status wiederhergestellt","audio.title":"Audioeinstellungen","audio.close":"Einstellungen schlie\xDFen","audio.device.output":"Ausgabeger\xE4t:","audio.device.input":"Eingabeger\xE4t:","audio.device.default":"Standardger\xE4t","audio.device.loading":"Ger\xE4te werden geladen...","audio.device.error":"Fehler beim Laden der Ger\xE4te","audio.device.system":"System","audio.mode.title":"Ausgabemodus","audio.mode.stereo":"Stereo","audio.mode.multichannel":"Mehrkanalig (12K)","audio.mode.multichannel.desc":"12 unabh\xE4ngige Kan\xE4le \xFCber PipeWire. Routing in qpwgraph.","audio.mode.unavailable":"(Erfordert Electron + PipeWire)","audio.outputs.title":"Ausg\xE4nge \u2192 System","audio.outputs.channels":"Erkannte Kan\xE4le:","audio.outputs.description":"Leiten Sie die logischen Ausg\xE4nge des Synthi zu den physischen Ausg\xE4ngen des Systems.","audio.outputs.more":"+{count} weitere Reihen (zum Sehen scrollen)","audio.outputs.reset":"Zur\xFCcksetzen","audio.inputs.title":"System \u2192 Eingangsverst\xE4rker","audio.inputs.channels":"Eingangskan\xE4le:","audio.inputs.description":"Leiten Sie die physischen Eing\xE4nge des Systems zu den Eingangsverst\xE4rkern des Synthi weiter.","audio.inputs.enable":"Audioeingabe aktivieren","audio.inputs.permission":"Erfordert Mikrofonerlaubnis.","audio.inputs.enabled":"\u2713 Eingabe aktiviert","audio.inputs.multichannel.title":"PipeWire \u2192 Eingangsverst\xE4rker","audio.inputs.multichannel.description":"Leiten Sie 8 PipeWire-Eingangskan\xE4le zu den Eingangsverst\xE4rkern weiter.","audio.inputs.multichannel.labels":"input_amp_{n}","audio.inputs.reset":"Zur\xFCcksetzen","audio.latency.title":"Latenz","audio.latency.description":"Audiopuffer anpassen. Niedriger = schnellere Reaktion, aber h\xF6heres Risiko von Klicks.","audio.latency.webAudio":"Web Audio Puffer:","audio.latency.multichannel":"Mehrkanal-Puffer:","audio.latency.interactive":"~10ms (Interaktiv)","audio.latency.balanced":"~25ms (Ausgewogen)","audio.latency.playback":"~50ms (Wiedergabe)","audio.latency.safe":"~100ms (Sicher)","audio.latency.maximum":"~200ms (Maximum)","audio.latency.veryLow":"sehr niedrig","audio.latency.low":"niedrig","audio.latency.normal":"normal","audio.latency.high":"hoch","audio.latency.veryHigh":"sehr hoch","audio.latency.total":"Gesch\xE4tzte Gesamtlatenz:","audio.latency.restartRequired":"\u26A0\uFE0F App neu starten um \xC4nderungen anzuwenden","audio.latency.reconnectRequired":"\u26A0\uFE0F Ger\xE4t aus- und wieder einschalten","audio.permission.denied.title":"Mikrofonzugriff verweigert","audio.permission.denied.message":"Aktivieren Sie das Mikrofon in den Browser- oder Systemeinstellungen, um Audioeingaben zu verwenden.","audio.permission.retry":"Erneut versuchen","audio.channel.mono":"Mono","audio.channel.stereo":"Stereo","audio.channel.quad":"Quadrafon","audio.channel.surround":"5.1 Surround","quickbar.open":"Schnellaktionen \xF6ffnen","quickbar.close":"Schnellaktionen schlie\xDFen","quickbar.pan.lock":"Schwenk sperren","quickbar.pan.unlock":"Schwenk entsperren","quickbar.zoom.lock":"Zoom sperren","quickbar.zoom.unlock":"Zoom entsperren","quickbar.settings":"Einstellungen (S)","quickbar.patches":"Patches (P)","quickbar.pip":"Schwebende Bedienfelder","quickbar.audio":"Audioeinstellungen (A)","quickbar.emergency":"Skalierung auf 1\xD7 zur\xFCcksetzen (Notfall)","quickbar.emergency.applied":"Skalierung auf 1\xD7 zur\xFCckgesetzt","quickbar.mute":"Audio stummschalten (M)","quickbar.unmute":"Audio aktivieren (M)","toast.mute":"Audio stummgeschaltet","toast.unmute":"Audio aktiv","toast.dspEnabled":"Audio-Engine aktiviert","toast.dspDisabled":"Audio-Engine deaktiviert","toast.dspRequired":"Die Audio-Engine ist deaktiviert. Aktivieren Sie sie in den Audio-Einstellungen.","quickbar.fullscreen":"Vollbild (F)","quickbar.fullscreen.exit":"Vollbild beenden (Esc)","quickbar.reset":"Synth zur\xFCcksetzen (Shift+I)","synth.reset.confirm":"M\xF6chten Sie den Synthesizer wirklich auf die Anfangswerte zur\xFCcksetzen?","common.dontAskAgain":"Nicht erneut fragen","settings.synth.confirmReset":"Best\xE4tigung beim Zur\xFCcksetzen des Synthesizers verlangen","quickbar.oscOn":"OSC aktiviert - Klicken zum Deaktivieren","quickbar.oscOff":"OSC deaktiviert - Klicken zum Aktivieren","quickbar.oscError":"OSC konnte nicht aktiviert werden","quickbar.undo":"R\xFCckg\xE4ngig (Strg+Z)","quickbar.redo":"Wiederherstellen (Strg+U)","toast.undo":"\xC4nderung r\xFCckg\xE4ngig gemacht","toast.redo":"\xC4nderung wiederhergestellt","quickbar.record":"Audio aufnehmen (R)","quickbar.stopRecording":"Aufnahme stoppen (R)","quickbar.recordSettings":"Aufnahmeeinstellungen","recording.title":"Aufnahmeeinstellungen","recording.close":"Close recording settings","recording.tracks.label":"Anzahl der Spuren","recording.tracks.mono":"1 (Mono)","recording.tracks.stereo":"2 (Stereo)","recording.tracks.tracks":"Spuren","recording.track":"Spur","recording.routing.title":"Aufnahmespur-Routing","recording.routing.description":"W\xE4hlen Sie, welche Ausg\xE4nge auf jeder Spur aufgezeichnet werden","recording.format.label":"Format","recording.format.wav":"WAV (verlustfrei, Mehrspur)","recording.format.webmOpus":"WebM/Opus (komprimiert, Stereo)","recording.format.wavDesc":"Verlustfrei 16-Bit PCM. Bis zu 12 Spuren mit benutzerdefiniertem Routing. Gro\xDFe Dateien.","recording.format.webmOpusDesc":"Hochwertig komprimiertes Audio. Nur Stereo. Viel kleinere Dateien, ideal zum Teilen.","recording.bitrate.label":"Qualit\xE4t (Bitrate)","recording.bitrate.recommended":"empfohlen","recording.overlay.recording":"Aufnahme l\xE4uft","settings.recording":"Audioaufnahme","settings.recording.description":"Audioausgang aufnehmen als WAV (verlustfrei) oder WebM/Opus (komprimiert)","settings.recording.configure":"Aufnahme konfigurieren","toast.recordingStarted":"Aufnahme gestartet","toast.recordingSaved":"Aufnahme gespeichert: {filename}","toast.recordingEmpty":"Kein Audio aufgezeichnet","toast.recordingError":"Aufnahmefehler","settings.reset":"Standardeinstellungen wiederherstellen","settings.reset.description":"Entfernt alle gespeicherten Einstellungen und stellt die Standardwerte wieder her. Die Seite wird neu geladen.","settings.reset.button":"Standardwerte wiederherstellen","settings.reset.confirm":"M\xF6chten Sie wirklich alle Einstellungen auf ihre Standardwerte zur\xFCcksetzen? Die Seite wird neu geladen.","settings.optimizations":"Leistungsoptimierungen","settings.optimizations.description":"Diese Optionen reduzieren die CPU-Last, indem sie die Audioverarbeitung deaktivieren, wenn sie nicht ben\xF6tigt wird. Besonders n\xFCtzlich auf Mobilger\xE4ten.","settings.optimizations.debugGlobal":"Debug-Toasts f\xFCr alle Optimierungen anzeigen","settings.dsp":"Audio-Engine (DSP)","settings.dsp.description":"Aktivieren oder deaktivieren Sie die Audio-Engine. Wenn deaktiviert, arbeitet die App als OSC-Controller ohne Audioverarbeitung.","settings.dsp.enabled":"Audio-Engine aktiviert","settings.dsp.startEnabled":"Audio beim Start aktivieren","settings.dormancy":"Moduldormanz","settings.dormancy.description":"Stummschaltet Module automatisch, die in der Matrix nicht verbunden sind.","settings.dormancy.enabled":"Dormancy-System aktivieren","settings.dormancy.debug":"Nur Dormancy debuggen","settings.filterBypass":"Filter-Bypass","settings.filterBypass.description":"Umgeht die LP/HP-Filter der Ausgangskan\xE4le und den Noise-Colour-Filter in Neutralposition und reduziert die CPU-Last.","settings.filterBypass.enabled":"Filter-Bypass aktivieren","settings.filterBypass.debug":"Nur Filter-Bypass debuggen","settings.latencyMode":"Latenzmodus","settings.latencyMode.description":'Passt die Audiopuffergr\xF6\xDFe an. Verwenden Sie "Wiedergabe" auf Mobilger\xE4ten f\xFCr Stabilit\xE4t und "Interaktiv" auf dem Desktop f\xFCr niedrige Latenz.',"settings.latencyMode.interactive":"Interaktiv (~10 ms)","settings.latencyMode.balanced":"Ausgewogen (~25 ms)","settings.latencyMode.playback":"Wiedergabe (~50 ms)","settings.latencyMode.safe":"Sicher (100 ms)","settings.latencyMode.maximum":"Maximum (200 ms)","settings.latencyMode.restartRequired":"Latenzmodus gespeichert. Starten Sie die App neu, um \xC4nderungen anzuwenden.","settings.voltageEmulation":"Spannungssimulation","settings.voltageEmulation.description":"Emuliert das elektrische Verhalten der Synthi 100 Cuenca/Datanomics (1982)-Version. Diese Optionen beeinflussen die analoge Genauigkeit von Signalen.","settings.voltageEmulation.softClip":"Sanftes Clipping","settings.voltageEmulation.softClip.description":"S\xE4ttigt sanft mit tanh() Signale, die die Eingangsgrenzen jedes Moduls \xFCberschreiten (typischerweise 8V p-p).","settings.voltageEmulation.pinTolerance":"Pin-Toleranz","settings.voltageEmulation.pinTolerance.description":"Wendet realistische Variation nach Pin-Typ an: grau \xB10,5%, wei\xDF \xB110%. Jede Verbindung hat ihre eigene reproduzierbare Toleranz.","settings.voltageEmulation.thermalDrift":"Thermische Drift","settings.voltageEmulation.thermalDrift.description":"Simuliert langsame Drift (\xB10,1%) von CEM 3340-Oszillatoren aufgrund von Temperatur\xE4nderungen.","menu.file":"Datei","menu.file.patches":"Patches\u2026","menu.file.language":"Sprache","menu.file.reload":"Neu laden","menu.file.reload.confirm":"Anwendung neu laden? Nicht gespeicherte \xC4nderungen gehen verloren.","menu.file.quit":"Beenden","menu.file.quit.confirm":"Anwendung beenden?","menu.preferences":"Einstellungen","menu.preferences.settings":"Alle Einstellungen\u2026","menu.view":"Ansicht","menu.view.quickbar":"Schnellleiste anzeigen","menu.view.fullscreen":"Vollbild","menu.view.zoomIn":"Vergr\xF6\xDFern","menu.view.zoomOut":"Verkleinern","menu.view.zoomReset":"Zoom zur\xFCcksetzen","menu.view.inactivePins":"Inaktive Pins anzeigen","menu.view.tooltipVoltage":"Elektronische Parameter in Tooltips","menu.view.tooltipAudioRate":"Audio-Infos in Tooltips","menu.view.linearFaders":"Lineare Fader-Antwort","menu.view.sharpRasterize":"Adaptive Rasterisierung (scharfer Zoom)","menu.view.devTools":"Entwicklertools","menu.audio":"Audio","menu.audio.mute":"Stummschalten","menu.audio.unmute":"Ton aktivieren","menu.audio.record":"Aufnehmen","menu.audio.stopRecording":"Aufnahme stoppen","menu.audio.audioSettings":"Audio- und Aufnahmeeinstellungen\u2026","menu.audio.preventSleep":"Systemruhezustand verhindern","menu.audio.dsp":"DSP (Audio-Engine)","menu.panels":"Bedienfelder","menu.panels.detachHeader":"Bedienfelder abtrennen","menu.panels.detachAll":"Alle trennen","menu.panels.attachAll":"Alle zur\xFCckgeben","menu.panels.lockPan":"Schwenk sperren","menu.panels.lockZoom":"Zoom sperren","menu.panels.rememberVisualLayout":"Visuelles Layout merken","menu.panels.singleFingerPan":"Schwenken mit einem Finger","menu.panels.multitouchControls":"Multitouch-Steuerung","menu.advanced":"Erweitert","menu.advanced.debugGlobal":"Debug-Toasts (alle)","menu.advanced.dormancy":"Moduldormanz","menu.advanced.dormancyDebug":"Dormancy debuggen","menu.advanced.filterBypass":"Filter-Bypass","menu.advanced.filterBypassDebug":"Filter-Bypass debuggen","menu.advanced.softClip":"Sanftes Clipping","menu.advanced.pinTolerance":"Pin-Toleranz","menu.advanced.thermalDrift":"Thermische Drift","menu.advanced.resetSynth":"Synthesizer zur\xFCcksetzen\u2026","menu.advanced.settings":"Alle Einstellungen\u2026","menu.osc":"OSC","menu.osc.enable":"OSC aktivieren","menu.osc.sendToSC":"An SuperCollider senden","menu.osc.receiveFromSC":"Von SuperCollider empfangen","menu.osc.showLog":"OSC-Protokoll anzeigen","menu.osc.settings":"OSC-Einstellungen\u2026","menu.help":"Hilfe","menu.help.about":"\xDCber Synthi GME\u2026","menu.help.repository":"GitHub-Repository","menu.help.reportBug":"Bug melden\u2026","menu.help.checkUpdates":"Nach Updates suchen\u2026","toast.reset":"Synthesizer auf Standard zur\xFCckgesetzt","toast.resolution":"Skalierung: {factor}\xD7","toast.resolution.mobileWarning":"Skalierung: {factor}\xD7 \u26A0\uFE0F Kann Leistungsprobleme verursachen","toast.pan.locked":"Schwenk gesperrt","toast.pan.unlocked":"Schwenk entsperrt","toast.zoom.locked":"Zoom gesperrt","toast.zoom.unlocked":"Zoom entsperrt","pip.detach":"Bedienfeld trennen","pip.detachAll":"Alle trennen","pip.attach":"Bedienfeld zur\xFCckgeben","pip.attachAll":"Alle zur\xFCckgeben","pip.close":"Schlie\xDFen","pip.zoomIn":"Vergr\xF6\xDFern","pip.zoomOut":"Verkleinern","pip.maximize":"Maximieren","pip.minimize":"Minimieren","pip.lock":"Sperren","pip.unlock":"Entsperren","pip.fitPanel":"Panel anpassen","pip.placeholderHint":"Lange dr\xFCcken oder Rechtsklick f\xFCr Optionen","panel.oscillators1":"Oszillatoren 1-3","panel.oscilloscope":"Oszilloskop","panel.oscillators2":"Oszillatoren 4-6","panel.oscillators3":"Oszillatoren 7-9","panel.audioMatrix":"Audio-Matrix","panel.controlMatrix":"Steuer-Matrix","panel.output":"Ausgabe","contextMenu.resetPanel":"Bedienfeld zur\xFCcksetzen","contextMenu.resetModule":"{name} zur\xFCcksetzen","contextMenu.resetControl":"{name} zur\xFCcksetzen","notes.add":"Notiz hinzuf\xFCgen","notes.delete":"Notiz l\xF6schen","notes.placeholder":"Hier schreiben...","notes.color":"Farbe \xE4ndern","notes.color.yellow":"Gelb","notes.color.pink":"Rosa","notes.color.blue":"Blau","notes.color.green":"Gr\xFCn","notes.color.orange":"Orange","notes.color.purple":"Lila","notes.fontUp":"Schriftgr\xF6\xDFe vergr\xF6\xDFern","notes.fontDown":"Schriftgr\xF6\xDFe verkleinern","notes.ctx.cut":"Ausschneiden","notes.ctx.copy":"Kopieren","notes.ctx.paste":"Einf\xFCgen","notes.ctx.bold":"Fett","notes.ctx.italic":"Kursiv","notes.ctx.edit":"Bearbeiten","notes.ctx.copyNote":"Notiz kopieren","notes.ctx.cutNote":"Notiz ausschneiden","notes.ctx.pasteNote":"Notiz einf\xFCgen","notes.ctx.alignLeft":"Linksb\xFCndig","notes.ctx.alignCenter":"Zentrieren","notes.ctx.alignRight":"Rechtsb\xFCndig","orientation.hint":"Drehen Sie Ihr Ger\xE4t f\xFCr eine bessere Erfahrung in die Querformatausrichtung","orientation.blocker":"Bitte drehen Sie Ihr Ger\xE4t in den Querformatmodus","orientation.blocker.dismiss":"Verwerfen","update.available":"Eine neue Version ist verf\xFCgbar. M\xF6chten Sie diese jetzt installieren und neu laden?","update.installNow":"Jetzt installieren","update.later":"Sp\xE4ter","error.fullscreen":"Vollbild konnte nicht umgeschaltet werden.","patches.title":"Patches","patches.close":"Patches schlie\xDFen","patches.saveCurrent":"Aktuelle Version speichern","patches.saveNew":"Neu speichern","patches.overwrite":"\xDCberschreiben","patches.confirmOverwrite":'Patch "{name}" \xFCberschreiben?',"patches.overwritten":"Patch \xFCberschrieben","patches.includeVisual":"Visuelles Layout einschlie\xDFen","patches.hasVisual":"Enth\xE4lt visuelles Layout","patches.search":"Suchen...","patches.empty":"Noch keine Patches gespeichert","patches.load":"Laden","patches.export":"Exportieren","patches.import":"Importieren","patches.delete":"L\xF6schen","patches.rename":"Umbenennen","patches.confirmDelete":'Patch "{name}" l\xF6schen?',"patches.confirmLoad":'Patch "{name}" laden? Nicht gespeicherte \xC4nderungen gehen verloren.',"patches.saved":"Patch gespeichert","patches.loaded":"Patch geladen","patches.loadedName":'"{name}" geladen',"patches.deleted":"Patch gel\xF6scht","patches.renamed":"Patch umbenannt","patches.exported":"Patch exportiert","patches.imported":"Patch importiert","patches.errorLoading":"Fehler beim Laden des Patches","patches.errorSaving":"Fehler beim Speichern des Patches","patches.errorRenaming":"Fehler beim Umbenennen des Patches","patches.namePrompt":"Patch-Name","patches.renamePrompt":"Neuer Name","patches.defaultName":"Neuer Patch","patches.init":"Init (Standard)","patches.lastSession":"Letzte Sitzung wiederherstellen?","patches.lastSession.yes":"Wiederherstellen","patches.lastSession.no":"Von vorne beginnen","patches.lastSession.remember":"Meine Wahl merken","patches.versionWarning":"Dieser Patch wurde mit einer \xE4lteren Version erstellt","matrix.source.inputAmp":"Eingabe {channel}","matrix.source.outputBus":"Ausgangsbus {bus}","matrix.source.noiseGen":"Rauschen {index}","matrix.source.panel3Osc.sineSaw":"Osc {osc} (sin+saw)","matrix.source.panel3Osc.triPulse":"Osc {osc} (tri+pul)","matrix.source.joystick":"Joystick {side} {axis}","matrix.dest.outputBus":"Aus {bus}","matrix.dest.oscilloscope.Y":"Scope Y","matrix.dest.oscilloscope.X":"Scope X","matrix.dest.oscFreqCV":"Osc {osc} Freq CV","matrix.dest.oscSync":"Osc {osc} Sync","matrix.dest.oscPWM":"Osc {osc} PWM","matrix.dest.outputLevelCV":"Aus {bus} Level CV","matrix.tooltip.format":"{source} \u2192 {dest}","matrix.tooltip.unknownSource":"Zeile {row}","matrix.tooltip.unknownDest":"Spalte {col}","pinColor.title":"Pin-Typ","pinColor.recommended":"Empfohlen","pinColor.standard":"Standard","pinColor.special":"Besonderheit","pinColor.white":"Wei\xDF (Standard)","pinColor.grey":"Grau (Pr\xE4zision)","pinColor.green":"Gr\xFCn (ged\xE4mpft)","pinColor.red":"Rot (Umfang)","pinColor.blue":"Blau (Verst\xE4rkung)","pinColor.yellow":"Gelb (Mittelgewinn)","pinColor.cyan":"Cyan (weich)","pinColor.purple":"Violett (subtil)","telemetry.consent.title":"Anonyme Berichte","telemetry.consent.message":"Helfen Sie, SynthiGME zu verbessern, indem Sie anonyme Fehler- und Sitzungsberichte senden. Es werden keine pers\xF6nlichen Daten erfasst. Sie k\xF6nnen dies jederzeit in den Einstellungen \xE4ndern.","telemetry.consent.accept":"Aktivieren","telemetry.consent.decline":"Nein, danke","menu.advanced.telemetry":"Anonyme Berichte","settings.telemetry":"Anonyme Berichte","settings.telemetry.label":"Anonyme Berichte senden","settings.telemetry.description":"Sendet anonyme Fehler- und Sitzungsberichte, um SynthiGME zu verbessern. Es werden keine pers\xF6nlichen Daten, musikalische Inhalte oder Nutzungsdetails erfasst. Sie k\xF6nnen dies jederzeit \xE4ndern."}});var Il={};Ot(Il,{default:()=>Zu});var Zu,Nl=Xe(()=>{Zu={"settings.language.en":"English","settings.language.es":"Espa\xF1ol","settings.language.fr":"Fran\xE7ais","settings.language.de":"Deutsch","settings.language.it":"Italiano","settings.language.pt":"Portugu\xEAs","settings.language.cs":"\u010Ce\u0161tina","splash.loading":"Loading","app.windowTitle":"Synthi GME (EMS Synthi 100 emulator from Cuenca, Spain)","common.yes":"Yes","common.no":"No","common.cancel":"Cancel","common.ok":"OK","settings.title":"Settings","settings.close":"Close settings","settings.tab.general":"General","settings.tab.audio":"Audio","settings.tab.advanced":"Advanced","settings.tab.osc":"OSC","settings.tab.about":"About","settings.tab.select":"Select section","settings.tab.interface":"Interface","settings.display.inactivePins":"Inactive Pins","settings.display.inactivePins.description":"Matrix pins that don't connect any source with any destination are considered inactive. By default they appear dimmed and cannot be clicked.","settings.display.inactivePins.show":"Show inactive pins as active","settings.display.pip":"Visual Layout","settings.display.pip.description":"The visual layout includes the position and size of floating panels and the zoom and scroll position of the main canvas. When enabled, this layout is restored when you reopen the application.","settings.display.pip.remember":"Remember visual layout between sessions","settings.display.paramInfo":"Parameter Information","settings.display.paramInfo.description":"Show extended technical information in control tooltips. These values would not be visible on the original Synthi hardware.","settings.display.paramInfo.voltage":"Show electrical values (V, Vp-p, \u03A9)","settings.display.paramInfo.audio":"Show audio values (frequency, gain)","settings.display.faderResponse":"Output Fader Response","settings.display.faderResponse.description":"The original Synthi has a logarithmic response where most volume change happens at the end of the fader travel. Enable linear response for easier control at the expense of authenticity.","settings.display.faderResponse.linear":"Linear gain response (easier control)","settings.display.knobStyle":"Knob Appearance","settings.display.knobStyle.description":"Choose between the authentic Synthi 100 knob design (SVG with coloured centres and scale ring) or a simplified CSS design.","settings.display.knobStyle.svg":"Authentic Synthi 100 (SVG knobs with scale)","settings.display.knobStyle.css":"Simplified (CSS knobs)","settings.display.glow":"Control Glow Effect","settings.display.glow.description":"Pulsing halo around knobs, sliders, pads and pins when their value changes. Useful for live performances so the audience can see what's being adjusted. The glow activates on interaction, patch loading, OSC messages, and resets.","settings.display.glow.performance":"Performance: maximum visibility for live shows","settings.display.glow.standard":"Standard: visible and balanced effect","settings.display.glow.subtle":"Subtle: barely visible, for personal use","settings.display.glow.off":"Off: no glow effect","settings.display.sharpRasterize":"Zoom Sharpness","settings.display.sharpRasterize.description":"When zooming in, the browser stretches cached textures which look blurry. Adaptive rasterization re-renders the interface at full resolution after interaction stops, producing a sharp image. There may be a brief pause during re-rendering.","settings.display.sharpRasterize.enable":"Enable adaptive rasterization","settings.display.touchInteraction":"Touch Interaction","settings.display.touchInteraction.description":"Options for touch gestures on mobile and tablet devices. Adjust panning and multi-finger control behavior according to your performance needs.","settings.display.touchInteraction.singleFingerPan":"Pan canvas with one finger","settings.display.touchInteraction.singleFingerPan.description":"Drag anywhere on the canvas background with one finger to pan. When disabled, use two-finger pinch to navigate.","settings.display.touchInteraction.multitouch":"Multitouch controls","settings.display.touchInteraction.multitouch.description":"Move multiple knobs and faders simultaneously with different fingers. When disabled, only one control responds to touch at a time, preventing accidental changes during zoom/pan gestures.","settings.osc.title":"OSC Communication","settings.osc.description":"OSC (Open Sound Control) allows multiple SynthiGME instances to synchronize in real-time over the local network. When a control is moved on one instance, all connected instances reflect the change.","settings.osc.enable":"Enable OSC","settings.osc.electronOnly":"OSC is only available in the desktop application (Electron).","settings.osc.mode":"Communication Mode","settings.osc.mode.peer":"Peer-to-peer (send and receive)","settings.osc.mode.master":"Master (send only)","settings.osc.mode.slave":"Slave (receive only)","settings.osc.prefix":"Address Prefix","settings.osc.prefix.description":"All OSC messages use this prefix. Only instances with the same prefix will synchronize.","settings.osc.supercollider":"SuperCollider","settings.osc.supercollider.send":"Send to SuperCollider","settings.osc.supercollider.send.description":"Sends OSC messages to SuperCollider on localhost (127.0.0.1:57120).","settings.osc.supercollider.receive":"Receive from SuperCollider","settings.osc.supercollider.receive.description":"Receives OSC messages from SuperCollider to control SynthiGME.","settings.osc.supercollider.port":"SC Port","settings.osc.port":"Listen port","settings.osc.port.description":"UDP port where SynthiGME receives OSC messages. Change if another program (e.g. SuperCollider) uses the default port.","settings.osc.port.note":"(Requires OSC restart)","settings.osc.targets":"Unicast Targets","settings.osc.targets.description":"Add specific IP addresses for applications that don't support multicast (like SuperCollider).","settings.osc.targets.add":"Add target","settings.osc.targets.ip":"IP Address","settings.osc.targets.port":"Port","settings.osc.targets.remove":"Remove","settings.osc.log":"Message Log","settings.osc.log.show":"Show floating log window","settings.osc.status":"Status","settings.osc.status.stopped":"Stopped","settings.osc.status.running":"Running","settings.osc.status.error":"Error","osc.log.title":"OSC Log","osc.log.filter.all":"All","osc.log.filter.in":"In","osc.log.filter.out":"Out","osc.log.pause":"Pause","osc.log.resume":"Resume","osc.log.clear":"Clear","osc.log.close":"Close","osc.log.noMessages":"No messages yet...","osc.log.messageCount":"{count} messages","settings.about.description":"Web port of the Synthi GME modular synthesizer, inspired by the EMS Synthi 100 from the Gabinete de M\xFAsica Electroac\xFAstica (GME) in Cuenca. Born as a Final Master's Project in Sound Art at the Universitat de Barcelona (2019/2020), this web version pursues the same pedagogical and experimental goal with frictionless distribution.","settings.about.info":"Information","settings.about.version":"Version:","settings.about.author":"Author:","settings.about.license":"License:","settings.about.links":"Links","settings.about.repository":"GitHub repository","settings.about.issues":"Report a bug / Contact","settings.about.telegram":"Join our Telegram Group","settings.about.originalProject":"Original project (SuperCollider)","settings.about.credits":"Credits","settings.about.credits.development":"Development & interface design: ","settings.about.credits.appIcons":"App icons: ","settings.about.credits.uiIcons":"UI icons: ","settings.about.credits.inspiration":"Inspired by: ","settings.language":"Language","settings.scale":"Rendering scale","settings.scale.description":'Higher scale = sharper image, but more resource usage. Resets to 1\xD7 on restart unless "Remember" is enabled.',"settings.scale.current":"Current scale:","settings.scale.remember":"Remember on restart","settings.updates":"Updates","settings.updates.version":"Current version:","settings.updates.check":"Check for updates","settings.updates.checking":"Checking...","settings.updates.available":"New version available!","settings.updates.pendingInstall":"A new version is ready to install","settings.updates.install":"Install update","settings.updates.installAndReload":"Install and reload","settings.updates.installing":"Installing...","settings.updates.upToDate":"You are up to date \u2713","settings.updates.error":"Error checking for updates","settings.autosave":"Auto-save","settings.autosave.description":"Automatically save the current state periodically","settings.autosave.interval":"Save interval","settings.autosave.interval.off":"Disabled","settings.autosave.interval.30s":"Every 30 seconds","settings.autosave.interval.1m":"Every 1 minute","settings.autosave.interval.5m":"Every 5 minutes","settings.autosave.interval.10m":"Every 10 minutes","settings.autosave.onExit":"Save on exit","settings.autosave.onExit.description":"Save the current state when closing the app","settings.autosave.restoreOnStart":"Restore on start","settings.autosave.restoreOnStart.description":"Ask to restore the last saved state when opening the app","settings.autosave.askBeforeRestore":"Ask before restoring","settings.autosave.askBeforeRestore.description":"Show a confirmation dialog before restoring (can be changed from dialog)","settings.wakelock":"Keep screen awake","settings.wakelock.description":"Prevents the screen from turning off while the app is open","settings.wakelock.unsupported":"Not supported in this browser","settings.shortcuts":"Keyboard shortcuts","settings.shortcuts.description":"Click on a shortcut to change it. Press the new key combination.","settings.shortcuts.knobModifiers":"Knobs: hold Ctrl/Cmd for 10\xD7 faster movement, Shift for 10\xD7 finer control.","settings.shortcuts.mute":"Mute/Unmute","settings.shortcuts.record":"Record/Stop","settings.shortcuts.patches":"Open patches","settings.shortcuts.settings":"Open settings","settings.shortcuts.fullscreen":"Toggle fullscreen","settings.shortcuts.reset":"Reset synth","settings.shortcuts.showPanelHints":"Show panel numbers (hold)","settings.shortcuts.signalFlow":"Highlight signal flow (hold)","settings.shortcuts.panel1":"Panel 1","settings.shortcuts.panel2":"Panel 2","settings.shortcuts.panel3":"Panel 3","settings.shortcuts.panel4":"Panel 4","settings.shortcuts.panel5":"Panel 5","settings.shortcuts.panel6":"Panel 6","settings.shortcuts.panelOutput":"Output panel","settings.shortcuts.overview":"Overview (all panels)","settings.shortcuts.press":"Press a key...","settings.shortcuts.none":"None","settings.shortcuts.conflict":"Already assigned to: {action}","settings.shortcuts.reserved":"This key is reserved","settings.shortcuts.resetDefaults":"Reset shortcuts","settings.signalFlow":"Signal flow","settings.signalFlow.description":"Visually highlights the source (cyan) and destination (magenta) of connections when hovering over modules or active pins. On desktop, requires holding the modifier key.","settings.signalFlow.noModifier":"Activate without modifier key (recommended on tablets)","settings.signalFlow.enabled":"Show signal flow on hover","toast.autosave":"State auto-saved","toast.autosave.exit":"State saved before exit","toast.restored":"Previous state restored","audio.title":"Audio Settings","audio.close":"Close settings","audio.device.output":"Output device:","audio.device.input":"Input device:","audio.device.default":"Default device","audio.device.loading":"Loading devices...","audio.device.error":"Error loading devices","audio.device.system":"System","audio.mode.title":"Output Mode","audio.mode.stereo":"Stereo","audio.mode.multichannel":"Multichannel (12ch)","audio.mode.multichannel.desc":"Outputs 12 independent channels via PipeWire. Route in qpwgraph.","audio.mode.unavailable":"(Requires Electron + PipeWire)","audio.outputs.title":"Outputs \u2192 System","audio.outputs.channels":"Detected channels:","audio.outputs.description":"Route Synthi logical outputs to system physical outputs.","audio.outputs.more":"+{count} more rows (scroll to see)","audio.outputs.reset":"Reset to Defaults","audio.inputs.title":"System \u2192 Input Amplifier Level","audio.inputs.channels":"Input channels:","audio.inputs.description":"Route system physical inputs to Synthi Input Amplifier Level.","audio.inputs.enable":"Enable audio input","audio.inputs.permission":"Requires microphone permission.","audio.inputs.enabled":"\u2713 Input enabled","audio.inputs.multichannel.title":"PipeWire \u2192 Input Amplifier Level","audio.inputs.multichannel.description":"Route 8 PipeWire input channels directly to Input Amplifier Level.","audio.inputs.multichannel.labels":"input_amp_{n}","audio.inputs.reset":"Reset to Defaults","audio.latency.title":"Latency","audio.latency.description":"Adjust audio buffer. Lower = faster response but higher risk of clicks.","audio.latency.webAudio":"Web Audio Buffer:","audio.latency.multichannel":"Multichannel Buffer:","audio.latency.interactive":"~10ms (Interactive)","audio.latency.balanced":"~25ms (Balanced)","audio.latency.playback":"~50ms (Playback)","audio.latency.safe":"~100ms (Safe)","audio.latency.maximum":"~200ms (Maximum)","audio.latency.veryLow":"very low","audio.latency.low":"low","audio.latency.normal":"normal","audio.latency.high":"high","audio.latency.veryHigh":"very high","audio.latency.total":"Estimated total latency:","audio.latency.restartRequired":"\u26A0\uFE0F Restart app to apply changes","audio.latency.reconnectRequired":"\u26A0\uFE0F Disable and re-enable device to apply","audio.permission.denied.title":"Microphone access denied","audio.permission.denied.message":"Enable microphone in browser or system settings to use audio inputs.","audio.permission.retry":"Retry","audio.channel.mono":"Mono","audio.channel.stereo":"Stereo","audio.channel.quad":"Quadraphonic","audio.channel.surround":"5.1 Surround","quickbar.open":"Open quick actions","quickbar.close":"Close quick actions","quickbar.pan.lock":"Lock panning","quickbar.pan.unlock":"Unlock panning","quickbar.zoom.lock":"Lock zoom","quickbar.zoom.unlock":"Unlock zoom","quickbar.settings":"Settings (S)","quickbar.patches":"Patches (P)","quickbar.pip":"Floating Panels","quickbar.audio":"Audio settings (A)","quickbar.emergency":"Reset scale to 1\xD7 (emergency)","quickbar.emergency.applied":"Scale reset to 1\xD7","quickbar.mute":"Mute audio (M)","quickbar.unmute":"Unmute audio (M)","toast.mute":"Audio muted","toast.unmute":"Audio active","toast.dspEnabled":"Audio engine enabled","toast.dspDisabled":"Audio engine disabled","toast.dspRequired":"Audio engine is disabled. Enable it in Audio settings.","quickbar.fullscreen":"Fullscreen (F)","quickbar.fullscreen.exit":"Exit fullscreen (Esc)","quickbar.reset":"Reset synth (Shift+I)","synth.reset.confirm":"Are you sure you want to reset the synthesizer to its initial values?","common.dontAskAgain":"Don't ask again","settings.synth.confirmReset":"Ask for confirmation when resetting synth","quickbar.oscOn":"OSC enabled - Click to disable","quickbar.oscOff":"OSC disabled - Click to enable","quickbar.oscError":"Failed to enable OSC","quickbar.undo":"Undo (Ctrl+Z)","quickbar.redo":"Redo (Ctrl+U)","toast.undo":"Change undone","toast.redo":"Change redone","quickbar.record":"Record audio (R)","quickbar.stopRecording":"Stop recording (R)","quickbar.recordSettings":"Recording settings","recording.title":"Recording Settings","recording.close":"Close recording settings","recording.tracks.label":"Number of tracks","recording.tracks.mono":"1 (Mono)","recording.tracks.stereo":"2 (Stereo)","recording.tracks.tracks":"tracks","recording.track":"Track","recording.routing.title":"Recording track routing","recording.routing.description":"Select which outputs are recorded to each track","recording.format.label":"Format","recording.format.wav":"WAV (lossless, multi-track)","recording.format.webmOpus":"WebM/Opus (compressed, stereo)","recording.format.wavDesc":"Lossless 16-bit PCM. Supports up to 12 tracks with custom routing. Large file size.","recording.format.webmOpusDesc":"High-quality compressed audio. Stereo only. Much smaller files, ideal for sharing.","recording.bitrate.label":"Quality (bitrate)","recording.bitrate.recommended":"recommended","recording.overlay.recording":"Recording in progress","settings.recording":"Audio recording","settings.recording.description":"Record audio output to WAV (lossless) or WebM/Opus (compressed)","settings.recording.configure":"Configure recording","toast.recordingStarted":"Recording started","toast.recordingSaved":"Recording saved: {filename}","toast.recordingEmpty":"No audio recorded","toast.recordingError":"Recording error","settings.reset":"Restore default settings","settings.reset.description":"Remove all saved preferences and restore default values. The page will reload.","settings.reset.button":"Restore defaults","settings.reset.confirm":"Are you sure you want to restore all settings to their default values? The page will reload.","settings.optimizations":"Performance Optimizations","settings.optimizations.description":"These options reduce CPU load by disabling audio processing when not needed. Especially useful on mobile devices.","settings.optimizations.debugGlobal":"Show debug toasts for all optimizations","settings.dsp":"Audio Engine (DSP)","settings.dsp.description":"Enable or disable the audio engine. When disabled, the app works as an OSC controller without audio processing.","settings.dsp.enabled":"Audio engine enabled","settings.dsp.startEnabled":"Enable audio on startup","settings.dormancy":"Module Dormancy","settings.dormancy.description":"Automatically mutes modules that are not connected in the matrix.","settings.dormancy.enabled":"Enable dormancy system","settings.dormancy.debug":"Debug dormancy only","settings.filterBypass":"Filter Bypass","settings.filterBypass.description":"Bypasses output channel LP/HP filters and noise colour filter when in neutral position, reducing CPU load.","settings.filterBypass.enabled":"Enable filter bypass","settings.filterBypass.debug":"Debug filter bypass only","settings.latencyMode":"Latency Mode","settings.latencyMode.description":'Adjusts audio buffer size. Use "Playback" on mobile for stability, "Interactive" on desktop for low latency.',"settings.latencyMode.interactive":"Interactive (~10ms)","settings.latencyMode.balanced":"Balanced (~25ms)","settings.latencyMode.playback":"Playback (~50ms)","settings.latencyMode.safe":"Safe (100ms)","settings.latencyMode.maximum":"Maximum (200ms)","settings.latencyMode.restartRequired":"Latency mode saved. Restart the app to apply changes.","settings.voltageEmulation":"Voltage Emulation","settings.voltageEmulation.description":"Emulates the electrical behavior of the Synthi 100 Cuenca/Datanomics (1982) version. These options affect the analog accuracy of signals.","settings.voltageEmulation.softClip":"Soft Clipping","settings.voltageEmulation.softClip.description":"Softly saturates with tanh() signals that exceed input limits of each module (typically 8V p-p).","settings.voltageEmulation.pinTolerance":"Pin Tolerance","settings.voltageEmulation.pinTolerance.description":"Applies realistic variation by pin type: grey \xB10.5%, white \xB110%. Each connection has its own reproducible tolerance.","settings.voltageEmulation.thermalDrift":"Thermal Drift","settings.voltageEmulation.thermalDrift.description":"Simulates slow drift (\xB10.1%) of CEM 3340 oscillators due to temperature changes.","menu.file":"File","menu.file.patches":"Patches\u2026","menu.file.language":"Language","menu.file.reload":"Reload","menu.file.reload.confirm":"Reload the application? Unsaved changes will be lost.","menu.file.quit":"Quit","menu.file.quit.confirm":"Quit the application?","menu.preferences":"Preferences","menu.preferences.settings":"All Settings\u2026","menu.view":"View","menu.view.quickbar":"Show Quickbar","menu.view.fullscreen":"Fullscreen","menu.view.zoomIn":"Zoom In","menu.view.zoomOut":"Zoom Out","menu.view.zoomReset":"Reset Zoom","menu.view.inactivePins":"Show inactive pins","menu.view.tooltipVoltage":"Electronic parameters in tooltips","menu.view.tooltipAudioRate":"Audio info in tooltips","menu.view.linearFaders":"Linear fader response","menu.view.sharpRasterize":"Adaptive rasterization (sharp zoom)","menu.view.devTools":"Developer Tools","menu.audio":"Audio","menu.audio.mute":"Mute","menu.audio.unmute":"Unmute","menu.audio.record":"Record","menu.audio.stopRecording":"Stop Recording","menu.audio.audioSettings":"Audio & Recording Settings\u2026","menu.audio.preventSleep":"Prevent system sleep","menu.audio.dsp":"DSP (Audio Engine)","menu.panels":"Panels","menu.panels.detachHeader":"Detach Panels","menu.panels.detachAll":"Detach All","menu.panels.attachAll":"Return All","menu.panels.lockPan":"Lock Panning","menu.panels.lockZoom":"Lock Zoom","menu.panels.rememberVisualLayout":"Remember visual layout","menu.panels.singleFingerPan":"Pan with one finger","menu.panels.multitouchControls":"Multitouch controls","menu.advanced":"Advanced","menu.advanced.debugGlobal":"Debug toasts (all)","menu.advanced.dormancy":"Module Dormancy","menu.advanced.dormancyDebug":"Debug dormancy","menu.advanced.filterBypass":"Filter Bypass","menu.advanced.filterBypassDebug":"Debug filter bypass","menu.advanced.softClip":"Soft Clipping","menu.advanced.pinTolerance":"Pin Tolerance","menu.advanced.thermalDrift":"Thermal Drift","menu.advanced.resetSynth":"Reset Synthesizer\u2026","menu.advanced.settings":"All Settings\u2026","menu.osc":"OSC","menu.osc.enable":"Enable OSC","menu.osc.sendToSC":"Send to SuperCollider","menu.osc.receiveFromSC":"Receive from SuperCollider","menu.osc.showLog":"Show OSC Log","menu.osc.settings":"OSC Settings\u2026","menu.help":"Help","menu.help.about":"About Synthi GME\u2026","menu.help.repository":"GitHub Repository","menu.help.reportBug":"Report a Bug\u2026","menu.help.checkUpdates":"Check for Updates\u2026","toast.reset":"Synthesizer reset to defaults","toast.resolution":"Scale: {factor}\xD7","toast.resolution.mobileWarning":"Scale: {factor}\xD7 \u26A0\uFE0F May cause performance issues","toast.pan.locked":"Panning locked","toast.pan.unlocked":"Panning unlocked","toast.zoom.locked":"Zoom locked","toast.zoom.unlocked":"Zoom unlocked","pip.detach":"Detach panel","pip.detachAll":"Detach all","pip.attach":"Return panel","pip.attachAll":"Return all","pip.close":"Close","pip.zoomIn":"Zoom in","pip.zoomOut":"Zoom out","pip.maximize":"Maximize","pip.minimize":"Restore size","pip.lock":"Lock","pip.unlock":"Unlock","pip.fitPanel":"Fit panel","pip.placeholderHint":"Long press or right-click for options","panel.oscillators1":"Oscillators 1-3","panel.oscilloscope":"Oscilloscope","panel.oscillators2":"Oscillators 4-6","panel.oscillators3":"Oscillators 7-9","panel.audioMatrix":"Audio Matrix","panel.controlMatrix":"Control Matrix","panel.output":"Output","contextMenu.resetPanel":"Reset panel","contextMenu.resetModule":"Reset {name}","contextMenu.resetControl":"Reset {name}","notes.add":"Add note","notes.delete":"Delete note","notes.placeholder":"Write here...","notes.color":"Change color","notes.color.yellow":"Yellow","notes.color.pink":"Pink","notes.color.blue":"Blue","notes.color.green":"Green","notes.color.orange":"Orange","notes.color.purple":"Purple","notes.fontUp":"Increase font size","notes.fontDown":"Decrease font size","notes.ctx.cut":"Cut","notes.ctx.copy":"Copy","notes.ctx.paste":"Paste","notes.ctx.bold":"Bold","notes.ctx.italic":"Italic","notes.ctx.edit":"Edit","notes.ctx.copyNote":"Copy note","notes.ctx.cutNote":"Cut note","notes.ctx.pasteNote":"Paste note","notes.ctx.alignLeft":"Align left","notes.ctx.alignCenter":"Center","notes.ctx.alignRight":"Align right","orientation.hint":"Rotate your device to landscape for a better experience","orientation.blocker":"Please rotate your device to landscape mode","orientation.blocker.dismiss":"Dismiss","update.available":"A new version is available. Do you want to install and reload now?","update.installNow":"Install now","update.later":"Later","error.fullscreen":"Could not toggle fullscreen.","patches.title":"Patches","patches.close":"Close patches","patches.saveCurrent":"Save current","patches.saveNew":"Save new","patches.overwrite":"Overwrite","patches.confirmOverwrite":'Overwrite patch "{name}"?',"patches.overwritten":"Patch overwritten","patches.includeVisual":"Include visual layout","patches.hasVisual":"Includes visual layout","patches.search":"Search...","patches.empty":"No patches saved yet","patches.load":"Load","patches.export":"Export","patches.import":"Import","patches.delete":"Delete","patches.rename":"Rename","patches.confirmDelete":'Delete patch "{name}"?',"patches.confirmLoad":'Load patch "{name}"? Unsaved changes will be lost.',"patches.saved":"Patch saved","patches.loaded":"Patch loaded","patches.loadedName":'"{name}" loaded',"patches.deleted":"Patch deleted","patches.renamed":"Patch renamed","patches.exported":"Patch exported","patches.imported":"Patch imported","patches.errorLoading":"Error loading patch","patches.errorSaving":"Error saving patch","patches.errorRenaming":"Error renaming patch","patches.namePrompt":"Patch name","patches.renamePrompt":"New name","patches.defaultName":"New patch","patches.init":"Init (default)","patches.lastSession":"Restore last session?","patches.lastSession.yes":"Restore","patches.lastSession.no":"Start fresh","patches.lastSession.remember":"Remember my choice","patches.versionWarning":"This patch was created with an older version","matrix.source.inputAmp":"Input {channel}","matrix.source.outputBus":"Out Bus {bus}","matrix.source.noiseGen":"Noise {index}","matrix.source.panel3Osc.sineSaw":"Osc {osc} (sin+saw)","matrix.source.panel3Osc.triPulse":"Osc {osc} (tri+pul)","matrix.source.joystick":"Joystick {side} {axis}","matrix.dest.outputBus":"Out {bus}","matrix.dest.oscilloscope.Y":"Scope Y","matrix.dest.oscilloscope.X":"Scope X","matrix.dest.oscFreqCV":"Osc {osc} Freq CV","matrix.dest.oscSync":"Osc {osc} Sync","matrix.dest.oscPWM":"Osc {osc} PWM","matrix.dest.outputLevelCV":"Out {bus} Level CV","matrix.tooltip.format":"{source} \u2192 {dest}","matrix.tooltip.unknownSource":"Row {row}","matrix.tooltip.unknownDest":"Col {col}","pinColor.title":"Pin Type","pinColor.recommended":"Recommended","pinColor.standard":"Standard","pinColor.special":"Special","pinColor.white":"White (standard)","pinColor.grey":"Grey (precision)","pinColor.green":"Green (attenuated)","pinColor.red":"Red (scope)","pinColor.blue":"Blue (boost)","pinColor.yellow":"Yellow (mid-gain)","pinColor.cyan":"Cyan (soft)","pinColor.purple":"Purple (subtle)","telemetry.consent.title":"Anonymous Reports","telemetry.consent.message":"Help improve SynthiGME by sending anonymous error and session reports. No personal data, musical content, or usage details are collected. You can change this at any time in Settings.","telemetry.consent.accept":"Enable","telemetry.consent.decline":"No, thanks","menu.advanced.telemetry":"Anonymous Reports","settings.telemetry":"Anonymous Reports","settings.telemetry.label":"Send anonymous reports","settings.telemetry.description":"Sends anonymous error and session reports to help improve SynthiGME. No personal data, musical content, or usage details are collected. You can change this at any time."}});var Dl={};Ot(Dl,{default:()=>Ju});var Ju,Bl=Xe(()=>{Ju={"settings.language.en":"English","settings.language.es":"Espa\xF1ol","settings.language.fr":"Fran\xE7ais","settings.language.de":"Deutsch","settings.language.it":"Italiano","settings.language.pt":"Portugu\xEAs","settings.language.cs":"\u010Ce\u0161tina","splash.loading":"Cargando","app.windowTitle":"Synthi GME (emulador del EMS Synthi 100 de Cuenca, Espa\xF1a)","common.yes":"S\xED","common.no":"No","common.cancel":"Cancelar","common.ok":"Aceptar","settings.title":"Ajustes","settings.close":"Cerrar ajustes","settings.tab.general":"General","settings.tab.audio":"Audio","settings.tab.advanced":"Avanzado","settings.tab.osc":"OSC","settings.tab.about":"Acerca de","settings.tab.select":"Seleccionar secci\xF3n","settings.tab.interface":"Interfaz","settings.display.inactivePins":"Pines inactivos","settings.display.inactivePins.description":"Los pines de la matriz que no conectan ninguna fuente con ning\xFAn destino se consideran inactivos. Por defecto aparecen atenuados y no se pueden pulsar.","settings.display.inactivePins.show":"Mostrar pines inactivos como activos","settings.display.pip":"Disposici\xF3n visual","settings.display.pip.description":"La disposici\xF3n visual incluye la posici\xF3n y tama\xF1o de los paneles flotantes y la posici\xF3n de zoom y desplazamiento del canvas principal. Al activarse, esta disposici\xF3n se restaura al reabrir la aplicaci\xF3n.","settings.display.pip.remember":"Recordar disposici\xF3n visual entre sesiones","settings.display.paramInfo":"Informaci\xF3n de par\xE1metros","settings.display.paramInfo.description":"Mostrar informaci\xF3n t\xE9cnica extendida en los tooltips de controles. Estos valores no ser\xEDan visibles en el Synthi original.","settings.display.paramInfo.voltage":"Mostrar valores el\xE9ctricos (V, Vp-p, \u03A9)","settings.display.paramInfo.audio":"Mostrar valores de audio (frecuencia, ganancia)","settings.display.faderResponse":"Respuesta de faders de salida","settings.display.faderResponse.description":"El Synthi original tiene una respuesta logar\xEDtmica donde la mayor parte del cambio de volumen ocurre al final del recorrido del fader. Activa la respuesta lineal para un control m\xE1s f\xE1cil a costa de la autenticidad.","settings.display.faderResponse.linear":"Respuesta lineal de ganancia (control m\xE1s f\xE1cil)","settings.display.knobStyle":"Apariencia de los knobs","settings.display.knobStyle.description":"Elige entre el dise\xF1o aut\xE9ntico del Synthi 100 (SVG con centros de color y anillo de escala) o un dise\xF1o CSS simplificado.","settings.display.knobStyle.svg":"Synthi 100 aut\xE9ntico (knobs SVG con escala)","settings.display.knobStyle.css":"Simplificado (knobs CSS)","settings.display.glow":"Efecto de brillo en controles","settings.display.glow.description":"Halo pulsante alrededor de knobs, sliders, pads y pines cuando cambia su valor. \xDAtil en actuaciones en directo para que el p\xFAblico vea qu\xE9 se est\xE1 ajustando. El brillo se activa con interacci\xF3n, carga de patches, mensajes OSC y reinicios.","settings.display.glow.performance":"Performance: m\xE1xima visibilidad para shows en directo","settings.display.glow.standard":"Est\xE1ndar: efecto visible y equilibrado","settings.display.glow.subtle":"Sutil: apenas visible, para uso personal","settings.display.glow.off":"Apagado: sin efecto de brillo","settings.display.sharpRasterize":"Nitidez de zoom","settings.display.sharpRasterize.description":"Al hacer zoom, el navegador escala texturas cacheadas que se ven borrosas. La rasterizaci\xF3n adaptativa re-renderiza la interfaz a resoluci\xF3n completa cuando se deja de interactuar, produciendo una imagen n\xEDtida. Puede haber una breve pausa durante el re-renderizado.","settings.display.sharpRasterize.enable":"Activar rasterizaci\xF3n adaptativa","settings.display.touchInteraction":"Interacci\xF3n t\xE1ctil","settings.display.touchInteraction.description":"Opciones para gestos t\xE1ctiles en dispositivos m\xF3viles y tablets. Ajusta el comportamiento del paneo y control con m\xFAltiples dedos seg\xFAn tus necesidades de interpretaci\xF3n.","settings.display.touchInteraction.singleFingerPan":"Mover canvas con un dedo","settings.display.touchInteraction.singleFingerPan.description":"Arrastra sobre el fondo del canvas con un dedo para hacer paneo. Al desactivar, usa pellizco con dos dedos para navegar.","settings.display.touchInteraction.multitouch":"Controles multit\xE1ctil","settings.display.touchInteraction.multitouch.description":"Mueve varios knobs y faders simult\xE1neamente con diferentes dedos. Al desactivar, solo un control responde al toque a la vez, evitando cambios accidentales durante gestos de zoom/paneo.","settings.osc.title":"Comunicaci\xF3n OSC","settings.osc.description":"OSC (Open Sound Control) permite sincronizar m\xFAltiples instancias de SynthiGME en tiempo real a trav\xE9s de la red local. Cuando se mueve un control en una instancia, todas las instancias conectadas reflejan el cambio.","settings.osc.enable":"Activar OSC","settings.osc.electronOnly":"OSC solo est\xE1 disponible en la aplicaci\xF3n de escritorio (Electron).","settings.osc.mode":"Modo de comunicaci\xF3n","settings.osc.mode.peer":"Peer-to-peer (enviar y recibir)","settings.osc.mode.master":"Master (solo enviar)","settings.osc.mode.slave":"Esclavo (solo recibir)","settings.osc.prefix":"Prefijo de direcciones","settings.osc.prefix.description":"Todos los mensajes OSC usan este prefijo. Solo las instancias con el mismo prefijo se sincronizar\xE1n.","settings.osc.supercollider":"SuperCollider","settings.osc.supercollider.send":"Enviar a SuperCollider","settings.osc.supercollider.send.description":"Env\xEDa mensajes OSC a SuperCollider en localhost (127.0.0.1:57120).","settings.osc.supercollider.receive":"Recibir desde SuperCollider","settings.osc.supercollider.receive.description":"Recibe mensajes OSC desde SuperCollider para controlar SynthiGME.","settings.osc.supercollider.port":"Puerto SC","settings.osc.port":"Puerto de escucha","settings.osc.port.description":"Puerto UDP donde SynthiGME recibe mensajes OSC. Cambiar si otro programa (ej. SuperCollider) usa el puerto por defecto.","settings.osc.port.note":"(Requiere reiniciar OSC)","settings.osc.targets":"Destinos unicast","settings.osc.targets.description":"A\xF1ade direcciones IP espec\xEDficas para aplicaciones que no soportan multicast (como SuperCollider).","settings.osc.targets.add":"A\xF1adir destino","settings.osc.targets.ip":"Direcci\xF3n IP","settings.osc.targets.port":"Puerto","settings.osc.targets.remove":"Eliminar","settings.osc.log":"Registro de mensajes","settings.osc.log.show":"Mostrar ventana de log flotante","settings.osc.status":"Estado","settings.osc.status.stopped":"Detenido","settings.osc.status.running":"En ejecuci\xF3n","settings.osc.status.error":"Error","osc.log.title":"Log OSC","osc.log.filter.all":"Todos","osc.log.filter.in":"Entrada","osc.log.filter.out":"Salida","osc.log.pause":"Pausar","osc.log.resume":"Continuar","osc.log.clear":"Limpiar","osc.log.close":"Cerrar","osc.log.noMessages":"Sin mensajes todav\xEDa...","osc.log.messageCount":"{count} mensajes","settings.about.description":"Port web del sintetizador modular Synthi GME, inspirado en el EMS Synthi 100 del Gabinete de M\xFAsica Electroac\xFAstica (GME) de Cuenca. Nacido como Trabajo Final del M\xE1ster en Arte Sonoro de la Universitat de Barcelona (2019/2020), esta versi\xF3n web persigue el mismo objetivo pedag\xF3gico y experimental con distribuci\xF3n sin fricciones.","settings.about.info":"Informaci\xF3n","settings.about.version":"Versi\xF3n:","settings.about.author":"Autor:","settings.about.license":"Licencia:","settings.about.links":"Enlaces","settings.about.repository":"Repositorio en GitHub","settings.about.issues":"Reportar un error / Contacto","settings.about.telegram":"\xDAnete a nuestro grupo de Telegram","settings.about.originalProject":"Proyecto original (SuperCollider)","settings.about.credits":"Cr\xE9ditos","settings.about.credits.development":"Desarrollo y dise\xF1o de interfaz: ","settings.about.credits.appIcons":"Iconos de la app: ","settings.about.credits.uiIcons":"Iconos de UI: ","settings.about.credits.inspiration":"Inspirado en: ","settings.language":"Idioma","settings.scale":"Escala de renderizado","settings.scale.description":'Mayor escala = mayor nitidez, pero m\xE1s consumo de recursos. Se resetea a 1\xD7 al reiniciar salvo que actives "Recordar".',"settings.scale.current":"Escala actual:","settings.scale.remember":"Recordar al reiniciar","settings.updates":"Actualizaciones","settings.updates.version":"Versi\xF3n actual:","settings.updates.check":"Buscar actualizaciones","settings.updates.checking":"Buscando...","settings.updates.available":"\xA1Nueva versi\xF3n disponible!","settings.updates.pendingInstall":"Hay una nueva versi\xF3n lista para instalar","settings.updates.install":"Instalar actualizaci\xF3n","settings.updates.installAndReload":"Instalar y recargar","settings.updates.installing":"Instalando...","settings.updates.upToDate":"Est\xE1s al d\xEDa \u2713","settings.updates.error":"Error al buscar actualizaciones","settings.autosave":"Autoguardado","settings.autosave.description":"Guardar autom\xE1ticamente el estado actual peri\xF3dicamente","settings.autosave.interval":"Intervalo de guardado","settings.autosave.interval.off":"Desactivado","settings.autosave.interval.30s":"Cada 30 segundos","settings.autosave.interval.1m":"Cada 1 minuto","settings.autosave.interval.5m":"Cada 5 minutos","settings.autosave.interval.10m":"Cada 10 minutos","settings.autosave.onExit":"Guardar al salir","settings.autosave.onExit.description":"Guardar el estado actual al cerrar la aplicaci\xF3n","settings.autosave.restoreOnStart":"Restaurar al iniciar","settings.autosave.restoreOnStart.description":"Preguntar si restaurar el \xFAltimo estado al abrir la aplicaci\xF3n","settings.autosave.askBeforeRestore":"Preguntar antes de restaurar","settings.autosave.askBeforeRestore.description":"Mostrar di\xE1logo de confirmaci\xF3n antes de restaurar (se puede cambiar desde el di\xE1logo)","settings.wakelock":"Mantener pantalla encendida","settings.wakelock.description":"Evita que la pantalla se apague mientras la app est\xE1 abierta","settings.wakelock.unsupported":"No soportado en este navegador","settings.shortcuts":"Atajos de teclado","settings.shortcuts.description":"Haz clic en un atajo para cambiarlo. Pulsa la nueva combinaci\xF3n de teclas.","settings.shortcuts.knobModifiers":"Knobs: mant\xE9n Ctrl/Cmd para mover 10\xD7 m\xE1s r\xE1pido y Shift para 10\xD7 m\xE1s preciso.","settings.shortcuts.mute":"Silenciar/Activar","settings.shortcuts.record":"Grabar/Detener","settings.shortcuts.patches":"Abrir patches","settings.shortcuts.settings":"Abrir ajustes","settings.shortcuts.fullscreen":"Pantalla completa","settings.shortcuts.reset":"Reiniciar synth","settings.shortcuts.showPanelHints":"Mostrar n\xFAmeros de panel (mantener)","settings.shortcuts.signalFlow":"Resaltar flujo de se\xF1al (mantener)","settings.shortcuts.panel1":"Panel 1","settings.shortcuts.panel2":"Panel 2","settings.shortcuts.panel3":"Panel 3","settings.shortcuts.panel4":"Panel 4","settings.shortcuts.panel5":"Panel 5","settings.shortcuts.panel6":"Panel 6","settings.shortcuts.panelOutput":"Panel Output","settings.shortcuts.overview":"Vista general","settings.shortcuts.press":"Pulsa una tecla...","settings.shortcuts.none":"Ninguno","settings.shortcuts.conflict":"Ya asignado a: {action}","settings.shortcuts.reserved":"Esta tecla est\xE1 reservada","settings.shortcuts.resetDefaults":"Restaurar atajos","settings.signalFlow":"Flujo de se\xF1al","settings.signalFlow.description":"Resalta visualmente el origen (cyan) y destino (magenta) de las conexiones al pasar sobre m\xF3dulos o pines activos. En desktop requiere mantener la tecla modificadora.","settings.signalFlow.noModifier":"Activar sin tecla modificadora (recomendado en tablets)","settings.signalFlow.enabled":"Mostrar flujo de se\xF1al al pasar el rat\xF3n","toast.autosave":"Estado guardado autom\xE1ticamente","toast.autosave.exit":"Estado guardado antes de salir","toast.restored":"Estado anterior restaurado","audio.title":"Configuraci\xF3n de Audio","audio.close":"Cerrar configuraci\xF3n","audio.device.output":"Dispositivo de salida:","audio.device.input":"Dispositivo de entrada:","audio.device.default":"Dispositivo por defecto","audio.device.loading":"Cargando dispositivos...","audio.device.error":"Error al cargar dispositivos","audio.device.system":"Sistema","audio.mode.title":"Modo de salida","audio.mode.stereo":"Est\xE9reo","audio.mode.multichannel":"Multicanal (12ch)","audio.mode.multichannel.desc":"12 canales independientes v\xEDa PipeWire. Rutea en qpwgraph.","audio.mode.unavailable":"(Requiere Electron + PipeWire)","audio.outputs.title":"Salidas \u2192 Sistema","audio.outputs.channels":"Canales detectados:","audio.outputs.description":"Rutea las salidas l\xF3gicas del Synthi a las salidas f\xEDsicas del sistema.","audio.outputs.more":"+{count} filas m\xE1s (scroll para ver)","audio.outputs.reset":"Restablecer valores","audio.inputs.title":"Sistema \u2192 Input Amplifier Level","audio.inputs.channels":"Canales de entrada:","audio.inputs.description":"Rutea las entradas f\xEDsicas del sistema al Input Amplifier Level del Synthi.","audio.inputs.enable":"Habilitar entrada de audio","audio.inputs.permission":"Requiere permiso de micr\xF3fono.","audio.inputs.enabled":"\u2713 Entrada habilitada","audio.inputs.multichannel.title":"PipeWire \u2192 Input Amplifier Level","audio.inputs.multichannel.description":"Rutea 8 canales de entrada de PipeWire al Input Amplifier Level.","audio.inputs.multichannel.labels":"input_amp_{n}","audio.inputs.reset":"Restablecer valores","audio.latency.title":"Latencia","audio.latency.description":"Ajusta el buffer de audio. Menor = respuesta m\xE1s r\xE1pida pero m\xE1s riesgo de clicks.","audio.latency.webAudio":"Buffer Web Audio:","audio.latency.multichannel":"Buffer Multicanal:","audio.latency.interactive":"~10ms (Interactivo)","audio.latency.balanced":"~25ms (Equilibrado)","audio.latency.playback":"~50ms (Reproducci\xF3n)","audio.latency.safe":"~100ms (Seguro)","audio.latency.maximum":"~200ms (M\xE1ximo)","audio.latency.veryLow":"muy baja","audio.latency.low":"baja","audio.latency.normal":"normal","audio.latency.high":"alta","audio.latency.veryHigh":"muy alta","audio.latency.total":"Latencia total estimada:","audio.latency.restartRequired":"\u26A0\uFE0F Reinicia la app para aplicar cambios","audio.latency.reconnectRequired":"\u26A0\uFE0F Desactiva y reactiva el dispositivo para aplicar","audio.permission.denied.title":"Acceso al micr\xF3fono denegado","audio.permission.denied.message":"Habilita el micr\xF3fono desde los ajustes del navegador o del sistema para usar entradas de audio.","audio.permission.retry":"Reintentar","audio.channel.mono":"Mono","audio.channel.stereo":"Est\xE9reo","audio.channel.quad":"Cuadraf\xF3nico","audio.channel.surround":"5.1 Surround","quickbar.open":"Abrir acciones r\xE1pidas","quickbar.close":"Cerrar acciones r\xE1pidas","quickbar.pan.lock":"Bloquear paneo","quickbar.pan.unlock":"Desbloquear paneo","quickbar.zoom.lock":"Bloquear zoom","quickbar.zoom.unlock":"Desbloquear zoom","quickbar.settings":"Ajustes (S)","quickbar.patches":"Patches (P)","quickbar.pip":"Paneles flotantes","quickbar.audio":"Configuraci\xF3n de audio (A)","quickbar.emergency":"Resetear escala a 1\xD7 (emergencia)","quickbar.emergency.applied":"Escala reseteada a 1\xD7","quickbar.mute":"Silenciar audio (M)","quickbar.unmute":"Activar audio (M)","toast.mute":"Audio silenciado","toast.unmute":"Audio activo","toast.dspEnabled":"Motor de audio activado","toast.dspDisabled":"Motor de audio desactivado","toast.dspRequired":"El motor de audio est\xE1 desactivado. Act\xEDvalo en Ajustes de audio.","quickbar.fullscreen":"Pantalla completa (F)","quickbar.fullscreen.exit":"Salir de pantalla completa (Esc)","quickbar.reset":"Reiniciar synth (Shift+I)","synth.reset.confirm":"\xBFSeguro que quieres reiniciar el sintetizador a sus valores iniciales?","common.dontAskAgain":"No volver a preguntar","settings.synth.confirmReset":"Pedir confirmaci\xF3n al reiniciar el sintetizador","quickbar.oscOn":"OSC habilitado - Click para deshabilitar","quickbar.oscOff":"OSC deshabilitado - Click para habilitar","quickbar.oscError":"Error al activar OSC","quickbar.undo":"Deshacer (Ctrl+Z)","quickbar.redo":"Rehacer (Ctrl+U)","toast.undo":"Cambio deshecho","toast.redo":"Cambio rehecho","quickbar.record":"Grabar audio (R)","quickbar.stopRecording":"Detener grabaci\xF3n (R)","quickbar.recordSettings":"Configuraci\xF3n de grabaci\xF3n","recording.title":"Configuraci\xF3n de grabaci\xF3n","recording.close":"Cerrar configuraci\xF3n de grabaci\xF3n","recording.tracks.label":"N\xFAmero de pistas","recording.tracks.mono":"1 (Mono)","recording.tracks.stereo":"2 (Est\xE9reo)","recording.tracks.tracks":"pistas","recording.track":"Pista","recording.routing.title":"Ruteo de pistas de grabaci\xF3n","recording.routing.description":"Selecciona qu\xE9 salidas se graban en cada pista","recording.format.label":"Formato","recording.format.wav":"WAV (sin p\xE9rdidas, multipista)","recording.format.webmOpus":"WebM/Opus (comprimido, est\xE9reo)","recording.format.wavDesc":"Sin p\xE9rdidas 16-bit PCM. Soporta hasta 12 pistas con ruteo personalizado. Archivos grandes.","recording.format.webmOpusDesc":"Audio comprimido de alta calidad. Solo est\xE9reo. Archivos mucho m\xE1s peque\xF1os, ideal para compartir.","recording.bitrate.label":"Calidad (bitrate)","recording.bitrate.recommended":"recomendado","recording.overlay.recording":"Grabaci\xF3n en curso","settings.recording":"Grabaci\xF3n de audio","settings.recording.description":"Graba la salida de audio a WAV (sin p\xE9rdidas) o WebM/Opus (comprimido)","settings.recording.configure":"Configurar grabaci\xF3n","toast.recordingStarted":"Grabaci\xF3n iniciada","toast.recordingSaved":"Grabaci\xF3n guardada: {filename}","toast.recordingEmpty":"No se grab\xF3 audio","toast.recordingError":"Error al grabar","settings.reset":"Restaurar ajustes por defecto","settings.reset.description":"Elimina todas las preferencias guardadas y restaura los valores por defecto. La p\xE1gina se recargar\xE1.","settings.reset.button":"Restaurar valores por defecto","settings.reset.confirm":"\xBFSeguro que quieres restaurar todos los ajustes a sus valores por defecto? La p\xE1gina se recargar\xE1.","settings.optimizations":"Optimizaciones de rendimiento","settings.optimizations.description":"Estas opciones reducen la carga de CPU desactivando el procesamiento de audio cuando no es necesario. Especialmente \xFAtiles en dispositivos m\xF3viles.","settings.optimizations.debugGlobal":"Mostrar toasts de debug para todas las optimizaciones","settings.dsp":"Motor de audio (DSP)","settings.dsp.description":"Activa o desactiva el motor de audio. Cuando est\xE1 desactivado, la app funciona como controlador OSC sin procesamiento de audio.","settings.dsp.enabled":"Motor de audio activado","settings.dsp.startEnabled":"Activar audio al iniciar","settings.dormancy":"Dormancy de m\xF3dulos","settings.dormancy.description":"Silencia autom\xE1ticamente los m\xF3dulos que no est\xE1n conectados en la matriz.","settings.dormancy.enabled":"Activar sistema de dormancy","settings.dormancy.debug":"Debug solo dormancy","settings.filterBypass":"Bypass de filtros","settings.filterBypass.description":"Puentea los filtros LP/HP de output channels y el filtro colour del noise en posici\xF3n neutral, reduciendo carga de CPU.","settings.filterBypass.enabled":"Activar bypass de filtros","settings.filterBypass.debug":"Debug solo bypass de filtros","settings.latencyMode":"Modo de latencia","settings.latencyMode.description":'Ajusta el tama\xF1o del buffer de audio. Usa "Reproducci\xF3n" en m\xF3vil para estabilidad, "Interactivo" en escritorio para baja latencia.',"settings.latencyMode.interactive":"Interactivo (~10ms)","settings.latencyMode.balanced":"Equilibrado (~25ms)","settings.latencyMode.playback":"Reproducci\xF3n (~50ms)","settings.latencyMode.safe":"Seguro (100ms)","settings.latencyMode.maximum":"M\xE1ximo (200ms)","settings.latencyMode.restartRequired":"Modo de latencia guardado. Reinicia la app para aplicar los cambios.","settings.voltageEmulation":"Emulaci\xF3n de voltajes","settings.voltageEmulation.description":"Emula el comportamiento el\xE9ctrico del Synthi 100 versi\xF3n Cuenca/Datanomics (1982). Estas opciones afectan la precisi\xF3n anal\xF3gica de las se\xF1ales.","settings.voltageEmulation.softClip":"Saturaci\xF3n suave (soft clip)","settings.voltageEmulation.softClip.description":"Satura suavemente con tanh() las se\xF1ales que superan los l\xEDmites de entrada de cada m\xF3dulo (8V p-p t\xEDpico).","settings.voltageEmulation.pinTolerance":"Tolerancia de pines","settings.voltageEmulation.pinTolerance.description":"Aplica variaci\xF3n realista seg\xFAn el tipo de pin: gris \xB10.5%, blanco \xB110%. Cada conexi\xF3n tiene su propia tolerancia reproducible.","settings.voltageEmulation.thermalDrift":"Deriva t\xE9rmica","settings.voltageEmulation.thermalDrift.description":"Simula la deriva lenta (\xB10.1%) de los osciladores CEM 3340 por cambios de temperatura.","menu.file":"Archivo","menu.file.patches":"Patches\u2026","menu.file.language":"Idioma","menu.file.reload":"Recargar","menu.file.reload.confirm":"\xBFRecargar la aplicaci\xF3n? Los cambios no guardados se perder\xE1n.","menu.file.quit":"Salir","menu.file.quit.confirm":"\xBFSalir de la aplicaci\xF3n?","menu.preferences":"Preferencias","menu.preferences.settings":"Todos los ajustes\u2026","menu.view":"Ver","menu.view.quickbar":"Mostrar barra r\xE1pida","menu.view.fullscreen":"Pantalla completa","menu.view.zoomIn":"Acercar","menu.view.zoomOut":"Alejar","menu.view.zoomReset":"Zoom 100%","menu.view.inactivePins":"Mostrar pines inactivos","menu.view.tooltipVoltage":"Par\xE1metros electr\xF3nicos en tooltips","menu.view.tooltipAudioRate":"Info de audio en tooltips","menu.view.linearFaders":"Respuesta lineal de faders","menu.view.sharpRasterize":"Rasterizaci\xF3n adaptativa (zoom n\xEDtido)","menu.view.devTools":"Herramientas de desarrollo","menu.audio":"Audio","menu.audio.mute":"Silenciar","menu.audio.unmute":"Activar audio","menu.audio.record":"Grabar","menu.audio.stopRecording":"Detener grabaci\xF3n","menu.audio.audioSettings":"Ajustes de audio y grabaci\xF3n\u2026","menu.audio.preventSleep":"Impedir suspensi\xF3n del sistema","menu.audio.dsp":"DSP (motor de audio)","menu.panels":"Paneles","menu.panels.detachHeader":"Separar paneles","menu.panels.detachAll":"Extraer todos","menu.panels.attachAll":"Devolver todos","menu.panels.lockPan":"Bloquear paneo","menu.panels.lockZoom":"Bloquear zoom","menu.panels.rememberVisualLayout":"Recordar disposici\xF3n visual","menu.panels.singleFingerPan":"Paneo con un dedo","menu.panels.multitouchControls":"Controles multit\xE1ctil","menu.advanced":"Avanzado","menu.advanced.debugGlobal":"Toasts de debug (todos)","menu.advanced.dormancy":"Dormancy de m\xF3dulos","menu.advanced.dormancyDebug":"Debug dormancy","menu.advanced.filterBypass":"Bypass de filtros","menu.advanced.filterBypassDebug":"Debug bypass de filtros","menu.advanced.softClip":"Saturaci\xF3n suave","menu.advanced.pinTolerance":"Tolerancia de pines","menu.advanced.thermalDrift":"Deriva t\xE9rmica","menu.advanced.resetSynth":"Reiniciar sintetizador\u2026","menu.advanced.settings":"Todos los ajustes\u2026","menu.osc":"OSC","menu.osc.enable":"Activar OSC","menu.osc.sendToSC":"Enviar a SuperCollider","menu.osc.receiveFromSC":"Recibir de SuperCollider","menu.osc.showLog":"Mostrar log OSC","menu.osc.settings":"Ajustes OSC\u2026","menu.help":"Ayuda","menu.help.about":"Acerca de Synthi GME\u2026","menu.help.repository":"Repositorio GitHub","menu.help.reportBug":"Reportar un error\u2026","menu.help.checkUpdates":"Buscar actualizaciones\u2026","toast.reset":"Sintetizador reiniciado","toast.resolution":"Escala: {factor}\xD7","toast.resolution.mobileWarning":"Escala: {factor}\xD7 \u26A0\uFE0F Puede causar problemas de rendimiento","toast.pan.locked":"Paneo bloqueado","toast.pan.unlocked":"Paneo desbloqueado","toast.zoom.locked":"Zoom bloqueado","toast.zoom.unlocked":"Zoom desbloqueado","pip.detach":"Extraer panel","pip.detachAll":"Extraer todos","pip.attach":"Devolver panel","pip.attachAll":"Devolver todos","pip.close":"Cerrar","pip.zoomIn":"Acercar","pip.zoomOut":"Alejar","pip.maximize":"Maximizar","pip.minimize":"Minimizar","pip.lock":"Bloquear","pip.unlock":"Desbloquear","pip.fitPanel":"Ajustar panel","pip.placeholderHint":"Mantener pulsado para opciones","panel.oscillators1":"Osciladores 1-3","panel.oscilloscope":"Osciloscopio","panel.oscillators2":"Osciladores 4-6","panel.oscillators3":"Osciladores 7-9","panel.audioMatrix":"Matriz Audio","panel.controlMatrix":"Matriz Control","panel.output":"Salida","contextMenu.resetPanel":"Reiniciar panel","contextMenu.resetModule":"Reiniciar {name}","contextMenu.resetControl":"Reiniciar {name}","notes.add":"A\xF1adir nota","notes.delete":"Eliminar nota","notes.placeholder":"Escribe aqu\xED...","notes.color":"Cambiar color","notes.color.yellow":"Amarillo","notes.color.pink":"Rosa","notes.color.blue":"Azul","notes.color.green":"Verde","notes.color.orange":"Naranja","notes.color.purple":"Morado","notes.fontUp":"Aumentar tama\xF1o de texto","notes.fontDown":"Reducir tama\xF1o de texto","notes.ctx.cut":"Cortar","notes.ctx.copy":"Copiar","notes.ctx.paste":"Pegar","notes.ctx.bold":"Negrita","notes.ctx.italic":"Cursiva","notes.ctx.edit":"Editar","notes.ctx.copyNote":"Copiar nota","notes.ctx.cutNote":"Cortar nota","notes.ctx.pasteNote":"Pegar nota","notes.ctx.alignLeft":"Alinear izquierda","notes.ctx.alignCenter":"Centrar","notes.ctx.alignRight":"Alinear derecha","orientation.hint":"Gira el dispositivo en posici\xF3n horizontal para una mejor experiencia","orientation.blocker":"Gira el dispositivo a modo horizontal","orientation.blocker.dismiss":"Cerrar","update.available":"Hay una nueva versi\xF3n disponible. \xBFQuieres instalarla y recargar ahora?","update.installNow":"Instalar ahora","update.later":"M\xE1s tarde","error.fullscreen":"No se pudo alternar la pantalla completa.","patches.title":"Patches","patches.close":"Cerrar patches","patches.saveCurrent":"Guardar actual","patches.saveNew":"Guardar nuevo","patches.overwrite":"Sobrescribir","patches.confirmOverwrite":'\xBFSobrescribir patch "{name}"?',"patches.overwritten":"Patch sobrescrito","patches.includeVisual":"Incluir configuraci\xF3n visual","patches.hasVisual":"Incluye configuraci\xF3n visual","patches.search":"Buscar...","patches.empty":"No hay patches guardados","patches.load":"Cargar","patches.export":"Exportar","patches.import":"Importar","patches.delete":"Eliminar","patches.rename":"Renombrar","patches.confirmDelete":'\xBFEliminar patch "{name}"?',"patches.confirmLoad":'\xBFCargar patch "{name}"? Los cambios no guardados se perder\xE1n.',"patches.saved":"Patch guardado","patches.loaded":"Patch cargado","patches.loadedName":'"{name}" cargado',"patches.deleted":"Patch eliminado","patches.renamed":"Patch renombrado","patches.exported":"Patch exportado","patches.imported":"Patch importado","patches.errorLoading":"Error al cargar patch","patches.errorSaving":"Error al guardar patch","patches.errorRenaming":"Error al renombrar patch","patches.namePrompt":"Nombre del patch","patches.renamePrompt":"Nuevo nombre","patches.defaultName":"Nuevo patch","patches.init":"Init (por defecto)","patches.lastSession":"\xBFRestaurar \xFAltima sesi\xF3n?","patches.lastSession.yes":"Restaurar","patches.lastSession.no":"Empezar de nuevo","patches.lastSession.remember":"Recordar mi elecci\xF3n","patches.versionWarning":"Este patch fue creado con una versi\xF3n anterior","matrix.source.inputAmp":"Input {channel}","matrix.source.outputBus":"Out Bus {bus}","matrix.source.noiseGen":"Noise {index}","matrix.source.panel3Osc.sineSaw":"Osc {osc} (sin+saw)","matrix.source.panel3Osc.triPulse":"Osc {osc} (tri+pul)","matrix.source.joystick":"Joystick {side} {axis}","matrix.dest.outputBus":"Out {bus}","matrix.dest.oscilloscope.Y":"Scope Y","matrix.dest.oscilloscope.X":"Scope X","matrix.dest.oscFreqCV":"Osc {osc} Freq CV","matrix.dest.oscSync":"Osc {osc} Sync","matrix.dest.oscPWM":"Osc {osc} PWM","matrix.dest.outputLevelCV":"Out {bus} Level CV","matrix.tooltip.format":"{source} \u2192 {dest}","matrix.tooltip.unknownSource":"Row {row}","matrix.tooltip.unknownDest":"Col {col}","pinColor.title":"Tipo de pin","pinColor.recommended":"Recomendado","pinColor.standard":"Est\xE1ndar","pinColor.special":"Especiales","pinColor.white":"Blanco (est\xE1ndar)","pinColor.grey":"Gris (precisi\xF3n)","pinColor.green":"Verde (atenuado)","pinColor.red":"Rojo (osciloscopio)","pinColor.blue":"Azul (ganancia)","pinColor.yellow":"Amarillo (media)","pinColor.cyan":"Cian (suave)","pinColor.purple":"Morado (sutil)  fr: Purple (subtle)","telemetry.consent.title":"Reportes an\xF3nimos","telemetry.consent.message":"Ayuda a mejorar SynthiGME enviando reportes an\xF3nimos de errores y sesiones. No se recopilan datos personales, contenido musical ni detalles de uso. Puedes cambiar esto en cualquier momento en Ajustes.","telemetry.consent.accept":"Activar","telemetry.consent.decline":"No, gracias","menu.advanced.telemetry":"Reportes an\xF3nimos","settings.telemetry":"Reportes an\xF3nimos","settings.telemetry.label":"Enviar reportes an\xF3nimos","settings.telemetry.description":"Env\xEDa reportes an\xF3nimos de errores y sesiones para ayudar a mejorar SynthiGME. No se recopilan datos personales, contenido musical ni detalles de uso. Puedes cambiar esto en cualquier momento."}});var zl={};Ot(zl,{default:()=>Qu});var Qu,Fl=Xe(()=>{Qu={"settings.language.en":"English","settings.language.es":"Espa\xF1ol","settings.language.fr":"Fran\xE7ais","settings.language.de":"Deutsch","settings.language.it":"Italiano","settings.language.pt":"Portugu\xEAs","settings.language.cs":"\u010Ce\u0161tina","splash.loading":"Chargement","app.windowTitle":"Synthi GME (\xE9mulateur de l'EMS Synthi 100 de Cuenca, Espagne)","common.yes":"Oui","common.no":"Non","common.cancel":"Annuler","common.ok":"D'accord","settings.title":"Param\xE8tres","settings.close":"Fermer les param\xE8tres","settings.tab.general":"G\xE9n\xE9ral","settings.tab.audio":"Audio","settings.tab.advanced":"Avanc\xE9","settings.tab.osc":"OSC","settings.tab.about":"\xC0 propos","settings.tab.select":"S\xE9lectionner la section","settings.tab.interface":"Interface","settings.display.inactivePins":"Broches inactives","settings.display.inactivePins.description":"Les broches de matrice qui ne connectent aucune source \xE0 aucune destination sont consid\xE9r\xE9es comme inactives. Par d\xE9faut, elles apparaissent att\xE9nu\xE9es et ne peuvent pas \xEAtre cliqu\xE9es.","settings.display.inactivePins.show":"Afficher les broches inactives comme actives","settings.display.pip":"Disposition visuelle","settings.display.pip.description":"La disposition visuelle comprend la position et la taille des panneaux flottants ainsi que la position de zoom et de d\xE9filement du canevas principal. Lorsqu'elle est activ\xE9e, cette disposition est restaur\xE9e \xE0 la r\xE9ouverture de l'application.","settings.display.pip.remember":"M\xE9moriser la disposition visuelle entre les sessions","settings.display.paramInfo":"Informations sur les param\xE8tres","settings.display.paramInfo.description":"Afficher les informations techniques \xE9tendues dans les info-bulles de contr\xF4le. Ces valeurs ne seraient pas visibles sur le mat\xE9riel Synthi original.","settings.display.paramInfo.voltage":"Afficher les valeurs \xE9lectriques (V, Vp-p, \u03A9)","settings.display.paramInfo.audio":"Afficher les valeurs audio (fr\xE9quence, gain)","settings.display.faderResponse":"R\xE9ponse des faders de sortie","settings.display.faderResponse.description":"Le Synthi original a une r\xE9ponse logarithmique o\xF9 la plupart des changements de volume se produisent \xE0 la fin de la course du fader. Activez la r\xE9ponse lin\xE9aire pour un contr\xF4le plus facile au d\xE9triment de l'authenticit\xE9.","settings.display.faderResponse.linear":"R\xE9ponse lin\xE9aire de gain (contr\xF4le plus facile)","settings.display.knobStyle":"Apparence des boutons","settings.display.knobStyle.description":"Choisissez entre le design authentique du Synthi 100 (SVG avec centres color\xE9s et anneau de graduation) ou un design CSS simplifi\xE9.","settings.display.knobStyle.svg":"Synthi 100 authentique (boutons SVG avec \xE9chelle)","settings.display.knobStyle.css":"Simplifi\xE9 (boutons CSS)","settings.display.glow":"Effet de luminosit\xE9 des contr\xF4les","settings.display.glow.description":"Halo pulsant autour des boutons, curseurs, pads et broches lorsque leur valeur change. Utile pour les performances en direct afin que le public puisse voir ce qui est ajust\xE9. La lueur s'active lors de l'interaction, du chargement de patches, des messages OSC et des r\xE9initialisations.","settings.display.glow.performance":"Performance : visibilit\xE9 maximale pour les spectacles en direct","settings.display.glow.standard":"Standard : effet visible et \xE9quilibr\xE9","settings.display.glow.subtle":"Subtil : \xE0 peine visible, pour un usage personnel","settings.display.glow.off":"D\xE9sactiv\xE9 : aucun effet de luminosit\xE9","settings.display.sharpRasterize":"Nettet\xE9 du zoom","settings.display.sharpRasterize.description":"Lors du zoom, le navigateur \xE9tire les textures mises en cache qui paraissent floues. La rast\xE9risation adaptative re-rend l'interface \xE0 pleine r\xE9solution apr\xE8s la fin de l'interaction, produisant une image nette. Il peut y avoir une br\xE8ve pause pendant le re-rendu.","settings.display.sharpRasterize.enable":"Activer la rast\xE9risation adaptative","settings.display.touchInteraction":"Interaction tactile","settings.display.touchInteraction.description":"Options pour les gestes tactiles sur appareils mobiles et tablettes. Ajustez le comportement du panoramique et du contr\xF4le multi-doigts selon vos besoins de performance.","settings.display.touchInteraction.singleFingerPan":"D\xE9placer le canevas avec un doigt","settings.display.touchInteraction.singleFingerPan.description":"Faites glisser n'importe o\xF9 sur le fond du canevas avec un doigt pour panoramiquer. D\xE9sactiv\xE9, utilisez le pincement \xE0 deux doigts pour naviguer.","settings.display.touchInteraction.multitouch":"Contr\xF4les multitouch","settings.display.touchInteraction.multitouch.description":"D\xE9placez plusieurs boutons et curseurs simultan\xE9ment avec diff\xE9rents doigts. D\xE9sactiv\xE9, un seul contr\xF4le r\xE9pond au toucher \xE0 la fois, \xE9vitant les changements accidentels pendant les gestes de zoom/panoramique.","settings.osc.title":"Communication OSC","settings.osc.description":"OSC (Open Sound Control) permet \xE0 plusieurs instances de SynthiGME de se synchroniser en temps r\xE9el sur le r\xE9seau local. Quand un contr\xF4le est d\xE9plac\xE9 sur une instance, toutes les instances connect\xE9es refl\xE8tent le changement.","settings.osc.enable":"Activer OSC","settings.osc.electronOnly":"OSC est uniquement disponible dans l'application de bureau (Electron).","settings.osc.mode":"Mode de communication","settings.osc.mode.peer":"Pair-\xE0-pair (envoyer et recevoir)","settings.osc.mode.master":"Ma\xEEtre (envoi uniquement)","settings.osc.mode.slave":"Esclave (r\xE9ception uniquement)","settings.osc.prefix":"Pr\xE9fixe d'adresse","settings.osc.prefix.description":"Tous les messages OSC utilisent ce pr\xE9fixe. Seules les instances avec le m\xEAme pr\xE9fixe se synchroniseront.","settings.osc.supercollider":"SuperCollider","settings.osc.supercollider.send":"Envoyer \xE0 SuperCollider","settings.osc.supercollider.send.description":"Envoie des messages OSC \xE0 SuperCollider sur localhost (127.0.0.1:57120).","settings.osc.supercollider.receive":"Recevoir depuis SuperCollider","settings.osc.supercollider.receive.description":"Re\xE7oit les messages OSC de SuperCollider pour contr\xF4ler SynthiGME.","settings.osc.supercollider.port":"Port SC","settings.osc.port":"Port d'\xE9coute","settings.osc.port.description":"Port UDP o\xF9 SynthiGME re\xE7oit les messages OSC. Changez si un autre programme (par ex. SuperCollider) utilise le port par d\xE9faut.","settings.osc.port.note":"(N\xE9cessite un red\xE9marrage OSC)","settings.osc.targets":"Cibles unicast","settings.osc.targets.description":"Ajoutez des adresses IP sp\xE9cifiques pour les applications qui ne supportent pas le multicast (comme SuperCollider).","settings.osc.targets.add":"Ajouter une cible","settings.osc.targets.ip":"Adresse IP","settings.osc.targets.port":"Port","settings.osc.targets.remove":"Supprimer","settings.osc.log":"Journal des messages","settings.osc.log.show":"Afficher la fen\xEAtre de journal flottant","settings.osc.status":"\xC9tat","settings.osc.status.stopped":"Arr\xEAt\xE9","settings.osc.status.running":"En cours d'ex\xE9cution","settings.osc.status.error":"Erreur","osc.log.title":"Journal OSC","osc.log.filter.all":"Tous","osc.log.filter.in":"Entr\xE9e","osc.log.filter.out":"Sortie","osc.log.pause":"Pause","osc.log.resume":"Reprendre","osc.log.clear":"Effacer","osc.log.close":"Fermer","osc.log.noMessages":"Pas de messages pour l'instant...","osc.log.messageCount":"{count} messages","settings.about.description":"Port web du synth\xE9tiseur modulaire Synthi GME, inspir\xE9 par l'EMS Synthi 100 du Gabinete de M\xFAsica Electroac\xFAstica (GME) \xE0 Cuenca. N\xE9 comme projet final de Master en Art Sonore \xE0 l'Universitat de Barcelona (2019/2020), cette version web poursuit le m\xEAme objectif p\xE9dagogique et exp\xE9rimental avec une distribution sans friction.","settings.about.info":"Informations","settings.about.version":"Version :","settings.about.author":"Auteur :","settings.about.license":"Licence :","settings.about.links":"Liens","settings.about.repository":"D\xE9p\xF4t GitHub","settings.about.issues":"Signaler un bug / Contacter","settings.about.telegram":"Rejoindre notre groupe Telegram","settings.about.originalProject":"Projet original (SuperCollider)","settings.about.credits":"Cr\xE9dits","settings.about.credits.development":"D\xE9veloppement et design de l\u2019interface :","settings.about.credits.appIcons":"Ic\xF4nes d'application :","settings.about.credits.uiIcons":"Ic\xF4nes d'interface :","settings.about.credits.inspiration":"Inspir\xE9 par :","settings.language":"Langue","settings.scale":"\xC9chelle de rendu","settings.scale.description":'\xC9chelle plus \xE9lev\xE9e = image plus nette, mais utilisation plus importante des ressources. Se r\xE9initialise \xE0 1\xD7 au red\xE9marrage sauf si "M\xE9moriser" est activ\xE9.',"settings.scale.current":"\xC9chelle actuelle :","settings.scale.remember":"M\xE9moriser au red\xE9marrage","settings.updates":"Mises \xE0 jour","settings.updates.version":"Version actuelle :","settings.updates.check":"V\xE9rifier les mises \xE0 jour","settings.updates.checking":"V\xE9rification...","settings.updates.available":"Nouvelle version disponible !","settings.updates.pendingInstall":"Une nouvelle version est pr\xEAte \xE0 \xEAtre install\xE9e","settings.updates.install":"Installer la mise \xE0 jour","settings.updates.installAndReload":"Installer et recharger","settings.updates.installing":"Installation...","settings.updates.upToDate":"Vous \xEAtes \xE0 jour \u2713","settings.updates.error":"Erreur lors de la v\xE9rification des mises \xE0 jour","settings.autosave":"Sauvegarde automatique","settings.autosave.description":"Enregistrer automatiquement l'\xE9tat actuel p\xE9riodiquement","settings.autosave.interval":"Intervalle de sauvegarde","settings.autosave.interval.off":"D\xE9sactiv\xE9","settings.autosave.interval.30s":"Tous les 30 secondes","settings.autosave.interval.1m":"Chaque 1 minute","settings.autosave.interval.5m":"Tous les 5 minutes","settings.autosave.interval.10m":"Tous les 10 minutes","settings.autosave.onExit":"Enregistrer \xE0 la fermeture","settings.autosave.onExit.description":"Enregistrer l'\xE9tat actuel lors de la fermeture de l'application","settings.autosave.restoreOnStart":"Restaurer au d\xE9marrage","settings.autosave.restoreOnStart.description":"Demander de restaurer le dernier \xE9tat enregistr\xE9 \xE0 l'ouverture de l'application","settings.autosave.askBeforeRestore":"Demander avant de restaurer","settings.autosave.askBeforeRestore.description":"Afficher un dialogue de confirmation avant de restaurer (peut \xEAtre modifi\xE9 \xE0 partir du dialogue)","settings.wakelock":"Garder l'\xE9cran allum\xE9","settings.wakelock.description":"Emp\xEAche l'\xE9cran de s'\xE9teindre pendant que l'application est ouverte","settings.wakelock.unsupported":"Non support\xE9 dans ce navigateur","settings.shortcuts":"Raccourcis clavier","settings.shortcuts.description":"Cliquez sur un raccourci pour le modifier. Appuyez sur la nouvelle combinaison de touches.","settings.shortcuts.knobModifiers":"Boutons : maintenez Ctrl/Cmd pour un mouvement 10\xD7 plus rapide, Shift pour un contr\xF4le 10\xD7 plus fin.","settings.shortcuts.mute":"Sourdine/Activer","settings.shortcuts.record":"Enregistrer/Arr\xEAter","settings.shortcuts.patches":"Ouvrir les patches","settings.shortcuts.settings":"Ouvrir les param\xE8tres","settings.shortcuts.fullscreen":"Basculer en plein \xE9cran","settings.shortcuts.reset":"R\xE9initialiser le synth","settings.shortcuts.showPanelHints":"Afficher les num\xE9ros de panneau (maintenir)","settings.shortcuts.signalFlow":"Surligner le flux de signal (maintenir)","settings.shortcuts.panel1":"Panneau 1","settings.shortcuts.panel2":"Panneau 2","settings.shortcuts.panel3":"Panneau 3","settings.shortcuts.panel4":"Panneau 4","settings.shortcuts.panel5":"Panneau 5","settings.shortcuts.panel6":"Panneau 6","settings.shortcuts.panelOutput":"Panneau de sortie","settings.shortcuts.overview":"Aper\xE7u (tous les panneaux)","settings.shortcuts.press":"Appuyez sur une touche...","settings.shortcuts.none":"Aucun","settings.shortcuts.conflict":"D\xE9j\xE0 assign\xE9 \xE0 : {action}","settings.shortcuts.reserved":"Cette cl\xE9 est r\xE9serv\xE9e","settings.shortcuts.resetDefaults":"R\xE9initialiser les raccourcis","settings.signalFlow":"Flux de signal","settings.signalFlow.description":"Met en \xE9vidence visuellement l'origine (cyan) et la destination (magenta) des connexions au survol des modules ou pins actifs. Sur desktop, maintenir la touche modificatrice.","settings.signalFlow.noModifier":"Activer sans touche modificatrice (recommand\xE9 sur tablettes)","settings.signalFlow.enabled":"Afficher le flux de signal au survol","toast.autosave":"\xC9tat sauvegard\xE9 automatiquement","toast.autosave.exit":"\xC9tat enregistr\xE9 avant la fermeture","toast.restored":"\xC9tat pr\xE9c\xE9dent restaur\xE9","audio.title":"Param\xE8tres audio","audio.close":"Fermer les param\xE8tres","audio.device.output":"Appareil de sortie :","audio.device.input":"Appareil d'entr\xE9e :","audio.device.default":"Appareil par d\xE9faut","audio.device.loading":"Chargement des appareils...","audio.device.error":"Erreur au chargement des appareils","audio.device.system":"Syst\xE8me","audio.mode.title":"Mode de sortie","audio.mode.stereo":"St\xE9r\xE9o","audio.mode.multichannel":"Multicanal (12 canaux)","audio.mode.multichannel.desc":"12 canaux ind\xE9pendants via PipeWire. Routez dans qpwgraph.","audio.mode.unavailable":"(N\xE9cessite Electron + PipeWire)","audio.outputs.title":"Sorties \u2192 Syst\xE8me","audio.outputs.channels":"Canaux d\xE9tect\xE9s :","audio.outputs.description":"Routez les sorties logiques du Synthi vers les sorties physiques du syst\xE8me.","audio.outputs.more":"+{count} autres lignes (scroll pour voir)","audio.outputs.reset":"R\xE9initialiser","audio.inputs.title":"Syst\xE8me \u2192 Amplificateurs d'entr\xE9e","audio.inputs.channels":"Canaux d'entr\xE9e :","audio.inputs.description":"Routez les entr\xE9es physiques du syst\xE8me vers les amplificateurs d'entr\xE9e du Synthi.","audio.inputs.enable":"Activer l'entr\xE9e audio","audio.inputs.permission":"N\xE9cessite la permission du microphone.","audio.inputs.enabled":"\u2713 Entr\xE9e activ\xE9e","audio.inputs.multichannel.title":"PipeWire \u2192 Amplificateurs d'entr\xE9e","audio.inputs.multichannel.description":"Routez 8 canaux d'entr\xE9e PipeWire vers les amplificateurs d'entr\xE9e.","audio.inputs.multichannel.labels":"input_amp_{n}","audio.inputs.reset":"R\xE9initialiser","audio.latency.title":"Latence","audio.latency.description":"Ajuste le tampon audio. Moins = r\xE9ponse plus rapide mais plus de risque de clics.","audio.latency.webAudio":"Tampon Web Audio :","audio.latency.multichannel":"Tampon Multicanal :","audio.latency.interactive":"~10ms (Interactif)","audio.latency.balanced":"~25ms (\xC9quilibr\xE9)","audio.latency.playback":"~50ms (Lecture)","audio.latency.safe":"~100ms (S\xFBr)","audio.latency.maximum":"~200ms (Maximum)","audio.latency.veryLow":"tr\xE8s basse","audio.latency.low":"basse","audio.latency.normal":"normale","audio.latency.high":"haute","audio.latency.veryHigh":"tr\xE8s haute","audio.latency.total":"Latence totale estim\xE9e :","audio.latency.restartRequired":"\u26A0\uFE0F Red\xE9marrez l'app pour appliquer","audio.latency.reconnectRequired":"\u26A0\uFE0F D\xE9sactivez et r\xE9activez le p\xE9riph\xE9rique","audio.permission.denied.title":"Acc\xE8s au microphone refus\xE9","audio.permission.denied.message":"Activez le microphone dans les param\xE8tres du navigateur ou du syst\xE8me pour utiliser les entr\xE9es audio.","audio.permission.retry":"R\xE9essayer","audio.channel.mono":"Mono","audio.channel.stereo":"St\xE9r\xE9o","audio.channel.quad":"Quadraphonique","audio.channel.surround":"5.1 Surround","quickbar.open":"Ouvrir les actions rapides","quickbar.close":"Fermer les actions rapides","quickbar.pan.lock":"Verrouiller le panoramique","quickbar.pan.unlock":"D\xE9verrouiller le panoramique","quickbar.zoom.lock":"Verrouiller le zoom","quickbar.zoom.unlock":"D\xE9verrouiller le zoom","quickbar.settings":"Param\xE8tres (S)","quickbar.patches":"Patches (P)","quickbar.pip":"Panneaux flottants","quickbar.audio":"Param\xE8tres audio (A)","quickbar.emergency":"R\xE9initialiser l'\xE9chelle \xE0 1\xD7 (urgence)","quickbar.emergency.applied":"\xC9chelle r\xE9initialis\xE9e \xE0 1\xD7","quickbar.mute":"Sourdine audio (M)","quickbar.unmute":"Activer l'audio (M)","toast.mute":"Audio en sourdine","toast.unmute":"Audio actif","toast.dspEnabled":"Moteur audio activ\xE9","toast.dspDisabled":"Moteur audio d\xE9sactiv\xE9","toast.dspRequired":"Le moteur audio est d\xE9sactiv\xE9. Activez-le dans les param\xE8tres audio.","quickbar.fullscreen":"Plein \xE9cran (F)","quickbar.fullscreen.exit":"Quitter le plein \xE9cran (Esc)","quickbar.reset":"R\xE9initialiser le synth (Shift+I)","synth.reset.confirm":"\xCAtes-vous s\xFBr de vouloir r\xE9initialiser le synth\xE9tiseur \xE0 ses valeurs initiales ?","common.dontAskAgain":"Ne plus demander","settings.synth.confirmReset":"Demander confirmation lors de la r\xE9initialisation du synth\xE9","quickbar.oscOn":"OSC activ\xE9 - Cliquez pour d\xE9sactiver","quickbar.oscOff":"OSC d\xE9sactiv\xE9 - Cliquez pour activer","quickbar.oscError":"\xC9chec de l'activation d'OSC","quickbar.undo":"Annuler (Ctrl+Z)","quickbar.redo":"R\xE9tablir (Ctrl+U)","toast.undo":"Modification annul\xE9e","toast.redo":"Modification r\xE9tablie","quickbar.record":"Enregistrer l'audio (R)","quickbar.stopRecording":"Arr\xEAter l'enregistrement (R)","quickbar.recordSettings":"Param\xE8tres d'enregistrement","recording.title":"Param\xE8tres d'enregistrement","recording.close":"Close recording settings","recording.tracks.label":"Nombre de pistes","recording.tracks.mono":"1 (Mono)","recording.tracks.stereo":"2 (St\xE9r\xE9o)","recording.tracks.tracks":"pistes","recording.track":"Piste","recording.routing.title":"Routage des pistes d'enregistrement","recording.routing.description":"S\xE9lectionnez les sorties enregistr\xE9es sur chaque piste","recording.format.label":"Format","recording.format.wav":"WAV (sans perte, multipiste)","recording.format.webmOpus":"WebM/Opus (compress\xE9, st\xE9r\xE9o)","recording.format.wavDesc":"Sans perte 16-bit PCM. Jusqu'\xE0 12 pistes avec routage personnalis\xE9. Fichiers volumineux.","recording.format.webmOpusDesc":"Audio compress\xE9 haute qualit\xE9. St\xE9r\xE9o uniquement. Fichiers plus petits, id\xE9al pour partager.","recording.bitrate.label":"Qualit\xE9 (d\xE9bit)","recording.bitrate.recommended":"recommand\xE9","recording.overlay.recording":"Enregistrement en cours","settings.recording":"Enregistrement audio","settings.recording.description":"Enregistrez la sortie audio en WAV (sans perte) ou WebM/Opus (compress\xE9)","settings.recording.configure":"Configurer l'enregistrement","toast.recordingStarted":"Enregistrement commenc\xE9","toast.recordingSaved":"Enregistrement enregistr\xE9 : {filename}","toast.recordingEmpty":"Aucun audio enregistr\xE9","toast.recordingError":"Erreur d'enregistrement","settings.reset":"Restaurer les param\xE8tres par d\xE9faut","settings.reset.description":"Supprime toutes les pr\xE9f\xE9rences enregistr\xE9es et restaure les valeurs par d\xE9faut. La page sera recharg\xE9e.","settings.reset.button":"Restaurer les valeurs par d\xE9faut","settings.reset.confirm":"\xCAtes-vous s\xFBr de vouloir restaurer tous les param\xE8tres \xE0 leurs valeurs par d\xE9faut ? La page sera recharg\xE9e.","settings.optimizations":"Optimisations de performance","settings.optimizations.description":"Ces options r\xE9duisent la charge du processeur en d\xE9sactivant le traitement audio quand il n'est pas n\xE9cessaire. Particuli\xE8rement utile sur les appareils mobiles.","settings.optimizations.debugGlobal":"Afficher les toasts de debug pour toutes les optimisations","settings.dsp":"Moteur audio (DSP)","settings.dsp.description":"Active ou d\xE9sactive le moteur audio. Lorsqu'il est d\xE9sactiv\xE9, l'application fonctionne comme un contr\xF4leur OSC sans traitement audio.","settings.dsp.enabled":"Moteur audio activ\xE9","settings.dsp.startEnabled":"Activer l'audio au d\xE9marrage","settings.dormancy":"Dormance des modules","settings.dormancy.description":"D\xE9sactive automatiquement les modules qui ne sont pas connect\xE9s dans la matrice.","settings.dormancy.enabled":"Activer le syst\xE8me de dormance","settings.dormancy.debug":"Debug uniquement la dormance","settings.filterBypass":"Contournement des filtres","settings.filterBypass.description":"Contourne les filtres LP/HP des canaux de sortie et le filtre colour du bruit en position neutre, r\xE9duisant la charge du processeur.","settings.filterBypass.enabled":"Activer le contournement des filtres","settings.filterBypass.debug":"Debug uniquement le contournement des filtres","settings.latencyMode":"Mode de latence","settings.latencyMode.description":'Ajuste la taille du tampon audio. Utilisez "Lecture" sur mobile pour la stabilit\xE9, "Interactif" sur bureau pour une faible latence.',"settings.latencyMode.interactive":"Interactif (~10ms)","settings.latencyMode.balanced":"\xC9quilibr\xE9 (~25ms)","settings.latencyMode.playback":"Lecture (~50ms)","settings.latencyMode.safe":"S\xFBr (100ms)","settings.latencyMode.maximum":"Maximum (200ms)","settings.latencyMode.restartRequired":"Mode de latence enregistr\xE9. Red\xE9marrez l'application pour appliquer les modifications.","settings.voltageEmulation":"\xC9mulation de tension","settings.voltageEmulation.description":"\xC9mule le comportement \xE9lectrique de la version Synthi 100 Cuenca/Datanomics (1982). Ces options affectent la pr\xE9cision analogique des signaux.","settings.voltageEmulation.softClip":"\xC9cr\xEAtage doux","settings.voltageEmulation.softClip.description":"Sature doucement avec tanh() les signaux qui d\xE9passent les limites d'entr\xE9e de chaque module (8V p-p typique).","settings.voltageEmulation.pinTolerance":"Tol\xE9rance des broches","settings.voltageEmulation.pinTolerance.description":"Applique une variation r\xE9aliste par type de broche : gris \xB10,5%, blanc \xB110%. Chaque connexion a sa propre tol\xE9rance reproductible.","settings.voltageEmulation.thermalDrift":"D\xE9rive thermique","settings.voltageEmulation.thermalDrift.description":"Simule la d\xE9rive lente (\xB10,1%) des oscillateurs CEM 3340 en raison des changements de temp\xE9rature.","menu.file":"Fichier","menu.file.patches":"Patches\u2026","menu.file.language":"Langue","menu.file.reload":"Recharger","menu.file.reload.confirm":"Recharger l'application ? Les modifications non enregistr\xE9es seront perdues.","menu.file.quit":"Quitter","menu.file.quit.confirm":"Quitter l'application ?","menu.preferences":"Pr\xE9f\xE9rences","menu.preferences.settings":"Tous les param\xE8tres\u2026","menu.view":"Affichage","menu.view.quickbar":"Afficher la barre rapide","menu.view.fullscreen":"Plein \xE9cran","menu.view.zoomIn":"Zoom avant","menu.view.zoomOut":"Zoom arri\xE8re","menu.view.zoomReset":"R\xE9initialiser le zoom","menu.view.inactivePins":"Afficher les broches inactives","menu.view.tooltipVoltage":"Param\xE8tres \xE9lectroniques dans les infobulles","menu.view.tooltipAudioRate":"Infos audio dans les infobulles","menu.view.linearFaders":"R\xE9ponse lin\xE9aire des faders","menu.view.sharpRasterize":"Rast\xE9risation adaptative (zoom net)","menu.view.devTools":"Outils de d\xE9veloppement","menu.audio":"Audio","menu.audio.mute":"Sourdine","menu.audio.unmute":"Activer l'audio","menu.audio.record":"Enregistrer","menu.audio.stopRecording":"Arr\xEAter l'enregistrement","menu.audio.audioSettings":"Param\xE8tres audio et enregistrement\u2026","menu.audio.preventSleep":"Emp\xEAcher la mise en veille","menu.audio.dsp":"DSP (moteur audio)","menu.panels":"Panneaux","menu.panels.detachHeader":"D\xE9tacher les panneaux","menu.panels.detachAll":"D\xE9tacher tout","menu.panels.attachAll":"Retourner tout","menu.panels.lockPan":"Verrouiller le panoramique","menu.panels.lockZoom":"Verrouiller le zoom","menu.panels.rememberVisualLayout":"M\xE9moriser la disposition visuelle","menu.panels.singleFingerPan":"Panoramique avec un doigt","menu.panels.multitouchControls":"Contr\xF4les multitouch","menu.advanced":"Avanc\xE9","menu.advanced.debugGlobal":"Toasts de debug (tous)","menu.advanced.dormancy":"Dormance des modules","menu.advanced.dormancyDebug":"Debug dormance","menu.advanced.filterBypass":"Contournement des filtres","menu.advanced.filterBypassDebug":"Debug contournement des filtres","menu.advanced.softClip":"\xC9cr\xEAtage doux","menu.advanced.pinTolerance":"Tol\xE9rance des broches","menu.advanced.thermalDrift":"D\xE9rive thermique","menu.advanced.resetSynth":"R\xE9initialiser le synth\xE9tiseur\u2026","menu.advanced.settings":"Tous les param\xE8tres\u2026","menu.osc":"OSC","menu.osc.enable":"Activer OSC","menu.osc.sendToSC":"Envoyer \xE0 SuperCollider","menu.osc.receiveFromSC":"Recevoir de SuperCollider","menu.osc.showLog":"Afficher le journal OSC","menu.osc.settings":"Param\xE8tres OSC\u2026","menu.help":"Aide","menu.help.about":"\xC0 propos de Synthi GME\u2026","menu.help.repository":"D\xE9p\xF4t GitHub","menu.help.reportBug":"Signaler un bug\u2026","menu.help.checkUpdates":"V\xE9rifier les mises \xE0 jour\u2026","toast.reset":"Synth\xE9tiseur r\xE9initialis\xE9 aux valeurs par d\xE9faut","toast.resolution":"\xC9chelle : {factor}\xD7","toast.resolution.mobileWarning":"\xC9chelle : {factor}\xD7 \u26A0\uFE0F Peut causer des probl\xE8mes de performance","toast.pan.locked":"Panoramique verrouill\xE9","toast.pan.unlocked":"Panoramique d\xE9verrouill\xE9","toast.zoom.locked":"Zoom verrouill\xE9","toast.zoom.unlocked":"Zoom d\xE9verrouill\xE9","pip.detach":"D\xE9tacher le panneau","pip.detachAll":"D\xE9tacher tout","pip.attach":"Retourner le panneau","pip.attachAll":"Retourner tout","pip.close":"Fermer","pip.zoomIn":"Zoomer","pip.zoomOut":"D\xE9zoomer","pip.maximize":"Maximiser","pip.minimize":"R\xE9duire","pip.lock":"Verrouiller","pip.unlock":"D\xE9verrouiller","pip.fitPanel":"Ajuster panneau","pip.placeholderHint":"Appui long ou clic droit pour options","panel.oscillators1":"Oscillateurs 1-3","panel.oscilloscope":"Oscilloscope","panel.oscillators2":"Oscillateurs 4-6","panel.oscillators3":"Oscillateurs 7-9","panel.audioMatrix":"Matrice Audio","panel.controlMatrix":"Matrice Contr\xF4le","panel.output":"Sortie","contextMenu.resetPanel":"R\xE9initialiser le panneau","contextMenu.resetModule":"R\xE9initialiser {name}","contextMenu.resetControl":"R\xE9initialiser {name}","notes.add":"Ajouter une note","notes.delete":"Supprimer la note","notes.placeholder":"\xC9crivez ici...","notes.color":"Changer la couleur","notes.color.yellow":"Jaune","notes.color.pink":"Rose","notes.color.blue":"Bleu","notes.color.green":"Vert","notes.color.orange":"Orange","notes.color.purple":"Violet","notes.fontUp":"Augmenter la taille du texte","notes.fontDown":"R\xE9duire la taille du texte","notes.ctx.cut":"Couper","notes.ctx.copy":"Copier","notes.ctx.paste":"Coller","notes.ctx.bold":"Gras","notes.ctx.italic":"Italique","notes.ctx.edit":"Modifier","notes.ctx.copyNote":"Copier la note","notes.ctx.cutNote":"Couper la note","notes.ctx.pasteNote":"Coller la note","notes.ctx.alignLeft":"Aligner \xE0 gauche","notes.ctx.alignCenter":"Centrer","notes.ctx.alignRight":"Aligner \xE0 droite","orientation.hint":"Tournez votre appareil en mode paysage pour une meilleure exp\xE9rience","orientation.blocker":"Veuillez tourner votre appareil en mode paysage","orientation.blocker.dismiss":"Fermer","update.available":"Une nouvelle version est disponible. Voulez-vous l'installer et recharger maintenant ?","update.installNow":"Installer maintenant","update.later":"Plus tard","error.fullscreen":"Impossible de basculer le plein \xE9cran.","patches.title":"Patches","patches.close":"Fermer les patches","patches.saveCurrent":"Enregistrer la version actuelle","patches.saveNew":"Enregistrer nouveau","patches.overwrite":"\xC9craser","patches.confirmOverwrite":'\xC9craser le patch "{name}" ?',"patches.overwritten":"Patch \xE9cras\xE9","patches.includeVisual":"Inclure la disposition visuelle","patches.hasVisual":"Inclut la disposition visuelle","patches.search":"Chercher...","patches.empty":"Aucun patch enregistr\xE9 pour l'instant","patches.load":"Charger","patches.export":"Exporter","patches.import":"Importer","patches.delete":"Supprimer","patches.rename":"Renommer","patches.confirmDelete":'Supprimer le patch "{name}" ?',"patches.confirmLoad":'Charger le patch "{name}" ? Les modifications non enregistr\xE9es seront perdues.',"patches.saved":"Patch enregistr\xE9","patches.loaded":"Patch charg\xE9","patches.loadedName":'"{name}" charg\xE9',"patches.deleted":"Patch supprim\xE9","patches.renamed":"Patch renomm\xE9","patches.exported":"Patch export\xE9","patches.imported":"Patch import\xE9","patches.errorLoading":"Erreur au chargement du patch","patches.errorSaving":"Erreur \xE0 l'enregistrement du patch","patches.errorRenaming":"Erreur au renommage du patch","patches.namePrompt":"Nom du patch","patches.renamePrompt":"Nouveau nom","patches.defaultName":"Nouveau patch","patches.init":"Init (par d\xE9faut)","patches.lastSession":"Restaurer la derni\xE8re session ?","patches.lastSession.yes":"Restaurer","patches.lastSession.no":"Commencer \xE0 nouveau","patches.lastSession.remember":"Retenir mon choix","patches.versionWarning":"Ce patch a \xE9t\xE9 cr\xE9\xE9 avec une version ant\xE9rieure","matrix.source.inputAmp":"Entr\xE9e {channel}","matrix.source.outputBus":"Bus de sortie {bus}","matrix.source.noiseGen":"Bruit {index}","matrix.source.panel3Osc.sineSaw":"Osc {osc} (sin+saw)","matrix.source.panel3Osc.triPulse":"Osc {osc} (tri+pul)","matrix.source.joystick":"Joystick {side} {axis}","matrix.dest.outputBus":"Out {bus}","matrix.dest.oscilloscope.Y":"Scope Y","matrix.dest.oscilloscope.X":"Scope X","matrix.dest.oscFreqCV":"Osc {osc} Freq CV","matrix.dest.oscSync":"Osc {osc} Sync","matrix.dest.oscPWM":"Osc {osc} PWM","matrix.dest.outputLevelCV":"Out {bus} Level CV","matrix.tooltip.format":"{source} \u2192 {dest}","matrix.tooltip.unknownSource":"Ligne {row}","matrix.tooltip.unknownDest":"Col {col}","pinColor.title":"Type de broche","pinColor.recommended":"Recommand\xE9","pinColor.standard":"Norme","pinColor.special":"Sp\xE9cial","pinColor.white":"Blanc (standard)","pinColor.grey":"Gris (pr\xE9cision)","pinColor.green":"Vert (att\xE9nu\xE9)","pinColor.red":"Rouge (oscilloscope)","pinColor.blue":"Bleu (amplification)","pinColor.yellow":"Jaune (gain moyen)","pinColor.cyan":"Cyan (doux)","pinColor.purple":"Violet (subtil)","telemetry.consent.title":"Rapports anonymes","telemetry.consent.message":"Aidez \xE0 am\xE9liorer SynthiGME en envoyant des rapports anonymes d'erreurs et de sessions. Aucune donn\xE9e personnelle n'est collect\xE9e. Vous pouvez modifier cela \xE0 tout moment dans les Param\xE8tres.","telemetry.consent.accept":"Activer","telemetry.consent.decline":"Non, merci","menu.advanced.telemetry":"Rapports anonymes","settings.telemetry":"Rapports anonymes","settings.telemetry.label":"Envoyer des rapports anonymes","settings.telemetry.description":"Envoie des rapports anonymes d'erreurs et de sessions pour aider \xE0 am\xE9liorer SynthiGME. Aucune donn\xE9e personnelle, contenu musical ou d\xE9tail d'utilisation n'est collect\xE9. Vous pouvez modifier cela \xE0 tout moment."}});var Vl={};Ot(Vl,{default:()=>ed});var ed,Gl=Xe(()=>{ed={"settings.language.en":"English","settings.language.es":"Espa\xF1ol","settings.language.fr":"Fran\xE7ais","settings.language.de":"Deutsch","settings.language.it":"Italiano","settings.language.pt":"Portugu\xEAs","settings.language.cs":"\u010Ce\u0161tina","splash.loading":"Caricamento","app.windowTitle":"Synthi GME (emulatore dell'EMS Synthi 100 di Cuenca, Spagna)","common.yes":"S\xEC","common.no":"No","common.cancel":"Annulla","common.ok":"OK","settings.title":"Impostazioni","settings.close":"Chiudi impostazioni","settings.tab.general":"Generale","settings.tab.audio":"Audio","settings.tab.advanced":"Avanzate","settings.tab.osc":"OSC","settings.tab.about":"Informazioni","settings.tab.select":"Seleziona sezione","settings.tab.interface":"Interfaccia","settings.display.inactivePins":"Pin inattivi","settings.display.inactivePins.description":"I pin della matrice che non collegano alcuna sorgente con alcuna destinazione sono considerati inattivi. Per impostazione predefinita, appaiono attenuati e non possono essere cliccati.","settings.display.inactivePins.show":"Mostra pin inattivi come attivi","settings.display.pip":"Disposizione visiva","settings.display.pip.description":"La disposizione visiva include la posizione e le dimensioni dei pannelli flottanti e la posizione di zoom e scorrimento del canvas principale. Quando attivata, questa disposizione viene ripristinata alla riapertura dell'applicazione.","settings.display.pip.remember":"Ricorda la disposizione visiva tra le sessioni","settings.display.paramInfo":"Informazioni sui parametri","settings.display.paramInfo.description":"Mostra informazioni tecniche estese nei suggerimenti dei controlli. Questi valori non sarebbero visibili nell'hardware Synthi originale.","settings.display.paramInfo.voltage":"Mostra valori elettrici (V, Vp-p, \u03A9)","settings.display.paramInfo.audio":"Mostra valori audio (frequenza, guadagno)","settings.display.faderResponse":"Risposta dei fader di uscita","settings.display.faderResponse.description":"Il Synthi originale ha una risposta logaritmica dove la maggior parte del cambiamento di volume avviene alla fine della corsa del fader. Abilita la risposta lineare per un controllo pi\xF9 facile a scapito dell'autenticit\xE0.","settings.display.faderResponse.linear":"Risposta lineare di guadagno (controllo pi\xF9 facile)","settings.display.knobStyle":"Aspetto delle manopole","settings.display.knobStyle.description":"Scegli tra il design autentico del Synthi 100 (SVG con centri colorati e anello di scala) o un design CSS semplificato.","settings.display.knobStyle.svg":"Synthi 100 autentico (manopole SVG con scala)","settings.display.knobStyle.css":"Semplificato (manopole CSS)","settings.display.glow":"Effetto luminoso dei controlli","settings.display.glow.description":"Alone pulsante attorno a manopole, cursori, pad e pin quando il loro valore cambia. Utile per esibizioni dal vivo in modo che il pubblico possa vedere cosa viene regolato. La luminosit\xE0 si attiva con l'interazione, il caricamento di patch, messaggi OSC e reset.","settings.display.glow.performance":"Performance: massima visibilit\xE0 per spettacoli dal vivo","settings.display.glow.standard":"Standard: effetto visibile e bilanciato","settings.display.glow.subtle":"Sottile: appena visibile, per uso personale","settings.display.glow.off":"Spento: nessun effetto luminoso","settings.display.sharpRasterize":"Nitidezza dello zoom","settings.display.sharpRasterize.description":"Durante lo zoom, il browser allunga le texture memorizzate che appaiono sfocate. La rasterizzazione adattiva ri-renderizza l'interfaccia a piena risoluzione dopo la fine dell'interazione, producendo un'immagine nitida. Potrebbe esserci una breve pausa durante il ri-rendering.","settings.display.sharpRasterize.enable":"Abilita rasterizzazione adattiva","settings.display.touchInteraction":"Interazione tattile","settings.display.touchInteraction.description":"Opzioni per i gesti tattili su dispositivi mobili e tablet. Regola il comportamento della panoramica e del controllo multi-dito in base alle tue esigenze performative.","settings.display.touchInteraction.singleFingerPan":"Sposta il canvas con un dito","settings.display.touchInteraction.singleFingerPan.description":"Trascina ovunque sullo sfondo del canvas con un dito per panoramicare. Disattivato, usa il pizzico a due dita per navigare.","settings.display.touchInteraction.multitouch":"Controlli multitouch","settings.display.touchInteraction.multitouch.description":"Sposta pi\xF9 manopole e cursori contemporaneamente con dita diverse. Disattivato, solo un controllo risponde al tocco alla volta, prevenendo cambiamenti accidentali durante i gesti di zoom/panoramica.","settings.osc.title":"Comunicazione OSC","settings.osc.description":"OSC (Open Sound Control) consente a pi\xF9 istanze di SynthiGME di sincronizzarsi in tempo reale sulla rete locale. Quando un controllo viene spostato su un'istanza, tutte le istanze connesse riflettono il cambiamento.","settings.osc.enable":"Abilita OSC","settings.osc.electronOnly":"OSC \xE8 disponibile solo nell'applicazione desktop (Electron).","settings.osc.mode":"Modalit\xE0 di comunicazione","settings.osc.mode.peer":"Peer-to-peer (invia e ricevi)","settings.osc.mode.master":"Master (solo invio)","settings.osc.mode.slave":"Slave (solo ricezione)","settings.osc.prefix":"Prefisso indirizzo","settings.osc.prefix.description":"Tutti i messaggi OSC utilizzano questo prefisso. Solo le istanze con lo stesso prefisso si sincronizzeranno.","settings.osc.supercollider":"SuperCollider","settings.osc.supercollider.send":"Invia a SuperCollider","settings.osc.supercollider.send.description":"Invia messaggi OSC a SuperCollider su localhost (127.0.0.1:57120).","settings.osc.supercollider.receive":"Ricevi da SuperCollider","settings.osc.supercollider.receive.description":"Riceve messaggi OSC da SuperCollider per controllare SynthiGME.","settings.osc.supercollider.port":"Porta SC","settings.osc.port":"Porta in ascolto","settings.osc.port.description":"Porta UDP dove SynthiGME riceve i messaggi OSC. Cambia se un altro programma (ad es. SuperCollider) utilizza la porta predefinita.","settings.osc.port.note":"(Richiede riavvio OSC)","settings.osc.targets":"Destinazioni Unicast","settings.osc.targets.description":"Aggiungi indirizzi IP specifici per le applicazioni che non supportano il multicast (come SuperCollider).","settings.osc.targets.add":"Aggiungi destinazione","settings.osc.targets.ip":"Indirizzo IP","settings.osc.targets.port":"Porta","settings.osc.targets.remove":"Rimuovi","settings.osc.log":"Registro messaggi","settings.osc.log.show":"Mostra finestra di registro mobile","settings.osc.status":"Stato","settings.osc.status.stopped":"Fermato","settings.osc.status.running":"In esecuzione","settings.osc.status.error":"Errore","osc.log.title":"Registro OSC","osc.log.filter.all":"Tutto","osc.log.filter.in":"Ingresso","osc.log.filter.out":"Uscita","osc.log.pause":"Pausa","osc.log.resume":"Riprendi","osc.log.clear":"Cancella","osc.log.close":"Chiudi","osc.log.noMessages":"Nessun messaggio ancora...","osc.log.messageCount":"{count} messaggi","settings.about.description":"Versione web del sintetizzatore modulare Synthi GME, ispirato all'EMS Synthi 100 del Gabinete de M\xFAsica Electroac\xFAstica (GME) a Cuenca. Nato come Progetto Finale del Master in Sound Art all'Universitat de Barcelona (2019/2020), questa versione web persegue lo stesso obiettivo pedagogico e sperimentale con distribuzione senza attriti.","settings.about.info":"Informazioni","settings.about.version":"Versione:","settings.about.author":"Autore:","settings.about.license":"Licenza:","settings.about.links":"Link","settings.about.repository":"Repository GitHub","settings.about.issues":"Segnala un bug / Contatti","settings.about.telegram":"Unisciti al nostro gruppo Telegram","settings.about.originalProject":"Progetto originale (SuperCollider)","settings.about.credits":"Crediti","settings.about.credits.development":"Sviluppo e design dell'interfaccia:","settings.about.credits.appIcons":"Icone app:","settings.about.credits.uiIcons":"Icone UI:","settings.about.credits.inspiration":"Ispirato da:","settings.language":"Lingua","settings.scale":"Scala di rendering","settings.scale.description":'Scala pi\xF9 alta = immagine pi\xF9 nitida, ma pi\xF9 utilizzo di risorse. Si ripristina a 1\xD7 al riavvio a meno che "Ricorda" non sia abilitato.',"settings.scale.current":"Scala attuale:","settings.scale.remember":"Ricorda al riavvio","settings.updates":"Aggiornamenti","settings.updates.version":"Versione attuale:","settings.updates.check":"Controlla aggiornamenti","settings.updates.checking":"Controllo in corso...","settings.updates.available":"Nuova versione disponibile!","settings.updates.pendingInstall":"Una nuova versione \xE8 pronta per l'installazione","settings.updates.install":"Installa aggiornamento","settings.updates.installAndReload":"Installa e ricarica","settings.updates.installing":"Installazione in corso...","settings.updates.upToDate":"Sei aggiornato \u2713","settings.updates.error":"Errore durante il controllo degli aggiornamenti","settings.autosave":"Salvataggio automatico","settings.autosave.description":"Salva automaticamente lo stato attuale periodicamente","settings.autosave.interval":"Intervallo di salvataggio","settings.autosave.interval.off":"Disabilitato","settings.autosave.interval.30s":"Ogni 30 secondi","settings.autosave.interval.1m":"Ogni 1 minuto","settings.autosave.interval.5m":"Ogni 5 minuti","settings.autosave.interval.10m":"Ogni 10 minuti","settings.autosave.onExit":"Salva all'uscita","settings.autosave.onExit.description":"Salva lo stato attuale quando si chiude l'app","settings.autosave.restoreOnStart":"Ripristina all'avvio","settings.autosave.restoreOnStart.description":"Chiedi di ripristinare l'ultimo stato salvato quando si apre l'app","settings.autosave.askBeforeRestore":"Chiedi prima di ripristinare","settings.autosave.askBeforeRestore.description":"Mostra una finestra di dialogo di conferma prima di ripristinare (pu\xF2 essere modificata dalla finestra di dialogo)","settings.wakelock":"Mantieni lo schermo attivo","settings.wakelock.description":"Impedisce lo spegnimento dello schermo mentre l'app \xE8 aperta","settings.wakelock.unsupported":"Non supportato in questo browser","settings.shortcuts":"Scorciatoie da tastiera","settings.shortcuts.description":"Fai clic su una scorciatoia per modificarla. Premi la nuova combinazione di tasti.","settings.shortcuts.knobModifiers":"Manopole: tieni premuto Ctrl/Cmd per movimento 10x pi\xF9 veloce, Maiusc per controllo 10x pi\xF9 fine.","settings.shortcuts.mute":"Silenzioso/Non silenzioso","settings.shortcuts.record":"Registra/Ferma","settings.shortcuts.patches":"Apri patch","settings.shortcuts.settings":"Apri impostazioni","settings.shortcuts.fullscreen":"Attiva/disattiva schermo intero","settings.shortcuts.reset":"Ripristina sintetizzatore","settings.shortcuts.showPanelHints":"Mostra numeri pannello (tieni premuto)","settings.shortcuts.signalFlow":"Evidenzia flusso segnale (tieni premuto)","settings.shortcuts.panel1":"Pannello 1","settings.shortcuts.panel2":"Pannello 2","settings.shortcuts.panel3":"Pannello 3","settings.shortcuts.panel4":"Pannello 4","settings.shortcuts.panel5":"Pannello 5","settings.shortcuts.panel6":"Pannello 6","settings.shortcuts.panelOutput":"Pannello di uscita","settings.shortcuts.overview":"Panoramica (tutti i pannelli)","settings.shortcuts.press":"Premi un tasto...","settings.shortcuts.none":"Nessuno","settings.shortcuts.conflict":"Gi\xE0 assegnato a: {action}","settings.shortcuts.reserved":"Questo tasto \xE8 riservato","settings.shortcuts.resetDefaults":"Ripristina scorciatoie","settings.signalFlow":"Flusso del segnale","settings.signalFlow.description":"Evidenzia visivamente l'origine (ciano) e la destinazione (magenta) delle connessioni al passaggio su moduli o pin attivi. Su desktop richiede di tenere premuto il tasto modificatore.","settings.signalFlow.noModifier":"Attiva senza tasto modificatore (consigliato su tablet)","settings.signalFlow.enabled":"Mostra flusso del segnale al passaggio","toast.autosave":"Stato salvato automaticamente","toast.autosave.exit":"Stato salvato prima dell'uscita","toast.restored":"Stato precedente ripristinato","audio.title":"Impostazioni audio","audio.close":"Chiudi impostazioni","audio.device.output":"Dispositivo di uscita:","audio.device.input":"Dispositivo di ingresso:","audio.device.default":"Dispositivo predefinito","audio.device.loading":"Caricamento dispositivi...","audio.device.error":"Errore durante il caricamento dei dispositivi","audio.device.system":"Sistema","audio.mode.title":"Modalit\xE0 di uscita","audio.mode.stereo":"Stereo","audio.mode.multichannel":"Multicanale (12ch)","audio.mode.multichannel.desc":"12 canali indipendenti tramite PipeWire. Instrada in qpwgraph.","audio.mode.unavailable":"(Richiede Electron + PipeWire)","audio.outputs.title":"Uscite \u2192 Sistema","audio.outputs.channels":"Canali rilevati:","audio.outputs.description":"Instrada le uscite logiche di Synthi alle uscite fisiche del sistema.","audio.outputs.more":"+{count} altre righe (scorri per vedere)","audio.outputs.reset":"Ripristina predefiniti","audio.inputs.title":"Sistema \u2192 Amplificatori di ingresso","audio.inputs.channels":"Canali di ingresso:","audio.inputs.description":"Instrada gli ingressi fisici del sistema agli amplificatori di ingresso di Synthi.","audio.inputs.enable":"Abilita ingresso audio","audio.inputs.permission":"Richiede l'autorizzazione del microfono.","audio.inputs.enabled":"\u2713 Ingresso abilitato","audio.inputs.multichannel.title":"PipeWire \u2192 Amplificatori di ingresso","audio.inputs.multichannel.description":"Instrada 8 canali di ingresso PipeWire agli amplificatori di ingresso.","audio.inputs.multichannel.labels":"input_amp_{n}","audio.inputs.reset":"Ripristina predefiniti","audio.latency.title":"Latenza","audio.latency.description":"Regola il buffer audio. Minore = risposta pi\xF9 veloce ma maggiore rischio di clic.","audio.latency.webAudio":"Buffer Web Audio:","audio.latency.multichannel":"Buffer Multicanale:","audio.latency.interactive":"~10ms (Interattivo)","audio.latency.balanced":"~25ms (Bilanciato)","audio.latency.playback":"~50ms (Riproduzione)","audio.latency.safe":"~100ms (Sicuro)","audio.latency.maximum":"~200ms (Massimo)","audio.latency.veryLow":"molto bassa","audio.latency.low":"bassa","audio.latency.normal":"normale","audio.latency.high":"alta","audio.latency.veryHigh":"molto alta","audio.latency.total":"Latenza totale stimata:","audio.latency.restartRequired":"\u26A0\uFE0F Riavvia l'app per applicare","audio.latency.reconnectRequired":"\u26A0\uFE0F Disattiva e riattiva il dispositivo","audio.permission.denied.title":"Accesso al microfono negato","audio.permission.denied.message":"Abilita il microfono nelle impostazioni del browser o del sistema per utilizzare gli ingressi audio.","audio.permission.retry":"Riprova","audio.channel.mono":"Mono","audio.channel.stereo":"Stereo","audio.channel.quad":"Quadrafonico","audio.channel.surround":"5.1 Surround","quickbar.open":"Apri azioni rapide","quickbar.close":"Chiudi azioni rapide","quickbar.pan.lock":"Blocca panoramica","quickbar.pan.unlock":"Sblocca panoramica","quickbar.zoom.lock":"Blocca zoom","quickbar.zoom.unlock":"Sblocca zoom","quickbar.settings":"Impostazioni (S)","quickbar.patches":"Patch (P)","quickbar.pip":"Pannelli mobili","quickbar.audio":"Impostazioni audio (A)","quickbar.emergency":"Ripristina scala a 1\xD7 (emergenza)","quickbar.emergency.applied":"Scala ripristinata a 1\xD7","quickbar.mute":"Silenzia audio (M)","quickbar.unmute":"Attiva audio (M)","toast.mute":"Audio silenziato","toast.unmute":"Audio attivo","toast.dspEnabled":"Motore audio abilitato","toast.dspDisabled":"Motore audio disabilitato","toast.dspRequired":"Il motore audio \xE8 disabilitato. Abilitalo nelle impostazioni audio.","quickbar.fullscreen":"Schermo intero (F)","quickbar.fullscreen.exit":"Esci da schermo intero (Esc)","quickbar.reset":"Ripristina synth (Maiusc+I)","synth.reset.confirm":"Sei sicuro di voler ripristinare il sintetizzatore ai valori iniziali?","common.dontAskAgain":"Non chiedere pi\xF9","settings.synth.confirmReset":"Chiedi conferma al ripristino del sintetizzatore","quickbar.oscOn":"OSC abilitato - Fai clic per disabilitare","quickbar.oscOff":"OSC disabilitato - Fai clic per abilitare","quickbar.oscError":"Impossibile abilitare OSC","quickbar.undo":"Annulla (Ctrl+Z)","quickbar.redo":"Ripristina (Ctrl+U)","toast.undo":"Modifica annullata","toast.redo":"Modifica ripristinata","quickbar.record":"Registra audio (R)","quickbar.stopRecording":"Ferma registrazione (R)","quickbar.recordSettings":"Impostazioni registrazione","recording.title":"Impostazioni di registrazione","recording.close":"Close recording settings","recording.tracks.label":"Numero di tracce","recording.tracks.mono":"1 (Mono)","recording.tracks.stereo":"2 (Stereo)","recording.tracks.tracks":"tracce","recording.track":"Traccia","recording.routing.title":"Instradamento tracce di registrazione","recording.routing.description":"Seleziona quali uscite vengono registrate su ogni traccia","recording.format.label":"Formato","recording.format.wav":"WAV (lossless, multitraccia)","recording.format.webmOpus":"WebM/Opus (compresso, stereo)","recording.format.wavDesc":"Lossless 16-bit PCM. Fino a 12 tracce con routing personalizzato. File di grandi dimensioni.","recording.format.webmOpusDesc":"Audio compresso di alta qualit\xE0. Solo stereo. File molto pi\xF9 piccoli, ideale per la condivisione.","recording.bitrate.label":"Qualit\xE0 (bitrate)","recording.bitrate.recommended":"consigliato","recording.overlay.recording":"Registrazione in corso","settings.recording":"Registrazione audio","settings.recording.description":"Registra uscita audio in WAV (lossless) o WebM/Opus (compresso)","settings.recording.configure":"Configura registrazione","toast.recordingStarted":"Registrazione iniziata","toast.recordingSaved":"Registrazione salvata: {filename}","toast.recordingEmpty":"Nessun audio registrato","toast.recordingError":"Errore di registrazione","settings.reset":"Ripristina impostazioni predefinite","settings.reset.description":"Rimuove tutte le preferenze salvate e ripristina i valori predefiniti. La pagina verr\xE0 ricaricata.","settings.reset.button":"Ripristina predefiniti","settings.reset.confirm":"Sei sicuro di voler ripristinare tutte le impostazioni ai valori predefiniti? La pagina verr\xE0 ricaricata.","settings.optimizations":"Ottimizzazioni delle prestazioni","settings.optimizations.description":"Queste opzioni riducono il carico della CPU disabilitando l'elaborazione audio quando non necessaria. Particolarmente utile su dispositivi mobili.","settings.optimizations.debugGlobal":"Mostra toast di debug per tutte le ottimizzazioni","settings.dsp":"Motore audio (DSP)","settings.dsp.description":"Abilita o disabilita il motore audio. Quando disabilitato, l'app funziona come controller OSC senza elaborazione audio.","settings.dsp.enabled":"Motore audio abilitato","settings.dsp.startEnabled":"Abilita audio all'avvio","settings.dormancy":"Dormienza del modulo","settings.dormancy.description":"Silenzia automaticamente i moduli che non sono collegati nella matrice.","settings.dormancy.enabled":"Abilita sistema di dormienza","settings.dormancy.debug":"Esegui solo il debug della dormienza","settings.filterBypass":"Bypass filtro","settings.filterBypass.description":"Bypassa i filtri LP/HP dei canali di uscita e il filtro colour del rumore in posizione neutra, riducendo il carico della CPU.","settings.filterBypass.enabled":"Abilita bypass filtro","settings.filterBypass.debug":"Esegui solo il debug del bypass filtro","settings.latencyMode":"Modalit\xE0 latenza","settings.latencyMode.description":'Regola la dimensione del buffer audio. Usa "Riproduzione" su dispositivi mobili per stabilit\xE0, "Interattivo" su desktop per bassa latenza.',"settings.latencyMode.interactive":"Interattivo (~10 ms)","settings.latencyMode.balanced":"Bilanciato (~25 ms)","settings.latencyMode.playback":"Riproduzione (~50 ms)","settings.latencyMode.safe":"Sicuro (100 ms)","settings.latencyMode.maximum":"Massimo (200 ms)","settings.latencyMode.restartRequired":"Modalit\xE0 latenza salvata. Riavvia l'app per applicare i cambiamenti.","settings.voltageEmulation":"Emulazione tensione","settings.voltageEmulation.description":"Emula il comportamento elettrico della versione Synthi 100 Cuenca/Datanomics (1982). Queste opzioni influenzano l'accuratezza analogica dei segnali.","settings.voltageEmulation.softClip":"Soft Clipping","settings.voltageEmulation.softClip.description":"Satura dolcemente con tanh() i segnali che superano i limiti di ingresso di ogni modulo (tipicamente 8V p-p).","settings.voltageEmulation.pinTolerance":"Tolleranza pin","settings.voltageEmulation.pinTolerance.description":"Applica variazione realistica per tipo di pin: grigio \xB10,5%, bianco \xB110%. Ogni connessione ha la propria tolleranza riproducibile.","settings.voltageEmulation.thermalDrift":"Deriva termica","settings.voltageEmulation.thermalDrift.description":"Simula la deriva lenta (\xB10,1%) degli oscillatori CEM 3340 a causa dei cambiamenti di temperatura.","menu.file":"File","menu.file.patches":"Patch\u2026","menu.file.language":"Lingua","menu.file.reload":"Ricarica","menu.file.reload.confirm":"Ricaricare l'applicazione? Le modifiche non salvate andranno perse.","menu.file.quit":"Esci","menu.file.quit.confirm":"Chiudere l'applicazione?","menu.preferences":"Preferenze","menu.preferences.settings":"Tutte le impostazioni\u2026","menu.view":"Visualizza","menu.view.quickbar":"Mostra barra rapida","menu.view.fullscreen":"Schermo intero","menu.view.zoomIn":"Ingrandisci","menu.view.zoomOut":"Rimpicciolisci","menu.view.zoomReset":"Reimposta zoom","menu.view.inactivePins":"Mostra pin inattivi","menu.view.tooltipVoltage":"Parametri elettronici nei tooltip","menu.view.tooltipAudioRate":"Info audio nei tooltip","menu.view.linearFaders":"Risposta lineare dei fader","menu.view.sharpRasterize":"Rasterizzazione adattiva (zoom nitido)","menu.view.devTools":"Strumenti sviluppatore","menu.audio":"Audio","menu.audio.mute":"Silenzia","menu.audio.unmute":"Attiva audio","menu.audio.record":"Registra","menu.audio.stopRecording":"Ferma registrazione","menu.audio.audioSettings":"Impostazioni audio e registrazione\u2026","menu.audio.preventSleep":"Impedisci sospensione del sistema","menu.audio.dsp":"DSP (motore audio)","menu.panels":"Pannelli","menu.panels.detachHeader":"Separa pannelli","menu.panels.detachAll":"Stacca tutto","menu.panels.attachAll":"Restituisci tutto","menu.panels.lockPan":"Blocca panoramica","menu.panels.lockZoom":"Blocca zoom","menu.panels.rememberVisualLayout":"Ricorda disposizione visiva","menu.panels.singleFingerPan":"Panoramica con un dito","menu.panels.multitouchControls":"Controlli multitouch","menu.advanced":"Avanzato","menu.advanced.debugGlobal":"Toast di debug (tutti)","menu.advanced.dormancy":"Dormienza dei moduli","menu.advanced.dormancyDebug":"Debug dormienza","menu.advanced.filterBypass":"Bypass filtro","menu.advanced.filterBypassDebug":"Debug bypass filtro","menu.advanced.softClip":"Soft Clipping","menu.advanced.pinTolerance":"Tolleranza pin","menu.advanced.thermalDrift":"Deriva termica","menu.advanced.resetSynth":"Ripristina sintetizzatore\u2026","menu.advanced.settings":"Tutte le impostazioni\u2026","menu.osc":"OSC","menu.osc.enable":"Abilita OSC","menu.osc.sendToSC":"Invia a SuperCollider","menu.osc.receiveFromSC":"Ricevi da SuperCollider","menu.osc.showLog":"Mostra registro OSC","menu.osc.settings":"Impostazioni OSC\u2026","menu.help":"Aiuto","menu.help.about":"Informazioni su Synthi GME\u2026","menu.help.repository":"Repository GitHub","menu.help.reportBug":"Segnala un bug\u2026","menu.help.checkUpdates":"Controlla aggiornamenti\u2026","toast.reset":"Sintetizzatore ripristinato ai predefiniti","toast.resolution":"Scala: {factor}\xD7","toast.resolution.mobileWarning":"Scala: {factor}\xD7 \u26A0\uFE0F Potrebbe causare problemi di prestazioni","toast.pan.locked":"Panoramica bloccata","toast.pan.unlocked":"Panoramica sbloccata","toast.zoom.locked":"Zoom bloccato","toast.zoom.unlocked":"Zoom sbloccato","pip.detach":"Stacca pannello","pip.detachAll":"Stacca tutto","pip.attach":"Restituisci pannello","pip.attachAll":"Restituisci tutto","pip.close":"Chiudi","pip.zoomIn":"Ingrandisci","pip.zoomOut":"Rimpicciolisci","pip.maximize":"Massimizza","pip.minimize":"Minimizza","pip.lock":"Blocca","pip.unlock":"Sblocca","pip.fitPanel":"Adatta pannello","pip.placeholderHint":"Pressione a lungo o clic destro per le opzioni","panel.oscillators1":"Oscillatori 1-3","panel.oscilloscope":"Oscilloscopio","panel.oscillators2":"Oscillatori 4-6","panel.oscillators3":"Oscillatori 7-9","panel.audioMatrix":"Matrice audio","panel.controlMatrix":"Matrice di controllo","panel.output":"Uscita","contextMenu.resetPanel":"Ripristina pannello","contextMenu.resetModule":"Ripristina {name}","contextMenu.resetControl":"Ripristina {name}","notes.add":"Aggiungi nota","notes.delete":"Elimina nota","notes.placeholder":"Scrivi qui...","notes.color":"Cambia colore","notes.color.yellow":"Giallo","notes.color.pink":"Rosa","notes.color.blue":"Blu","notes.color.green":"Verde","notes.color.orange":"Arancione","notes.color.purple":"Viola","notes.fontUp":"Aumenta dimensione testo","notes.fontDown":"Riduci dimensione testo","notes.ctx.cut":"Taglia","notes.ctx.copy":"Copia","notes.ctx.paste":"Incolla","notes.ctx.bold":"Grassetto","notes.ctx.italic":"Corsivo","notes.ctx.edit":"Modifica","notes.ctx.copyNote":"Copia nota","notes.ctx.cutNote":"Taglia nota","notes.ctx.pasteNote":"Incolla nota","notes.ctx.alignLeft":"Allinea a sinistra","notes.ctx.alignCenter":"Centra","notes.ctx.alignRight":"Allinea a destra","orientation.hint":"Ruota il dispositivo in orizzontale per un'esperienza migliore","orientation.blocker":"Ruota il dispositivo in modalit\xE0 orizzontale","orientation.blocker.dismiss":"Ignora","update.available":"Una nuova versione \xE8 disponibile. Vuoi installarla e ricaricare ora?","update.installNow":"Installa ora","update.later":"Pi\xF9 tardi","error.fullscreen":"Impossibile attivare/disattivare la modalit\xE0 schermo intero.","patches.title":"Patch","patches.close":"Chiudi patch","patches.saveCurrent":"Salva corrente","patches.saveNew":"Salva nuovo","patches.overwrite":"Sovrascrivi","patches.confirmOverwrite":'Sovrascrivere patch "{name}"?',"patches.overwritten":"Patch sovrascritto","patches.includeVisual":"Includi layout visivo","patches.hasVisual":"Include layout visivo","patches.search":"Cerca...","patches.empty":"Nessuna patch salvata ancora","patches.load":"Carica","patches.export":"Esporta","patches.import":"Importa","patches.delete":"Elimina","patches.rename":"Rinomina","patches.confirmDelete":'Elimina patch "{name}"?',"patches.confirmLoad":'Carica patch "{name}"? Le modifiche non salvate andranno perse.',"patches.saved":"Patch salvata","patches.loaded":"Patch caricata","patches.loadedName":'"{name}" caricata',"patches.deleted":"Patch eliminata","patches.renamed":"Patch rinominata","patches.exported":"Patch esportata","patches.imported":"Patch importata","patches.errorLoading":"Errore durante il caricamento della patch","patches.errorSaving":"Errore durante il salvataggio della patch","patches.errorRenaming":"Errore durante la ridenominazione della patch","patches.namePrompt":"Nome patch","patches.renamePrompt":"Nuovo nome","patches.defaultName":"Nuova patch","patches.init":"Init (predefinito)","patches.lastSession":"Ripristina l'ultima sessione?","patches.lastSession.yes":"Ripristina","patches.lastSession.no":"Ricomincia da capo","patches.lastSession.remember":"Ricorda la mia scelta","patches.versionWarning":"Questa patch \xE8 stata creata con una versione precedente","matrix.source.inputAmp":"Ingresso {channel}","matrix.source.outputBus":"Bus di uscita {bus}","matrix.source.noiseGen":"Rumore {index}","matrix.source.panel3Osc.sineSaw":"Osc {osc} (sin+saw)","matrix.source.panel3Osc.triPulse":"Osc {osc} (tri+pul)","matrix.source.joystick":"Joystick {side} {axis}","matrix.dest.outputBus":"Uscita {bus}","matrix.dest.oscilloscope.Y":"Scope Y","matrix.dest.oscilloscope.X":"Scope X","matrix.dest.oscFreqCV":"Osc {osc} Freq CV","matrix.dest.oscSync":"Osc {osc} Sync","matrix.dest.oscPWM":"Osc {osc} PWM","matrix.dest.outputLevelCV":"Uscita {bus} Level CV","matrix.tooltip.format":"{source} \u2192 {dest}","matrix.tooltip.unknownSource":"Riga {row}","matrix.tooltip.unknownDest":"Colonna {col}","pinColor.title":"Tipo di pin","pinColor.recommended":"Consigliato","pinColor.standard":"Standard","pinColor.special":"Speciale","pinColor.white":"Bianco (standard)","pinColor.grey":"Grigio (precisione)","pinColor.green":"Verde (attenuato)","pinColor.red":"Rosso (ambito)","pinColor.blue":"Blu (spinta)","pinColor.yellow":"Giallo (guadagno medio)","pinColor.cyan":"Ciano (morbido)","pinColor.purple":"Viola (sottile)","telemetry.consent.title":"Report anonimi","telemetry.consent.message":"Aiuta a migliorare SynthiGME inviando report anonimi di errori e sessioni. Non vengono raccolti dati personali. Puoi modificarlo in qualsiasi momento nelle Impostazioni.","telemetry.consent.accept":"Attiva","telemetry.consent.decline":"No, grazie","menu.advanced.telemetry":"Report anonimi","settings.telemetry":"Report anonimi","settings.telemetry.label":"Invia report anonimi","settings.telemetry.description":"Invia report anonimi di errori e sessioni per aiutare a migliorare SynthiGME. Non vengono raccolti dati personali, contenuti musicali o dettagli di utilizzo. Puoi modificarlo in qualsiasi momento."}});var ql={};Ot(ql,{default:()=>td});var td,$l=Xe(()=>{td={"settings.language.en":"English","settings.language.es":"Espa\xF1ol","settings.language.fr":"Fran\xE7ais","settings.language.de":"Deutsch","settings.language.it":"Italiano","settings.language.pt":"Portugu\xEAs","settings.language.cs":"\u010Ce\u0161tina","splash.loading":"Carregando","app.windowTitle":"Synthi GME (emulador do EMS Synthi 100 de Cuenca, Espanha)","common.yes":"Sim","common.no":"N\xE3o","common.cancel":"Cancelar","common.ok":"OK","settings.title":"Configura\xE7\xF5es","settings.close":"Fechar configura\xE7\xF5es","settings.tab.general":"Geral","settings.tab.audio":"\xC1udio","settings.tab.advanced":"Avan\xE7ado","settings.tab.osc":"OSC","settings.tab.about":"Sobre","settings.tab.select":"Selecionar se\xE7\xE3o","settings.tab.interface":"Interface","settings.display.inactivePins":"Pinos inativos","settings.display.inactivePins.description":"Os pinos da matriz que n\xE3o conectam nenhuma fonte com nenhum destino s\xE3o considerados inativos. Por padr\xE3o, aparecem atenuados e n\xE3o podem ser clicados.","settings.display.inactivePins.show":"Mostrar pinos inativos como ativos","settings.display.pip":"Disposi\xE7\xE3o visual","settings.display.pip.description":"A disposi\xE7\xE3o visual inclui a posi\xE7\xE3o e o tamanho dos pain\xE9is flutuantes e a posi\xE7\xE3o de zoom e rolagem do canvas principal. Quando ativada, esta disposi\xE7\xE3o \xE9 restaurada ao reabrir o aplicativo.","settings.display.pip.remember":"Lembrar disposi\xE7\xE3o visual entre sess\xF5es","settings.display.paramInfo":"Informa\xE7\xF5es de par\xE2metros","settings.display.paramInfo.description":"Mostrar informa\xE7\xF5es t\xE9cnicas estendidas em dicas de ferramentas de controle. Esses valores n\xE3o seriam vis\xEDveis no hardware Synthi original.","settings.display.paramInfo.voltage":"Mostrar valores el\xE9tricos (V, Vp-p, \u03A9)","settings.display.paramInfo.audio":"Mostrar valores de \xE1udio (frequ\xEAncia, ganho)","settings.display.faderResponse":"Resposta dos faders de sa\xEDda","settings.display.faderResponse.description":"O Synthi original tem uma resposta logar\xEDtmica onde a maior parte da mudan\xE7a de volume acontece no final do curso do fader. Ative a resposta linear para um controle mais f\xE1cil em detrimento da autenticidade.","settings.display.faderResponse.linear":"Resposta linear de ganho (controle mais f\xE1cil)","settings.display.knobStyle":"Apar\xEAncia dos bot\xF5es","settings.display.knobStyle.description":"Escolha entre o design aut\xEAntico do Synthi 100 (SVG com centros coloridos e anel de escala) ou um design CSS simplificado.","settings.display.knobStyle.svg":"Synthi 100 aut\xEAntico (bot\xF5es SVG com escala)","settings.display.knobStyle.css":"Simplificado (bot\xF5es CSS)","settings.display.glow":"Efeito de brilho nos controles","settings.display.glow.description":"Halo pulsante ao redor de knobs, sliders, pads e pinos quando seu valor muda. \xDAtil em performances ao vivo para que o p\xFAblico veja o que est\xE1 sendo ajustado. O brilho se ativa com intera\xE7\xE3o, carregamento de patches, mensagens OSC e resets.","settings.display.glow.performance":"Performance: m\xE1xima visibilidade para shows ao vivo","settings.display.glow.standard":"Padr\xE3o: efeito vis\xEDvel e equilibrado","settings.display.glow.subtle":"Sutil: quase invis\xEDvel, para uso pessoal","settings.display.glow.off":"Desligado: sem efeito de brilho","settings.display.sharpRasterize":"Nitidez do zoom","settings.display.sharpRasterize.description":"Ao fazer zoom, o navegador estica texturas em cache que ficam desfocadas. A rasteriza\xE7\xE3o adaptativa re-renderiza a interface em resolu\xE7\xE3o completa ap\xF3s o fim da intera\xE7\xE3o, produzindo uma imagem n\xEDtida. Pode haver uma breve pausa durante a re-renderiza\xE7\xE3o.","settings.display.sharpRasterize.enable":"Ativar rasteriza\xE7\xE3o adaptativa","settings.display.touchInteraction":"Intera\xE7\xE3o t\xE1til","settings.display.touchInteraction.description":"Op\xE7\xF5es para gestos t\xE1teis em dispositivos m\xF3veis e tablets. Ajuste o comportamento de panor\xE2mica e controle multi-dedo de acordo com suas necessidades de performance.","settings.display.touchInteraction.singleFingerPan":"Mover canvas com um dedo","settings.display.touchInteraction.singleFingerPan.description":"Arraste em qualquer lugar do fundo do canvas com um dedo para panor\xE2mica. Desativado, use o pin\xE7ar com dois dedos para navegar.","settings.display.touchInteraction.multitouch":"Controles multitoque","settings.display.touchInteraction.multitouch.description":"Mova v\xE1rios knobs e faders simultaneamente com dedos diferentes. Desativado, apenas um controle responde ao toque por vez, prevenindo mudan\xE7as acidentais durante gestos de zoom/panor\xE2mica.","settings.osc.title":"Comunica\xE7\xE3o OSC","settings.osc.description":"OSC (Open Sound Control) permite que v\xE1rias inst\xE2ncias do SynthiGME se sincronizem em tempo real atrav\xE9s da rede local. Quando um controle \xE9 movido em uma inst\xE2ncia, todas as inst\xE2ncias conectadas refletem a mudan\xE7a.","settings.osc.enable":"Ativar OSC","settings.osc.electronOnly":"OSC est\xE1 dispon\xEDvel apenas no aplicativo de desktop (Electron).","settings.osc.mode":"Modo de comunica\xE7\xE3o","settings.osc.mode.peer":"Peer-to-peer (enviar e receber)","settings.osc.mode.master":"Mestre (apenas envio)","settings.osc.mode.slave":"Escravo (apenas recep\xE7\xE3o)","settings.osc.prefix":"Prefixo de endere\xE7o","settings.osc.prefix.description":"Todas as mensagens OSC usam este prefixo. Apenas inst\xE2ncias com o mesmo prefixo ser\xE3o sincronizadas.","settings.osc.supercollider":"SuperCollider","settings.osc.supercollider.send":"Enviar para SuperCollider","settings.osc.supercollider.send.description":"Envia mensagens OSC para SuperCollider em localhost (127.0.0.1:57120).","settings.osc.supercollider.receive":"Receber de SuperCollider","settings.osc.supercollider.receive.description":"Recebe mensagens OSC do SuperCollider para controlar o SynthiGME.","settings.osc.supercollider.port":"Porta SC","settings.osc.port":"Porta de escuta","settings.osc.port.description":"Porta UDP onde SynthiGME recebe mensagens OSC. Altere se outro programa (por exemplo, SuperCollider) usar a porta padr\xE3o.","settings.osc.port.note":"(Requer reinicializa\xE7\xE3o de OSC)","settings.osc.targets":"Destinos Unicast","settings.osc.targets.description":"Adicione endere\xE7os IP espec\xEDficos para aplicativos que n\xE3o suportam multicast (como SuperCollider).","settings.osc.targets.add":"Adicionar destino","settings.osc.targets.ip":"Endere\xE7o IP","settings.osc.targets.port":"Porta","settings.osc.targets.remove":"Remover","settings.osc.log":"Log de mensagens","settings.osc.log.show":"Mostrar janela de log flutuante","settings.osc.status":"Status","settings.osc.status.stopped":"Parado","settings.osc.status.running":"Em execu\xE7\xE3o","settings.osc.status.error":"Erro","osc.log.title":"Log de OSC","osc.log.filter.all":"Tudo","osc.log.filter.in":"Entrada","osc.log.filter.out":"Sa\xEDda","osc.log.pause":"Pausa","osc.log.resume":"Retomar","osc.log.clear":"Limpar","osc.log.close":"Fechar","osc.log.noMessages":"Nenhuma mensagem ainda...","osc.log.messageCount":"{count} mensagens","settings.about.description":"Vers\xE3o web do sintetizador modular Synthi GME, inspirado no EMS Synthi 100 do Gabinete de M\xFAsica Electroac\xFAstica (GME) em Cuenca. Nascido como um Projeto Final de Mestrado em Sound Art na Universitat de Barcelona (2019/2020), esta vers\xE3o web persegue o mesmo objetivo pedag\xF3gico e experimental com distribui\xE7\xE3o sem fric\xE7\xE3o.","settings.about.info":"Informa\xE7\xF5es","settings.about.version":"Vers\xE3o:","settings.about.author":"Autor:","settings.about.license":"Licen\xE7a:","settings.about.links":"Links","settings.about.repository":"Reposit\xF3rio GitHub","settings.about.issues":"Relatar um bug / Contato","settings.about.telegram":"Participe do nosso grupo no Telegram","settings.about.originalProject":"Projeto original (SuperCollider)","settings.about.credits":"Cr\xE9ditos","settings.about.credits.development":"Desenvolvimento e design da interface:","settings.about.credits.appIcons":"\xCDcones do app:","settings.about.credits.uiIcons":"\xCDcones da UI:","settings.about.credits.inspiration":"Inspirado por:","settings.language":"Idioma","settings.scale":"Escala de renderiza\xE7\xE3o","settings.scale.description":'Escala mais alta = imagem mais n\xEDtida, mas mais uso de recursos. Redefine para 1\xD7 ao reiniciar, a menos que "Lembrar" esteja ativado.',"settings.scale.current":"Escala atual:","settings.scale.remember":"Lembrar ao reiniciar","settings.updates":"Atualiza\xE7\xF5es","settings.updates.version":"Vers\xE3o atual:","settings.updates.check":"Verificar atualiza\xE7\xF5es","settings.updates.checking":"Verificando...","settings.updates.available":"Nova vers\xE3o dispon\xEDvel!","settings.updates.pendingInstall":"Uma nova vers\xE3o est\xE1 pronta para ser instalada","settings.updates.install":"Instalar atualiza\xE7\xE3o","settings.updates.installAndReload":"Instalar e recarregar","settings.updates.installing":"Instalando...","settings.updates.upToDate":"Voc\xEA est\xE1 atualizado \u2713","settings.updates.error":"Erro ao verificar atualiza\xE7\xF5es","settings.autosave":"Salvamento autom\xE1tico","settings.autosave.description":"Salvar automaticamente o estado atual periodicamente","settings.autosave.interval":"Intervalo de salvamento","settings.autosave.interval.off":"Desabilitado","settings.autosave.interval.30s":"A cada 30 segundos","settings.autosave.interval.1m":"A cada 1 minuto","settings.autosave.interval.5m":"A cada 5 minutos","settings.autosave.interval.10m":"A cada 10 minutos","settings.autosave.onExit":"Salvar ao sair","settings.autosave.onExit.description":"Salvar o estado atual ao fechar o aplicativo","settings.autosave.restoreOnStart":"Restaurar ao iniciar","settings.autosave.restoreOnStart.description":"Solicitar para restaurar o \xFAltimo estado salvo ao abrir o aplicativo","settings.autosave.askBeforeRestore":"Perguntar antes de restaurar","settings.autosave.askBeforeRestore.description":"Mostrar uma caixa de di\xE1logo de confirma\xE7\xE3o antes de restaurar (pode ser alterada na caixa de di\xE1logo)","settings.wakelock":"Manter a tela acordada","settings.wakelock.description":"Evita que a tela se desligue enquanto o aplicativo est\xE1 aberto","settings.wakelock.unsupported":"N\xE3o suportado neste navegador","settings.shortcuts":"Atalhos de teclado","settings.shortcuts.description":"Clique em um atalho para alter\xE1-lo. Pressione a nova combina\xE7\xE3o de teclas.","settings.shortcuts.knobModifiers":"Bot\xF5es: mantenha Ctrl/Cmd pressionado para movimento 10x mais r\xE1pido, Shift para controle 10x mais fino.","settings.shortcuts.mute":"Mutar/Desmutar","settings.shortcuts.record":"Gravar/Parar","settings.shortcuts.patches":"Abrir patches","settings.shortcuts.settings":"Abrir configura\xE7\xF5es","settings.shortcuts.fullscreen":"Alternar tela cheia","settings.shortcuts.reset":"Redefinir sintetizador","settings.shortcuts.showPanelHints":"Mostrar n\xFAmeros de pain\xE9is (manter pressionado)","settings.shortcuts.signalFlow":"Destacar fluxo de sinal (manter pressionado)","settings.shortcuts.panel1":"Painel 1","settings.shortcuts.panel2":"Painel 2","settings.shortcuts.panel3":"Painel 3","settings.shortcuts.panel4":"Painel 4","settings.shortcuts.panel5":"Painel 5","settings.shortcuts.panel6":"Painel 6","settings.shortcuts.panelOutput":"Painel de sa\xEDda","settings.shortcuts.overview":"Vis\xE3o geral (todos os pain\xE9is)","settings.shortcuts.press":"Pressione uma tecla...","settings.shortcuts.none":"Nenhum","settings.shortcuts.conflict":"J\xE1 atribu\xEDdo a: {action}","settings.shortcuts.reserved":"Esta tecla est\xE1 reservada","settings.shortcuts.resetDefaults":"Redefinir atalhos","settings.signalFlow":"Fluxo de sinal","settings.signalFlow.description":"Destaca visualmente a origem (ciano) e o destino (magenta) das conex\xF5es ao passar sobre m\xF3dulos ou pinos ativos. No desktop requer manter a tecla modificadora pressionada.","settings.signalFlow.noModifier":"Ativar sem tecla modificadora (recomendado em tablets)","settings.signalFlow.enabled":"Mostrar fluxo de sinal ao passar o cursor","toast.autosave":"Estado salvo automaticamente","toast.autosave.exit":"Estado salvo antes de sair","toast.restored":"Estado anterior restaurado","audio.title":"Configura\xE7\xF5es de \xE1udio","audio.close":"Fechar configura\xE7\xF5es","audio.device.output":"Dispositivo de sa\xEDda:","audio.device.input":"Dispositivo de entrada:","audio.device.default":"Dispositivo padr\xE3o","audio.device.loading":"Carregando dispositivos...","audio.device.error":"Erro ao carregar dispositivos","audio.device.system":"Sistema","audio.mode.title":"Modo de sa\xEDda","audio.mode.stereo":"Est\xE9reo","audio.mode.multichannel":"Multicanal (12ch)","audio.mode.multichannel.desc":"12 canais independentes via PipeWire. Rotear no qpwgraph.","audio.mode.unavailable":"(Requer Electron + PipeWire)","audio.outputs.title":"Sa\xEDdas \u2192 Sistema","audio.outputs.channels":"Canais detectados:","audio.outputs.description":"Rotear as sa\xEDdas l\xF3gicas do Synthi para as sa\xEDdas f\xEDsicas do sistema.","audio.outputs.more":"+{count} mais linhas (rolar para ver)","audio.outputs.reset":"Restaurar padr\xF5es","audio.inputs.title":"Sistema \u2192 Amplificadores de entrada","audio.inputs.channels":"Canais de entrada:","audio.inputs.description":"Rotear as entradas f\xEDsicas do sistema para os amplificadores de entrada do Synthi.","audio.inputs.enable":"Ativar entrada de \xE1udio","audio.inputs.permission":"Requer permiss\xE3o de microfone.","audio.inputs.enabled":"\u2713 Entrada ativada","audio.inputs.multichannel.title":"PipeWire \u2192 Amplificadores de entrada","audio.inputs.multichannel.description":"Rotear 8 canais de entrada do PipeWire para os amplificadores de entrada.","audio.inputs.multichannel.labels":"input_amp_{n}","audio.inputs.reset":"Restaurar padr\xF5es","audio.latency.title":"Lat\xEAncia","audio.latency.description":"Ajustar buffer de \xE1udio. Menor = resposta mais r\xE1pida, mas maior risco de cliques.","audio.latency.webAudio":"Buffer Web Audio:","audio.latency.multichannel":"Buffer Multicanal:","audio.latency.interactive":"~10ms (Interativo)","audio.latency.balanced":"~25ms (Equilibrado)","audio.latency.playback":"~50ms (Reprodu\xE7\xE3o)","audio.latency.safe":"~100ms (Seguro)","audio.latency.maximum":"~200ms (M\xE1ximo)","audio.latency.veryLow":"muito baixa","audio.latency.low":"baixa","audio.latency.normal":"normal","audio.latency.high":"alta","audio.latency.veryHigh":"muito alta","audio.latency.total":"Lat\xEAncia total estimada:","audio.latency.restartRequired":"\u26A0\uFE0F Reinicie o app para aplicar","audio.latency.reconnectRequired":"\u26A0\uFE0F Desative e reative o dispositivo","audio.permission.denied.title":"Acesso ao microfone negado","audio.permission.denied.message":"Ative o microfone nas configura\xE7\xF5es do navegador ou do sistema para usar entradas de \xE1udio.","audio.permission.retry":"Tentar novamente","audio.channel.mono":"Mono","audio.channel.stereo":"Est\xE9reo","audio.channel.quad":"Quadraf\xF4nico","audio.channel.surround":"5.1 Surround","quickbar.open":"Abrir a\xE7\xF5es r\xE1pidas","quickbar.close":"Fechar a\xE7\xF5es r\xE1pidas","quickbar.pan.lock":"Bloquear panor\xE2mica","quickbar.pan.unlock":"Desbloquear panor\xE2mica","quickbar.zoom.lock":"Bloquear zoom","quickbar.zoom.unlock":"Desbloquear zoom","quickbar.settings":"Configura\xE7\xF5es (S)","quickbar.patches":"Patches (P)","quickbar.pip":"Pain\xE9is flutuantes","quickbar.audio":"Configura\xE7\xF5es de \xE1udio (A)","quickbar.emergency":"Redefinir escala para 1\xD7 (emerg\xEAncia)","quickbar.emergency.applied":"Escala redefinida para 1\xD7","quickbar.mute":"Mutar \xE1udio (M)","quickbar.unmute":"Desmutar \xE1udio (M)","toast.mute":"\xC1udio mudo","toast.unmute":"\xC1udio ativo","toast.dspEnabled":"Motor de \xE1udio ativado","toast.dspDisabled":"Motor de \xE1udio desativado","toast.dspRequired":"O motor de \xE1udio est\xE1 desativado. Ative-o nas configura\xE7\xF5es de \xE1udio.","quickbar.fullscreen":"Tela cheia (F)","quickbar.fullscreen.exit":"Sair de tela cheia (Esc)","quickbar.reset":"Redefinir sintetizador (Shift+I)","synth.reset.confirm":"Tem certeza de que deseja redefinir o sintetizador para seus valores iniciais?","common.dontAskAgain":"N\xE3o perguntar novamente","settings.synth.confirmReset":"Pedir confirma\xE7\xE3o ao redefinir o sintetizador","quickbar.oscOn":"OSC ativado - Clique para desativar","quickbar.oscOff":"OSC desativado - Clique para ativar","quickbar.oscError":"Falha ao ativar OSC","quickbar.undo":"Desfazer (Ctrl+Z)","quickbar.redo":"Refazer (Ctrl+U)","toast.undo":"Altera\xE7\xE3o desfeita","toast.redo":"Altera\xE7\xE3o refeita","quickbar.record":"Gravar \xE1udio (R)","quickbar.stopRecording":"Parar grava\xE7\xE3o (R)","quickbar.recordSettings":"Configura\xE7\xF5es de grava\xE7\xE3o","recording.title":"Configura\xE7\xF5es de grava\xE7\xE3o","recording.close":"Close recording settings","recording.tracks.label":"N\xFAmero de faixas","recording.tracks.mono":"1 (Mono)","recording.tracks.stereo":"2 (Est\xE9reo)","recording.tracks.tracks":"faixas","recording.track":"Faixa","recording.routing.title":"Roteamento de faixas de grava\xE7\xE3o","recording.routing.description":"Selecione quais sa\xEDdas s\xE3o gravadas em cada faixa","recording.format.label":"Formato","recording.format.wav":"WAV (sem perdas, multipista)","recording.format.webmOpus":"WebM/Opus (comprimido, est\xE9reo)","recording.format.wavDesc":"Sem perdas 16-bit PCM. Suporta at\xE9 12 faixas com roteamento personalizado. Arquivos grandes.","recording.format.webmOpusDesc":"\xC1udio comprimido de alta qualidade. Apenas est\xE9reo. Arquivos muito menores, ideal para compartilhar.","recording.bitrate.label":"Qualidade (bitrate)","recording.bitrate.recommended":"recomendado","recording.overlay.recording":"Grava\xE7\xE3o em andamento","settings.recording":"Grava\xE7\xE3o de \xE1udio","settings.recording.description":"Gravar sa\xEDda de \xE1udio em WAV (sem perdas) ou WebM/Opus (comprimido)","settings.recording.configure":"Configurar grava\xE7\xE3o","toast.recordingStarted":"Grava\xE7\xE3o iniciada","toast.recordingSaved":"Grava\xE7\xE3o salva: {filename}","toast.recordingEmpty":"Nenhum \xE1udio gravado","toast.recordingError":"Erro de grava\xE7\xE3o","settings.reset":"Restaurar configura\xE7\xF5es padr\xE3o","settings.reset.description":"Remove todas as prefer\xEAncias salvas e restaura os valores padr\xE3o. A p\xE1gina ser\xE1 recarregada.","settings.reset.button":"Restaurar padr\xF5es","settings.reset.confirm":"Tem certeza de que deseja restaurar todas as configura\xE7\xF5es para seus valores padr\xE3o? A p\xE1gina ser\xE1 recarregada.","settings.optimizations":"Otimiza\xE7\xF5es de desempenho","settings.optimizations.description":"Essas op\xE7\xF5es reduzem a carga da CPU desabilitando o processamento de \xE1udio quando n\xE3o necess\xE1rio. Especialmente \xFAtil em dispositivos m\xF3veis.","settings.optimizations.debugGlobal":"Mostrar toasts de depura\xE7\xE3o para todas as otimiza\xE7\xF5es","settings.dsp":"Motor de \xE1udio (DSP)","settings.dsp.description":"Ativa ou desativa o motor de \xE1udio. Quando desativado, o app funciona como controlador OSC sem processamento de \xE1udio.","settings.dsp.enabled":"Motor de \xE1udio ativado","settings.dsp.startEnabled":"Ativar \xE1udio ao iniciar","settings.dormancy":"Dorm\xEAncia do m\xF3dulo","settings.dormancy.description":"Silencia automaticamente m\xF3dulos que n\xE3o est\xE3o conectados na matriz.","settings.dormancy.enabled":"Ativar sistema de dorm\xEAncia","settings.dormancy.debug":"Apenas depurar dorm\xEAncia","settings.filterBypass":"Bypass de filtro","settings.filterBypass.description":"Contorna os filtros LP/HP dos canais de sa\xEDda e o filtro colour do ru\xEDdo em posi\xE7\xE3o neutra, reduzindo a carga da CPU.","settings.filterBypass.enabled":"Ativar bypass de filtro","settings.filterBypass.debug":"Apenas depurar bypass de filtro","settings.latencyMode":"Modo de lat\xEAncia","settings.latencyMode.description":'Ajusta o tamanho do buffer de \xE1udio. Use "Reprodu\xE7\xE3o" em dispositivos m\xF3veis para estabilidade, "Interativo" no desktop para baixa lat\xEAncia.',"settings.latencyMode.interactive":"Interativo (~10 ms)","settings.latencyMode.balanced":"Equilibrado (~25 ms)","settings.latencyMode.playback":"Reprodu\xE7\xE3o (~50 ms)","settings.latencyMode.safe":"Seguro (100 ms)","settings.latencyMode.maximum":"M\xE1ximo (200 ms)","settings.latencyMode.restartRequired":"Modo de lat\xEAncia salvo. Reinicie o aplicativo para aplicar as altera\xE7\xF5es.","settings.voltageEmulation":"Emula\xE7\xE3o de tens\xE3o","settings.voltageEmulation.description":"Emula o comportamento el\xE9trico da vers\xE3o Synthi 100 Cuenca/Datanomics (1982). Essas op\xE7\xF5es afetam a precis\xE3o anal\xF3gica dos sinais.","settings.voltageEmulation.softClip":"Clipping suave","settings.voltageEmulation.softClip.description":"Satura suavemente com tanh() sinais que excedem os limites de entrada de cada m\xF3dulo (tipicamente 8V p-p).","settings.voltageEmulation.pinTolerance":"Toler\xE2ncia de pino","settings.voltageEmulation.pinTolerance.description":"Aplica varia\xE7\xE3o realista por tipo de pino: cinza \xB10,5%, branco \xB110%. Cada conex\xE3o tem sua pr\xF3pria toler\xE2ncia reprodut\xEDvel.","settings.voltageEmulation.thermalDrift":"Deriva t\xE9rmica","settings.voltageEmulation.thermalDrift.description":"Simula a deriva lenta (\xB10,1%) dos osciladores CEM 3340 devido a mudan\xE7as de temperatura.","menu.file":"Arquivo","menu.file.patches":"Patches\u2026","menu.file.language":"Idioma","menu.file.reload":"Recarregar","menu.file.reload.confirm":"Recarregar o aplicativo? As altera\xE7\xF5es n\xE3o salvas ser\xE3o perdidas.","menu.file.quit":"Sair","menu.file.quit.confirm":"Sair do aplicativo?","menu.preferences":"Prefer\xEAncias","menu.preferences.settings":"Todas as configura\xE7\xF5es\u2026","menu.view":"Visualizar","menu.view.quickbar":"Mostrar barra r\xE1pida","menu.view.fullscreen":"Tela cheia","menu.view.zoomIn":"Ampliar","menu.view.zoomOut":"Reduzir","menu.view.zoomReset":"Redefinir zoom","menu.view.inactivePins":"Mostrar pinos inativos","menu.view.tooltipVoltage":"Par\xE2metros eletr\xF4nicos nos tooltips","menu.view.tooltipAudioRate":"Info de \xE1udio nos tooltips","menu.view.linearFaders":"Resposta linear dos faders","menu.view.sharpRasterize":"Rasteriza\xE7\xE3o adaptativa (zoom n\xEDtido)","menu.view.devTools":"Ferramentas de desenvolvedor","menu.audio":"\xC1udio","menu.audio.mute":"Mutar","menu.audio.unmute":"Desmutar","menu.audio.record":"Gravar","menu.audio.stopRecording":"Parar grava\xE7\xE3o","menu.audio.audioSettings":"Configura\xE7\xF5es de \xE1udio e grava\xE7\xE3o\u2026","menu.audio.preventSleep":"Impedir suspens\xE3o do sistema","menu.audio.dsp":"DSP (motor de \xE1udio)","menu.panels":"Pain\xE9is","menu.panels.detachHeader":"Separar pain\xE9is","menu.panels.detachAll":"Desanexar tudo","menu.panels.attachAll":"Retornar tudo","menu.panels.lockPan":"Bloquear panor\xE2mica","menu.panels.lockZoom":"Bloquear zoom","menu.panels.rememberVisualLayout":"Lembrar disposi\xE7\xE3o visual","menu.panels.singleFingerPan":"Panor\xE2mica com um dedo","menu.panels.multitouchControls":"Controles multitoque","menu.advanced":"Avan\xE7ado","menu.advanced.debugGlobal":"Toasts de depura\xE7\xE3o (todos)","menu.advanced.dormancy":"Dorm\xEAncia de m\xF3dulos","menu.advanced.dormancyDebug":"Depurar dorm\xEAncia","menu.advanced.filterBypass":"Bypass de filtro","menu.advanced.filterBypassDebug":"Depurar bypass de filtro","menu.advanced.softClip":"Clipping suave","menu.advanced.pinTolerance":"Toler\xE2ncia de pino","menu.advanced.thermalDrift":"Deriva t\xE9rmica","menu.advanced.resetSynth":"Redefinir sintetizador\u2026","menu.advanced.settings":"Todas as configura\xE7\xF5es\u2026","menu.osc":"OSC","menu.osc.enable":"Ativar OSC","menu.osc.sendToSC":"Enviar para SuperCollider","menu.osc.receiveFromSC":"Receber de SuperCollider","menu.osc.showLog":"Mostrar log OSC","menu.osc.settings":"Configura\xE7\xF5es OSC\u2026","menu.help":"Ajuda","menu.help.about":"Sobre Synthi GME\u2026","menu.help.repository":"Reposit\xF3rio GitHub","menu.help.reportBug":"Relatar um bug\u2026","menu.help.checkUpdates":"Verificar atualiza\xE7\xF5es\u2026","toast.reset":"Sintetizador redefinido para padr\xF5es","toast.resolution":"Escala: {factor}\xD7","toast.resolution.mobileWarning":"Escala: {factor}\xD7 \u26A0\uFE0F Pode causar problemas de desempenho","toast.pan.locked":"Panor\xE2mica bloqueada","toast.pan.unlocked":"Panor\xE2mica desbloqueada","toast.zoom.locked":"Zoom bloqueado","toast.zoom.unlocked":"Zoom desbloqueado","pip.detach":"Desanexar painel","pip.detachAll":"Desanexar tudo","pip.attach":"Retornar painel","pip.attachAll":"Retornar tudo","pip.close":"Fechar","pip.zoomIn":"Ampliar","pip.zoomOut":"Reduzir","pip.maximize":"Maximizar","pip.minimize":"Minimizar","pip.lock":"Bloquear","pip.unlock":"Desbloquear","pip.fitPanel":"Ajustar painel","pip.placeholderHint":"Pressione longo ou clique direito para op\xE7\xF5es","panel.oscillators1":"Osciladores 1-3","panel.oscilloscope":"Oscilosc\xF3pio","panel.oscillators2":"Osciladores 4-6","panel.oscillators3":"Osciladores 7-9","panel.audioMatrix":"Matriz de \xE1udio","panel.controlMatrix":"Matriz de controle","panel.output":"Sa\xEDda","contextMenu.resetPanel":"Redefinir painel","contextMenu.resetModule":"Redefinir {name}","contextMenu.resetControl":"Redefinir {name}","notes.add":"Adicionar nota","notes.delete":"Excluir nota","notes.placeholder":"Escreva aqui...","notes.color":"Mudar cor","notes.color.yellow":"Amarelo","notes.color.pink":"Rosa","notes.color.blue":"Azul","notes.color.green":"Verde","notes.color.orange":"Laranja","notes.color.purple":"Roxo","notes.fontUp":"Aumentar tamanho do texto","notes.fontDown":"Diminuir tamanho do texto","notes.ctx.cut":"Cortar","notes.ctx.copy":"Copiar","notes.ctx.paste":"Colar","notes.ctx.bold":"Negrito","notes.ctx.italic":"It\xE1lico","notes.ctx.edit":"Editar","notes.ctx.copyNote":"Copiar nota","notes.ctx.cutNote":"Cortar nota","notes.ctx.pasteNote":"Colar nota","notes.ctx.alignLeft":"Alinhar \xE0 esquerda","notes.ctx.alignCenter":"Centralizar","notes.ctx.alignRight":"Alinhar \xE0 direita","orientation.hint":"Gire seu dispositivo para paisagem para uma melhor experi\xEAncia","orientation.blocker":"Gire seu dispositivo para o modo paisagem","orientation.blocker.dismiss":"Descartar","update.available":"Uma nova vers\xE3o est\xE1 dispon\xEDvel. Voc\xEA gostaria de instalar e recarregar agora?","update.installNow":"Instalar agora","update.later":"Mais tarde","error.fullscreen":"N\xE3o foi poss\xEDvel alternar a tela cheia.","patches.title":"Patches","patches.close":"Fechar patches","patches.saveCurrent":"Salvar atual","patches.saveNew":"Salvar novo","patches.overwrite":"Sobrescrever","patches.confirmOverwrite":'Sobrescrever patch "{name}"?',"patches.overwritten":"Patch sobrescrito","patches.includeVisual":"Incluir layout visual","patches.hasVisual":"Inclui layout visual","patches.search":"Pesquisar...","patches.empty":"Nenhum patch salvo ainda","patches.load":"Carregar","patches.export":"Exportar","patches.import":"Importar","patches.delete":"Deletar","patches.rename":"Renomear","patches.confirmDelete":'Deletar patch "{name}"?',"patches.confirmLoad":'Carregar patch "{name}"? As altera\xE7\xF5es n\xE3o salvas ser\xE3o perdidas.',"patches.saved":"Patch salvo","patches.loaded":"Patch carregado","patches.loadedName":'"{name}" carregado',"patches.deleted":"Patch deletado","patches.renamed":"Patch renomeado","patches.exported":"Patch exportado","patches.imported":"Patch importado","patches.errorLoading":"Erro ao carregar patch","patches.errorSaving":"Erro ao salvar patch","patches.errorRenaming":"Erro ao renomear patch","patches.namePrompt":"Nome do patch","patches.renamePrompt":"Novo nome","patches.defaultName":"Novo patch","patches.init":"Init (padr\xE3o)","patches.lastSession":"Restaurar \xFAltima sess\xE3o?","patches.lastSession.yes":"Restaurar","patches.lastSession.no":"Come\xE7ar do zero","patches.lastSession.remember":"Lembrar minha escolha","patches.versionWarning":"Este patch foi criado com uma vers\xE3o anterior","matrix.source.inputAmp":"Entrada {channel}","matrix.source.outputBus":"Barramento de sa\xEDda {bus}","matrix.source.noiseGen":"Ru\xEDdo {index}","matrix.source.panel3Osc.sineSaw":"Osc {osc} (sin+saw)","matrix.source.panel3Osc.triPulse":"Osc {osc} (tri+pul)","matrix.source.joystick":"Joystick {side} {axis}","matrix.dest.outputBus":"Sa\xEDda {bus}","matrix.dest.oscilloscope.Y":"Scope Y","matrix.dest.oscilloscope.X":"Scope X","matrix.dest.oscFreqCV":"Osc {osc} Freq CV","matrix.dest.oscSync":"Osc {osc} Sync","matrix.dest.oscPWM":"Osc {osc} PWM","matrix.dest.outputLevelCV":"Sa\xEDda {bus} Level CV","matrix.tooltip.format":"{source} \u2192 {dest}","matrix.tooltip.unknownSource":"Linha {row}","matrix.tooltip.unknownDest":"Coluna {col}","pinColor.title":"Tipo de pino","pinColor.recommended":"Recomendado","pinColor.standard":"Padr\xE3o","pinColor.special":"Especial","pinColor.white":"Branco (padr\xE3o)","pinColor.grey":"Cinza (precis\xE3o)","pinColor.green":"Verde (atenuado)","pinColor.red":"Vermelho (escopo)","pinColor.blue":"Azul (refor\xE7o)","pinColor.yellow":"Amarelo (ganho m\xE9dio)","pinColor.cyan":"Ciano (suave)","pinColor.purple":"Roxo (sutil)","telemetry.consent.title":"Relat\xF3rios an\xF4nimos","telemetry.consent.message":"Ajude a melhorar o SynthiGME enviando relat\xF3rios an\xF4nimos de erros e sess\xF5es. Nenhum dado pessoal \xE9 coletado. Voc\xEA pode alterar isso a qualquer momento nas Configura\xE7\xF5es.","telemetry.consent.accept":"Ativar","telemetry.consent.decline":"N\xE3o, obrigado","menu.advanced.telemetry":"Relat\xF3rios an\xF4nimos","settings.telemetry":"Relat\xF3rios an\xF4nimos","settings.telemetry.label":"Enviar relat\xF3rios an\xF4nimos","settings.telemetry.description":"Envia relat\xF3rios an\xF4nimos de erros e sess\xF5es para ajudar a melhorar o SynthiGME. Nenhum dado pessoal, conte\xFAdo musical ou detalhe de uso \xE9 coletado. Voc\xEA pode alterar isso a qualquer momento."}});var nd,Va=Xe(()=>{nd=Yr({"./locales/_meta.js":()=>Promise.resolve().then(()=>(Fa(),Rl)),"./locales/cs.js":()=>Promise.resolve().then(()=>(Ml(),Tl)),"./locales/de.js":()=>Promise.resolve().then(()=>(Ol(),Pl)),"./locales/en.js":()=>Promise.resolve().then(()=>(Nl(),Il)),"./locales/es.js":()=>Promise.resolve().then(()=>(Bl(),Dl)),"./locales/fr.js":()=>Promise.resolve().then(()=>(Fl(),zl)),"./locales/it.js":()=>Promise.resolve().then(()=>(Gl(),Vl)),"./locales/pt.js":()=>Promise.resolve().then(()=>($l(),ql))})});var Ul={};Ot(Ul,{getLocale:()=>Xi,getSupportedLocales:()=>hi,initI18n:()=>Ga,loadLocale:()=>Qs,onLocaleChange:()=>Pe,setLocale:()=>qa,t:()=>u});function id(){let o=navigator.language?.split("-")[0]||"en";return di.includes(o)?o:"en"}async function Ga(){let o=localStorage.getItem(v.LANGUAGE),e=o&&di.includes(o)?o:id();return await Qs(e),e}async function Qs(o){if(di.includes(o)||(Js.warn(` Idioma no soportado: ${o}, usando ${"en"}`),o="en"),!Yi[o])try{let e=await nd(`./locales/${o}.js`);Yi[o]=e.default}catch(e){if(Js.error(` Error cargando locale ${o}:`,e),o!=="en")return Qs("en");Yi[o]={}}Ki=o,document.documentElement.lang=o}async function qa(o,e=!0){o!==Ki&&(await Qs(o),e&&localStorage.setItem(v.LANGUAGE,o),Zs.forEach(t=>{try{t(o)}catch(n){Js.error(" Error en listener:",n)}}))}function Xi(){return Ki}function hi(){return[...di]}function u(o,e={}){let n=(Yi[Ki]||{})[o];return n===void 0&&Ki!=="en"&&(n=Yi["en"]?.[o]),n===void 0?(Js.warn(` Clave no encontrada: ${o}`),o):(e&&typeof n=="string"&&(n=n.replace(/\{(\w+)\}/g,(i,s)=>e[s]??`{${s}}`)),n)}function Pe(o){return Zs.push(o),()=>{let e=Zs.indexOf(o);e>=0&&Zs.splice(e,1)}}var Js,Yi,Ki,Zs,Oe=Xe(()=>{Fa();be();Te();Va();Js=W("i18n"),Yi={},Ki="en",Zs=[]});function sc(){document.querySelectorAll(".panel").forEach(e=>{Yt.has(e.id)||Yt.set(e.id,new Set)}),Yt.has(Dt)||Yt.set(Dt,new Set),Cd(),Ld(),ln.info("PanelNotes inicializado")}function Cd(){let o=document.getElementById("viewportInner");o&&o.addEventListener("contextmenu",e=>{if(e.target!==o)return;e.preventDefault(),e.stopPropagation();let t=o.getBoundingClientRect(),n=o.offsetWidth>0?t.width/o.offsetWidth:1,i=(e.clientX-t.left)/n,s=(e.clientY-t.top)/n;Ed(e.clientX,e.clientY,i,s)})}function Ed(o,e,t,n){Ue();let i=document.createElement("div");i.className="panel-note__context-menu",i.setAttribute("data-prevent-pan","true"),i.appendChild(dt(u("notes.add"),()=>{Ue(),qn(Dt,{xPx:t,yPx:n})})),or()&&(i.appendChild(ss()),i.appendChild(dt(u("notes.ctx.pasteNote"),()=>{Ue(),qn(Dt,{xPx:t,yPx:n,wPx:Qe.wPx,hPx:Qe.hPx,html:Qe.html,color:Qe.color,fontSize:Qe.fontSize})}))),document.body.appendChild(i),bi=i,ir(i,o,e),sr(i)}function qn(o,e={}){let t=o===Dt,n=t?document.getElementById("viewportInner"):document.getElementById(o);if(!n)return ln.warn("Container no encontrado:",o),null;let i=e.id||`note-${Date.now()}-${++_d}`,s=Qa.find(f=>f.id===(e.color||ho))||Qa[0],a=e.fontSize??ns,r=document.createElement("div");if(r.className="panel-note",r.id=i,r.dataset.noteColor=s.id,r.dataset.panelId=o,r.dataset.fontSize=String(a),r.setAttribute("data-prevent-pan","true"),t)r.style.left=`${e.xPx??100}px`,r.style.top=`${e.yPx??100}px`,r.style.width=`${e.wPx??200}px`,r.style.height=`${e.hPx??100}px`;else{let f=os(e.xPct??50,0,95),b=os(e.yPct??50,0,95),E=e.wPct??er,w=e.hPct??tr;r.style.left=`${f}%`,r.style.top=`${b}%`,r.style.width=`${E}%`,r.style.height=`${w}%`}r.style.fontSize=`${a}px`,ac(r,s);let l=["contextmenu","pointerdown","pointerup","click","dblclick","mousedown","mouseup","touchstart","touchend"];for(let f of l)r.addEventListener(f,b=>{b.stopPropagation()});let c=document.createElement("div");c.className="panel-note__header";let d=document.createElement("div");d.className="panel-note__drag",d.innerHTML="\u22EE\u22EE",c.appendChild(d);let h=document.createElement("div");h.className="panel-note__actions";let p=document.createElement("button");p.className="panel-note__btn panel-note__btn--font-down",p.innerHTML="A<small>\u2212</small>",p.title=u("notes.fontDown"),ec(p,r,-Ql),h.appendChild(p);let m=document.createElement("button");m.className="panel-note__btn panel-note__btn--font-up",m.innerHTML="A<small>+</small>",m.title=u("notes.fontUp"),ec(m,r,Ql),h.appendChild(m);let g=document.createElement("button");g.className="panel-note__btn panel-note__btn--color",g.innerHTML="\u25CF",g.style.color=s.border,g.title=u("notes.color"),g.addEventListener("click",f=>{f.stopPropagation(),wd(r,g)}),h.appendChild(g);let _=document.createElement("button");_.className="panel-note__btn panel-note__btn--delete",_.innerHTML="\xD7",_.title=u("notes.delete"),_.addEventListener("click",f=>{f.stopPropagation(),nr(i)}),h.appendChild(_),c.appendChild(h),r.appendChild(c),c.addEventListener("contextmenu",f=>{f.preventDefault(),f.stopPropagation(),nc(r,f.clientX,f.clientY)});let y=document.createElement("div");if(y.className="panel-note__body",y.contentEditable="false",y.spellcheck=!1,e.html?y.innerHTML=Ad(e.html):e.text&&(y.textContent=e.text),!e.text&&!e.html&&(y.dataset.placeholder=u("notes.placeholder")),y.addEventListener("input",()=>{y.textContent.trim()?delete y.dataset.placeholder:y.dataset.placeholder=u("notes.placeholder"),Je()}),y.addEventListener("keydown",f=>{if(f.stopPropagation(),!!(f.ctrlKey||f.metaKey))switch(f.key.toLowerCase()){case"b":f.preventDefault(),document.execCommand("bold",!1,null),Je();break;case"i":f.preventDefault(),document.execCommand("italic",!1,null),Je();break}}),y.addEventListener("contextmenu",f=>{f.preventDefault(),f.stopPropagation(),y.contentEditable==="true"?kd(r,y,f.clientX,f.clientY):nc(r,f.clientX,f.clientY)}),y.addEventListener("focus",()=>{y._exitEditTimeout&&(clearTimeout(y._exitEditTimeout),y._exitEditTimeout=null)}),y.addEventListener("blur",()=>{y._exitEditTimeout=setTimeout(()=>{y._exitEditTimeout=null,y.contentEditable="false";let f=window.getSelection?.();f&&!f.isCollapsed&&f.removeAllRanges()},200)}),r.appendChild(y),xd(r,r),n.appendChild(r),typeof ResizeObserver<"u"){let f=null;new ResizeObserver(()=>{is||(clearTimeout(f),f=setTimeout(()=>Je(),400))}).observe(r)}return Yt.has(o)||Yt.set(o,new Set),Yt.get(o).add(r),is||(Je(),y.contentEditable="true",y.focus()),ln.debug("Nota creada:",i,"en",o),r}function nr(o){let e=document.getElementById(o);if(!e)return;let t=e.dataset.panelId,n=Yt.get(t);n&&n.delete(e),e.remove(),Je(),ln.debug("Nota eliminada:",o)}function Sd(){for(let[,o]of Yt){for(let e of o)e.remove();o.clear()}Je()}function ec(o,e,t){let n=null,i=null;function s(){a(),tc(e,t),n=setTimeout(()=>{i=setInterval(()=>{tc(e,t)},vd)},yd)}function a(){n&&(clearTimeout(n),n=null),i&&(clearInterval(i),i=null)}o.addEventListener("pointerdown",r=>{r.stopPropagation(),r.preventDefault(),o.setPointerCapture(r.pointerId),s()}),o.addEventListener("pointerup",r=>{r.stopPropagation(),a()}),o.addEventListener("pointercancel",r=>{a()}),o.addEventListener("pointerleave",r=>{a()}),o.addEventListener("click",r=>{r.stopPropagation()})}function tc(o,e){let t=parseInt(o.dataset.fontSize,10)||ns,n=os(t+e,fd,bd);o.dataset.fontSize=String(n),o.style.fontSize=`${n}px`,Je()}function kd(o,e,t,n){Ue();let i=document.createElement("div");i.className="panel-note__context-menu",i.setAttribute("data-prevent-pan","true");let s=window.getSelection(),a=s&&s.rangeCount>0&&!s.isCollapsed,r=s&&s.rangeCount>0?s.getRangeAt(0).cloneRange():null;function l(){if(e.contentEditable="true",e.focus(),r){let h=window.getSelection();h.removeAllRanges(),h.addRange(r)}}let c=dt(u("notes.ctx.cut"),()=>{l(),document.execCommand("cut"),Ue(),Je()});c.disabled=!a,i.appendChild(c);let d=dt(u("notes.ctx.copy"),()=>{l(),document.execCommand("copy"),Ue()});d.disabled=!a,i.appendChild(d),i.appendChild(dt(u("notes.ctx.paste"),()=>{l(),document.execCommand("paste"),Ue(),Je()})),i.appendChild(ss()),i.appendChild(dt(u("notes.ctx.bold"),()=>{l(),document.execCommand("bold",!1,null),Ue(),Je()})),i.appendChild(dt(u("notes.ctx.italic"),()=>{l(),document.execCommand("italic",!1,null),Ue(),Je()})),i.appendChild(ss()),i.appendChild(dt(u("notes.ctx.alignLeft"),()=>{l(),document.execCommand("justifyLeft",!1,null),Ue(),Je()})),i.appendChild(dt(u("notes.ctx.alignCenter"),()=>{l(),document.execCommand("justifyCenter",!1,null),Ue(),Je()})),i.appendChild(dt(u("notes.ctx.alignRight"),()=>{l(),document.execCommand("justifyRight",!1,null),Ue(),Je()})),document.body.appendChild(i),bi=i,ir(i,t,n),sr(i)}function nc(o,e,t){Ue();let n=document.createElement("div");n.className="panel-note__context-menu",n.setAttribute("data-prevent-pan","true"),n.appendChild(dt(u("notes.ctx.edit"),()=>{Ue();let i=o.querySelector(".panel-note__body");i&&(i._exitEditTimeout&&(clearTimeout(i._exitEditTimeout),i._exitEditTimeout=null),i.contentEditable="true",i.focus())})),n.appendChild(ss()),n.appendChild(dt(u("notes.ctx.copyNote"),()=>{ic(o,!1),Ue()})),n.appendChild(dt(u("notes.ctx.cutNote"),()=>{ic(o,!0),Ue()})),n.appendChild(ss()),n.appendChild(dt(u("notes.delete"),()=>{nr(o.id),Ue()})),document.body.appendChild(n),bi=n,ir(n,e,t),sr(n)}function Ue(){bi&&(bi.remove(),bi=null)}function ir(o,e,t){o.style.left=`${e}px`,o.style.top=`${t}px`,requestAnimationFrame(()=>{let n=o.getBoundingClientRect();n.right>window.innerWidth&&(o.style.left=`${e-n.width}px`),n.bottom>window.innerHeight&&(o.style.top=`${t-n.height}px`)})}function sr(o){let e=i=>{o.contains(i.target)||(Ue(),n())},t=i=>{i.key==="Escape"&&(Ue(),n())},n=()=>{document.removeEventListener("pointerdown",e,!0),document.removeEventListener("keydown",t)};setTimeout(()=>{document.addEventListener("pointerdown",e,!0),document.addEventListener("keydown",t)},50)}function dt(o,e){let t=document.createElement("button");return t.className="panel-note__ctx-item",t.textContent=o,t.addEventListener("click",n=>{n.stopPropagation(),e()}),t}function ss(){let o=document.createElement("div");return o.className="panel-note__ctx-separator",o}function ic(o,e=!1){let t=o.querySelector(".panel-note__body"),n=o.dataset.panelId===Dt,i={html:t?.innerHTML||"",text:t?.textContent||"",color:o.dataset.noteColor||ho,fontSize:parseInt(o.dataset.fontSize,10)||ns,srcIsViewport:n};if(n)i.wPx=o.offsetWidth>0?o.offsetWidth:parseFloat(o.style.width)||200,i.hPx=o.offsetHeight>0?o.offsetHeight:parseFloat(o.style.height)||100;else{let s=document.getElementById(o.dataset.panelId),a=s?.offsetWidth||0,r=s?.offsetHeight||0,l=a>0&&r>0&&o.offsetWidth>0;i.wPct=l?o.offsetWidth/a*100:parseFloat(o.style.width)||er,i.hPct=l?o.offsetHeight/r*100:parseFloat(o.style.height)||tr,i.wPx=o.offsetWidth>0?o.offsetWidth:200,i.hPx=o.offsetHeight>0?o.offsetHeight:100}Qe=i,e&&nr(o.id),ln.debug("Nota",e?"cortada":"copiada","al clipboard")}function oc(o,e,t){if(!Qe)return null;let n={xPct:e,yPct:t,html:Qe.html,color:Qe.color,fontSize:Qe.fontSize};if(Qe.wPct!=null)n.wPct=Qe.wPct,n.hPct=Qe.hPct;else{let i=document.getElementById(o),s=i?.offsetWidth||0,a=i?.offsetHeight||0;s>0&&a>0&&(n.wPct=Qe.wPx/s*100,n.hPct=Qe.hPx/a*100)}return qn(o,n)}function or(){return Qe!==null}function wd(o,e){let t=document.querySelector(".panel-note__color-picker");t&&t.remove();let n=document.createElement("div");n.className="panel-note__color-picker",n.setAttribute("data-prevent-pan","true"),Qa.forEach(a=>{let r=document.createElement("button");r.className="panel-note__color-swatch",a.id===o.dataset.noteColor&&r.classList.add("is-active"),r.style.background=a.bg,r.style.borderColor=a.border,r.title=u(`notes.color.${a.id}`),r.addEventListener("click",l=>{l.stopPropagation(),ac(o,a),o.dataset.noteColor=a.id;let c=o.querySelector(".panel-note__btn--color");c&&(c.style.color=a.border),n.remove(),Je()}),n.appendChild(r)}),document.body.appendChild(n);let i=e.getBoundingClientRect();n.style.left=`${i.left}px`,n.style.top=`${i.bottom+2}px`,requestAnimationFrame(()=>{let a=n.getBoundingClientRect();a.right>window.innerWidth&&(n.style.left=`${window.innerWidth-a.width-4}px`),a.bottom>window.innerHeight&&(n.style.top=`${i.top-a.height-2}px`)});let s=a=>{!n.contains(a.target)&&a.target!==e&&(n.remove(),document.removeEventListener("pointerdown",s,!0))};setTimeout(()=>{document.addEventListener("pointerdown",s,!0)},50)}function ac(o,e){o.style.setProperty("--note-bg",e.bg),o.style.setProperty("--note-border",e.border),o.style.setProperty("--note-text",e.text)}function xd(o,e){let i=!1,s=!1,a=null,r=0,l=0,c=0,d=0,h=!1,p=0,m=null,g=null;function _(b){let E=b.target.closest(".panel-note__header")&&!b.target.closest(".panel-note__btn"),w=o.querySelector(".panel-note__body"),S=b.target.closest(".panel-note__body")&&w?.contentEditable!=="true";!E&&!S||b.button===0&&(b.stopPropagation(),i=!0,s=!1,a=b.pointerId,g=b.target,e.setPointerCapture(b.pointerId),r=b.clientX,l=b.clientY,h=o.dataset.panelId===Dt,h?(c=parseFloat(o.style.left)||0,d=parseFloat(o.style.top)||0):(c=o.offsetLeft,d=o.offsetTop))}function y(b){if(b.pointerId!==a||!i&&!s)return;let E=b.clientX-r,w=b.clientY-l;if(i&&!s){if(Math.abs(E)<4&&Math.abs(w)<4)return;if(i=!1,s=!0,o.classList.add("panel-note--dragging"),!h){let S=o.closest(".panel");S&&S.classList.add("panel--note-dragging")}}if(b.preventDefault(),b.stopPropagation(),h){let S=document.getElementById("viewportInner"),T=S?.getBoundingClientRect(),A=S&&S.offsetWidth>0?T.width/S.offsetWidth:1;o.style.left=`${c+E/A}px`,o.style.top=`${d+w/A}px`}else{let S=o.closest(".panel")||o.parentElement,T=S.getBoundingClientRect(),A=T.width/S.offsetWidth,C=T.height/S.offsetHeight,x=c+E/A,R=d+w/C,M=x/S.offsetWidth*100,I=R/S.offsetHeight*100;o.style.left=`${os(M,-5,95)}%`,o.style.top=`${os(I,0,95)}%`}}function f(b){if(b.pointerId!==a)return;let E=s;i=!1,s=!1,a=null,o.classList.remove("panel-note--dragging");let w=o.closest(".panel");w&&w.classList.remove("panel--note-dragging");try{e.releasePointerCapture(b.pointerId)}catch{}if(E)Je();else{let S=o.querySelector(".panel-note__body");if(g?.closest(".panel-note__body")&&S){let A=Date.now();m===S&&A-p<400?(p=0,m=null,S._exitEditTimeout&&(clearTimeout(S._exitEditTimeout),S._exitEditTimeout=null),S.contentEditable="true",S.focus()):(p=A,m=S)}}}e.addEventListener("pointerdown",_),e.addEventListener("pointermove",y),e.addEventListener("pointerup",f),e.addEventListener("pointercancel",f),o.addEventListener("touchmove",b=>{s&&b.preventDefault()},{passive:!1})}function ar(){let o=[];for(let[e,t]of Yt){let n=e===Dt,i=n?null:document.getElementById(e),s=i?.offsetWidth||0,a=i?.offsetHeight||0;for(let r of t){let l=r.querySelector(".panel-note__body");if(n)o.push({id:r.id,panelId:Dt,xPx:parseFloat(r.style.left)||0,yPx:parseFloat(r.style.top)||0,wPx:r.offsetWidth>0?r.offsetWidth:parseFloat(r.style.width)||200,hPx:r.offsetHeight>0?r.offsetHeight:parseFloat(r.style.height)||100,text:l?.textContent||"",html:l?.innerHTML||"",color:r.dataset.noteColor||ho,fontSize:parseInt(r.dataset.fontSize,10)||ns});else{let c=s>0&&a>0&&r.offsetWidth>0;o.push({id:r.id,panelId:e,xPct:parseFloat(r.style.left)||0,yPct:parseFloat(r.style.top)||0,wPct:c?r.offsetWidth/s*100:parseFloat(r.style.width)||er,hPct:c?r.offsetHeight/a*100:parseFloat(r.style.height)||tr,text:l?.textContent||"",html:l?.innerHTML||"",color:r.dataset.noteColor||ho,fontSize:parseInt(r.dataset.fontSize,10)||ns})}}}return o}function rr(o){if(Array.isArray(o)){is=!0,Sd();for(let e of o)e.panelId===Dt?qn(Dt,{id:e.id,xPx:e.xPx,yPx:e.yPx,wPx:e.wPx,hPx:e.hPx,html:e.html,color:e.color,fontSize:e.fontSize}):qn(e.panelId,{id:e.id,xPct:e.xPct,yPct:e.yPct,wPct:e.wPct,hPct:e.hPct,text:e.text,html:e.html,color:e.color,fontSize:e.fontSize});is=!1,ln.info("Notas restauradas:",o.length)}}function Je(){if(!is)try{let o=ar();localStorage.setItem(v.PANEL_NOTES,JSON.stringify(o)),ln.debug("Notas guardadas:",o.length)}catch(o){ln.warn("Error guardando notas:",o)}}function Ld(){try{let o=localStorage.getItem(v.PANEL_NOTES);if(!o)return;let e=JSON.parse(o);Array.isArray(e)&&e.length>0&&rr(e)}catch(o){ln.warn("Error restaurando notas:",o)}}function os(o,e,t){return Math.min(t,Math.max(e,o))}function Ad(o){return o?o.replace(/<(?!\/?(?:b|i|strong|em|br|span|u|div|p)\b)[^>]*>/gi,""):""}var ln,Qa,ho,er,tr,ns,fd,bd,Ql,yd,vd,Dt,_d,Yt,is,Qe,bi,po=Xe(()=>{Te();be();Oe();ln=W("PanelNotes"),Qa=[{id:"yellow",bg:"#fef3b5",border:"#e6d570",text:"#5a4e00"},{id:"pink",bg:"#ffd6e0",border:"#e8a0b4",text:"#6b1a30"},{id:"blue",bg:"#d0e8ff",border:"#8cb8e6",text:"#1a3a5c"},{id:"green",bg:"#d4f5d4",border:"#8dce8d",text:"#1a4d1a"},{id:"orange",bg:"#ffe4c4",border:"#e6b87a",text:"#5a3600"},{id:"purple",bg:"#e8d5f5",border:"#b89cd4",text:"#3d1a5c"}],ho="yellow",er=20,tr=15,ns=11,fd=4,bd=72,Ql=1,yd=400,vd=80,Dt="__viewport__",_d=0,Yt=new Map,is=!1,Qe=null;bi=null});function Id(o){let e=o.closest(".sgme-osc, .noise-generator, .random-voltage, .output-channel-module, .panel7-joystick, .synth-module, .input-amplifiers-module");if(!e)return null;let t=e.id;if(!t)return null;let n=e.querySelector(".sgme-osc__header, .synth-module__header, .noise-generator__header, .random-voltage__header, .input-amplifiers__header"),i=e.dataset.moduleName||n?.textContent?.trim()||t;return{id:t,name:i,element:e}}function Nd(o,e){if(!e)return null;let t=e.element;if(t.classList.contains("panel7-joystick")){if(o.closest(".panel7-joystick-pad"))return{label:"Joystick",knobIndex:-1,controlType:"pad",moduleId:e.id};let p=o.closest(".knob-wrapper");if(p&&p.dataset.knob){let m=p.dataset.knob;return{label:m==="rangeY"?"Range Y":m==="rangeX"?"Range X":"Range",knobIndex:-1,controlType:"knob",controlKey:m,moduleId:e.id}}return null}if(t.classList.contains("output-channel-module")){if(o.closest(".output-channel__slider-wrap"))return{label:"Level",knobIndex:-1,controlType:"slider",moduleId:e.id};let p=o.closest(".output-channel__knob-wrap");if(p){let g=p.dataset.knob;return{label:g?g.charAt(0).toUpperCase()+g.slice(1):"Knob",knobIndex:-1,controlType:"knob",controlKey:g,moduleId:e.id}}return o.closest(".output-channel__switch-wrap")?{label:"Power",knobIndex:-1,controlType:"switch",moduleId:e.id}:null}let i=o.closest(".sgme-osc__knob-shell, .noise-generator__knob-shell, .random-voltage__knob-shell")||o.closest('[class*="__knob-shell"]');if(!i)return null;if(t.classList.contains("sgme-osc")){let h=t.querySelector(".sgme-osc__knobs");if(!h)return null;let m=Array.from(h.children).indexOf(i);if(m<0)return null;let g=t.querySelector(".sgme-osc__labels");return{label:(g?Array.from(g.children):[])[m]?.textContent?.trim()||`Knob ${m+1}`,knobIndex:m,moduleId:e.id}}let r=i.querySelector('[class*="__knob-label"]')?.textContent?.trim()||"",l=i.parentElement,d=(l?Array.from(l.children).filter(h=>h.classList.contains(`${t.className.split(" ")[0]}__knob-shell`)||h.className.includes("__knob-shell")):[]).indexOf(i);return{label:r||`Knob ${d+1}`,knobIndex:d,moduleId:e.id}}function yi({x:o,y:e,panelId:t,isPipped:n,target:i,onDetach:s,onAttach:a}){xt();let r=Id(i),l=Nd(i,r),c=document.createElement("div");c.className="pip-context-menu",c.style.left=`${o}px`,c.style.top=`${e}px`,n?c.appendChild($n(Md,u("pip.attach"),()=>{xt(),a?.(t)})):c.appendChild($n(Td,u("pip.detach"),()=>{xt(),s?.(t)})),c.appendChild(rc()),c.appendChild($n(Pd,u("notes.add"),()=>{xt();let y=document.getElementById(t);if(y){let f=y.getBoundingClientRect(),b=f.width/y.offsetWidth,E=f.height/y.offsetHeight,w=(o-f.left)/b,S=(e-f.top)/E,T=w/y.offsetWidth*100,A=S/y.offsetHeight*100;qn(t,{xPct:T,yPct:A})}})),or()&&c.appendChild($n(Od,u("notes.ctx.pasteNote"),()=>{xt();let y=document.getElementById(t);if(y){let f=y.getBoundingClientRect(),b=f.width/y.offsetWidth,E=f.height/y.offsetHeight,w=(o-f.left)/b,S=(e-f.top)/E,T=w/y.offsetWidth*100,A=S/y.offsetHeight*100;oc(t,T,A)}})),c.appendChild(rc()),c.appendChild($n(lr,u("contextMenu.resetPanel"),()=>{xt(),cr("panel",{panelId:t})})),r&&c.appendChild($n(lr,u("contextMenu.resetModule",{name:r.name}),()=>{xt(),cr("module",{panelId:t,moduleId:r.id,moduleName:r.name})})),l&&l.label&&c.appendChild($n(lr,u("contextMenu.resetControl",{name:l.label}),()=>{xt(),cr("control",{panelId:t,moduleId:l.moduleId,knobIndex:l.knobIndex,controlType:l.controlType,controlKey:l.controlKey,controlLabel:l.label})})),document.body.appendChild(c),Sn=c,requestAnimationFrame(()=>{let y=c.getBoundingClientRect();y.right>window.innerWidth&&(c.style.left=`${o-y.width}px`),y.bottom>window.innerHeight&&(c.style.top=`${e-y.height}px`)});let d=y=>{Sn&&Sn.contains(y.target)||xt()},h=y=>{Sn&&Sn.contains(y.target)||xt()},p=y=>{y.key==="Escape"&&(y.preventDefault(),xt())},m=y=>{if(y.target.closest?.(".panel")||y.target.closest?.(".pip-container")){g();return}xt()},g=()=>{document.removeEventListener("click",d),document.removeEventListener("contextmenu",m),document.removeEventListener("pointerdown",h,!0),document.removeEventListener("touchstart",h,!0),document.removeEventListener("keydown",p),mo=null};mo=g;let _="ontouchstart"in window?300:10;setTimeout(()=>{document.addEventListener("click",d),document.addEventListener("contextmenu",m),document.addEventListener("pointerdown",h,!0),document.addEventListener("touchstart",h,!0),document.addEventListener("keydown",p)},_)}function xt(){Sn&&(Sn.remove(),Sn=null),mo&&mo()}function $n(o,e,t){let n=document.createElement("button");return n.className="pip-context-menu__item",n.innerHTML=`${o}<span>${e}</span>`,n.addEventListener("click",t),n}function rc(){let o=document.createElement("div");return o.className="pip-context-menu__separator",o}function cr(o,e){Rd.info(`Reset ${o}:`,e),document.dispatchEvent(new CustomEvent("synth:resetContext",{detail:{level:o,...e}}))}var Rd,Sn,mo,Td,Md,lr,Pd,Od,lc=Xe(()=>{be();Oe();po();Rd=W("ContextMenu"),Sn=null,mo=null,Td=`<svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2">
  <rect x="3" y="3" width="18" height="18" rx="2"/>
  <path d="M9 3v18"/>
  <path d="M14 9l3 3-3 3"/>
</svg>`,Md=`<svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2">
  <rect x="3" y="3" width="18" height="18" rx="2"/>
  <path d="M9 3v18"/>
  <path d="M14 9l-3 3 3 3"/>
</svg>`,lr=`<svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2">
  <path d="M3 12a9 9 0 1 1 3 6.74"/>
  <polyline points="3 22 3 16 9 16"/>
</svg>`,Pd=`<svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2">
  <path d="M15.5 3H5a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2V8.5L15.5 3z"/>
  <polyline points="14 3 14 8 21 8"/>
  <line x1="8" y1="13" x2="16" y2="13"/>
  <line x1="8" y1="17" x2="12" y2="17"/>
</svg>`,Od=`<svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2">
  <path d="M16 4h2a2 2 0 012 2v14a2 2 0 01-2 2H6a2 2 0 01-2-2V6a2 2 0 012-2h2"/>
  <rect x="8" y="2" width="8" height="4" rx="1" ry="1"/>
  <line x1="9" y1="12" x2="15" y2="12"/>
  <line x1="9" y1="16" x2="13" y2="16"/>
</svg>`});var vc={};Ot(vc,{ALL_PANELS:()=>Yn,clearPipState:()=>yc,closeAllPips:()=>Ei,closePip:()=>jn,focusPip:()=>hr,getActivePips:()=>Wd,getOpenPips:()=>Kn,initPipManager:()=>ur,isPipped:()=>mr,isRememberPipsEnabled:()=>jd,openAllPips:()=>pr,openPip:()=>wn,restorePipState:()=>gr,savePipState:()=>zt,serializePipState:()=>So,setRememberPips:()=>Yd,togglePip:()=>dr});function Bd(){let o=window.__synthNavState?.getMinScale?.()||.4,e=760,t=Math.round(e*o),n=Math.min(window.innerWidth*.5,(window.innerHeight-je)*.5);return t=Math.max(Bt,Math.min(n,t)),{width:t+he,height:t+je+he,scale:t/e}}function as(){bo&&(bo.classList.remove("tooltip-visible"),bo=null),yo&&(clearTimeout(yo),yo=null)}function Fd(o){let e=0,t=0,n=!1;o.addEventListener("touchstart",i=>{let s=i.touches[0];e=s.clientX,t=s.clientY,n=!1,yo=setTimeout(()=>{as(),o.classList.add("tooltip-visible"),bo=o,n=!0,navigator.vibrate&&navigator.vibrate(15)},zd)},{passive:!0}),o.addEventListener("touchmove",i=>{let s=i.touches[0];(Math.abs(s.clientX-e)>10||Math.abs(s.clientY-t)>10)&&as()},{passive:!0}),o.addEventListener("touchend",i=>{n?(i.preventDefault(),setTimeout(as,1500)):as()}),o.addEventListener("touchcancel",()=>as(),{passive:!0})}function Vd(o){if(!(window.matchMedia&&window.matchMedia("(pointer: coarse)").matches))return;o.querySelectorAll(".pip-controls button[data-tooltip]").forEach(n=>Fd(n))}function Wn(o){let e=ee.get(o);if(!e)return us;let t=document.getElementById(o),n=t?.offsetWidth||760,i=t?.offsetHeight||760,s=e.pipContainer.querySelector(".pip-viewport"),a=s?.clientWidth||e.width-he,r=s?.clientHeight||e.height-je-he,l=a/n,c=r/i,d=Math.min(l,c);return Math.max(us,d)}function ur(){if(_i)return;_i=document.createElement("div"),_i.id="pipLayer",_i.className="pip-layer",document.body.appendChild(_i),document.addEventListener("pointermove",Hd),document.addEventListener("pointerup",hc),document.addEventListener("pointercancel",hc);let o=n=>{ls&&n.detail?.source!=="pipAutoLock"&&(ls=!1)};document.addEventListener("synth:panLockChange",o),document.addEventListener("synth:zoomLockChange",o);let e=0,t=document.getElementById("viewportOuter");t&&t.addEventListener("pointerdown",()=>{He=null,window.__synthFocusedPip=null}),window.__synthZoomFocusedPip=n=>{if(!He||!ee.has(He))return!1;let i=ee.get(He);if(!i)return!1;if(i.locked)return!0;let s=Wn(He);return n==="in"?ct(He,Math.min(i.scale*1.25,Hn)):n==="out"?ct(He,Math.max(i.scale*.8,s)):n==="reset"&&ct(He,s),!0},window.__synthPanFocusedPip=(n,i)=>{if(!He||!ee.has(He))return!1;let s=ee.get(He);if(!s||s.locked)return!0;let a=s.pipContainer.querySelector(".pip-viewport");if(!a)return!1;let r=a.clientWidth*.15,l=a.clientHeight*.15;return a.scrollLeft+=n*r,a.scrollTop+=i*l,!0},document.addEventListener("keydown",n=>{if(n.key==="Escape"&&ee.size>0){let i=Date.now();i-e<400&&Ei(),e=i}if(He&&!n.ctrlKey&&!n.metaKey&&!n.altKey){let i=ee.get(He);if(!i||i.locked)return;n.key==="+"||n.key==="="?(n.preventDefault(),gc(He)):n.key==="-"||n.key==="_"?(n.preventDefault(),fc(He)):n.key==="0"&&(n.preventDefault(),bc(He))}}),qd(),lt.info("PipManager inicializado")}function qd(){let o=document.querySelectorAll(".panel");lt.info(`Configurando men\xFA contextual en ${o.length} paneles`),o.forEach(e=>{e.addEventListener("contextmenu",t=>{if(t.preventDefault(),Ci){Ci=!1;return}ee.has(e.id)||yi({x:t.clientX,y:t.clientY,panelId:e.id,isPipped:!1,target:t.target,onDetach:wn})}),e.addEventListener("touchstart",t=>{if(ee.has(e.id))return;St.has(e.id)&&clearTimeout(St.get(e.id)),vi.delete(e.id);let n=t.touches[0],i=n.clientX,s=n.clientY,a=setTimeout(()=>{St.delete(e.id),vi.set(e.id,!0),Ci=!0,navigator.vibrate&&navigator.vibrate(50),yi({x:i,y:s,panelId:e.id,isPipped:!1,target:t.target,onDetach:wn})},mc);St.set(e.id,a)},{passive:!0}),e.addEventListener("touchmove",t=>{St.has(e.id)&&(clearTimeout(St.get(e.id)),St.delete(e.id)),vi.delete(e.id)},{passive:!0}),e.addEventListener("touchend",t=>{St.has(e.id)&&(clearTimeout(St.get(e.id)),St.delete(e.id)),vi.has(e.id)&&(t.preventDefault(),vi.delete(e.id))},{passive:!1}),e.addEventListener("touchcancel",()=>{St.has(e.id)&&(clearTimeout(St.get(e.id)),St.delete(e.id)),vi.delete(e.id)},{passive:!0})})}function $d(o,e,t){let n=Gd[o]||{col:0,row:0},i=4,s=2,a=60,r=80,l=40,c=20,d=window.innerWidth-c-r,h=window.innerHeight-a-l,p=d/i,m=h/s,g=c+n.col*p+(p-e)/2,_=a+n.row*m+(m-t)/2;return{x:Math.max(c,Math.min(g,window.innerWidth-e-r)),y:Math.max(a,Math.min(_,window.innerHeight-t-l))}}function dr(o){ee.has(o)?jn(o):wn(o)}function Kn(){return Array.from(ee.keys())}function hr(o){return ee.has(o)?(Co(o),!0):!1}function wn(o,e=null){let t=document.getElementById(o);if(!t||ee.has(o))return;let n=t.parentElement,s=Array.from(n.children).indexOf(t),a=document.createElement("div");a.className="pip-placeholder",a.id=`pip-placeholder-${o}`;let r=t.style.getPropertyValue("--panel-col"),l=t.style.getPropertyValue("--panel-row");r&&a.style.setProperty("--panel-col",r),l&&a.style.setProperty("--panel-row",l),a.innerHTML=`
    <div class="pip-placeholder__content">
      <span class="pip-placeholder__title">${pc(o)}</span>
      <span class="pip-placeholder__hint">${u("pip.placeholderHint","Mantener pulsado para opciones")}</span>
    </div>
  `,t.parentElement.insertBefore(a,t),a.addEventListener("contextmenu",A=>{if(A.preventDefault(),A.stopPropagation(),Ci){Ci=!1;return}yi({x:A.clientX,y:A.clientY,panelId:o,isPipped:!0,target:A.target,onAttach:jn})});let c=null,d=!1;a.addEventListener("touchstart",A=>{c&&clearTimeout(c),d=!1;let C=A.touches[0],x=C.clientX,R=C.clientY;c=setTimeout(()=>{c=null,d=!0,Ci=!0,navigator.vibrate&&navigator.vibrate(50),yi({x,y:R,panelId:o,isPipped:!0,target:A.target,onAttach:jn})},mc)},{passive:!0}),a.addEventListener("touchmove",()=>{c&&(clearTimeout(c),c=null),d=!1},{passive:!0}),a.addEventListener("touchend",A=>{c&&(clearTimeout(c),c=null),d&&(A.preventDefault(),d=!1)},{passive:!1}),a.addEventListener("touchcancel",()=>{c&&(clearTimeout(c),c=null),d=!1},{passive:!0});let h=document.createElement("div");h.className="pip-container",h.dataset.panelId=o;let p,m,g,_,y;if(e){let A=window.innerWidth-e.width,C=window.innerHeight-40,x=window.innerWidth-Math.max(0,e.x),R=window.innerHeight-Math.max(0,e.y);p=Math.max(0,Math.min(A,e.x)),m=Math.max(0,Math.min(C,e.y)),g=Math.max(Bt,Math.min(x,e.width)),_=Math.max(Bt,Math.min(R,e.height)),y=e.scale,h.style.zIndex=e.zIndex||cs+ee.size}else{let A=Bd(),C=$d(o,A.width,A.height);p=C.x,m=C.y,g=A.width,_=A.height,y=A.scale,h.style.zIndex=cs+ee.size}h.style.left=`${p}px`,h.style.top=`${m}px`,h.style.width=`${g}px`,h.style.height=`${_}px`;let f=document.createElement("div");f.className="pip-header",f.innerHTML=`
    <span class="pip-title">${pc(o)}</span>
    <div class="pip-controls">
      <button type="button" class="pip-minimize" aria-label="${u("pip.minimize","Minimizar")}" data-tooltip="${u("pip.minimize","Minimizar")}">\u2212</button>
      <button type="button" class="pip-maximize" aria-label="${u("pip.maximize","Maximizar")}" data-tooltip="${u("pip.maximize","Maximizar")}">+</button>
      <button type="button" class="pip-fit" aria-label="${u("pip.fitPanel","Ajustar panel")}" data-tooltip="${u("pip.fitPanel","Ajustar panel")}">
        <svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2.5">
          <rect x="3" y="3" width="18" height="18" rx="2"/>
          <path d="M9 3v18M3 9h18"/>
        </svg>
      </button>
      <button type="button" class="pip-lock" aria-label="${u("pip.lock","Bloquear")}" data-tooltip="${u("pip.lock","Bloquear")}">
        <svg class="pip-lock__icon-unlocked" viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2.5">
          <rect x="3" y="11" width="18" height="11" rx="2"/>
          <path d="M7 11V7a5 5 0 0 1 10 0"/>
        </svg>
        <svg class="pip-lock__icon-locked" viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2.5">
          <rect x="3" y="11" width="18" height="11" rx="2"/>
          <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
        </svg>
      </button>
      <button type="button" class="pip-close" aria-label="${u("pip.close","Cerrar")}" data-tooltip="${u("pip.close","Cerrar")}">&times;</button>
    </div>
  `;let b=document.createElement("div");b.className="pip-content";let E=document.createElement("div");E.className="pip-viewport";let w=document.createElement("div");w.className="pip-viewport-inner",w.appendChild(t),E.appendChild(w),b.appendChild(E),h.appendChild(f),h.appendChild(b);for(let A of["right","bottom","left","top"]){let C=document.createElement("div");C.className=`pip-resize-edge pip-resize-edge--${A}`,C.dataset.edge=A,h.appendChild(C)}let S=document.createElement("div");S.className="pip-resize-handle",S.dataset.edge="corner",h.appendChild(S),_i.appendChild(h);let T={panelId:o,originalParent:n,originalIndex:s,pipContainer:h,x:p,y:m,width:g,height:_,scale:y,defaultWidth:e?.defaultWidth||g,defaultHeight:e?.defaultHeight||_,locked:!1,isMaximized:e?.isMaximized||!1,lastScrollLeft:e?.scrollX||0,lastScrollTop:e?.scrollY||0};if(ee.set(o,T),e){h.offsetHeight;let A=Wn(o);T.scale=Math.max(A,Math.min(Hn,y)),ct(o,T.scale,!1),lt.debug(`PiP ${o} restaurado: scale=${T.scale.toFixed(3)} (saved=${y}, min=${A.toFixed(3)}), size=${g}x${_}`);let C=e.scrollX||0,x=e.scrollY||0,R=e.locked||!1,M=T.scale;requestAnimationFrame(()=>{ct(o,M,!1),E.scrollLeft=C,E.scrollTop=x,T.lastScrollLeft=C,T.lastScrollTop=x,lt.debug(`PiP ${o} rAF: scroll=${E.scrollLeft},${E.scrollTop} (target=${C},${x})`),R&&setTimeout(()=>{T.locked=!0,h.classList.add("pip-container--locked");let I=h.querySelector(".pip-lock");if(I){let B=u("pip.unlock","Desbloquear");I.setAttribute("aria-label",B),I.setAttribute("data-tooltip",B)}},0)})}else{ct(o,T.scale);let A=Wn(o);A!==T.scale&&(T.scale=A,ct(o,A));let C=h.querySelector(".pip-viewport");if(C){let x=C.clientWidth,R=C.clientHeight,M=(t?.offsetWidth||760)*T.scale,I=(t?.offsetHeight||760)*T.scale;C.scrollLeft=Math.max(0,(M-x)/2),C.scrollTop=Math.max(0,(I-R)/2)}}if(Ud(h,o),t.classList.add("panel--pipped"),lt.info(`Panel ${o} extra\xEDdo a PiP`),zt(),window.dispatchEvent(new CustomEvent("pip:open",{detail:{panelId:o}})),ee.size===1&&!Un&&!e){typeof window.__synthAnimateToPanel=="function"&&window.__synthAnimateToPanel(null,600);let A=window.__synthNavLocks||(window.__synthNavLocks={zoomLocked:!1,panLocked:!1});ls=!0,A.panLocked||(A.panLocked=!0,document.dispatchEvent(new CustomEvent("synth:panLockChange",{detail:{enabled:!0,source:"pipAutoLock"}}))),A.zoomLocked||(A.zoomLocked=!0,document.dispatchEvent(new CustomEvent("synth:zoomLockChange",{detail:{enabled:!0,source:"pipAutoLock"}})))}}function jn(o){let e=ee.get(o);if(!e)return;let t=document.getElementById(o);if(!t)return;t.style.transform="",t.classList.remove("panel--pipped");let n=document.getElementById(`pip-placeholder-${o}`);if(n&&n.parentElement)n.parentElement.insertBefore(t,n),n.remove();else{let{originalParent:s}=e,a=Array.from(s.children),r=dc.indexOf(o),l=null;for(let c of a){let d=c.id.replace("pip-placeholder-","");if(dc.indexOf(d)>r){l=c;break}}l?s.insertBefore(t,l):s.appendChild(t)}let{pipContainer:i}=e;if(i.remove(),ee.delete(o),He===o&&(He=null,window.__synthFocusedPip=null),lt.info(`Panel ${o} devuelto a viewport`),zt(),window.dispatchEvent(new CustomEvent("pip:close",{detail:{panelId:o}})),ee.size===0&&ls){ls=!1;let s=window.__synthNavLocks;s&&(s.panLocked&&(s.panLocked=!1,document.dispatchEvent(new CustomEvent("synth:panLockChange",{detail:{enabled:!1,source:"pipAutoLock"}}))),s.zoomLocked&&(s.zoomLocked=!1,document.dispatchEvent(new CustomEvent("synth:zoomLockChange",{detail:{enabled:!1,source:"pipAutoLock"}}))))}}function Ei(){for(let o of ee.keys())jn(o)}function pr(){for(let o of Yn)ee.has(o.id)||wn(o.id)}function Ud(o,e){let t=o.querySelector(".pip-header"),n=o.querySelector(".pip-close"),i=o.querySelector(".pip-maximize"),s=o.querySelector(".pip-minimize"),a=o.querySelector(".pip-fit"),r=o.querySelector(".pip-lock"),l=o.querySelector(".pip-resize-handle");Vd(o),n.addEventListener("click",()=>jn(e)),i.addEventListener("click",()=>{let C=ee.get(e);!C||C.locked||gc(e)}),s.addEventListener("click",()=>{let C=ee.get(e);!C||C.locked||fc(e)}),a.addEventListener("click",()=>{let C=ee.get(e);!C||C.locked||bc(e)}),r.addEventListener("click",()=>{let C=ee.get(e);if(!C)return;C.locked=!C.locked,o.classList.toggle("pip-container--locked",C.locked);let x=C.locked?u("pip.unlock","Desbloquear"):u("pip.lock","Bloquear");r.setAttribute("aria-label",x),r.setAttribute("data-tooltip",x),zt()}),t.addEventListener("pointerdown",C=>{if(C.target.closest("button"))return;C.preventDefault(),C.stopPropagation(),cn=e,vo=C.pointerId,t.setPointerCapture(C.pointerId);let x=o.getBoundingClientRect();Eo.x=C.clientX-x.left,Eo.y=C.clientY-x.top,o.classList.add("pip-container--dragging"),Co(e)});let c=(C,x)=>{let R=ee.get(e);if(R?.locked)return;C.preventDefault(),C.stopPropagation(),ht=e,rt=x,_o=C.pointerId,C.target.setPointerCapture(C.pointerId);let M=o.querySelector(".pip-viewport"),I=M?M.clientWidth:R.width-he,B=M?M.clientHeight:R.height-je-he,Y=M?M.scrollLeft:0,P=M?M.scrollTop:0,F=(Y+I/2)/R.scale,z=(P+B/2)/R.scale;re={x:C.clientX,y:C.clientY,w:R.width,h:R.height,pipX:R.x,pipY:R.y,scale:R.scale,aspectRatio:R.width/R.height,viewCenterX:F,viewCenterY:z,scrollX:Y,scrollY:P},o.classList.add("pip-container--resizing"),Co(e)};l.addEventListener("pointerdown",C=>c(C,"corner")),o.querySelectorAll(".pip-resize-edge").forEach(C=>{C.addEventListener("pointerdown",x=>c(x,C.dataset.edge))}),o.addEventListener("pointerdown",C=>{C.stopPropagation(),Co(e)}),o.addEventListener("pointermove",C=>{!cn&&!ht&&C.stopPropagation()}),o.addEventListener("pointerup",C=>{!cn&&!ht&&C.stopPropagation()}),o.addEventListener("pointercancel",C=>{!cn&&!ht&&C.stopPropagation()}),o.addEventListener("click",C=>C.stopPropagation()),o.addEventListener("mousedown",C=>C.stopPropagation()),o.addEventListener("mouseup",C=>C.stopPropagation()),o.addEventListener("mousemove",C=>C.stopPropagation()),o.addEventListener("contextmenu",C=>{C.preventDefault(),C.stopPropagation(),yi({x:C.clientX,y:C.clientY,panelId:e,isPipped:!0,target:C.target,onAttach:jn})}),o.addEventListener("dblclick",C=>{C.preventDefault(),C.stopPropagation()},{capture:!0}),o.addEventListener("touchstart",C=>C.stopPropagation(),{passive:!0}),o.addEventListener("touchmove",C=>C.stopPropagation(),{passive:!0}),o.addEventListener("touchcancel",C=>C.stopPropagation(),{capture:!0,passive:!0});let d=0;o.addEventListener("touchend",C=>{C.stopPropagation();let x=Date.now();x-d<300&&C.preventDefault(),d=x},{passive:!1}),o.addEventListener("wheel",C=>C.stopPropagation(),{passive:!0});let h=o.querySelector(".pip-viewport");o.querySelector(".pip-content").addEventListener("wheel",C=>{let x=ee.get(e);if(x){if(x.locked){C.ctrlKey&&C.preventDefault();return}if(C.ctrlKey){C.preventDefault();let R=x.scale,M=C.deltaY>0?-.05:.05,I=Wn(e),B=Math.max(I,Math.min(Hn,R+M));if(B!==R){let Y=h.getBoundingClientRect(),P=C.clientX-Y.left,F=C.clientY-Y.top,z=(h.scrollLeft+P)/R,$=(h.scrollTop+F)/R;ct(e,B);let N=z*B-P,K=$*B-F;h.scrollLeft=Math.max(0,N),h.scrollTop=Math.max(0,K)}}else{let R=h.clientWidth,M=h.clientHeight,I=document.getElementById(e),B=(I?.offsetWidth||760)*x.scale,Y=(I?.offsetHeight||760)*x.scale,P=Math.max(0,B-R),F=Math.max(0,Y-M),z=x.scale*x.scale,$=h.scrollLeft+(C.deltaX||0)*z,N=h.scrollTop+(C.deltaY||0)*z;h.scrollLeft=Math.max(0,Math.min(P,$)),h.scrollTop=Math.max(0,Math.min(F,N))}}},{passive:!1});let p=C=>{if(!C)return!1;let x=".knob, .knob-inner, .pin-btn, .joystick-pad, .panel7-joystick-pad, .joystick-handle, .output-fader, .synth-toggle, button, input, select, textarea";return C.closest('[data-prevent-pan="true"]')?!0:!!C.closest(x)},m=o.querySelector(".pip-content"),g=o.querySelector(".pip-viewport"),_=0,y=0,f=0,b=null,E=0,w=0,S=0,T=0;if(m.addEventListener("touchstart",C=>{if(C.touches.length===2){b=null;let x=ee.get(e);if(x?.locked)return;C.preventDefault(),fo=!0,window.__synthPipGestureActive=!0,document.dispatchEvent(new Event("synth:dismissTooltips"));let R=C.touches[0].clientX-C.touches[1].clientX,M=C.touches[0].clientY-C.touches[1].clientY;_=Math.hypot(R,M);let I=x?x.scale:.4,B=g.getBoundingClientRect(),Y=g.scrollLeft,P=g.scrollTop,F=(C.touches[0].clientX+C.touches[1].clientX)/2-B.left,z=(C.touches[0].clientY+C.touches[1].clientY)/2-B.top;y=(Y+F)/I,f=(P+z)/I}else if(C.touches.length===1&&b===null){if(ee.get(e)?.locked||p(C.touches[0].target))return;b=C.touches[0].identifier,E=C.touches[0].clientX,w=C.touches[0].clientY,S=g.scrollLeft,T=g.scrollTop}},{passive:!1}),m.addEventListener("touchmove",C=>{if(C.touches.length===2&&_>0){let x=ee.get(e);if(x?.locked)return;C.preventDefault(),C.stopPropagation();let R=C.touches[0].clientX-C.touches[1].clientX,M=C.touches[0].clientY-C.touches[1].clientY,I=Math.hypot(R,M),B=Math.max(_,cc),P=Math.max(I,cc)/B,F=Math.max(1-uc,Math.min(1+uc,P));if(_=I,!x)return;if(Math.abs(F-1)>Dd){let ne=Wn(e),ce=Math.max(ne,Math.min(Hn,x.scale*F));ct(e,ce)}let z=x.scale,$=y*z,N=f*z,K=g.getBoundingClientRect(),te=(C.touches[0].clientX+C.touches[1].clientX)/2-K.left,Q=(C.touches[0].clientY+C.touches[1].clientY)/2-K.top,ge=$-te,Se=N-Q;g.scrollLeft=Math.max(0,ge),g.scrollTop=Math.max(0,Se)}else if(C.touches.length===1&&b!==null){let x=Array.from(C.touches).find(I=>I.identifier===b);if(!x)return;C.preventDefault();let R=x.clientX-E,M=x.clientY-w;g.scrollLeft=S-R,g.scrollTop=T-M}},{passive:!1}),m.addEventListener("touchend",C=>{C.touches.length<2&&(_=0,setTimeout(()=>{fo=!1,window.__synthPipGestureActive=!1},500)),b!==null&&(Array.from(C.touches).find(R=>R.identifier===b)||(b=null))},{passive:!0}),g&&g.addEventListener("scroll",()=>{let C=ee.get(e);if(C?.locked){g.scrollLeft=C.lastScrollLeft,g.scrollTop=C.lastScrollTop;return}C.lastScrollLeft=g.scrollLeft,C.lastScrollTop=g.scrollTop},{passive:!0}),g){let C=null;g.addEventListener("scroll",()=>{ee.get(e)?.locked||Un||fo||(C&&clearTimeout(C),C=setTimeout(()=>{!fo&&!Un&&zt()},500))},{passive:!0})}m.addEventListener("pointerdown",C=>{if(C.pointerType==="touch")return;let x=ee.get(e);if(!x||x.locked)return;let R=C.button===1,M=C.button===0;!R&&!M||M&&p(C.target)||(C.preventDefault(),go=e,rs=C.pointerId,m.setPointerCapture(C.pointerId),kn.x=C.clientX,kn.y=C.clientY,kn.scrollX=g.scrollLeft,kn.scrollY=g.scrollTop,m.style.cursor="grabbing")}),m.addEventListener("pointermove",C=>{if(C.pointerType==="touch"||go!==e||C.pointerId!==rs)return;let x=C.clientX-kn.x,R=C.clientY-kn.y;g.scrollLeft=kn.scrollX-x,g.scrollTop=kn.scrollY-R});let A=C=>{if(C.pointerType!=="touch"&&!(go!==e||C.pointerId!==rs)){try{m.releasePointerCapture(rs)}catch{}go=null,rs=null,m.style.cursor=""}};m.addEventListener("pointerup",A),m.addEventListener("pointercancel",A)}function Hd(o){if(cn){let e=ee.get(cn);if(!e)return;let t=Math.max(0,Math.min(window.innerWidth-e.width,o.clientX-Eo.x)),n=Math.max(0,Math.min(window.innerHeight-40,o.clientY-Eo.y));e.x=t,e.y=n,e.pipContainer.style.left=`${t}px`,e.pipContainer.style.top=`${n}px`}if(ht){let e=ee.get(ht);if(!e)return;let t=o.clientX-re.x,n=o.clientY-re.y,i=re.w,s=re.h,a=re.pipX,r=re.pipY;if(rt==="corner"){let d=re.aspectRatio,h=re.w+t,p=re.h+n;Math.abs(t)*(re.h/re.w)>=Math.abs(n)?(i=h,s=i/d):(s=p,i=s*d)}else rt==="right"?i=re.w+t:rt==="bottom"?s=re.h+n:rt==="left"?(i=re.w-t,a=re.pipX+t):rt==="top"&&(s=re.h-n,r=re.pipY+n);let l=window.innerWidth-a,c=window.innerHeight-r;if(i=Math.max(Bt,Math.min(l,i)),s=Math.max(Bt,Math.min(c,s)),rt==="left"&&(a=re.pipX+re.w-i,a=Math.max(0,a),i=re.pipX+re.w-a),rt==="top"&&(r=re.pipY+re.h-s,r=Math.max(0,r),s=re.pipY+re.h-r),e.width=i,e.height=s,e.x=a,e.y=r,e.pipContainer.style.width=`${i}px`,e.pipContainer.style.height=`${s}px`,e.pipContainer.style.left=`${a}px`,e.pipContainer.style.top=`${r}px`,rt==="left"||rt==="top"){let d=e.pipContainer.querySelector(".pip-viewport");if(d){if(rt==="left"){let h=i-re.w;d.scrollLeft=Math.max(0,re.scrollX-h)}if(rt==="top"){let h=s-re.h;d.scrollTop=Math.max(0,re.scrollY-h)}}}if(rt==="corner"){let d=i/re.w,h=re.scale||e.scale,p=Wn(ht),m=Math.max(p,Math.min(Hn,h*d));ct(ht,m,!1);let g=e.pipContainer.querySelector(".pip-viewport");if(g&&re.viewCenterX!==void 0){let _=g.clientWidth,y=g.clientHeight,f=re.viewCenterX*m-_/2,b=re.viewCenterY*m-y/2;g.scrollLeft=Math.max(0,f),g.scrollTop=Math.max(0,b)}}else{let d=Wn(ht);e.scale<d?ct(ht,d,!1):ct(ht,e.scale,!1)}}}function hc(o){let e=!1;if(cn){let t=ee.get(cn);if(t){t.pipContainer.classList.remove("pip-container--dragging");let n=t.pipContainer.querySelector(".pip-header");if(n&&vo!==null)try{n.releasePointerCapture(vo)}catch{}e=!0}cn=null,vo=null}if(ht){let t=ee.get(ht);if(t){if(t.pipContainer.classList.remove("pip-container--resizing"),_o!==null)try{let n=t.pipContainer.querySelector(`[data-edge="${rt}"]`);n&&n.releasePointerCapture(_o)}catch{}e=!0}ht=null,_o=null,rt="corner"}e&&zt()}function gc(o){let e=ee.get(o);if(!e||e.locked)return;let t=20,n=window.innerWidth-t*2,i=window.innerHeight-t*2,s=e.width-he,a=e.height-je-he,r=s/a,l=n-he,c=i-je-he,d,h;r>=l/c?(d=l,h=Math.round(d/r)):(h=c,d=Math.round(h*r));let p=d+he,m=h+je+he,g=e.x,_=e.y;g+p>window.innerWidth&&(g=Math.max(0,window.innerWidth-p)),_+m>window.innerHeight&&(_=Math.max(0,window.innerHeight-m)),g<0&&(g=0),_<0&&(_=0);let y=e.width,f=p/y,b=e.scale,E=document.getElementById(o),w=E?.offsetWidth||760,S=E?.offsetHeight||760,T=p-he,A=m-je-he,C=Math.max(us,Math.min(T/w,A/S)),x=Math.max(C,Math.min(Hn,b*f));e.width=p,e.height=m,e.x=g,e.y=_,e.isMaximized=!0,e.pipContainer.style.width=`${p}px`,e.pipContainer.style.height=`${m}px`,e.pipContainer.style.left=`${g}px`,e.pipContainer.style.top=`${_}px`,ct(o,x,!1);let R=e.pipContainer.querySelector(".pip-viewport");if(R){let M=w*x,I=S*x;R.scrollLeft=Math.max(0,(M-R.clientWidth)/2),R.scrollTop=Math.max(0,(I-R.clientHeight)/2)}zt(),lt.debug(`PiP ${o} maximizado a ${p}x${m} (escala ${b.toFixed(2)} \u2192 ${x.toFixed(2)})`)}function fc(o){let e=ee.get(o);if(!e||e.locked)return;let t=e.width-he,n=e.height-je-he,i=t/n,s=e.defaultWidth-he,a=e.defaultHeight-je-he,r=s/a,l,c;i>=r?(l=s,c=Math.round(l/i),c<Bt-je-he&&(c=Bt-je-he,l=Math.round(c*i))):(c=a,l=Math.round(c*i),l<Bt-he&&(l=Bt-he,c=Math.round(l/i)));let d=l+he,h=c+je+he,p=e.width,m=d/p,g=e.scale,_=document.getElementById(o),y=_?.offsetWidth||760,f=_?.offsetHeight||760,b=d-he,E=h-je-he,w=Math.max(us,Math.min(b/y,E/f)),S=Math.max(w,Math.min(Hn,g*m)),T=e.x,A=e.y;T+d>window.innerWidth&&(T=Math.max(0,window.innerWidth-d)),A+h>window.innerHeight&&(A=Math.max(0,window.innerHeight-h)),e.width=d,e.height=h,e.x=T,e.y=A,e.isMaximized=!1,e.pipContainer.style.width=`${d}px`,e.pipContainer.style.height=`${h}px`,e.pipContainer.style.left=`${T}px`,e.pipContainer.style.top=`${A}px`,ct(o,S,!1);let C=e.pipContainer.querySelector(".pip-viewport");if(C){let x=y*S,R=f*S;C.scrollLeft=Math.max(0,(x-C.clientWidth)/2),C.scrollTop=Math.max(0,(R-C.clientHeight)/2)}zt(),lt.debug(`PiP ${o} restaurado a ${d}x${h} (escala ${g.toFixed(2)} \u2192 ${S.toFixed(2)})`)}function bc(o){let e=ee.get(o);if(!e||e.locked)return;let t=document.getElementById(o),n=t?.offsetWidth||760,i=t?.offsetHeight||760,s=e.width-he,a=e.height-je-he,r=Math.min(s,a),l=Math.min(r/n,r/i),c=Math.max(n,i)*l,d=Math.max(Bt,Math.round(c)+he),h=Math.max(Bt,Math.round(c)+je+he),p=e.x+(e.width-d)/2,m=e.y+(e.height-h)/2;p=Math.max(0,Math.min(p,window.innerWidth-d)),m=Math.max(0,Math.min(m,window.innerHeight-h));let g=e.scale;e.width=d,e.height=h,e.x=p,e.y=m,e.pipContainer.style.width=`${d}px`,e.pipContainer.style.height=`${h}px`,e.pipContainer.style.left=`${p}px`,e.pipContainer.style.top=`${m}px`;let _=d-he,y=h-je-he,f=Math.max(us,Math.min(_/n,y/i));ct(o,f,!1);let b=e.pipContainer.querySelector(".pip-viewport");b&&(b.scrollLeft=0,b.scrollTop=0),zt(),lt.debug(`PiP ${o} ajustado a cuadrado ${d}x${h} (escala ${g.toFixed(2)} \u2192 ${f.toFixed(2)})`)}function Co(o){let e=Math.max(cs,...Array.from(ee.values()).map(n=>parseInt(n.pipContainer.style.zIndex)||cs)),t=ee.get(o);t&&(t.pipContainer.style.zIndex=e+1),He=o,window.__synthFocusedPip=o}function ct(o,e,t=!0){let n=ee.get(o);if(!n)return;n.scale=e;let i=document.getElementById(o);if(!i)return;let s=i.offsetWidth||760,a=i.offsetHeight||760,r=s*e,l=a*e;i.style.transform=`scale(${e})`,i.style.transformOrigin="0 0";let c=n.pipContainer.querySelector(".pip-viewport"),d=c?c.clientWidth:n.width-he,h=c?c.clientHeight:n.height-je-he,p=n.pipContainer.querySelector(".pip-viewport-inner");p&&(p.style.width=`${r}px`,p.style.height=`${l}px`,p.style.padding="0",p.style.boxSizing="border-box"),t&&zt()}function pc(o){return{"panel-1":"Panel 1","panel-2":"Panel 2","panel-3":"Panel 3","panel-4":"Panel 4","panel-5":"Panel 5","panel-6":"Panel 6","panel-7":"Panel 7","panel-output":"Panel 7"}[o]||o}function mr(o){return ee.has(o)}function Wd(){return Array.from(ee.keys())}function So(){let o=[];for(let[e,t]of ee){let n=t.pipContainer.querySelector(".pip-viewport"),i=n?n.scrollLeft:0,s=n?n.scrollTop:0;o.push({panelId:e,x:t.x,y:t.y,width:t.width,height:t.height,scale:t.scale,scrollX:i,scrollY:s,zIndex:parseInt(t.pipContainer.style.zIndex)||cs,locked:t.locked||!1,isMaximized:t.isMaximized||!1,defaultWidth:t.defaultWidth,defaultHeight:t.defaultHeight})}return o}function zt(){if(Un||localStorage.getItem(v.REMEMBER_VISUAL_LAYOUT)!=="true")return;let e=So();try{localStorage.setItem(v.PIP_STATE,JSON.stringify(e)),lt.debug("Estado PiP guardado:",e.length,"paneles")}catch(t){lt.warn("No se pudo guardar estado PiP:",t)}}function gr(){if(localStorage.getItem(v.REMEMBER_VISUAL_LAYOUT)==="true")try{let e=localStorage.getItem(v.PIP_STATE);if(!e)return;let t=JSON.parse(e);if(!Array.isArray(t)||t.length===0)return;lt.info("Restaurando",t.length,"paneles PiP"),Un=!0;for(let n of t){if(!document.getElementById(n.panelId)){lt.warn("Panel no encontrado para restaurar:",n.panelId);continue}wn(n.panelId,n)}requestAnimationFrame(()=>{requestAnimationFrame(()=>{Un=!1,zt(),lt.debug("PiP restore completado, estado guardado")})})}catch(e){Un=!1,lt.warn("Error restaurando estado PiP:",e)}}function yc(){localStorage.removeItem(v.PIP_STATE)}function jd(){return localStorage.getItem(v.REMEMBER_VISUAL_LAYOUT)==="true"}function Yd(o){localStorage.setItem(v.REMEMBER_VISUAL_LAYOUT,String(o)),o||yc()}var lt,ee,_i,Un,ls,cs,Bt,je,he,us,Hn,cc,uc,Dd,zd,bo,yo,He,cn,Eo,vo,ht,re,_o,rt,go,kn,rs,fo,Gd,dc,Yn,mc,St,vi,Ci,Xn=Xe(()=>{be();Oe();Te();lc();lt=W("PipManager"),ee=new Map,_i=null,Un=!1,ls=!1,cs=1200,Bt=150,je=37,he=2,us=.1,Hn=3,cc=180,uc=.12,Dd=.002;zd=400,bo=null,yo=null;He=null,cn=null,Eo={x:0,y:0},vo=null,ht=null,re={x:0,y:0,w:0,h:0},_o=null,rt="corner",go=null,kn={x:0,y:0,scrollX:0,scrollY:0},rs=null,fo=!1,Gd={"panel-1":{col:0,row:0},"panel-2":{col:1,row:0},"panel-3":{col:2,row:0},"panel-4":{col:3,row:0},"panel-5":{col:0,row:1},"panel-6":{col:2,row:1},"panel-output":{col:3,row:1},"panel-7":{col:3,row:1}},dc=["panel-1","panel-2","panel-3","panel-4","panel-5","panel-6","panel-output"],Yn=[{id:"panel-1",name:()=>"Panel 1"},{id:"panel-2",name:()=>"Panel 2"},{id:"panel-3",name:()=>"Panel 3"},{id:"panel-4",name:()=>"Panel 4"},{id:"panel-5",name:()=>"Panel 5"},{id:"panel-6",name:()=>"Panel 6"},{id:"panel-output",name:()=>"Panel 7"}],mc=500,St=new Map,vi=new Map,Ci=!1});be();Te();var Kr=null,mu={info:"",success:"toast--success",warning:"toast--warning",error:"toast--error"};function se(o,e=2e3){let t,n;typeof e=="object"&&e!==null?(t=e.duration??2e3,n=e.level??"info"):(t=e,n="info");let i=document.getElementById("appToast");i||(i=document.createElement("div"),i.id="appToast",i.className="toast",document.body.appendChild(i)),i.classList.remove("toast--success","toast--warning","toast--error");let s=mu[n]||"";s&&i.classList.add(s),i.textContent=o,i.classList.add("toast--visible"),clearTimeout(Kr),Kr=setTimeout(()=>{i.classList.remove("toast--visible")},t)}be();Ms();Pn();var Mu=W("Audio");function on(o){if(!o||typeof o.disconnect!="function")return!1;try{return o.disconnect(),!0}catch{return!1}}function We(o,e){return!o||typeof o.addEventListener!="function"||o.addEventListener("processorerror",t=>{let n=`AudioWorklet "${e}" fall\xF3 en runtime`;Mu.error(n,t),Qr(n,{source:`worklet:${e}`,type:"processorerror"}),ut("worklet_crash",{processor:e})}),o}Pn();var _a={HI:{min:5,max:2e4},LO:{min:.5,max:2e3}},rl=10,kt={WHITE:{value:1e5,tolerance:.1,description:"Standard audio patching",category:"standard"},GREY:{value:1e5,tolerance:.005,description:"Precision CV patching (tuned intervals)",category:"standard"},GREEN:{value:68e3,tolerance:.1,description:"Attenuated mixing",category:"standard"},RED:{value:2700,tolerance:.1,description:"Oscilloscope connections (strong signal)",category:"standard"},BLUE:{value:1e4,tolerance:.1,description:"High gain (Belgrado legacy)",category:"special"},YELLOW:{value:22e3,tolerance:.1,description:"Jumper connections / signal boost",category:"special"},CYAN:{value:25e4,tolerance:.1,description:"Very attenuated mixing",category:"special"},PURPLE:{value:1e6,tolerance:.1,description:"Minimal influence mixing",category:"special"},ORANGE:{value:0,tolerance:0,description:"Short circuit - DO NOT USE in Cuenca version",category:"forbidden",dangerous:!0}},Pu="GREY",si=1e5,ll=8;function cl(o){return o*4}function ul(o){return o/4}function Ou(o,e){return e===0?(console.warn("Pin con resistencia 0 (cortocircuito) - esto puede causar problemas"),1/0):o/e}function Iu(o,e,t){let s=Math.pow(2,32),r=((1664525*t+1013904223)%s/s*2-1)*e;return o*(1+r)}function Ca(o,e,t=1){let n=e/2,i=o/n;return Math.tanh(i*t)*n}function va(o,e){if(typeof localStorage>"u")return e;let t=localStorage.getItem(`synthigme-${o}`);return t===null?e:t==="true"}var On={defaultPinType:Pu,get applyPinTolerance(){return va("voltage-pin-tolerance-enabled",!0)},get applyThermalDrift(){return va("voltage-thermal-drift-enabled",!0)},get softClipEnabled(){return va("voltage-soft-clip-enabled",!0)}};function Ea(o,e=si,t={}){let{applyTolerance:n=!1,seed:i=0}=t,s=kt[o]||kt.GREY;if(s.dangerous)return console.warn(`Pin tipo ${o} marcado como peligroso - no usar`),1;let a=s.value;return n&&s.tolerance>0&&(a=Iu(a,s.tolerance,i)),Ou(e,a)}function dl(o=1024,e=2.25,t=2.875,n=3,i=2){let s=new Float32Array(o),a=.95;for(let r=0;r<o;r++){let c=2*(r/(o-1))-1,d=Math.abs(c),h=c>=0?1:-1,p;if(d<=a)p=c;else{let m=d-a,g=1-a,_=m/g,y=Math.tanh(i*_)*g;p=h*(a+y)}s[r]=p}return s}var Nu=1e-10;function gn(o,e=Nu){return o<=0?(console.warn("Resistencia \u2264 0 no v\xE1lida para c\xE1lculo de cutoff"),1/0):1/(2*Math.PI*o*e)}var fn={WHITE:gn(kt.WHITE.value),GREY:gn(kt.GREY.value),GREEN:gn(kt.GREEN.value),RED:gn(kt.RED.value),BLUE:gn(kt.BLUE.value),YELLOW:gn(kt.YELLOW.value),CYAN:gn(kt.CYAN.value),PURPLE:gn(kt.PURPLE.value)};function Fs(o,e="WHITE",t=.5){let n=o.createBiquadFilter();n.type="lowpass",n.Q.value=t;let i=fn[e]??fn.WHITE,s=24e3;return n.frequency.value=Math.min(i,s),n}function Sa(o,e,t=null){let n=fn[e]??fn.WHITE,s=Math.min(n,24e3);t!==null?o.frequency.setValueAtTime(s,t):o.frequency.value=s}function ka(o,e={}){let t=e.voltageAtMax??0,n=e.voltageAtMin??-12,s=Math.max(0,Math.min(10,o))/10;return n+(t-n)*s}function Du(o,e={}){let t=e.dbPerVolt??10,n=e.cutoffVoltage??-12,i=e.saturation??{},s=i.linearThreshold??0,a=i.hardLimit??3,r=i.softness??2;if(o<=n)return 0;if(o<=s){let g=o*t;return Math.pow(10,g/20)}let l=o-s,c=a-s,d=l/c,h=c*d/(1+d*r),m=(s+h)*t;return Math.pow(10,m/20)}function bn(o,e=0,t={}){if(o<=0)return 0;let i=ka(o,t)+e;return Du(i,t)}function wa(o){if(o<=0)return 0;if(o>=10)return 10;let e=o/10,n=(2*Math.log10(e)+12)/1.2;return Math.max(0,Math.min(10,n))}function In(o,e=0,t={}){let n=wa(o);return bn(n,e,t)}function yn(){if(typeof localStorage>"u")return!0;let o=localStorage.getItem("synthigme-fader-linear-response");return o===null?!0:o==="true"}var qe={schemaVersion:1,defaults:{knobs:{pulseLevel:{min:0,max:1,initial:0,curve:"linear",pixelsForFullRange:900},pulseWidth:{min:.01,max:.99,initial:.5,curve:"linear",pixelsForFullRange:900},sineLevel:{min:0,max:1,initial:0,curve:"linear",pixelsForFullRange:900},sineSymmetry:{min:0,max:1,initial:.5,curve:"linear",pixelsForFullRange:900},triangleLevel:{min:0,max:1,initial:0,curve:"linear",pixelsForFullRange:900},sawtoothLevel:{min:0,max:1,initial:0,curve:"linear",pixelsForFullRange:900},frequency:{min:0,max:10,initial:5,curve:"synthi100",pixelsForFullRange:1e4,scaleDecimals:3}},switches:{range:{initial:"hi"}},audio:{pulseHarmonics:32,sineHarmonics:16,smoothingTime:.01,frequencyRampTime:.2},moduleSlew:{cutoffHz:2e4,enabled:!0},tracking:{alpha:.01,linearHalfRange:2.5},freqCV:{cvScale:2,octavesPerUnit:.5,ranges:{cvScale:{min:.1,max:10},octavesPerUnit:{min:.1,max:4}}},sineShape:{attenuation:1,purity:.7,saturationK:1.55,maxOffset:.85},voltage:{outputLevels:{sine:8,sawtooth:6.2,triangle:8.1,pulse:8.1,cusp:.5},feedbackResistance:{sineSawtooth:1e5,pulseTriangle:3e5},inputLimit:8,thermalDrift:{maxDeviation:.001,periodSeconds:120,enabledByDefault:!0},legacyBelgrado:{sine:4,sawtooth:5,sawtoothHi:7.4,pulse:3.2,noise:3}},thermalSlew:{riseTimeConstant:.005,fallTimeConstant:.02,threshold:.5,enabled:!0},softClip:{coefficient:1e-4,enabled:!0}},oscillators:{}};var ft={schemaVersion:2,defaults:{colourSmoothingTime:.01,levelSmoothingTime:.03,ramps:{colour:.05,level:.06}},colourFilter:{potResistance:1e4,capacitance:33e-9,order:1},levelCurve:{type:"log",logBase:100},noise1:{id:"panel3-noise-1",title:"Noise 1",matrixRow:89,knobs:{colour:{min:0,max:10,initial:5,curve:"linear",pixelsForFullRange:900},level:{min:0,max:10,initial:0,curve:"linear",pixelsForFullRange:900}},audio:{}},noise2:{id:"panel3-noise-2",title:"Noise 2",matrixRow:90,knobs:{colour:{min:0,max:10,initial:5,curve:"linear",pixelsForFullRange:900},level:{min:0,max:10,initial:0,curve:"linear",pixelsForFullRange:900}},audio:{}}};var Gi={schemaVersion:1,id:"panel3-random-cv",title:"Random Voltage",knobs:{mean:{min:-1,max:1,initial:0,curve:"linear"},variance:{min:0,max:1,initial:.5,curve:"linear"},voltage1:{min:0,max:1,initial:0,curve:"linear"},voltage2:{min:0,max:1,initial:0,curve:"linear"},key:{min:0,max:1,initial:0,curve:"linear"}}};var bt={schemaVersion:1,defaults:{positionSmoothingTime:.01,rangeSmoothingTime:.03,ramps:{position:.03,range:.05}},rangeCurve:{type:"linear"},left:{id:"joystick-left",title:"Joystick L",matrixRows:{y:117,x:118},knobs:{rangeY:{min:0,max:10,initial:0,curve:"linear",pixelsForFullRange:900},rangeX:{min:0,max:10,initial:0,curve:"linear",pixelsForFullRange:900}}},right:{id:"joystick-right",title:"Joystick R",matrixRows:{y:119,x:120},knobs:{rangeY:{min:0,max:10,initial:0,curve:"linear",pixelsForFullRange:900},rangeX:{min:0,max:10,initial:0,curve:"linear",pixelsForFullRange:900}}}};var $t={schemaVersion:1,count:8,knobs:{level:{min:0,max:1,initial:0,pixelsForFullRange:900}},audio:{levelSmoothingTime:.03}};var Ze={schemaVersion:2,count:8,knobs:{filter:{min:-5,max:5,initial:0,curve:"linear",pixelsForFullRange:900},pan:{min:-1,max:1,initial:0,curve:"linear",pixelsForFullRange:900}},faders:{level:{min:0,max:10,initial:0,step:.01,curve:"linear"}},switches:{power:{initial:!1}},audio:{levelSmoothingTime:.06,panSmoothingTime:.03,filterSmoothingTime:.03,ramps:{level:.06,filter:.2,pan:.2},filter:{capacitance:47e-9,potResistance:1e4,order:1},dcBlocker:{cutoffFrequency:1}},vca:{dbPerVolt:10,sliderVoltage:{atMax:0,atMin:-12},cutoffVoltage:-12,saturation:{linearThreshold:0,hardLimit:3,softness:2},antiClickFilter:{slewTime:.005}}};var Ut={schemaVersion:1,display:{internalWidth:400,internalHeight:300,useDevicePixelRatio:!1,lineColor:"#00ff00",lineColor2:"#00ff00",bgColor:"#0a0a0a",gridColor:"#1a3a1a",centerColor:"#2a5a2a",lineWidth:3,glowBlur:8,glowColor:"#00ff00",glowColor2:"#00ff00",showGrid:!0,showTriggerIndicator:!0},audio:{bufferSize:4096,triggerEnabled:!0,triggerLevel:0,mode:"yt",inputSensitivity:.027,triggerHysteresis:150,schmittHysteresis:.05},knobs:{timeScale:{min:.01,max:1,initial:1,curve:"quadratic",curveExponent:2,pixelsForFullRange:600},ampScale:{min:.25,max:4,initial:1,curve:"exponential",curveK:2,pixelsForFullRange:150},triggerLevel:{min:-1,max:1,initial:0,curve:"linear",pixelsForFullRange:200}}};var yt={schemaVersion:1,configType:"audio",audio:{matrixGain:1,gainRange:{min:0,max:2},sumMode:"direct",maxSumGain:4},rowGains:{},colGains:{},pinGains:{},pinFiltering:{busCapacitance:1e-10,filterQ:.5},hybridClipping:{linearThreshold:2.25,softThreshold:2.875,hardLimit:3,softness:2,samples:1024,enabled:!0}};var Vs={schemaVersion:1,configType:"control",control:{matrixGain:1,gainRange:{min:0,max:2},sumMode:"direct",maxSumGain:4},rowGains:{},colGains:{},pinGains:{}};var ae=W("AudioEngine"),vt={DEFAULT_RAMP_TIME:.03,SLOW_RAMP_TIME:.06,FAST_RAMP_TIME:.01,FILTER_BYPASS_CROSSFADE:.05,FILTER_BYPASS_THRESHOLD:.02};function Me(o,e,t,{ramp:n=vt.DEFAULT_RAMP_TIME}={}){if(!o||!t)return;let i=t.currentTime;o.cancelScheduledValues(i),o.setTargetAtTime(e,i,n)}var Gs=class{constructor(e={}){let{outputChannels:t=8}=e;this.audioCtx=null,this.modules=[],this.isRunning=!1,this.muted=!1,this.masterBaseGain=1,this.workletReady=!1,this._workletLoadPromise=null;let i=typeof localStorage<"u"?localStorage.getItem(v.DSP_ENABLED):null;this.dspEnabled=i===null?!0:i==="true",this.outputChannels=t,this.physicalChannels=2,this.physicalChannelLabels=["L","R"],this.outputLevels=Array.from({length:this.outputChannels},()=>0),this.outputPans=Array.from({length:this.outputChannels},()=>0),this.outputFilters=Array.from({length:this.outputChannels},()=>0),this.outputMutes=Array.from({length:this.outputChannels},()=>!1),this.outputBuses=[];let s=typeof localStorage<"u",a=s?localStorage.getItem(v.FILTER_BYPASS_ENABLED):null;this._filterBypassEnabled=a===null?!0:a==="true",this._filterBypassDebug=s?localStorage.getItem(v.FILTER_BYPASS_DEBUG)==="true":!1,this._filterBypassState=Array.from({length:this.outputChannels},()=>!0),this._filterBypassPendingChanges=null,this._filterBypassToastTimeout=null,this._channelBypassDebug=!1,this.stereoBuses={A:{sumL:null,sumR:null,outputL:null,outputR:null,channels:[0,1,2,3]},B:{sumL:null,sumR:null,outputL:null,outputR:null,channels:[4,5,6,7]}},this.stereoBusOutputs=[],this._stereoBusRoutingMatrix=null,this._outputRoutingMatrix=null,this._onPhysicalChannelsChange=null,this.bus1=null,this.bus2=null,this.bus1Mod=null,this.bus2Mod=null,this.bus1L=null,this.bus1R=null,this.bus2L=null,this.bus2R=null,this.masterL=null,this.masterR=null,this.merger=null,this.bus1Level=this.outputLevels[0]??0,this.bus1Pan=this.outputPans[0]??0,this.bus2Level=this.outputLevels[1]??0,this.bus2Pan=this.outputPans[1]??0}start(e={}){if(!this.dspEnabled){ae.info("DSP disabled, skipping AudioContext creation");return}if(this.audioCtx)return;let t;if(e.audioContext)t=e.audioContext;else{let i=e.latencyHint||"interactive";isNaN(parseFloat(i))||(i=parseFloat(i));let s=window.AudioContext||window.webkitAudioContext;t=new s({latencyHint:i}),ae.info(`AudioContext created with latencyHint: ${typeof i=="number"?i+"s":'"'+i+'"'}, baseLatency: ${t.baseLatency?.toFixed(3)||"N/A"}s`)}this.audioCtx=t,this._loadWorklet();let n=t.destination.maxChannelCount||2;this.physicalChannels=n,this.physicalChannelLabels=this._generateChannelLabels(n),ae.info(`Initial physical channels: ${n}`),this.masterGains=[];for(let i=0;i<n;i++){let s=t.createGain();s.gain.value=this.muted?0:this.masterBaseGain,this.masterGains.push(s)}this.masterL=this.masterGains[0]||null,this.masterR=this.masterGains[1]||null,this._initOutputRoutingMatrix(n),this.outputBuses=[];for(let i=0;i<this.outputChannels;i+=1){let s=t.createGain();s.gain.value=1;let a=null,{hybridClipping:r}=yt;r.enabled&&(a=t.createWaveShaper(),a.curve=dl(r.samples,r.linearThreshold,r.softThreshold,r.hardLimit,r.softness),a.oversample="2x");let l=t.createGain();l.gain.value=this.outputLevels[i];let c=t.createGain();c.gain.value=1;let d=null,h=t.createGain();h.gain.value=this.outputMutes[i]?0:1;let p=t.createGain(),m=t.createGain(),_=this.outputFilters[i]/5,y=Math.abs(_)<vt.FILTER_BYPASS_THRESHOLD;this._filterBypassEnabled&&y?(p.gain.value=0,m.gain.value=1,this._filterBypassState[i]=!0):(p.gain.value=1,m.gain.value=0,this._filterBypassState[i]=!1),a?(s.connect(a),a.connect(l)):s.connect(l),l.connect(c),c.connect(p),p.connect(h),c.connect(m),m.connect(h);let b=t.createGain();b.gain.value=1,h.connect(b);let E=[];for(let T=0;T<n;T++){let A=t.createGain(),C=this._outputRoutingMatrix[i]?.[T]??0;A.gain.value=C,b.connect(A),A.connect(this.masterGains[T]),E.push(A)}let w=i,S={input:s,hybridClipShaper:a,levelNode:l,postVcaNode:c,filterGain:p,bypassGain:m,filterNode:d,muteNode:h,dcBlockerOut:b,dcBlockerWorklet:null,panLeft:E[0]||null,panRight:E[1]||null,channelGains:E,stereoPanL:null,stereoPanR:null,vcaWorklet:null,_isDormant:!1,_savedMuteValue:1,setDormant:T=>{if(S._isDormant===T)return;S._isDormant=T;let A=this,C=!!S.hybridClipShaper;if(T){S._savedMuteValue=S.muteNode.gain.value;try{C?S.input.disconnect(S.hybridClipShaper):S.input.disconnect(S.levelNode),console.log(`[Dormancy] Output Bus ${w+1}: DORMANT (disconnected)`)}catch{}}else try{C?S.input.connect(S.hybridClipShaper):S.input.connect(S.levelNode);let x=A.outputLevels[w];if(typeof x=="number"&&(x!==S.levelNode.gain.value&&S.levelNode.gain.setValueAtTime(x,A.audioCtx.currentTime),S.vcaWorklet?.port)){let R=A._gainToDialVoltage(x);S.vcaWorklet.port.postMessage({type:"resync",dialVoltage:R})}console.log(`[Dormancy] Output Bus ${w+1}: ACTIVE (reconnected)`)}catch{}}};this.outputBuses.push(S)}this._createStereoBuses(t,n),this.bus1=this.outputBuses[0]?.input||null,this.bus2=this.outputBuses[1]?.input||null,this.bus1Mod=this.outputBuses[0]?.levelNode||null,this.bus2Mod=this.outputBuses[1]?.levelNode||null,this.bus1L=this.outputBuses[0]?.channelGains?.[0]||null,this.bus1R=this.outputBuses[0]?.channelGains?.[1]||null,this.bus2L=this.outputBuses[1]?.channelGains?.[0]||null,this.bus2R=this.outputBuses[1]?.channelGains?.[1]||null,this.merger=t.createChannelMerger(n),this.masterGains.forEach((i,s)=>{i.connect(this.merger,0,s)}),this.merger.connect(t.destination);for(let i of this.modules)i.start&&i.start();for(let i=0;i<this.outputChannels;i+=1)this.updateOutputPan(i);this.isRunning=!0}_initOutputRoutingMatrix(e){if(!this._outputRoutingMatrix){this._outputRoutingMatrix=[];for(let t=0;t<this.outputChannels;t++){let n=Array(e).fill(0);this._outputRoutingMatrix.push(n)}}}updateOutputPan(e,t=vt.DEFAULT_RAMP_TIME){let n=this.audioCtx,i=this.outputBuses[e];!n||!i||this._updateStereoBusPanning(e,t)}setOutputLevel(e,t,{ramp:n=vt.DEFAULT_RAMP_TIME}={}){if(e<0||e>=this.outputChannels)return;this.outputLevels[e]=t;let i=this.audioCtx,s=this.outputBuses[e];if(i&&s)if(s.vcaWorklet){let a=this._gainToDialVoltage(t),r=s.vcaWorklet.parameters.get("dialVoltage");r&&(r.cancelScheduledValues(i.currentTime),r.setValueAtTime(r.value,i.currentTime),r.linearRampToValueAtTime(a,i.currentTime+n));let l=s.vcaWorklet.parameters.get("cutoffEnabled");l&&l.setValueAtTime(t<=0?1:0,i.currentTime)}else Me(s.levelNode.gain,t,i,{ramp:n});e===0&&(this.bus1Level=t),e===1&&(this.bus2Level=t)}getOutputLevel(e){return this.outputLevels[e]??0}connectOutputLevelCV(e,t){if(e<0||e>=this.outputChannels)return!1;let n=this.audioCtx,i=this.outputBuses[e];if(!n||!i)return!1;if(!this.workletReady)return ae.warn("Worklets not ready for audio-rate CV. Call ensureWorkletReady() first."),!1;if(!i.vcaWorklet)try{let s=Ze?.vca?.antiClickFilter?.slewTime??.005;i.vcaWorklet=new AudioWorkletNode(n,"vca-processor",{numberOfInputs:2,numberOfOutputs:1,outputChannelCount:[1],parameterData:{dialVoltage:this._gainToDialVoltage(this.outputLevels[e]),cvScale:4,cutoffEnabled:this.outputLevels[e]>0?0:1,slewTime:s}}),We(i.vcaWorklet,`vca-processor[bus ${e}]`);try{i.levelNode.disconnect(i.postVcaNode)}catch{}i.levelNode.connect(i.vcaWorklet,0,0),i.vcaWorklet.connect(i.postVcaNode),i.levelNode.gain.setValueAtTime(1,n.currentTime),ae.info(`Bus ${e+1}: VCA worklet created for audio-rate AM`)}catch(s){return ae.error(`Failed to create VCA worklet for bus ${e}:`,s),!1}try{return t.connect(i.vcaWorklet,0,1),ae.info(`Bus ${e+1}: CV source connected to VCA worklet`),!0}catch(s){return ae.error(`Failed to connect CV source to bus ${e}:`,s),!1}}disconnectOutputLevelCV(e,t=null){if(e<0||e>=this.outputChannels)return!1;let n=this.audioCtx,i=this.outputBuses[e];if(!n||!i?.vcaWorklet)return!1;try{return t&&t.disconnect(i.vcaWorklet),ae.info(`Bus ${e+1}: CV source disconnected`),!0}catch(s){return ae.warn(`Disconnect CV failed for bus ${e}:`,s),!1}}_gainToDialVoltage(e){return e<=0?-12:e>=1?0:Math.max(-12,Math.min(0,20*Math.log10(e)))}setOutputMute(e,t,{ramp:n=vt.DEFAULT_RAMP_TIME}={}){if(e<0||e>=this.outputChannels)return;this.outputMutes[e]=t;let i=this.audioCtx,s=this.outputBuses[e];if(!i||!s?.muteNode)return;let a=t?0:1;Me(s.muteNode.gain,a,i,{ramp:n})}getOutputMute(e){return this.outputMutes[e]??!1}_applyFilterValue(e,t,n=vt.DEFAULT_RAMP_TIME){let s=this.outputBuses[e]?.filterNode,a=this.audioCtx;if(!s)return;let r=s.parameters.get("filterPosition");r&&(a?Me(r,t,a,{ramp:n}):r.value=t)}setOutputFilter(e,t,{ramp:n=vt.DEFAULT_RAMP_TIME}={}){if(e<0||e>=this.outputChannels)return;let i=Math.max(-5,Math.min(5,t)),s=i/5;this.outputFilters[e]=i,this._filterBypassEnabled&&this._updateFilterBypass(e,s),this._filterBypassState[e]||this._applyFilterValue(e,s,n)}_updateFilterBypass(e,t){let n=this.outputBuses[e],i=this.audioCtx;if(!n||!i)return;let s=Math.abs(t)<vt.FILTER_BYPASS_THRESHOLD,a=this._filterBypassState[e],r=vt.FILTER_BYPASS_CROSSFADE,l=5*r,c=i.currentTime;s&&!a?(Me(n.filterGain.gain,0,i,{ramp:r}),Me(n.bypassGain.gain,1,i,{ramp:r}),n.filterGain.gain.setValueAtTime(0,c+l),n.bypassGain.gain.setValueAtTime(1,c+l),this._filterBypassState[e]=!0,this._filterBypassDebug&&this._logFilterBypassChange(e,!0)):!s&&a&&(Me(n.filterGain.gain,1,i,{ramp:r}),Me(n.bypassGain.gain,0,i,{ramp:r}),n.filterGain.gain.setValueAtTime(1,c+l),n.bypassGain.gain.setValueAtTime(0,c+l),this._filterBypassState[e]=!1,this._filterBypassDebug&&this._logFilterBypassChange(e,!1))}_logFilterBypassChange(e,t){let n=t?"BYPASS":"ACTIVE";ae.info(`[FilterBypass] Out ${e+1}: ${n}`),this._filterBypassPendingChanges||(this._filterBypassPendingChanges={bypassed:[],active:[]});let i=`Out ${e+1}`;t?this._filterBypassPendingChanges.bypassed.push(i):this._filterBypassPendingChanges.active.push(i),this._filterBypassToastTimeout&&clearTimeout(this._filterBypassToastTimeout),this._filterBypassToastTimeout=setTimeout(()=>{this._showFilterBypassToast()},100)}_showFilterBypassToast(){if(!this._filterBypassPendingChanges)return;let{bypassed:e,active:t}=this._filterBypassPendingChanges;if(e.length===0&&t.length===0)return;let n=[];t.length>0&&n.push(`\u{1F50A} Filter: ${t.join(", ")}`),e.length>0&&n.push(`\u26A1 Bypass: ${e.join(", ")}`),se(n.join(" | "),2e3),this._filterBypassPendingChanges=null,this._filterBypassToastTimeout=null}setFilterBypassEnabled(e){this._filterBypassEnabled=e;let t=this.audioCtx;if(t){if(e)for(let n=0;n<this.outputChannels;n++){let i=this.outputFilters[n]/5;this._updateFilterBypass(n,i)}else for(let n=0;n<this.outputChannels;n++)if(this._filterBypassState[n]){let i=this.outputBuses[n];if(i){let s=vt.FILTER_BYPASS_CROSSFADE,a=t.currentTime;Me(i.filterGain.gain,1,t,{ramp:s}),Me(i.bypassGain.gain,0,t,{ramp:s});let r=5*s;i.filterGain.gain.setValueAtTime(1,a+r),i.bypassGain.gain.setValueAtTime(0,a+r),this._filterBypassState[n]=!1;let l=this.outputFilters[n]/5;this._applyFilterValue(n,l)}}}}setFilterBypassDebug(e){this._filterBypassDebug=e}isFilterBypassed(e){return this._filterBypassState[e]??!1}getOutputFilter(e){return this.outputFilters[e]??0}_createStereoBuses(e,t){this._stereoBusRoutingMatrix=Array.from({length:4},()=>Array(t).fill(0)),this.stereoBusOutputs=[];for(let n of["A","B"]){let i=this.stereoBuses[n],s=n==="A"?0:2;i.sumL=e.createGain(),i.sumL.gain.value=1,i.sumR=e.createGain(),i.sumR.gain.value=1,i.outputL=e.createGain(),i.outputL.gain.value=1,i.outputR=e.createGain(),i.outputR.gain.value=1,i.sumL.connect(i.outputL),i.sumR.connect(i.outputR);let a=[];for(let l=0;l<t;l++){let c=e.createGain();c.gain.value=this._stereoBusRoutingMatrix[s][l],i.outputL.connect(c),c.connect(this.masterGains[l]),a.push(c)}let r=[];for(let l=0;l<t;l++){let c=e.createGain();c.gain.value=this._stereoBusRoutingMatrix[s+1][l],i.outputR.connect(c),c.connect(this.masterGains[l]),r.push(c)}i.channelGainsL=a,i.channelGainsR=r,this.stereoBusOutputs.push({output:i.outputL,channelGains:a,busId:n,side:"L"}),this.stereoBusOutputs.push({output:i.outputR,channelGains:r,busId:n,side:"R"})}for(let n=0;n<this.outputChannels;n++){let i=this.outputBuses[n],s=n<4?"A":"B",a=this.stereoBuses[s];i.stereoPanL=e.createGain(),i.stereoPanR=e.createGain(),i.dcBlockerOut.connect(i.stereoPanL),i.dcBlockerOut.connect(i.stereoPanR),i.stereoPanL.connect(a.sumL),i.stereoPanR.connect(a.sumR);let l=((this.outputPans[n]??0)+1)*.25*Math.PI;i.stereoPanL.gain.value=Math.cos(l),i.stereoPanR.gain.value=Math.sin(l)}}_updateStereoBusPanning(e,t=vt.DEFAULT_RAMP_TIME){let n=this.audioCtx,i=this.outputBuses[e];if(!n||!i?.stereoPanL||!i?.stereoPanR)return;let a=((this.outputPans[e]??0)+1)*.25*Math.PI,r=Math.cos(a),l=Math.sin(a);Me(i.stereoPanL.gain,r,n,{ramp:t}),Me(i.stereoPanR.gain,l,n,{ramp:t})}setStereoBusRouting(e,t){if(e<0||e>=4||!Array.isArray(t))return;let n=this.stereoBusOutputs[e];if(!n)return;let i=this.audioCtx;t.forEach((s,a)=>{this._stereoBusRoutingMatrix?.[e]&&(this._stereoBusRoutingMatrix[e][a]=s);let r=n.channelGains?.[a];r&&i&&Me(r.gain,s,i)}),ae.debug(`Stereo bus routing row ${e}: ${t.map(s=>s?1:0).join(",")}`)}getStereoBusRouting(e){return this._stereoBusRoutingMatrix?.[e]??[]}getRecordingNodes(){return{stereo:{A:{L:this.stereoBuses.A?.outputL,R:this.stereoBuses.A?.outputR},B:{L:this.stereoBuses.B?.outputL,R:this.stereoBuses.B?.outputR}},individual:this.outputBuses.map(e=>e.muteNode)}}setOutputPan(e,t,{ramp:n=vt.DEFAULT_RAMP_TIME}={}){e<0||e>=this.outputChannels||(this.outputPans[e]=t,this._updateStereoBusPanning(e,n),e===0&&(this.bus1Pan=t),e===1&&(this.bus2Pan=t))}setOutputRouting(e,t,n){if(e<0||e>=this.outputChannels)return{applied:[],ignored:[]};let i;Array.isArray(t)?i=t:i=[t??0,n??0],this._outputRoutingMatrix||(this._outputRoutingMatrix=Array.from({length:this.outputChannels},()=>Array(this.physicalChannels).fill(0)));let s=[],a=[];return i.forEach((r,l)=>{this._outputRoutingMatrix[e]||(this._outputRoutingMatrix[e]=[]),this._outputRoutingMatrix[e][l]=r;let d=this.outputBuses[e]?.channelGains?.[l];d&&this.audioCtx?(Me(d.gain,r,this.audioCtx),s.push(l)):l<i.length&&a.push(l)}),a.length>0&&ae.warn(`setOutputRouting: Bus ${e} \u2192 canales ${a.join(", ")} ignorados (dispositivo actual tiene ${this.physicalChannels} canales)`),{applied:s,ignored:a}}getOutputRouting(e){let t=this.outputBuses[e];if(!t)return null;let n=(t.channelGains||[]).map(i=>i?.gain?.value??0);for(;n.length<2;)n.push(0);return{channels:n,legacy:{left:n[0]??0,right:n[1]??0},left:n[0]??0,right:n[1]??0}}getFullRoutingMatrix(){return this._outputRoutingMatrix?this._outputRoutingMatrix.map(e=>[...e]):[]}setFullRoutingMatrix(e){let t=[];return Array.isArray(e)?(e.forEach((n,i)=>{if(i>=this.outputChannels)return;let s=this.setOutputRouting(i,n);s.ignored.length>0&&t.push(`Bus ${i+1}: canales ${s.ignored.map(a=>a+1).join(", ")} ignorados`)}),{warnings:t}):{warnings:["Invalid matrix format"]}}forcePhysicalChannels(e,t=null,n=!1){if(!this.audioCtx)return{success:!1,channels:2};let i=this.physicalChannels;if(this.physicalChannels=e,this.physicalChannelLabels=t||this._generateChannelLabels(e),this._skipDestinationConnect=n,n){this._outputRoutingMatrix=[];for(let s=0;s<this.outputChannels;s++)this._outputRoutingMatrix[s]=Array(e).fill(0),s<e&&(this._outputRoutingMatrix[s][s]=1);ae.info(`Configured 1:1 routing for ${e} channels`)}return this.isRunning&&e!==i&&(ae.info(`Forcing physical channels: ${i} \u2192 ${e}${n?" (skip destination)":""}`),this._rebuildOutputArchitecture(e),this._onPhysicalChannelsChange&&this._onPhysicalChannelsChange(e,this.physicalChannelLabels)),{success:!0,channels:e}}async setOutputDevice(e){if(!this.audioCtx)return{success:!1,channels:2};if(typeof this.audioCtx.setSinkId=="function")try{await this.audioCtx.setSinkId(e==="default"?"":e),ae.info("Output device changed to:",e);let t=await this._detectPhysicalChannels();return ae.info("Detected physical channels:",t),{success:!0,channels:t}}catch(t){return ae.warn("Failed to change output device:",t),{success:!1,channels:this.physicalChannels}}return ae.warn("setSinkId not supported in this browser"),{success:!1,channels:this.physicalChannels}}async _detectPhysicalChannels(){if(!this.audioCtx)return 2;let e=this.audioCtx.destination.maxChannelCount||2,t=this.physicalChannels;return this.physicalChannels=e,this.physicalChannelLabels=this._generateChannelLabels(e),e!==t&&this.isRunning&&(ae.info(`Channel count changed: ${t} \u2192 ${e}`),this._rebuildOutputArchitecture(e),this._onPhysicalChannelsChange&&this._onPhysicalChannelsChange(e,this.physicalChannelLabels)),e}_generateChannelLabels(e){let t={2:["L","R"],4:["FL","FR","RL","RR"],6:["FL","FR","C","LFE","RL","RR"],8:["FL","FR","C","LFE","RL","RR","SL","SR"]};return t[e]?t[e]:Array.from({length:e},(n,i)=>`Ch${i+1}`)}_rebuildOutputArchitecture(e){let t=this.audioCtx;if(t){ae.debug(`Rebuilding output architecture for ${e} channels`),this.merger&&this.merger.disconnect(),this.masterGains?.forEach(n=>n?.disconnect()),this.masterGains=[];for(let n=0;n<e;n++){let i=t.createGain();i.gain.value=this.muted?0:this.masterBaseGain,this.masterGains.push(i)}this.masterL=this.masterGains[0]||null,this.masterR=this.masterGains[1]||null,this.merger=t.createChannelMerger(e),this.masterGains.forEach((n,i)=>{n.connect(this.merger,0,i)}),this._skipDestinationConnect?ae.debug("Skipping destination connection (external routing)"):this.merger.connect(t.destination),this._rebuildBusConnections(e),this._rebuildStereoBusConnections(e)}}_rebuildBusConnections(e){let t=this.audioCtx;t&&(this.outputBuses.forEach((n,i)=>{n.channelGains?.forEach(s=>s?.disconnect()),n.channelGains=[];for(let s=0;s<e;s++){let a=t.createGain(),r=this._outputRoutingMatrix?.[i]?.[s]??0;a.gain.value=r,n.dcBlockerOut.connect(a),a.connect(this.masterGains[s]),n.channelGains.push(a)}}),this.outputBuses[0]&&(this.bus1L=this.outputBuses[0].channelGains?.[0]||null,this.bus1R=this.outputBuses[0].channelGains?.[1]||null),this.outputBuses[1]&&(this.bus2L=this.outputBuses[1].channelGains?.[0]||null,this.bus2R=this.outputBuses[1].channelGains?.[1]||null))}_rebuildStereoBusConnections(e){let t=this.audioCtx;if(!t||!this.stereoBusOutputs?.length)return;if(this._stereoBusRoutingMatrix)for(let i=0;i<4;i++){let s=this._stereoBusRoutingMatrix[i]||[];this._stereoBusRoutingMatrix[i]=Array.from({length:e},(a,r)=>s[r]??0)}let n=0;for(let i of["A","B"]){let s=this.stereoBuses[i];if(!s)continue;let a=i==="A"?0:2;s.channelGainsL?.forEach(c=>c?.disconnect());let r=[];for(let c=0;c<e;c++){let d=t.createGain();d.gain.value=this._stereoBusRoutingMatrix?.[a]?.[c]??0,s.outputL.connect(d),d.connect(this.masterGains[c]),r.push(d)}s.channelGainsL=r,this.stereoBusOutputs[n]&&(this.stereoBusOutputs[n].channelGains=r),n++,s.channelGainsR?.forEach(c=>c?.disconnect());let l=[];for(let c=0;c<e;c++){let d=t.createGain();d.gain.value=this._stereoBusRoutingMatrix?.[a+1]?.[c]??0,s.outputR.connect(d),d.connect(this.masterGains[c]),l.push(d)}s.channelGainsR=l,this.stereoBusOutputs[n]&&(this.stereoBusOutputs[n].channelGains=l),n++}ae.info(`Stereo bus connections rebuilt for ${e} channels`)}onPhysicalChannelsChange(e){this._onPhysicalChannelsChange=e}getPhysicalChannelInfo(){return{count:this.physicalChannels,labels:[...this.physicalChannelLabels]}}getOutputBusNode(e){return this.outputBuses[e]?.input||null}connectNodeToOutput(e,t){let n=this.getOutputBusNode(e);return!n||!t?null:(t.connect(n),n)}setBusLevel(e,t){let n=e-1;this.setOutputLevel(n,t)}setBusPan(e,t){let n=e-1;this.setOutputPan(n,t)}addModule(e){this.modules.push(e)}findModule(e){return this.modules.find(t=>t.id===e)||null}setMute(e){if(this.muted=e,!this.audioCtx)return;let t=this.muted?0:this.masterBaseGain;this.masterGains&&this.masterGains.length>0?this.masterGains.forEach(n=>{n&&Me(n.gain,t,this.audioCtx)}):(this.masterL&&Me(this.masterL.gain,t,this.audioCtx),this.masterR&&Me(this.masterR.gain,t,this.audioCtx))}toggleMute(){this.setMute(!this.muted)}async _loadWorklet(){return this._workletLoadPromise?this._workletLoadPromise:this.audioCtx?(this._workletLoadPromise=(async()=>{try{let e=["./assets/js/worklets/synthOscillator.worklet.js","./assets/js/worklets/scopeCapture.worklet.js","./assets/js/worklets/noiseGenerator.worklet.js","./assets/js/worklets/cvThermalSlew.worklet.js","./assets/js/worklets/cvSoftClip.worklet.js","./assets/js/worklets/vcaProcessor.worklet.js","./assets/js/worklets/outputFilter.worklet.js","./assets/js/worklets/dcBlocker.worklet.js"];await Promise.all(e.map(t=>this.audioCtx.audioWorklet.addModule(t))),this.workletReady=!0,ae.info("All worklets loaded:",e.length),this._initFilterNodes(),this._initDCBlockerNodes()}catch(e){ae.error("Failed to load worklet:",e),this.workletReady=!1,ut("worklet_fail",{message:e?.message||String(e)})}})(),this._workletLoadPromise):Promise.resolve()}_initFilterNodes(){let e=this.audioCtx;if(!e||!this.outputBuses.length)return;let t=Ze.audio.filter;for(let n=0;n<this.outputBuses.length;n++){let i=this.outputBuses[n];if(!(!i||i.filterNode))try{let s=new AudioWorkletNode(e,"output-filter",{channelCount:1,channelCountMode:"explicit",parameterData:{filterPosition:0},processorOptions:{capacitance:t.capacitance,potResistance:t.potResistance}});We(s,`output-filter[bus ${n}]`),i.filterGain.disconnect(i.muteNode),i.filterGain.connect(s),s.connect(i.muteNode),i.filterNode=s;let a=this.outputFilters[n]/5;Math.abs(a)>.001&&this._applyFilterValue(n,a)}catch(s){ae.error(`Failed to create filter node for bus ${n}:`,s)}}}_initDCBlockerNodes(){let e=this.audioCtx;if(!e||!this.outputBuses.length)return;let t=Ze.audio.dcBlocker;for(let n=0;n<this.outputBuses.length;n++){let i=this.outputBuses[n];if(!(!i||i.dcBlockerWorklet))try{let s=new AudioWorkletNode(e,"dc-blocker",{channelCount:1,channelCountMode:"explicit",parameterData:{cutoffFrequency:t.cutoffFrequency}});We(s,`dc-blocker[bus ${n}]`),i.muteNode.disconnect(i.dcBlockerOut),i.muteNode.connect(s),s.connect(i.dcBlockerOut),i.dcBlockerWorklet=s}catch(s){ae.error(`Failed to create DC blocker node for bus ${n}:`,s)}}}async ensureWorkletReady(){return this.workletReady?!0:(this.audioCtx||this.start(),this._workletLoadPromise||this._loadWorklet(),this._workletLoadPromise?(await this._workletLoadPromise,this.workletReady):!1)}createSynthOscillator(e={}){if(!this.audioCtx||!this.workletReady)return ae.warn("Worklet not ready, cannot create SynthOscillator"),null;let{waveform:t="pulse",frequency:n=440,pulseWidth:i=.5,symmetry:s=.5,gain:a=1}=e,r=new AudioWorkletNode(this.audioCtx,"synth-oscillator",{numberOfInputs:1,numberOfOutputs:1,outputChannelCount:[1],channelCount:1,channelCountMode:"explicit",processorOptions:{waveform:t}});return We(r,"synth-oscillator[single]"),r.parameters.get("frequency").value=n,r.parameters.get("pulseWidth").value=i,r.parameters.get("symmetry").value=s,r.parameters.get("gain").value=a,r.setFrequency=(l,c=0)=>{let d=r.parameters.get("frequency"),h=this.audioCtx.currentTime;d.cancelScheduledValues(h),c>0?d.setTargetAtTime(l,h,c/3):d.setValueAtTime(l,h)},r.setPulseWidth=(l,c=.01)=>{let d=r.parameters.get("pulseWidth"),h=this.audioCtx.currentTime;d.cancelScheduledValues(h),d.setTargetAtTime(Math.max(.01,Math.min(.99,l)),h,c)},r.setSymmetry=(l,c=.01)=>{let d=r.parameters.get("symmetry"),h=this.audioCtx.currentTime;d.cancelScheduledValues(h),d.setTargetAtTime(Math.max(.01,Math.min(.99,l)),h,c)},r.setGain=(l,c=.01)=>{let d=r.parameters.get("gain"),h=this.audioCtx.currentTime;d.cancelScheduledValues(h),d.setTargetAtTime(l,h,c)},r.setWaveform=l=>{r.port.postMessage({type:"setWaveform",waveform:l})},r.resetPhase=()=>{r.port.postMessage({type:"resetPhase"})},r.stop=()=>{r.port.postMessage({type:"stop"})},r}createMultiOscillator(e={}){if(!this.audioCtx||!this.workletReady)return ae.warn("Worklet not ready, cannot create MultiOscillator"),null;let{frequency:t=10,pulseWidth:n=.5,symmetry:i=.5,sineLevel:s=0,sawLevel:a=0,triLevel:r=0,pulseLevel:l=0,sineShapeAttenuation:c=1,sinePurity:d=.7,saturationK:h=1.55,maxOffset:p=.85,smoothingTime:m=vt.FAST_RAMP_TIME,moduleSlewCutoff:g=2e4,moduleSlewEnabled:_=!0}=e,y=new AudioWorkletNode(this.audioCtx,"synth-oscillator",{numberOfInputs:1,numberOfOutputs:2,outputChannelCount:[1,1],channelCount:1,channelCountMode:"explicit",processorOptions:{mode:"multi",sineShapeAttenuation:c,sinePurity:d,saturationK:h,maxOffset:p,moduleSlewCutoff:g,moduleSlewEnabled:_}});We(y,"synth-oscillator[multi]"),y.parameters.get("frequency").value=t,y.parameters.get("pulseWidth").value=n,y.parameters.get("symmetry").value=i,y.parameters.get("sineLevel").value=s,y.parameters.get("sawLevel").value=a,y.parameters.get("triLevel").value=r,y.parameters.get("pulseLevel").value=l;let f=this.audioCtx;return y.setFrequency=(b,E=0)=>{let w=y.parameters.get("frequency"),S=f.currentTime;w.cancelScheduledValues(S),E>0?w.setTargetAtTime(b,S,E/3):w.setValueAtTime(b,S)},y.setPulseWidth=(b,E=m)=>{let w=y.parameters.get("pulseWidth"),S=f.currentTime;w.cancelScheduledValues(S),w.setTargetAtTime(Math.max(.01,Math.min(.99,b)),S,E)},y.setSymmetry=(b,E=m)=>{let w=y.parameters.get("symmetry"),S=f.currentTime;w.cancelScheduledValues(S),w.setTargetAtTime(Math.max(.01,Math.min(.99,b)),S,E)},y.setSineLevel=(b,E=m)=>{let w=y.parameters.get("sineLevel"),S=f.currentTime;w.cancelScheduledValues(S),w.setTargetAtTime(b,S,E)},y.setSawLevel=(b,E=m)=>{let w=y.parameters.get("sawLevel"),S=f.currentTime;w.cancelScheduledValues(S),w.setTargetAtTime(b,S,E)},y.setTriLevel=(b,E=m)=>{let w=y.parameters.get("triLevel"),S=f.currentTime;w.cancelScheduledValues(S),w.setTargetAtTime(b,S,E)},y.setPulseLevel=(b,E=m)=>{let w=y.parameters.get("pulseLevel"),S=f.currentTime;w.cancelScheduledValues(S),w.setTargetAtTime(b,S,E)},y.resetPhase=()=>{y.port.postMessage({type:"resetPhase"})},y.stop=()=>{y.port.postMessage({type:"stop"})},y.connectSync=b=>{b.connect(y,0,0)},y.setSineShapeAttenuation=b=>{y.port.postMessage({type:"setSineShapeAttenuation",value:b})},y.setSinePurity=b=>{y.port.postMessage({type:"setSinePurity",value:b})},y.setSaturationK=b=>{y.port.postMessage({type:"setSaturationK",value:b})},y.setMaxOffset=b=>{y.port.postMessage({type:"setMaxOffset",value:b})},y}async suspendDSP(){if(this.dspEnabled=!1,typeof localStorage<"u"&&localStorage.setItem(v.DSP_ENABLED,"false"),this.audioCtx&&this.audioCtx.state!=="closed")try{await this.audioCtx.suspend(),ae.info("DSP suspended (AudioContext frozen)")}catch(e){ae.warn("Error suspending AudioContext:",e)}}async resumeDSP(){if(this.dspEnabled=!0,typeof localStorage<"u"&&localStorage.setItem(v.DSP_ENABLED,"true"),this.audioCtx&&this.audioCtx.state==="suspended")try{await this.audioCtx.resume(),ae.info("DSP resumed (AudioContext running)")}catch(e){ae.warn("Error resuming AudioContext:",e)}}async closeAudioContext(){if(this.audioCtx){for(let e of this.modules)if(e.stop)try{e.stop()}catch(t){ae.warn("Error stopping module:",t)}try{await this.audioCtx.close(),ae.info("AudioContext closed")}catch(e){ae.warn("Error closing AudioContext:",e)}this.audioCtx=null,this.workletReady=!1,this._workletLoadPromise=null,this.isRunning=!1,this.outputBuses=[],this.masterGains=[]}}getLatencyInfo(){let e=this.audioCtx;return e?{baseLatency:e.baseLatency??null,outputLatency:e.outputLatency??null}:{baseLatency:null,outputLatency:null}}},wt=class{constructor(e,t,n){this.engine=e,this.id=t,this.name=n,this.inputs=[],this.outputs=[],this._isDormant=!1,this._inputVoltageLimit=ll,this._softClipEnabled=On.softClipEnabled}getAudioCtx(){return this.engine.audioCtx}setInputVoltageLimit(e){this._inputVoltageLimit=e}setSoftClipEnabled(e){this._softClipEnabled=e}applyInputClipping(e,t=1){if(!this._softClipEnabled)return e;let n=cl(e),i=Ca(n,this._inputVoltageLimit,t);return ul(i)}applyVoltageClipping(e,t=1){return this._softClipEnabled?Ca(e,this._inputVoltageLimit,t):e}get isDormant(){return this._isDormant}setDormant(e){this._isDormant!==e&&(this._isDormant=e,this._onDormancyChange(e))}_onDormancyChange(e){}};function Nn(o){let e=o?.grid?.coordSystem?.rowBase??67,t=o?.grid?.coordSystem?.colBase??1,n=o?.grid?.rows??63,i=o?.grid?.cols??67,s=Array.isArray(o?.ui?.hiddenRows0)?o.ui.hiddenRows0.filter(Number.isFinite):(o?.ui?.hiddenRowsSynth||[]).filter(Number.isFinite).map(b=>b-e).filter(b=>b>=0),a=Array.isArray(o?.ui?.hiddenCols0)?o.ui.hiddenCols0.filter(Number.isFinite):(o?.ui?.hiddenColsSynth||[]).filter(Number.isFinite).map(b=>b-t).filter(b=>b>=0),r=new Set(s),l=[];for(let b=0;b<n;b+=1)r.has(b)||l.push(b);let c=b=>{let E=b-e;return!Number.isFinite(E)||E<0?null:l[E]??null},d=new Set(a),h=[];for(let b=0;b<i;b+=1)d.has(b)||h.push(b);let p=b=>{let E=b-t;return!Number.isFinite(E)||E<0?null:h[E]??null},m=new Map,g=new Map,_=new Map;for(let b of o?.sources||[]){let E=b?.rowSynth,w=b?.source;if(!Number.isFinite(E)||!w)continue;let S=c(E);if(S!=null&&(_.set(S,w),w.kind==="panel3Osc")){let T=w.oscIndex,A=w.channelId||"sineSaw";Number.isFinite(T)&&(m.set(S,T),g.set(S,A))}}let y=new Map,f=new Map;for(let b of o?.destinations||[]){let E=b?.colSynth,w=b?.dest;if(!Number.isFinite(E)||!w)continue;let S=p(E);if(S!=null&&(f.set(S,w),w.kind==="outputBus"&&Number.isFinite(w.bus))){let T=w.bus-1;T>=0&&y.set(S,T)}}return{rowMap:m,colMap:y,destMap:f,channelMap:g,sourceMap:_,hiddenRows:s,hiddenCols:a,rowBase:e,colBase:t}}be();var rm=W("Conversions");function Dn(o,e={}){let{cvVoltage:t=0,rangeLow:n=!1,trackingConfig:i={}}=e,{alpha:s=.01,linearHalfRange:a=2.5}=i,l=5+(o-5)/.95+t,c=Fu(l,{referenceVoltage:5,linearHalfRange:a,alpha:s}),d=261*Math.pow(2,c-5);n&&(d=d/rl);let h=n?_a.LO:_a.HI;return d=Math.max(h.min,Math.min(h.max,d)),d}function Fu(o,e={}){let{referenceVoltage:t=5,linearHalfRange:n=2.5,alpha:i=.01}=e,s=o-t,a=Math.abs(s);if(a<=n)return o;let r=a-n,l=1-i*r*r;return t+s*l}function Vu(o=null,e=!1){let t=o||qe?.defaults?.knobs||{},n=t.pulseLevel?.initial??0,i=t.pulseWidth?.initial??.5,s=t.sineLevel?.initial??0,a=t.sineSymmetry?.initial??.5,r=t.triangleLevel?.initial??0,l=t.sawtoothLevel?.initial??0,c=t.frequency?.initial??5;return{freq:Dn(c,{rangeLow:e}),oscLevel:s,sawLevel:l,triLevel:r,pulseLevel:n,pulseWidth:i,sineSymmetry:a}}function Bn(o,e,t={}){o.state=o.state||[];let n=o.state[e];return n||(n=Vu(t.knobsConfig,t.rangeLow),o.state[e]=n),n}function xa(o,e,t){if(!o||!e||!t)return;let n=t.currentTime;if(o.osc&&Number.isFinite(e.freq))try{o._useWorklet&&o.osc.setFrequency?o.osc.setFrequency(e.freq):o.osc.frequency&&(o.osc.frequency.cancelScheduledValues(n),o.osc.frequency.setValueAtTime(e.freq,n))}catch{}if(o.sawOsc&&o.sawOsc.frequency&&Number.isFinite(e.freq))try{o.sawOsc.frequency.cancelScheduledValues(n),o.sawOsc.frequency.setValueAtTime(e.freq,n)}catch{}if(o.gain&&o.gain.gain&&Number.isFinite(e.oscLevel))try{o.gain.gain.cancelScheduledValues(n),o.gain.gain.setValueAtTime(e.oscLevel,n)}catch{}if(o.sawGain&&o.sawGain.gain&&Number.isFinite(e.sawLevel))try{o.sawGain.gain.cancelScheduledValues(n),o.sawGain.gain.setValueAtTime(e.sawLevel,n)}catch{}if(o.triOsc&&o.triOsc.frequency&&Number.isFinite(e.freq))try{o.triOsc.frequency.cancelScheduledValues(n),o.triOsc.frequency.setValueAtTime(e.freq,n)}catch{}if(o.triGain&&o.triGain.gain&&Number.isFinite(e.triLevel))try{o.triGain.gain.cancelScheduledValues(n),o.triGain.gain.setValueAtTime(e.triLevel,n)}catch{}if(o.pulseOsc&&Number.isFinite(e.freq))try{o._useWorklet&&o.pulseOsc.setFrequency?o.pulseOsc.setFrequency(e.freq):o.pulseOsc.frequency&&(o.pulseOsc.frequency.cancelScheduledValues(n),o.pulseOsc.frequency.setValueAtTime(e.freq,n))}catch{}if(o.pulseGain&&o.pulseGain.gain&&Number.isFinite(e.pulseLevel))try{o.pulseGain.gain.cancelScheduledValues(n),o.pulseGain.gain.setValueAtTime(e.pulseLevel,n)}catch{}}be();Te();var pl=W("DormancyManager"),$s=class{constructor(e){this.app=e;let t=localStorage.getItem(v.DORMANCY_ENABLED);this._enabled=t===null?!0:t==="true",this._moduleStates=new Map,this._pendingUpdate=null,this._debugIndicators=localStorage.getItem(v.DORMANCY_DEBUG)==="true",pl.info(`Initialized (enabled: ${this._enabled}, debug: ${this._debugIndicators})`)}setEnabled(e){this._enabled!==e&&(this._enabled=e,localStorage.setItem(v.DORMANCY_ENABLED,String(e)),pl.info(`Dormancy system ${e?"enabled":"disabled"}`),e?this.updateAllStates():this._wakeAllModules())}isEnabled(){return this._enabled}setDebugIndicators(e){this._debugIndicators=e,localStorage.setItem(v.DORMANCY_DEBUG,String(e)),this._applyDebugIndicators()}_applyDebugIndicators(){this._enabled&&this._debugIndicators&&this._showCurrentStateToast()}_showCurrentStateToast(){let e=this._getPanel5Connections(),t=this._getPanel6Connections(),n=new Set;e.forEach(c=>{c.source?.kind==="panel3Osc"&&n.add(c.source.oscIndex)});let i=e.some(c=>c.dest?.kind==="oscilloscope")||t.some(c=>c.dest?.kind==="oscilloscope"),s=e.some(c=>c.source?.kind==="noiseGen"),a=e.some(c=>c.source?.kind==="inputAmp"),r=new Set;e.forEach(c=>{c.dest?.kind==="outputBus"&&r.add(c.dest.bus)});let l=[];l.push(`\u{1F50C} OSCs: ${n.size}/9`),l.push(`\u{1F50A} Outputs: ${r.size}/8`),i&&l.push("\u{1F4FA} Scope"),s&&l.push("\u{1F509} Noise"),a&&l.push("\u{1F3A4} Input"),se(`Dormancy: ${l.join(" | ")}`,3e3)}hasDebugIndicators(){return this._debugIndicators}onConnectionChange(){this._enabled&&(this._pendingUpdate||(this._pendingUpdate=requestAnimationFrame(()=>{this._pendingUpdate=null,this.updateAllStates()})))}flushPendingUpdate(){this._enabled&&(this._pendingUpdate&&(cancelAnimationFrame(this._pendingUpdate),this._pendingUpdate=null),this.updateAllStates())}updateAllStates(){if(!this._enabled)return;this._pendingChanges={woke:[],slept:[]};let e=this._getPanel5Connections(),t=this._getPanel6Connections();for(let s=0;s<9;s++){let a=e.some(l=>l.source?.kind==="panel3Osc"&&l.source?.oscIndex===s);this._findModule(`osc-${s}`)&&this._setModuleDormant(`osc-${s}`,!a)}for(let s=0;s<2;s++){let a=e.some(r=>r.source?.kind==="noiseGen"&&r.source?.index===s);this._setModuleDormant(`noise-${s+1}`,!a)}let n=e.some(s=>s.source?.kind==="inputAmp");this._setModuleDormant("input-amplifiers",!n);let i=e.some(s=>s.dest?.kind==="oscilloscope")||t.some(s=>s.dest?.kind==="oscilloscope");this._setModuleDormant("oscilloscope",!i);for(let s=0;s<8;s++){let a=e.some(c=>c.dest?.kind==="outputBus"&&c.dest?.bus===s+1),r=t.some(c=>c.dest?.kind==="outputBus"&&c.dest?.bus===s+1),l=a||r;this._setModuleDormant(`output-channel-${s+1}`,!l)}for(let s of["left","right"]){let a=t.some(r=>r.source?.kind==="joystick"&&r.source?.side===s);this._setModuleDormant(`joystick-${s}`,!a)}this._showConsolidatedToast()}_getPanel5Connections(){let e=this.app._panel3Routing;if(!e?.connections)return[];let t=[];for(let n of Object.keys(e.connections)){let[i,s]=n.split(":"),a=parseInt(i,10),r=parseInt(s,10),l=e.sourceMap?.get(a),c=e.destMap?.get(r);(l||c)&&t.push({source:l,dest:c,key:n})}return t}_getPanel6Connections(){let e=this.app._panel6Routing;if(!e?.connections)return[];let t=[];for(let n of Object.keys(e.connections)){let[i,s]=n.split(":"),a=parseInt(i,10),r=parseInt(s,10),l=e.sourceMap?.get(a),c=e.destMap?.get(r);(l||c)&&t.push({source:l,dest:c,key:n})}return t}_setModuleDormant(e,t){if(this._moduleStates.get(e)?.isDormant===t)return;this._moduleStates.set(e,{isDormant:t});let i=this._findModule(e);i?.setDormant&&(i.setDormant(t),this._debugIndicators&&this._pendingChanges&&(t?this._pendingChanges.slept.push(e):this._pendingChanges.woke.push(e)))}_showConsolidatedToast(){if(!this._debugIndicators||!this._pendingChanges)return;let{woke:e,slept:t}=this._pendingChanges;if(e.length===0&&t.length===0)return;let n=[];e.length>0&&n.push(`\u{1F50A} ${e.join(", ")}`),t.length>0&&n.push(`\u{1F4A4} ${t.join(", ")}`),se(n.join(" | "),2e3),this._pendingChanges=null}_findModule(e){if(e.startsWith("osc-")){let t=parseInt(e.split("-")[1],10);return this.app._panelAudios?.[3]?.nodes?.[t]}if(e==="noise-1")return this.app._panel3LayoutData?.noiseAudioModules?.noise1;if(e==="noise-2")return this.app._panel3LayoutData?.noiseAudioModules?.noise2;if(e==="oscilloscope")return this.app.oscilloscope;if(e==="input-amplifiers")return this.app.inputAmplifiers;if(e.startsWith("output-channel-")){let t=parseInt(e.split("-")[2],10)-1;return this.app.engine?.outputBuses?.[t]}return e==="joystick-left"?this.app._joystickModules?.left:e==="joystick-right"?this.app._joystickModules?.right:this.app.engine?.findModule?.(e)??null}_wakeAllModules(){for(let[e]of this._moduleStates)this._setModuleDormant(e,!1);this._moduleStates.clear()}isDormant(e){return this._moduleStates.get(e)?.isDormant??!1}getStats(){let e=0,t=0;for(let[,n]of this._moduleStates)n.isDormant?e++:t++;return{total:this._moduleStates.size,dormant:e,active:t}}};be();Te();var _t=W("SessionManager"),La=class{constructor(){this._dirty=!1,this._autoSaveTimer=null,this._applyingPatch=!1,this._serializeCallback=null}setSerializeCallback(e){this._serializeCallback=e}configureAutoSave(e){this._autoSaveTimer&&(clearInterval(this._autoSaveTimer),this._autoSaveTimer=null),e>0?(this._autoSaveTimer=setInterval(()=>{this._performAutoSave()},e),_t.info(` Autosave configured: every ${e/1e3}s`)):_t.info(" Autosave disabled")}_performAutoSave(){if(!(!this._dirty||!this._serializeCallback))try{let e=this._serializeCallback();localStorage.setItem(v.LAST_STATE,JSON.stringify({timestamp:Date.now(),state:e,isAutoSave:!0})),_t.info(" State auto-saved")}catch(e){_t.warn(" Autosave failed:",e)}}saveOnExit(){if(!this._dirty||!this._serializeCallback){_t.info(" No changes to save on exit");return}try{let e=this._serializeCallback();localStorage.setItem(v.LAST_STATE,JSON.stringify({timestamp:Date.now(),state:e,savedOnExit:!0,isAutoSave:!0})),_t.info(" State saved on exit")}catch(e){_t.warn(" Save on exit failed:",e)}}markDirty(){this._applyingPatch||this._dirty||(this._dirty=!0,_t.info(" Session marked as dirty"))}markClean(){this._dirty=!1,_t.info(" Session marked as clean")}isDirty(){return this._dirty}applyingPatch(e){return e!==void 0&&(this._applyingPatch=e),this._applyingPatch}clearLastState(){localStorage.removeItem(v.LAST_STATE),this._dirty=!1,_t.info(" Last state cleared")}getLastState(){try{let e=localStorage.getItem(v.LAST_STATE);return e?JSON.parse(e):null}catch(e){return _t.warn(" Error reading last state:",e),null}}hasLastState(){return!!localStorage.getItem(v.LAST_STATE)}setRestoreCallback(e){this._restoreCallback=e}async restoreLastState(){let e=this.getLastState();if(!e?.state||!this._restoreCallback)return;let{state:t,timestamp:n}=e;setTimeout(async()=>{try{await this._restoreCallback({modules:t.modules||t}),_t.info(` Previous state restored (saved at ${new Date(n).toLocaleString()})`)}catch(i){_t.error("Error restaurando estado previo:",i),this.clearLastState()}},500)}async maybeRestoreLastState(e){let{getAskBeforeRestore:t,setAskBeforeRestore:n,showConfirmDialog:i,getRememberedChoice:s}=e,a=this.getLastState();if(!a?.state)return;if(!(a.isAutoSave!==!1)){this.restoreLastState();return}if(!t()){let{skip:d,choice:h}=s("restore-last-session");if(d){h&&this.restoreLastState();return}this.restoreLastState();return}let c=await i();c.remember&&n(!1),c.confirmed?this.restoreLastState():this.clearLastState()}},$e=new La;be();var Ht=W("UndoRedo"),Gu=50;var Aa=class{constructor(){this._undoStack=[],this._redoStack=[],this._currentSnapshot=null,this._serializeFn=null,this._applyFn=null,this._applying=!1,this._listeners=new Set}init(e,t){this._serializeFn=e,this._applyFn=t,this._captureCurrentAsBase(),Ht.info("Inicializado con estado base")}_captureCurrentAsBase(){if(this._serializeFn)try{this._currentSnapshot=JSON.stringify(this._serializeFn())}catch(e){Ht.error("Error capturando estado base:",e)}}commitInteraction(){if(!this._applying&&this._serializeFn)try{let e=JSON.stringify(this._serializeFn());this._currentSnapshot&&this._currentSnapshot!==e&&(this._undoStack.push(this._currentSnapshot),this._undoStack.length>Gu&&this._undoStack.shift(),this._redoStack.length=0,Ht.info(`Cambio registrado (undo: ${this._undoStack.length})`)),this._currentSnapshot=e,this._notifyListeners()}catch(e){Ht.error("Error registrando interacci\xF3n:",e)}}undo(){if(!this.canUndo||!this._applyFn)return!1;this._applying=!0;try{this._redoStack.push(this._currentSnapshot);let e=this._undoStack.pop();this._currentSnapshot=e;let t=JSON.parse(e);return this._applyFn(t),Ht.info(`Undo aplicado (undo: ${this._undoStack.length}, redo: ${this._redoStack.length})`),this._notifyListeners(),!0}catch(e){return Ht.error("Error en undo:",e),!1}finally{this._applying=!1}}redo(){if(!this.canRedo||!this._applyFn)return!1;this._applying=!0;try{this._undoStack.push(this._currentSnapshot);let e=this._redoStack.pop();this._currentSnapshot=e;let t=JSON.parse(e);return this._applyFn(t),Ht.info(`Redo aplicado (undo: ${this._undoStack.length}, redo: ${this._redoStack.length})`),this._notifyListeners(),!0}catch(e){return Ht.error("Error en redo:",e),!1}finally{this._applying=!1}}get canUndo(){return this._undoStack.length>0}get canRedo(){return this._redoStack.length>0}get undoCount(){return this._undoStack.length}get redoCount(){return this._redoStack.length}clear(){this._undoStack.length=0,this._redoStack.length=0,this._captureCurrentAsBase(),this._notifyListeners(),Ht.info("Historial limpiado")}onChange(e){return this._listeners.add(e),()=>this._listeners.delete(e)}_notifyListeners(){let e=this.canUndo,t=this.canRedo;this._listeners.forEach(n=>{try{n(e,t)}catch(i){Ht.error("Error en listener:",i)}})}get isApplying(){return this._applying}},an=new Aa;be();be();Te();Pn();var pe=W("RecordingEngine"),oi={wav:{extension:"wav",mimeType:"audio/wav",lossy:!1,maxTracks:12},"webm-opus":{extension:"webm",mimeType:"audio/webm;codecs=opus",lossy:!0,maxTracks:2}},ml="webm-opus",qu=192e3,ai=class{constructor(e){this.engine=e,this.isRecording=!1,this.workletNode=null,this.workletReady=!1,this._workletLoadPromise=null,this._trackBuffers=[],this._sampleRate=44100,this._mediaRecorder=null,this._mediaChunks=[],this._mediaStreamDest=null,this._stereoSourceCount=4,this._individualOutputCount=e?.outputChannels||8,this._totalSourceCount=this._stereoSourceCount+this._individualOutputCount,this._trackCount=this._loadTrackCount(),this._format=this._loadFormat(),this._bitrate=this._loadBitrate(),this._routingMatrix=this._loadRoutingMatrix(),this._trackMixers=[],this._trackMerger=null,this._outputGains=[],this.onRecordingStart=null,this.onRecordingStop=null}_loadTrackCount(){let e=localStorage.getItem(v.RECORDING_TRACKS);if(e){let t=parseInt(e,10);if(t>=1&&t<=12)return t}return 2}_saveTrackCount(e){localStorage.setItem(v.RECORDING_TRACKS,String(e))}_loadFormat(){let e=localStorage.getItem(v.RECORDING_FORMAT);return e&&oi[e]?e:ml}_saveFormat(e){localStorage.setItem(v.RECORDING_FORMAT,e)}_loadBitrate(){let e=localStorage.getItem(v.RECORDING_BITRATE);if(e){let t=parseInt(e,10);if(t>0)return t}return qu}_saveBitrate(e){localStorage.setItem(v.RECORDING_BITRATE,String(e))}get format(){return this._format}set format(e){if(!oi[e])return;this._format=e,this._saveFormat(e);let t=oi[e].maxTracks;this._trackCount>t&&(this.trackCount=t)}get bitrate(){return this._bitrate}set bitrate(e){this._bitrate=e,this._saveBitrate(e)}get formatInfo(){return oi[this._format]||oi[ml]}static get FORMATS(){return oi}_loadRoutingMatrix(){let e=localStorage.getItem(v.RECORDING_ROUTING);if(e)try{let t=JSON.parse(e);if(Array.isArray(t))return t}catch{pe.warn(" Invalid routing matrix in storage")}return this._createDefaultRoutingMatrix()}_createDefaultRoutingMatrix(){let e=[];for(let t=0;t<this._stereoSourceCount;t++){let n=Array(this._trackCount).fill(0),i=t%2;i<this._trackCount&&(n[i]=1),e.push(n)}for(let t=0;t<this._individualOutputCount;t++)e.push(Array(this._trackCount).fill(0));return e}_saveRoutingMatrix(){localStorage.setItem(v.RECORDING_ROUTING,JSON.stringify(this._routingMatrix))}get trackCount(){return this._trackCount}set trackCount(e){let t=this.formatInfo.maxTracks,n=Math.max(1,Math.min(Math.min(12,t),e));if(n!==this._trackCount){this._trackCount=n,this._saveTrackCount(n);for(let i=0;i<this._totalSourceCount;i++)if(this._routingMatrix[i]){for(;this._routingMatrix[i].length<n;)this._routingMatrix[i].push(0);this._routingMatrix[i]=this._routingMatrix[i].slice(0,n)}else if(this._routingMatrix[i]=Array(n).fill(0),i<this._stereoSourceCount){let s=i%2;s<n&&(this._routingMatrix[i][s]=1)}this._saveRoutingMatrix(),this.workletReady&&this._rebuildRoutingGraph()}}get routingMatrix(){return this._routingMatrix}setRouting(e,t,n){if(!this._routingMatrix[e]||t<0||t>=this._trackCount)return;let i=n?1:0;if(this._routingMatrix[e][t]=i,this._saveRoutingMatrix(),this._outputGains[e]?.[t]){let s=this.engine.audioCtx;s&&this._outputGains[e][t].gain.setTargetAtTime(i,s.currentTime,.01)}}getRouting(e,t){return this._routingMatrix[e]?.[t]??0}async ensureWorkletReady(){if(this.workletReady)return;if(this._workletLoadPromise)return this._workletLoadPromise;let e=this.engine.audioCtx;if(!e)throw new Error("AudioContext not available");return this._workletLoadPromise=(async()=>{try{await e.audioWorklet.addModule("./assets/js/worklets/recordingCapture.worklet.js"),this.workletReady=!0,pe.info(" Worklet loaded")}catch(t){throw pe.error(" Failed to load worklet:",t),t}})(),this._workletLoadPromise}async _buildRoutingGraph(){let e=this.engine.audioCtx;if(!e)return;await this.ensureWorkletReady(),this._sampleRate=e.sampleRate,this._cleanupRoutingGraph();let t=e.createChannelMerger(this._trackCount);this._trackMixers=[];for(let i=0;i<this._trackCount;i++){let s=e.createGain();s.gain.value=1,s.connect(t,0,i),this._trackMixers.push(s)}this._outputGains=[];let n=[this.engine.stereoBuses?.A?.outputL,this.engine.stereoBuses?.A?.outputR,this.engine.stereoBuses?.B?.outputL,this.engine.stereoBuses?.B?.outputR];for(let i=0;i<n.length;i++){let s=n[i];if(this._outputGains[i]=[],!!s)for(let a=0;a<this._trackCount;a++){let r=e.createGain(),l=this._routingMatrix[i]?.[a]??0;r.gain.value=l,s.connect(r),r.connect(this._trackMixers[a]),this._outputGains[i][a]=r}}for(let i=0;i<this._individualOutputCount;i++){let s=this._stereoSourceCount+i;this._outputGains[s]=[];let a=this.engine.outputBuses[i]?.muteNode;if(a)for(let r=0;r<this._trackCount;r++){let l=e.createGain(),c=this._routingMatrix[s]?.[r]??0;l.gain.value=c,a.connect(l),l.connect(this._trackMixers[r]),this._outputGains[s][r]=l}}this._trackMerger=t}async _rebuildRoutingGraph(){if(this.isRecording){pe.warn(" Cannot rebuild while recording");return}await this._buildRoutingGraph()}_cleanupRoutingGraph(){for(let e of this._outputGains)if(e)for(let t of e)t&&t.disconnect();this._outputGains=[];for(let e of this._trackMixers)e&&e.disconnect();this._trackMixers=[],this._trackMerger&&(this._trackMerger.disconnect(),this._trackMerger=null),this.workletNode&&(this.workletNode.disconnect(),this.workletNode.port.onmessage=null,this.workletNode=null)}_handleSamples(e){for(let t=0;t<e.length;t++)this._trackBuffers[t]||(this._trackBuffers[t]=[]),this._trackBuffers[t].push(e[t])}async startRecording(){if(pe.info(" startRecording() called, isRecording:",this.isRecording,"format:",this._format),this.isRecording){pe.warn(" Already recording, ignoring");return}let e=this.engine.audioCtx;if(!e){pe.warn(" No AudioContext available");return}if(e.state!=="running"){pe.info(" Waiting for AudioContext to start...");try{await e.resume()}catch(t){pe.error(" Could not resume AudioContext:",t);return}}this._format==="webm-opus"?await this._startMediaRecording(e):await this._startWavRecording(e)}async _startWavRecording(e){pe.info(" Building routing graph..."),await this._buildRoutingGraph(),await this.ensureWorkletReady(),this.workletNode=new AudioWorkletNode(e,"recording-capture-processor",{numberOfInputs:1,numberOfOutputs:0,channelCount:this._trackCount,processorOptions:{channelCount:this._trackCount}}),We(this.workletNode,"recording-capture-processor"),this._trackMerger.connect(this.workletNode),this.workletNode.port.onmessage=t=>{t.data.type==="samples"&&this.isRecording?this._handleSamples(t.data.channels):t.data.type==="stopped"?(pe.info(" Worklet confirmed stop, finalizing..."),this._finalizeWavRecording()):pe.warn(" Unknown worklet message:",t.data)},this._trackBuffers=[];for(let t=0;t<this._trackCount;t++)this._trackBuffers[t]=[];this.isRecording=!0,pe.info(" Sending start command to worklet..."),this.workletNode.port.postMessage({command:"start"}),this.onRecordingStart&&this.onRecordingStart(),pe.info(" WAV recording started successfully")}async _startMediaRecording(e){pe.info(" Starting MediaRecorder (WebM/Opus)..."),await this._buildRoutingGraph(),this._mediaStreamDest=e.createMediaStreamDestination(),this._trackMerger.connect(this._mediaStreamDest);let t=this._getBestOpusMimeType();if(!t)throw pe.error(" No supported WebM/Opus MIME type found"),this._cleanupMediaRecording(),new Error("WebM/Opus recording not supported in this browser");let n={mimeType:t,audioBitsPerSecond:this._bitrate};this._mediaRecorder=new MediaRecorder(this._mediaStreamDest.stream,n),this._mediaChunks=[],this._mediaRecorder.ondataavailable=i=>{i.data.size>0&&this._mediaChunks.push(i.data)},this._mediaRecorder.onstop=()=>{pe.info(" MediaRecorder stopped, finalizing..."),this._finalizeMediaRecording()},this._mediaRecorder.onerror=i=>{pe.error(" MediaRecorder error:",i.error),this.isRecording=!1,this._cleanupMediaRecording(),this.onRecordingStop&&this.onRecordingStop(null)},this._mediaRecorder.start(1e3),this.isRecording=!0,this.onRecordingStart&&this.onRecordingStart(),pe.info(" WebM/Opus recording started successfully")}_getBestOpusMimeType(){let e=["audio/webm;codecs=opus","audio/webm","audio/ogg;codecs=opus"];for(let t of e)if(MediaRecorder.isTypeSupported(t))return pe.info(` Using MIME type: ${t}`),t;return null}stopRecording(){if(pe.info(" stopRecording() called, isRecording:",this.isRecording),!this.isRecording){pe.warn(" Not recording, ignoring");return}this.isRecording=!1,this._mediaRecorder&&this._mediaRecorder.state!=="inactive"?(pe.info(" Stopping MediaRecorder..."),this._mediaRecorder.stop()):this.workletNode?(pe.info(" Sending stop command to worklet..."),this.workletNode.port.postMessage({command:"stop"})):pe.error(" No recording mechanism to stop!")}_finalizeWavRecording(){pe.info(" Finalizing WAV recording..."),this.workletNode&&(this.workletNode.disconnect(),this.workletNode.port.onmessage=null,this.workletNode=null);let e=[],t=0;for(let n=0;n<this._trackCount;n++){let i=this._trackBuffers[n]||[];if(i.length===0){e.push(new Float32Array(0));continue}let s=i.reduce((l,c)=>l+c.length,0);n===0&&(t=s);let a=new Float32Array(s),r=0;for(let l of i)a.set(l,r),r+=l.length;e.push(a)}if(this._trackBuffers=[],t===0){pe.warn(" No audio recorded"),this.onRecordingStop&&this.onRecordingStop(null);return}try{let n=this._encodeWAV(e,this._sampleRate),s=`synthigme-${new Date().toISOString().replace(/[:.]/g,"-").slice(0,19)}.wav`;this.onRecordingStop&&this.onRecordingStop(s),pe.info(` Recording saved: ${s}`),setTimeout(()=>this._downloadBlob(n,s),100)}catch(n){pe.error(" Export failed:",n),ut("export_fail",{message:n?.message||String(n)}),this.onRecordingStop&&this.onRecordingStop(null)}}_finalizeMediaRecording(){if(pe.info(" Finalizing WebM/Opus recording..."),this._mediaChunks.length===0){pe.warn(" No audio recorded"),this._cleanupMediaRecording(),this.onRecordingStop&&this.onRecordingStop(null);return}try{let e=new Blob(this._mediaChunks,{type:this._mediaRecorder?.mimeType||"audio/webm"}),n=(this._mediaRecorder?.mimeType||"").includes("ogg")?"ogg":"webm",s=`synthigme-${new Date().toISOString().replace(/[:.]/g,"-").slice(0,19)}.${n}`;this._cleanupMediaRecording(),this.onRecordingStop&&this.onRecordingStop(s),pe.info(` Recording saved: ${s}`),setTimeout(()=>this._downloadBlob(e,s),100)}catch(e){pe.error(" Export failed:",e),ut("export_fail",{message:e?.message||String(e)}),this._cleanupMediaRecording(),this.onRecordingStop&&this.onRecordingStop(null)}}_cleanupMediaRecording(){this._mediaStreamDest&&(this._mediaStreamDest.disconnect(),this._mediaStreamDest=null),this._mediaRecorder=null,this._mediaChunks=[]}_encodeWAV(e,t){let n=e.length,i=e[0]?.length||0,s=16,a=s/8,r=n*a,l=t*r,c=i*r,h=44+c,p=new ArrayBuffer(h),m=new DataView(p);this._writeString(m,0,"RIFF"),m.setUint32(4,h-8,!0),this._writeString(m,8,"WAVE"),this._writeString(m,12,"fmt "),m.setUint32(16,16,!0),m.setUint16(20,1,!0),m.setUint16(22,n,!0),m.setUint32(24,t,!0),m.setUint32(28,l,!0),m.setUint16(32,r,!0),m.setUint16(34,s,!0),this._writeString(m,36,"data"),m.setUint32(40,c,!0);let g=44;for(let _=0;_<i;_++)for(let y=0;y<n;y++){let f=e[y]?.[_]||0,b=Math.max(-1,Math.min(1,f)),E=b<0?Math.floor(b*32768):Math.floor(b*32767);m.setInt16(g,E,!0),g+=2}return new Blob([p],{type:"audio/wav"})}_writeString(e,t,n){for(let i=0;i<n.length;i++)e.setUint8(t+i,n.charCodeAt(i))}_downloadBlob(e,t){let n=URL.createObjectURL(e),i=document.createElement("a");i.href=n,i.download=t,i.style.display="none",document.body.appendChild(i),i.click(),document.body.removeChild(i),setTimeout(()=>URL.revokeObjectURL(n),1e3)}async toggle(){this.isRecording?this.stopRecording():await this.startRecording()}};var Ra=class{constructor(e={}){let{id:t,title:n,subtitle:i}=e;this.id=t||`panel-${Date.now()}`,this.element=document.createElement("div"),this.element.className="panel",this.element.id=this.id,this.sections=new Map;let s=document.createElement("span");s.className="panel-build-version",s.textContent="",this.element.appendChild(s),n&&this.setTitle(n),i&&this.setSubtitle(i)}appendElement(e){return this.element.appendChild(e),e}setTitle(e){return this.titleEl||(this.titleEl=document.createElement("h1"),this.element.appendChild(this.titleEl)),this.titleEl.textContent=e,this.titleEl}setSubtitle(e){return this.subtitleEl||(this.subtitleEl=document.createElement("p"),this.subtitleEl.style.fontSize="0.8rem",this.subtitleEl.style.textAlign="center",this.subtitleEl.style.marginTop="0",this.element.appendChild(this.subtitleEl)),this.subtitleEl.textContent=e,this.subtitleEl}addHeaderElement(e){return e?(this.element.insertBefore(e,this.titleEl||this.element.firstChild),e):null}addSection({id:e,title:t,type:n="row",className:i}={}){if(!e)throw new Error("Section id is required");if(t){let a=document.createElement("div");a.className="section-title",a.textContent=t,this.element.appendChild(a)}let s;if(n==="matrix"){let a=document.createElement("div");a.className="matrix-container";let r=document.createElement("table");r.className="matrix",a.appendChild(r),this.element.appendChild(a),s=r}else if(n==="custom")s=document.createElement("div"),i&&(s.className=i),this.element.appendChild(s);else{let a=document.createElement("div");a.className=i||"row",this.element.appendChild(a),s=a}return s.id=e,this.sections.set(e,s),s}getSection(e){return this.sections.get(e)||null}},Hs=class{constructor(e){if(!e)throw new Error("PanelManager requires a root element");this.rootEl=e,this.panels=new Map}createPanel(e={}){let t=new Ra(e);return this.rootEl.appendChild(t.element),e.id&&this.panels.set(e.id,t),t}getPanel(e){return this.panels.get(e)||null}};var Ve=class{constructor(e={}){this.id=e.id||`module-${Date.now()}`,this.title=e.title,this.className=e.className||"",this.size=e.size||null,this.showHeader=this.title!=null&&e.showHeader!==!1,this.element=null,this.headerArea=null,this.contentArea=null,this.controlsArea=null}createElement(){let e=document.createElement("div");if(e.className=`synth-module ${this.className}`.trim(),e.id=this.id,this.size&&(e.style.width=`${this.size.width}px`,e.style.height=`${this.size.height}px`),this.showHeader){let i=document.createElement("div");i.className="synth-module__header",i.textContent=this.title,e.appendChild(i),this.headerArea=i}let t=document.createElement("div");t.className="synth-module__content",e.appendChild(t),this.contentArea=t;let n=document.createElement("div");return n.className="synth-module__controls",e.appendChild(n),this.controlsArea=n,this.element=e,e}appendToContent(e){this.contentArea&&this.contentArea.appendChild(e)}appendToControls(e){this.controlsArea&&this.controlsArea.appendChild(e)}appendToHeader(e){this.headerArea&&this.headerArea.appendChild(e)}getContentArea(){return this.contentArea}getControlsArea(){return this.controlsArea}getHeaderArea(){return this.headerArea}};function qi(o){return o.pointerType==="touch"&&(window.__synthNavGestureActive||window.__synthPipGestureActive)}function zn(){return!!(window.__synthNavGestureActive||window.__synthPipGestureActive)}var Ws=new Set,gl=!1;function vn(o){return Ws.add(o),$u(),()=>{Ws.delete(o)}}function $i(){Ws.forEach(o=>{try{o()}catch(e){console.warn("[TooltipManager] Error hiding tooltip:",e)}})}function _n(o){Ws.forEach(e=>{if(e!==o)try{e()}catch(t){console.warn("[TooltipManager] Error hiding tooltip:",t)}})}function $u(){gl||typeof document>"u"||(gl=!0,document.addEventListener("pointerdown",o=>{o.pointerType==="touch"&&o.isPrimary===!1&&$i()},{passive:!0,capture:!0}),document.addEventListener("touchmove",o=>{o.touches.length>=2&&$i()},{passive:!0,capture:!0}),document.addEventListener("touchstart",o=>{let e=o.target;e?.closest?.(".knob-tooltip, .matrix-tooltip")||e?.closest?.(".knob, .knob-inner, .pin-btn, .output-channel__slider, .panel7-joystick-pad")||$i()},{passive:!0,capture:!0}),document.addEventListener("scroll",()=>{$i()},{passive:!0,capture:!0}),document.addEventListener("wheel",()=>{$i()},{passive:!0}))}Te();var li={performance:{id:"performance",intensity:2.5,spread:18,duration:600,color:[255,215,128],opacity:.95,pulseOnChange:!0},standard:{id:"standard",intensity:1.6,spread:14,duration:500,color:[255,215,128],opacity:.8,pulseOnChange:!0},subtle:{id:"subtle",intensity:.8,spread:8,duration:400,color:[255,215,128],opacity:.55,pulseOnChange:!0},off:{id:"off",intensity:0,spread:0,duration:0,color:[255,215,128],opacity:0,pulseOnChange:!1}},fl="standard",rn=li[fl],Ta=fl,ri=new WeakMap;function bl(){let o=localStorage.getItem(v.GLOW_PRESET);o&&li[o]&&(Ta=o,rn=li[o]),_l()}function yl(){return Ta}function vl(o){li[o]&&(Ta=o,rn=li[o],localStorage.setItem(v.GLOW_PRESET,o),_l(),document.dispatchEvent(new CustomEvent("synth:settingChanged",{detail:{key:"glowPreset",value:o}})))}function Ma(){return Object.keys(li)}function Ae(o){if(!o||!rn.pulseOnChange||rn.intensity===0||o.classList.contains("is-tooltip-active"))return;let e=ri.get(o);e&&(clearTimeout(e),o.classList.remove("glow-flash"),o.offsetWidth),o.classList.add("glow-flash");let t=setTimeout(()=>{o.classList.remove("glow-flash"),ri.delete(o)},rn.duration);ri.set(o,t)}function Cn(o){if(!o||!rn.pulseOnChange||rn.intensity===0||o.classList.contains("is-tooltip-target"))return;let e=ri.get(o);e&&(clearTimeout(e),o.classList.remove("glow-flash-pin"),o.offsetWidth),o.classList.add("glow-flash-pin");let t=setTimeout(()=>{o.classList.remove("glow-flash-pin"),ri.delete(o)},rn.duration);ri.set(o,t)}function _l(){let o=document.documentElement,e=rn,[t,n,i]=e.color,s=y=>`rgba(${t}, ${n}, ${i}, ${y})`;o.style.setProperty("--glow-intensity",e.intensity),o.style.setProperty("--glow-spread",`${e.spread}px`),o.style.setProperty("--glow-opacity",e.opacity),o.style.setProperty("--glow-duration",`${e.duration}ms`);let a=Math.round(e.spread*e.intensity),r=Math.round(a*.8);o.style.setProperty("--glow-knob-shadow",`0 0 ${r}px ${a}px ${s(e.opacity)}`),o.style.setProperty("--glow-knob-shadow-idle",`0 0 ${Math.round(r*.4)}px ${Math.round(a*.3)}px ${s(e.opacity*.4)}`);let l=Math.round(e.spread*e.intensity*.85),c=Math.round(l*.7);o.style.setProperty("--glow-slider-shadow",`0 0 ${c}px ${l}px ${s(e.opacity*.85)}`),o.style.setProperty("--glow-slider-shadow-idle",`0 0 0 0 ${s(e.opacity*.4)}`);let d=Math.round(e.spread*e.intensity*.9),h=Math.round(d*.85);o.style.setProperty("--glow-pad-shadow",`inset 0 0 10px rgba(0,0,0,0.6), 0 0 ${h}px ${d}px ${s(e.opacity*.85)}`),o.style.setProperty("--glow-pad-shadow-idle",`inset 0 0 10px rgba(0,0,0,0.6), 0 0 0 0 ${s(e.opacity*.3)}`);let p=Math.round(e.spread*e.intensity*.7),m=Math.round(p*.6);o.style.setProperty("--glow-pin-shadow",`0 0 ${m}px ${p}px ${s(e.opacity*.9)}`),o.style.setProperty("--glow-pin-shadow-idle",`0 0 0 0 ${s(e.opacity*.5)}`);let g=Math.round(e.spread*e.intensity*1.2),_=Math.round(g*.9);o.style.setProperty("--glow-flash-shadow",`0 0 ${_}px ${g}px ${s(e.opacity)}`),o.classList.toggle("glow-disabled",e.intensity===0)}var Uu=()=>"ontouchstart"in window||navigator.maxTouchPoints>0,Ct=class{constructor(e,t={}){this.rootEl=e,this.innerEl=e.querySelector(".knob-inner");let{valueElement:n=null,min:i=0,max:s=1,initial:a=0,onChange:r=null,format:l=(y=>y),pixelsForFullRange:c=150,scaleMin:d=0,scaleMax:h=10,scaleDecimals:p=1,getTooltipInfo:m=null,tooltipAutoHideDelay:g=3e3,angleOffset:_=0}=t;this.valueEl=n,this.min=i,this.max=s,this.value=a,this.initialValue=a,this.onChange=r,this.format=l,this.pixelsForFullRange=c,this.scaleMin=d,this.scaleMax=h,this.scaleDecimals=p,this.getTooltipInfo=m,this.tooltipAutoHideDelay=g,this._tooltipAutoHideTimer=null,this._touchTooltipTimer=null,this.dragging=!1,this.startY=0,this.lastY=0,this.startX=0,this.startValue=this.value,this.maxPxForSpeedEffect=200,this.tooltip=null,this.modBadge=null,this.modifierState="none",this._modBadgeHideTimer=null,this.modBadgeNeutralDuration=1e3,this._rafId=null,this._pendingValue=null,this.minAngle=150+_,this.maxAngle=450+_,this._tooltipHideCallback=()=>{this.dragging||this._hideTooltip()},this._unregisterTooltipHide=vn(this._tooltipHideCallback),this._attach(),this._updateVisual()}_getScaleValue(){let e=(this.value-this.min)/(this.max-this.min);return this.scaleMin+e*(this.scaleMax-this.scaleMin)}_formatScaleValue(){return this._getScaleValue().toFixed(this.scaleDecimals)}_generateTooltipContent(){let e=this._getScaleValue(),t=e.toFixed(this.scaleDecimals);if(this.getTooltipInfo){let n=this.getTooltipInfo(this.value,e);if(n)return`<div class="knob-tooltip__main">${t}</div><div class="knob-tooltip__info">${n}</div>`}return t}_showTooltip(){this.tooltip||(_n(this._tooltipHideCallback),this.tooltip=document.createElement("div"),this.tooltip.className="knob-tooltip",this.tooltip.innerHTML=this._generateTooltipContent(),document.body.appendChild(this.tooltip),this._positionTooltip(),this.tooltip.offsetHeight,this.tooltip.classList.add("is-visible"),this.rootEl.classList.add("is-tooltip-active"))}_positionTooltip(){if(!this.tooltip)return;let e=this.rootEl.getBoundingClientRect(),t=this.tooltip.getBoundingClientRect(),n=e.left+e.width/2-t.width/2,i=e.top-t.height-8;n<4&&(n=4),n+t.width>window.innerWidth-4&&(n=window.innerWidth-t.width-4),i<4&&(i=e.bottom+8),this.tooltip.style.left=`${n}px`,this.tooltip.style.top=`${i}px`}_updateTooltip(){this.tooltip&&(this.tooltip.innerHTML=this._generateTooltipContent(),this._positionTooltip())}_hideTooltip(){if(this._touchTooltipTimer&&(clearTimeout(this._touchTooltipTimer),this._touchTooltipTimer=null),!this.tooltip)return;this._tooltipAutoHideTimer&&(clearTimeout(this._tooltipAutoHideTimer),this._tooltipAutoHideTimer=null);let e=this.tooltip;e.classList.remove("is-visible"),this.rootEl.classList.remove("is-tooltip-active"),setTimeout(()=>{e.parentNode&&e.parentNode.removeChild(e)},150),this.tooltip=null}_showTooltipWithAutoHide(){this._showTooltip(),this._tooltipAutoHideTimer&&clearTimeout(this._tooltipAutoHideTimer),this._tooltipAutoHideTimer=setTimeout(()=>{this.dragging||this._hideTooltip()},this.tooltipAutoHideDelay)}_ensureModifierBadge(){if(this.modBadge)return;let e=document.createElement("div");e.className="knob-mod-badge",e.textContent="1x",document.body.appendChild(e),this.modBadge=e}_positionModifierBadge(){if(!this.modBadge)return;let e=this.rootEl.getBoundingClientRect(),t=e.right-8,n=e.top+e.height/2;this.modBadge.style.left=`${t}px`,this.modBadge.style.top=`${n}px`}_setModifierVisual(e,t=1){this._ensureModifierBadge();let n=this.modifierState;if(e==="progressive")if(t>.95&&t<1.05)e="none";else{this._positionModifierBadge(),this.modBadge.classList.remove("is-fast","is-slow");let s;t>=10?s="10x":t>=1?s=`${t.toFixed(1)}x`:t<=.1?s="0.1x":s=`${t.toFixed(2)}x`,this.modBadge.textContent=s,t>1?this.modBadge.classList.add("is-fast"):this.modBadge.classList.add("is-slow"),this.modBadge.classList.add("is-active"),this.modifierState="progressive";return}if(this.modifierState===e){this._positionModifierBadge();return}this.modifierState=e,this._positionModifierBadge(),this._modBadgeHideTimer&&(clearTimeout(this._modBadgeHideTimer),this._modBadgeHideTimer=null),this.modBadge.classList.remove("is-fast","is-slow"),e==="fast"?(this.modBadge.textContent="10x",this.modBadge.classList.add("is-fast","is-active")):e==="slow"?(this.modBadge.textContent="0.1x",this.modBadge.classList.add("is-slow","is-active")):n==="fast"||n==="slow"||n==="progressive"?(this.modBadge.textContent="1x",this.modBadge.classList.add("is-active"),this._modBadgeHideTimer=setTimeout(()=>{this.modifierState==="none"&&this.modBadge.classList.remove("is-active"),this._modBadgeHideTimer=null},this.modBadgeNeutralDuration)):this.modBadge.classList.remove("is-active")}_attach(){let e=Uu();if(this._ensureModifierBadge(),this._setModifierVisual("none"),this.rootEl.addEventListener("contextmenu",i=>{i.preventDefault()}),this.rootEl.addEventListener("pointerenter",i=>{i.pointerType!=="touch"&&this._showTooltip()}),this.rootEl.addEventListener("pointerleave",i=>{i.pointerType!=="touch"&&(this.dragging||this._hideTooltip())}),document.addEventListener("synth:dismissTooltips",()=>{this._hideTooltip()}),e){let i=0,s=0,a=!1;this.rootEl.addEventListener("touchstart",r=>{i=Date.now(),s=r.touches[0]?.clientY??0,a=r.touches.length===1},{passive:!0}),this.rootEl.addEventListener("touchmove",r=>{if(r.touches.length>1){a=!1;return}let l=r.touches[0]?.clientY??0;Math.abs(l-s)>10&&(a=!1)},{passive:!0}),this.rootEl.addEventListener("touchend",()=>{let r=Date.now()-i;a&&r<200&&!this.dragging&&!zn()&&this._showTooltipWithAutoHide(),a=!1},{passive:!0})}let t="mouse";this.rootEl.addEventListener("pointerdown",i=>{qi(i)||(window._synthApp&&window._synthApp.ensureAudio&&window._synthApp.ensureAudio(),this.dragging=!0,this.startY=i.clientY,this.lastY=i.clientY,this.startX=i.clientX,this.startValue=this.value,this.rootEl.setPointerCapture(i.pointerId),t=i.pointerType,i.pointerType==="touch"?(this._touchTooltipTimer&&clearTimeout(this._touchTooltipTimer),this._touchTooltipTimer=setTimeout(()=>{this._touchTooltipTimer=null,this.dragging&&!zn()&&this._showTooltip()},80),this._tooltipAutoHideTimer&&(clearTimeout(this._tooltipAutoHideTimer),this._tooltipAutoHideTimer=null)):this._showTooltip(),this._setModifierVisual("none"),this._positionModifierBadge())}),this.rootEl.addEventListener("pointermove",i=>{if(!this.dragging)return;if(qi(i)){this.dragging=!1,this._setModifierVisual("none"),this._hideTooltip();try{this.rootEl.releasePointerCapture(i.pointerId)}catch{}return}let s=this.lastY-i.clientY;this.lastY=i.clientY;let a=i.clientX-this.startX,r=Math.max(-1,Math.min(1,a/this.maxPxForSpeedEffect)),l=Math.pow(10,r),c="progressive",d=l;i.ctrlKey||i.metaKey?(d=10,c="fast"):i.shiftKey&&(d=.1,c="slow"),this._setModifierVisual(c,d);let p=(this.max-this.min)/this.pixelsForFullRange*d,m=Math.min(this.max,Math.max(this.min,this.value+s*p));m!==this.value&&(this._pendingValue=m,this._rafId||(this._rafId=requestAnimationFrame(()=>{this._rafId=null,this._pendingValue!==null&&this._pendingValue!==this.value&&(this.value=this._pendingValue,this._pendingValue=null,this._updateVisualFast(),this._updateTooltip(),this.onChange&&this.onChange(this.value))})))});let n=i=>{if(this.dragging){this.dragging=!1,this._setModifierVisual("none"),this._pendingValue!==null&&(this.value=this._pendingValue,this._pendingValue=null,this._updateVisualFast(),this.onChange&&this.onChange(this.value)),document.dispatchEvent(new CustomEvent("synth:userInteraction"));try{this.rootEl.releasePointerCapture(i.pointerId)}catch{}t==="touch"?(this._tooltipAutoHideTimer&&clearTimeout(this._tooltipAutoHideTimer),this._tooltipAutoHideTimer=setTimeout(()=>{this._hideTooltip()},this.tooltipAutoHideDelay)):this._hideTooltip()}};this.rootEl.addEventListener("pointerup",n),this.rootEl.addEventListener("pointercancel",n)}_updateVisualFast(){let e=(this.value-this.min)/(this.max-this.min),t=this.minAngle+e*(this.maxAngle-this.minAngle);this.innerEl.style.transform=`rotate(${t}deg)`,this.valueEl&&(this.valueEl.textContent=this._formatScaleValue()),this.modBadge&&this.modBadge.classList.contains("is-active")&&this._positionModifierBadge()}_updateVisual(){this._updateVisualFast()}setValue(e){let t=Math.min(this.max,Math.max(this.min,e));t!==this.value&&(this.value=t,this._updateVisual(),this.onChange&&this.onChange(this.value),this.dragging||(Ae(this.rootEl),document.dispatchEvent(new CustomEvent("synth:userInteraction"))))}getValue(){return this.value}resetToDefault(){this.setValue(this.initialValue)}};function js(o={}){let{label:e="",size:t="",className:n="",showValue:i=!1,centerColor:s="",svgSrc:a="assets/knobs/knob.svg"}=o,r=document.createElement("div");r.className=`knob-wrapper${n?" "+n:""}`;let l=document.createElement("div"),c=t?` knob--${t}`:"";l.className=`knob knob--svg${c}`;let d=document.createElement("div");d.className="knob-inner";let h=document.createElement("img");h.className="knob-svg-ring",h.src=a,h.alt="",h.draggable=!1,d.appendChild(h),l.appendChild(d);let p=document.createElement("div");p.className="knob-center",s&&p.style.setProperty("--knob-center-color",s),l.appendChild(p),r.appendChild(l);let m={wrapper:r,knobEl:l,inner:d};if(e){let g=document.createElement("div");g.className="knob-label",g.textContent=e,r.appendChild(g),m.labelEl=g}if(i){let g=document.createElement("div");g.className="knob-value",r.appendChild(g),m.valueEl=g}return m}function Wt(o={}){let{label:e,size:t,className:n,centerColor:i,svgSrc:s,showValue:a=!0,min:r=0,max:l=1,initial:c=0,pixelsForFullRange:d=150,scaleMin:h=0,scaleMax:p=10,scaleDecimals:m=1,onChange:g,format:_,getTooltipInfo:y}=o,f=js({label:e,size:t,className:n,showValue:a,centerColor:i,svgSrc:s}),b={min:r,max:l,initial:c,pixelsForFullRange:d,scaleMin:h,scaleMax:p,scaleDecimals:m};g&&(b.onChange=g),_&&(b.format=_),y&&(b.getTooltipInfo=y),f.valueEl&&(b.valueElement=f.valueEl);let E=new Ct(f.knobEl,b);return{...f,knobInstance:E}}var Fn="#547FA1",Pa="#467660",Et="#BEB7B1",Cl="#242227",Oa="#B54049",Ui="#C8A638";Te();function Hi(){return localStorage.getItem(v.TOOLTIP_SHOW_VOLTAGE)!=="false"}function ci(){return localStorage.getItem(v.TOOLTIP_SHOW_AUDIO_VALUES)!=="false"}function El(o){return o<=0?"-\u221E dB":`${(20*Math.log10(o)).toFixed(1)} dB`}function ui(o){return`\xD7${o.toFixed(2)}`}function Vn(o,e=1){return`${o.toFixed(e)} V`}function Sl(o,e,t=()=>0){return n=>{let i=[],s=t();if(Hi()){let a=o(n),r=a+s;s!==0?i.push(`${Vn(r)} (${Vn(a)}+CV)`):i.push(Vn(r))}if(ci()){let a=e(n,s);i.push(ui(a)),i.push(El(a))}return i.length>0?i.join(" \xB7 "):null}}function kl(o){return(e,t)=>{if(!ci())return null;let n=e/5-1;return Math.abs(n)<.02?"White noise":n<0?`LP \xB7 fc \u2248 ${Math.round(o)} Hz`:"HP \xB7 +6 dB shelf"}}function wl(o,e){return(t,n)=>{let i=[],s;if(t<=0)s=0;else{let a=t/10;s=(Math.pow(e,a)-1)/(e-1)}if(Hi()){let a=(s*o).toFixed(2);i.push(`${a} Vp-p`)}return ci()&&(i.push(ui(s)),i.push(El(s))),i.length>0?i.join(" \xB7 "):null}}var Hu={prefix:"SynthiGME",sendEnabled:!0,receiveEnabled:!0,verbose:!1},Ia=class{constructor(){this.config={...Hu},this.connected=!1,this._unsubscribe=null,this._listeners=new Map}isAvailable(){return typeof window<"u"&&window.oscAPI!==void 0}async start(e={}){if(!this.isAvailable())return console.warn("[OSCBridge] OSC no disponible (solo funciona en Electron)"),!1;this.config={...this.config,...e};let t=localStorage.getItem("synthigme_osc-port"),n=e.port||(t?parseInt(t,10):57121);try{let i=await window.oscAPI.start(n?{port:n}:void 0);return i.success?(this.connected=!0,this._setupMessageHandler(),console.log("[OSCBridge] Conectado correctamente en puerto",i.status?.port||57121),this.config.verbose&&console.log("[OSCBridge] Conectado:",i.status),this._emit("osc:connected",i.status),!0):(console.error("[OSCBridge] Error al iniciar:",i.error),!1)}catch(i){return console.error("[OSCBridge] Excepci\xF3n al iniciar:",i),!1}}async stop(){if(!this.isAvailable()||!this.connected)return!1;try{this._unsubscribe&&(this._unsubscribe(),this._unsubscribe=null);let e=await window.oscAPI.stop();return this.connected=!1,this.config.verbose&&console.log("[OSCBridge] Desconectado"),this._emit("osc:disconnected"),e.success}catch(e){return console.error("[OSCBridge] Error al detener:",e),!1}}getFormattedPrefix(){return`/${(this.config.prefix||"SynthiGME").replace(/^\/+|\/+$/g,"")}/`}async getStatus(){return this.isAvailable()?{available:!0,...await window.oscAPI.getStatus()}:{available:!1,running:!1}}send(e,t,n={}){if(!this.connected||!this.config.sendEnabled)return console.log("[OSCBridge] send blocked - connected:",this.connected,"sendEnabled:",this.config.sendEnabled),!1;let i=e,s=this.getFormattedPrefix();!n.skipPrefix&&!e.startsWith(s)&&(i=s+e);let a=Array.isArray(t)?t:[t];return this.config.verbose&&console.log("[OSCBridge] Enviando:",i,a),this._emit("osc:message",{address:i,args:a,direction:"out"}),window.oscAPI.send(i,a)}on(e,t){let n=e;return e.startsWith("/")||(n=this.getFormattedPrefix()+e),this._listeners.has(n)||this._listeners.set(n,new Set),this._listeners.get(n).add(t),()=>{let i=this._listeners.get(n);i&&(i.delete(t),i.size===0&&this._listeners.delete(n))}}onAny(e){return this.on("*",e)}setConfig(e){this.config={...this.config,...e},this.config.verbose&&console.log("[OSCBridge] Configuraci\xF3n actualizada:",this.config)}_setupMessageHandler(){this._unsubscribe&&this._unsubscribe(),this._unsubscribe=window.oscAPI.onMessage((e,t,n)=>{if(!this.config.receiveEnabled)return;this.config.verbose&&console.log("[OSCBridge] Recibido:",e,t,"de",n);let i=t.length===1?t[0]:t;this._notifyListeners(e,i,n);let s=this._listeners.get("*");s&&s.forEach(a=>{try{a(e,t,n)}catch(r){console.error("[OSCBridge] Error en listener wildcard:",r)}}),this._emit("osc:message",{address:e,args:t,from:n,direction:"in"})})}_notifyListeners(e,t,n){let i=this._listeners.get(e);i&&i.forEach(s=>{try{s(t,e,n)}catch(a){console.error("[OSCBridge] Error en listener:",a)}}),this._listeners.forEach((s,a)=>{if(a==="*"||a===e)return;new RegExp("^"+a.replace(/\*/g,".*")+"$").test(e)&&s.forEach(l=>{try{l(t,e,n)}catch(c){console.error("[OSCBridge] Error en listener wildcard:",c)}})})}_emit(e,t=null){window.dispatchEvent(new CustomEvent(e,{detail:t}))}},J=new Ia;var Na=class{constructor(){this._unsubscribers=new Map,this._app=null,this._ignoreOSCUpdates=!1,this._lastSentValues=new Map}init(e){this._app=e,this._setupListeners(),console.log("[OutputChannelOSCSync] Inicializado para 8 canales")}sendLevelChange(e,t){if(!J.connected)return;let n=`out/${e+1}/level`,i=this._lastSentValues.get(n);i!==void 0&&Math.abs(i-t)<1e-4||(this._lastSentValues.set(n,t),J.send(n,t))}sendFilterChange(e,t){if(!J.connected)return;let n=`out/${e+1}/filter`,i=this._lastSentValues.get(n);i!==void 0&&Math.abs(i-t)<1e-4||(this._lastSentValues.set(n,t),J.send(n,t))}sendPanChange(e,t){if(!J.connected)return;let n=(t+1)*5,i=`out/${e+1}/pan`,s=this._lastSentValues.get(i);s!==void 0&&Math.abs(s-n)<1e-4||(this._lastSentValues.set(i,n),J.send(i,n))}sendPowerChange(e,t){if(!J.connected)return;let n=t?1:0,i=`out/${e+1}/on`;this._lastSentValues.get(i)!==n&&(this._lastSentValues.set(i,n),J.send(i,n))}_setupListeners(){this._unsubscribers.forEach(t=>t()),this._unsubscribers.clear();let e=["level","filter","pan","on"];for(let t=1;t<=8;t++)for(let n of e){let i=`out/${t}/${n}`,s=J.on(i,a=>{this._handleIncoming(t-1,n,a)});this._unsubscribers.set(`out-${t}-${n}`,s)}}_handleIncoming(e,t,n){if(!(this._ignoreOSCUpdates||!this._app)){this._ignoreOSCUpdates=!0;try{let i=this._app._outputChannelsPanel?.getChannel(e);if(!i)return;switch(t){case"level":i.values.level=n,i.slider&&(i.slider.value=String(n)),i.valueDisplay&&(i.valueDisplay.textContent=n.toFixed(2)),this._applyLevel(i,n),i._sliderWrapEl&&Ae(i._sliderWrapEl);break;case"filter":i.values.filter=n,i.filterKnobUI&&i.filterKnobUI.setValue(n),i.engine.setOutputFilter(e,n,{ramp:.2});break;case"pan":let s=n/5-1;i.values.pan=s,i.panKnobUI&&i.panKnobUI.setValue(s),i.engine.setOutputPan(e,s,{ramp:.2});break;case"on":let a=n===1||n===!0;i.values.power=a,i.powerSwitch&&(i.powerSwitch.classList.toggle("is-on",a),i.powerSwitch.setAttribute("aria-pressed",String(a)),Ae(i.powerSwitch)),i.engine.setOutputMute(e,!a);break}}finally{setTimeout(()=>{this._ignoreOSCUpdates=!1},10)}}}_applyLevel(e,t){let n=e.values.externalCV||0,i=yn()?In(t,n):bn(t,n);e.engine.setOutputLevel(e.channelIndex,i,{ramp:.06})}shouldIgnoreOSC(){return this._ignoreOSCUpdates}destroy(){this._unsubscribers.forEach(e=>e()),this._unsubscribers.clear(),this._app=null}},It=new Na;var Da=()=>"ontouchstart"in window||navigator.maxTouchPoints>0,Ys=Ze.knobs||{},xl=Ze.faders||{},Wu=Ze.switches||{},ju=Ze.audio||{},Ba=ju.ramps||{},za=class extends wt{constructor(e,t,n={}){let i=`output-channel-${t+1}`,s=n.title||`Out ${t+1}`;super(e,i,s),this.channelIndex=t,this.options=n,this.frame=null,this.slider=null,this.valueDisplay=null,this.filterKnobEl=null,this.filterKnobUI=null,this.panKnobEl=null,this.panKnobUI=null,this.powerSwitch=null,this._sliderTooltip=null,this._sliderTooltipAutoHideTimer=null,this._sliderTooltipDelayTimer=null,this._sliderTooltipAutoHideDelay=3e3,this._unregisterTooltipHide=null;let a=Ys.filter||{},r=Ys.pan||{},l=xl.level||{},c=Wu.power||{};this.values={level:e.getOutputLevel(t)??l.initial??0,filter:e.getOutputFilter?e.getOutputFilter(t)??a.initial??0:a.initial??0,pan:e.outputPans?.[t]??r.initial??0,power:c.initial??!0,externalCV:0}}createPanel(e){this.frame=new Ve({id:this.id,title:this.name,className:"output-channel-module"});let t=this.frame.createElement(),n=this._createContent();return this.frame.appendToContent(n),e.appendChild(t),this._initKnobs(),t}_createContent(){let e=document.createElement("div");e.className="output-channel__content";let t=this._createFilterKnob();e.appendChild(t);let n=this._createPanKnob();e.appendChild(n);let i=this._createSwitch();e.appendChild(i);let s=this._createSlider();return e.appendChild(s),e}_createFilterKnob(){let{wrapper:e,knobEl:t,valueEl:n}=js({label:"Filter",size:"sm",className:"output-channel__knob-wrap",showValue:!0,centerColor:Fn,svgSrc:"assets/knobs/knob-0-center.svg"});return e.dataset.knob="filter",t.dataset.preventPan="true",this.filterKnobEl=t,this.filterValueEl=n,e}_createPanKnob(){let{wrapper:e,knobEl:t,valueEl:n}=js({label:"Pan",size:"sm",className:"output-channel__knob-wrap",showValue:!0,centerColor:Et,svgSrc:"assets/knobs/knob-0-center.svg"});return e.dataset.knob="pan",t.dataset.preventPan="true",this.panKnobEl=t,this.panValueEl=n,e}_initKnobs(){let e=Ys.filter||{},t=Ys.pan||{};this.filterKnobEl&&!this.filterKnobUI&&(this.filterKnobUI=new Ct(this.filterKnobEl,{min:e.min??-5,max:e.max??5,initial:this.values.filter,pixelsForFullRange:e.pixelsForFullRange??900,scaleMin:-5,scaleMax:5,scaleDecimals:1,angleOffset:-150,valueElement:this.filterValueEl,onChange:n=>{this.values.filter=n;let i=Ba.filter??.2;this.engine.setOutputFilter(this.channelIndex,n,{ramp:i}),It.shouldIgnoreOSC()||It.sendFilterChange(this.channelIndex,n)}})),this.panKnobEl&&!this.panKnobUI&&(this.panKnobUI=new Ct(this.panKnobEl,{min:t.min??-1,max:t.max??1,initial:this.values.pan,pixelsForFullRange:t.pixelsForFullRange??900,scaleMin:-5,scaleMax:5,scaleDecimals:1,angleOffset:-150,valueElement:this.panValueEl,onChange:n=>{this.values.pan=n;let i=Ba.pan??.2;this.engine.setOutputPan(this.channelIndex,n,{ramp:i}),It.shouldIgnoreOSC()||It.sendPanChange(this.channelIndex,n)}}))}_createSwitch(){let e=document.createElement("div");e.className="output-channel__switch-wrap";let t=document.createElement("button");t.type="button",t.className="output-channel__switch",t.classList.toggle("is-on",this.values.power),t.setAttribute("aria-pressed",String(this.values.power)),t.setAttribute("aria-label",`Channel ${this.channelIndex+1} power`);let n=document.createElement("span");return n.className="output-channel__switch-indicator",t.appendChild(n),t.addEventListener("click",()=>{this.values.power=!this.values.power,t.classList.toggle("is-on",this.values.power),t.setAttribute("aria-pressed",String(this.values.power)),this.engine.setOutputMute(this.channelIndex,!this.values.power),It.shouldIgnoreOSC()||It.sendPowerChange(this.channelIndex,this.values.power),Ae(t),document.dispatchEvent(new CustomEvent("synth:userInteraction"))}),this.powerSwitch=t,e.appendChild(t),e}_createSlider(){let e=xl.level||{},t=document.createElement("div");t.className="output-channel__slider-wrap",this._sliderWrapEl=t;let n=document.createElement("div");n.className="output-channel__slider-shell";let i=document.createElement("input");i.type="range",i.min=String(e.min??0),i.max=String(e.max??1),i.step=String(e.step??.001),i.value=String(this.values.level),i.className="output-channel__slider",i.setAttribute("aria-label",`Level ${this.channelIndex+1}`),i.dataset.preventPan="true",this.slider=i;let s=document.createElement("div");s.className="output-channel__value",s.textContent=this.values.level.toFixed(2),this.valueDisplay=s,this._tooltipHideCallback=()=>{this._hideSliderTooltip()},this._unregisterTooltipHide=vn(this._tooltipHideCallback);let a=Sl(m=>{let g=yn()?wa(m):m;return ka(g)},(m,g)=>yn()?In(m,g):bn(m,g),()=>this.values.externalCV),r=this.values.level,l=null,c=null,d=!1,h=14,p=()=>{if(l=null,c==null)return;let m=c;if(c=null,m===r)return;r=m,this.values.level=m;let g=yn()?In(m,this.values.externalCV):bn(m,this.values.externalCV),_=Ba.level??.06;this.engine.setOutputLevel(this.channelIndex,g,{ramp:_}),s.textContent=m.toFixed(2),It.shouldIgnoreOSC()||It.sendLevelChange(this.channelIndex,m)};return i.addEventListener("pointerdown",m=>{if(qi(m))return;let g=i.getBoundingClientRect(),_=Number(i.value),y=Number(i.min),f=Number(i.max),b=(_-y)/(f-y),E=g.bottom-b*g.height,w=m.clientY;d=Math.abs(w-E)<=h,window._synthApp&&window._synthApp.ensureAudio&&window._synthApp.ensureAudio(),m.pointerType==="touch"?(this._sliderTooltipDelayTimer&&clearTimeout(this._sliderTooltipDelayTimer),this._sliderTooltipDelayTimer=setTimeout(()=>{this._sliderTooltipDelayTimer=null,zn()||this._showSliderTooltip(t,a)},80)):this._showSliderTooltip(t,a)}),i.addEventListener("pointerup",()=>{document.dispatchEvent(new CustomEvent("synth:userInteraction"));let m=!!this._sliderTooltipDelayTimer;this._sliderTooltipDelayTimer&&(clearTimeout(this._sliderTooltipDelayTimer),this._sliderTooltipDelayTimer=null),m&&!zn()&&this._showSliderTooltip(t,a),Da()?this._scheduleTooltipAutoHide():this._hideSliderTooltip()}),i.addEventListener("pointercancel",()=>{this._sliderTooltipDelayTimer&&(clearTimeout(this._sliderTooltipDelayTimer),this._sliderTooltipDelayTimer=null),this._hideSliderTooltip()}),i.addEventListener("mouseenter",()=>{Da()||this._showSliderTooltip(t,a)}),i.addEventListener("mouseleave",()=>{!Da()&&!i.matches(":active")&&this._hideSliderTooltip()}),document.addEventListener("synth:dismissTooltips",()=>{this._hideSliderTooltip()}),i.addEventListener("input",()=>{if(zn()||!d){i.value=String(r);return}c=Number(i.value),l||(l=requestAnimationFrame(p)),this._updateSliderTooltip(a,c)}),n.appendChild(i),t.appendChild(n),t.appendChild(s),t}_generateSliderTooltipContent(e,t){let n=t??this.values.level,i=n.toFixed(2),s=e(n);return s?`<div class="knob-tooltip__main">${i}</div><div class="knob-tooltip__info">${s}</div>`:i}_showSliderTooltip(e,t){if(_n(this._tooltipHideCallback),this._sliderTooltipAutoHideTimer&&(clearTimeout(this._sliderTooltipAutoHideTimer),this._sliderTooltipAutoHideTimer=null),this._sliderTooltip){this._updateSliderTooltip(t);return}this._sliderWrapEl=e,this._sliderTooltip=document.createElement("div"),this._sliderTooltip.className="knob-tooltip",this._sliderTooltip.innerHTML=this._generateSliderTooltipContent(t),document.body.appendChild(this._sliderTooltip),this._positionSliderTooltip(e),this._sliderTooltip.offsetHeight,this._sliderTooltip.classList.add("is-visible"),e.classList.add("is-tooltip-active")}_positionSliderTooltip(e){if(!this._sliderTooltip)return;let t=e.getBoundingClientRect(),n=this._sliderTooltip.getBoundingClientRect(),i=t.left-n.width-8,s=t.top+t.height/2-n.height/2;i<4&&(i=t.right+8),s<4&&(s=4),s+n.height>window.innerHeight-4&&(s=window.innerHeight-n.height-4),this._sliderTooltip.style.left=`${i}px`,this._sliderTooltip.style.top=`${s}px`}_updateSliderTooltip(e,t){this._sliderTooltip&&(this._sliderTooltip.innerHTML=this._generateSliderTooltipContent(e,t))}_hideSliderTooltip(){if(this._sliderTooltipDelayTimer&&(clearTimeout(this._sliderTooltipDelayTimer),this._sliderTooltipDelayTimer=null),this._sliderTooltipAutoHideTimer&&(clearTimeout(this._sliderTooltipAutoHideTimer),this._sliderTooltipAutoHideTimer=null),!this._sliderTooltip)return;this._sliderTooltip.classList.remove("is-visible");let e=this._sliderTooltip;this._sliderTooltip=null,this._sliderWrapEl&&this._sliderWrapEl.classList.remove("is-tooltip-active"),setTimeout(()=>{e.parentNode&&e.parentNode.removeChild(e)},150)}_scheduleTooltipAutoHide(){this._sliderTooltipAutoHideTimer&&clearTimeout(this._sliderTooltipAutoHideTimer),this._sliderTooltipAutoHideTimer=setTimeout(()=>{this._hideSliderTooltip()},this._sliderTooltipAutoHideDelay)}serialize(){return{level:this.values.level,filter:this.values.filter,pan:this.values.pan,power:this.values.power}}deserialize(e){if(e){if(typeof e.level=="number"){let t=e.level!==this.values.level;this.values.level=e.level,this.slider&&(this.slider.value=String(e.level)),this.valueDisplay&&(this.valueDisplay.textContent=e.level.toFixed(2));let n=yn()?In(e.level,this.values.externalCV):bn(e.level,this.values.externalCV);this.engine.setOutputLevel(this.channelIndex,n,{ramp:.06}),t&&this._sliderWrapEl&&Ae(this._sliderWrapEl)}if(typeof e.filter=="number"&&(this.values.filter=e.filter,this.engine.setOutputFilter(this.channelIndex,e.filter),this.filterKnobUI&&this.filterKnobUI.setValue(e.filter)),typeof e.pan=="number"&&(this.values.pan=e.pan,this.engine.setOutputPan(this.channelIndex,e.pan),this.panKnobUI&&this.panKnobUI.setValue(e.pan)),typeof e.power=="boolean"){let t=e.power!==this.values.power;this.values.power=e.power,this.powerSwitch&&(this.powerSwitch.classList.toggle("is-on",e.power),this.powerSwitch.setAttribute("aria-pressed",String(e.power)),t&&Ae(this.powerSwitch))}}}setExternalCV(e,{ramp:t=.01}={}){this.values.externalCV=e;let n=yn()?In(this.values.level,e):bn(this.values.level,e);this.engine.setOutputLevel(this.channelIndex,n,{ramp:t})}getExternalCV(){return this.values.externalCV}},Ks=class{constructor(e,t){this.engine=e,this.channelCount=t??Ze.count??8,this.channels=[]}createPanel(e){e.classList.add("output-channels-row");for(let t=0;t<this.channelCount;t++){let n=new za(this.engine,t);n.createPanel(e),this.channels.push(n)}}serialize(){return{channels:this.channels.map(e=>e.serialize())}}deserialize(e){if(e){if(Array.isArray(e.channels)){e.channels.forEach((t,n)=>{this.channels[n]&&this.channels[n].deserialize(t)});return}Array.isArray(e.levels)&&e.levels.forEach((t,n)=>{this.channels[n]&&typeof t=="number"&&this.channels[n].deserialize({level:t})})}}getChannel(e){return this.channels[e]??null}};be();var Ll=W("NoiseModule"),Wi=class extends wt{constructor(e,t,n={}){super(e,t,"Noise Gen"),this.config={initialColour:n.initialColour??5,initialLevel:n.initialLevel??0,levelSmoothingTime:n.levelSmoothingTime??.03,colourSmoothingTime:n.colourSmoothingTime??.01,colourFilter:{potResistance:n.colourFilter?.potResistance??1e4,capacitance:n.colourFilter?.capacitance??33e-9},levelCurve:{type:n.levelCurve?.type??"log",logBase:n.levelCurve?.logBase??100},ramps:{colour:n.ramps?.colour??.05,level:n.ramps?.level??.06}},this.workletNode=null,this.levelNode=null,this.colourParam=null,this.values={colour:this.config.initialColour,level:this.config.initialLevel},this.isStarted=!1,this._colourBypassed=!1,this._filterBypassEnabled=!1,this._bypassThreshold=.02}_colourDialToPosition(e){return e/5-1}_levelDialToGain(e){if(e<=0)return 0;let t=this.config.levelCurve.logBase,n=e/10;return(Math.pow(t,n)-1)/(t-1)}_initAudioNodes(){let e=this.getAudioCtx();if(!(!e||this.workletNode))try{this.workletNode=new AudioWorkletNode(e,"noise-generator",{numberOfInputs:0,numberOfOutputs:1,outputChannelCount:[1],processorOptions:{potResistance:this.config.colourFilter.potResistance,capacitance:this.config.colourFilter.capacitance}}),We(this.workletNode,"noise-generator"),this.colourParam=this.workletNode.parameters.get("colourPosition"),this.colourParam.value=this._colourDialToPosition(this.values.colour),this.levelNode=e.createGain(),this.levelNode.gain.value=this._levelDialToGain(this.values.level),this.workletNode.connect(this.levelNode),this.outputs.push({id:"audioOut",kind:"audio",node:this.levelNode,label:"Noise OUT"})}catch(t){Ll.error(`${this.id}] Error inicializando nodos:`,t)}}start(){this.isStarted||(this._initAudioNodes(),this.isStarted=!0)}stop(e){if(!(!this.isStarted||!this.workletNode))try{this.workletNode.port.postMessage({type:"stop"}),this.workletNode.disconnect(),this.levelNode&&this.levelNode.disconnect(),this.workletNode=null,this.levelNode=null,this.colourParam=null,this.isStarted=!1}catch(t){Ll.error(`${this.id}] Error deteniendo:`,t)}}setColour(e){if(this.values.colour=Math.max(0,Math.min(10,e)),this._isDormant||!this.colourParam)return;let t=this.getAudioCtx();if(!t)return;let n=this._colourDialToPosition(this.values.colour);this._updateColourBypass(n);let i=t.currentTime;this.colourParam.cancelScheduledValues(i),this.colourParam.setTargetAtTime(n,i,this.config.ramps.colour/3)}setLevel(e){if(this.values.level=Math.max(0,Math.min(10,e)),this._isDormant){this._preDormantLevel=this.values.level;return}if(!this.levelNode)return;let t=this.getAudioCtx();if(!t)return;let n=this._levelDialToGain(this.values.level),i=t.currentTime;this.levelNode.gain.cancelScheduledValues(i),this.levelNode.gain.setTargetAtTime(n,i,this.config.ramps.level/3)}getColour(){return this.values.colour}getLevel(){return this.values.level}getOutputNode(){return this.levelNode||this._initAudioNodes(),this.levelNode}getColourParam(){return this.colourParam}getLevelParam(){return this.levelNode?.gain??null}setFilterBypassEnabled(e){if(this._filterBypassEnabled=!!e,this.workletNode)try{let t=e&&Math.abs(this._colourDialToPosition(this.values.colour))<this._bypassThreshold;this.workletNode.port.postMessage({type:"setFilterBypassed",bypassed:t}),this._colourBypassed=t}catch{}}_updateColourBypass(e){if(!this._filterBypassEnabled||!this.workletNode)return;let t=Math.abs(e)<this._bypassThreshold;if(t!==this._colourBypassed)try{this.workletNode.port.postMessage({type:"setFilterBypassed",bypassed:t}),this._colourBypassed=t}catch{}}_onDormancyChange(e){if(this.workletNode)try{this.workletNode.port.postMessage({type:"setDormant",dormant:e})}catch{}if(!this.levelNode)return;let t=this.getAudioCtx();if(!t)return;let n=.01,i=t.currentTime;if(e){this._preDormantLevel=this.values.level;try{this.levelNode.gain.cancelScheduledValues(i),this.levelNode.gain.setTargetAtTime(0,i,n)}catch{}}else{let s=this._levelDialToGain(this.values.level);try{this.levelNode.gain.cancelScheduledValues(i),this.levelNode.gain.setTargetAtTime(s,i,n)}catch{}if(this.colourParam){let a=this._colourDialToPosition(this.values.colour);try{this.colourParam.cancelScheduledValues(i),this.colourParam.setTargetAtTime(a,i,n)}catch{}this._updateColourBypass(a)}}}};be();var Al=W("JoystickModule"),ji=class extends wt{constructor(e,t,n={}){super(e,t,"Joystick"),this.config={ramps:{position:n.ramps?.position??.01,range:n.ramps?.range??.05}},this.xConst=null,this.yConst=null,this.xGain=null,this.yGain=null,this.x=0,this.y=0,this._rangeX=0,this._rangeY=0,this.isStarted=!1,this._preDormantRangeX=null,this._preDormantRangeY=null}_rangeDialToGain(e){return Math.max(0,Math.min(1,e/10))}_initAudioNodes(){let e=this.getAudioCtx();if(!(!e||this.xConst))try{this.xConst=e.createConstantSource(),this.xConst.offset.value=0,this.xGain=e.createGain(),this.xGain.gain.value=this._rangeDialToGain(this._rangeX),this.xConst.connect(this.xGain),this.yConst=e.createConstantSource(),this.yConst.offset.value=0,this.yGain=e.createGain(),this.yGain.gain.value=this._rangeDialToGain(this._rangeY),this.yConst.connect(this.yGain),this.outputs.push({id:"xOut",kind:"cv",node:this.xGain,label:`${this.name} X`},{id:"yOut",kind:"cv",node:this.yGain,label:`${this.name} Y`})}catch(t){Al.error(`${this.id}] Error inicializando nodos:`,t)}}start(){if(this.isStarted)return;this._initAudioNodes();let e=this.getAudioCtx();if(!e)return;let t=e.currentTime+.05;try{this.xConst.start(t)}catch{}try{this.yConst.start(t)}catch{}this.isStarted=!0}stop(e){if(!(!this.isStarted||!this.xConst)){try{this.xConst.stop(e),this.yConst.stop(e),this.xConst.disconnect(),this.yConst.disconnect(),this.xGain&&this.xGain.disconnect(),this.yGain&&this.yGain.disconnect()}catch(t){Al.error(`${this.id}] Error deteniendo:`,t)}this.xConst=null,this.yConst=null,this.xGain=null,this.yGain=null,this.isStarted=!1}}setPosition(e,t){let n=Math.max(-1,Math.min(1,e)),i=Math.max(-1,Math.min(1,t));if(this.x=n,this.y=i,this._isDormant)return;let s=this.getAudioCtx();if(!s||!this.xConst||!this.yConst)return;let a=s.currentTime,r=a+this.config.ramps.position;this.xConst.offset.cancelScheduledValues(a),this.xConst.offset.setValueAtTime(this.xConst.offset.value,a),this.xConst.offset.linearRampToValueAtTime(n,r),this.yConst.offset.cancelScheduledValues(a),this.yConst.offset.setValueAtTime(this.yConst.offset.value,a),this.yConst.offset.linearRampToValueAtTime(i,r)}setRangeX(e){if(this._rangeX=Math.max(0,Math.min(10,e)),this._isDormant||!this.xGain)return;let t=this.getAudioCtx();if(!t)return;let n=this._rangeDialToGain(this._rangeX);Me(this.xGain.gain,n,t,{ramp:this.config.ramps.range})}setRangeY(e){if(this._rangeY=Math.max(0,Math.min(10,e)),this._isDormant||!this.yGain)return;let t=this.getAudioCtx();if(!t)return;let n=this._rangeDialToGain(this._rangeY);Me(this.yGain.gain,n,t,{ramp:this.config.ramps.range})}getX(){return this.x}getY(){return this.y}getRangeX(){return this._rangeX}getRangeY(){return this._rangeY}getOutputNodeX(){return this.xGain||this._initAudioNodes(),this.xGain}getOutputNodeY(){return this.yGain||this._initAudioNodes(),this.yGain}_onDormancyChange(e){if(!this.xGain||!this.yGain)return;let t=this.getAudioCtx();if(!t)return;let n=.01;if(e){this._preDormantRangeX=this._rangeX,this._preDormantRangeY=this._rangeY;try{let i=t.currentTime;this.xGain.gain.cancelScheduledValues(i),this.xGain.gain.setTargetAtTime(0,i,n),this.yGain.gain.cancelScheduledValues(i),this.yGain.gain.setTargetAtTime(0,i,n)}catch{}}else{let i=this._rangeDialToGain(this._rangeX),s=this._rangeDialToGain(this._rangeY);try{let a=t.currentTime;this.xGain.gain.cancelScheduledValues(a),this.xGain.gain.setTargetAtTime(i,a,n),this.yGain.gain.cancelScheduledValues(a),this.yGain.gain.setTargetAtTime(s,a,n)}catch{}if(this.xConst&&this.yConst)try{Me(this.xConst.offset,this.x,t,{ramp:n}),Me(this.yConst.offset,this.y,t,{ramp:n})}catch{}}}};var Xs=class extends wt{constructor(e,t,n={}){super(e,t,"Input Amp"),this.config={channels:n.channels??8,initialLevel:n.initialLevel??0,levelSmoothingTime:n.levelSmoothingTime??.03},this.gainNodes=[],this.levels=new Array(this.config.channels).fill(this.config.initialLevel),this.isStarted=!1}_initAudioNodes(){let e=this.getAudioCtx();if(!(!e||this.gainNodes.length>0))for(let t=0;t<this.config.channels;t++){let n=e.createGain();n.gain.value=this.levels[t],this.gainNodes.push(n),this.outputs.push({id:`channel-${t+1}`,kind:"audio",node:n,label:`Channel ${t+1}`})}}async start(){this._initAudioNodes(),this.isStarted=!0}stop(){this.isStarted=!1}setLevel(e,t){if(e<0||e>=this.config.channels)return;let n=Math.max(0,Math.min(1,t));this.levels[e]=n;let i=this.gainNodes[e];if(i){let a=this.getAudioCtx()?.currentTime??0;i.gain.cancelScheduledValues(a),i.gain.setTargetAtTime(n,a,this.config.levelSmoothingTime)}}getLevel(e){return this.levels[e]??0}getInputNode(e){return this.gainNodes[e]??null}getOutputNode(e){return this.gainNodes[e]??null}getAllOutputNodes(){return[...this.gainNodes]}_onDormancyChange(e){let t=this.getAudioCtx();if(!t)return;let n=.01,i=t.currentTime;if(e){this._preDormantLevels=[...this.levels];for(let s of this.gainNodes)if(s)try{s.gain.cancelScheduledValues(i),s.gain.setTargetAtTime(0,i,n)}catch{}console.log("[Dormancy] InputAmplifiers: DORMANT")}else{for(let s=0;s<this.gainNodes.length;s++){let a=this.gainNodes[s];if(a)try{a.gain.cancelScheduledValues(i),a.gain.setTargetAtTime(this.levels[s]||0,i,n)}catch{}}console.log("[Dormancy] InputAmplifiers: ACTIVE")}}};Oe();var Hl=["RED","GREEN","WHITE","GREY"],Wl=["BLUE","YELLOW","CYAN","PURPLE"],Sg=[...Hl,...Wl],$a={audio:"WHITE",control:"GREY",oscilloscope:"RED"};function En(o,e){return typeof document>"u"?e:getComputedStyle(document.documentElement).getPropertyValue(o).trim()||e}var sd={get WHITE(){return En("--pin-color-white","#ffffff")},get GREY(){return En("--pin-color-grey","#888888")},get GREEN(){return En("--pin-color-green","#4CAF50")},get RED(){return En("--pin-color-red","#f44336")},get BLUE(){return En("--pin-color-blue","#2196F3")},get YELLOW(){return En("--pin-color-yellow","#FFEB3B")},get CYAN(){return En("--pin-color-cyan","#00BCD4")},get PURPLE(){return En("--pin-color-purple","#9C27B0")}};function od(o){if(o>=1e6){let e=o/1e6;return Number.isInteger(e)?`${e}M\u03A9`:`${e.toFixed(1)}M\u03A9`}if(o>=1e3){let e=o/1e3;return Number.isInteger(e)?`${e}k\u03A9`:`${e.toFixed(1)}k\u03A9`}return`${o}\u03A9`}function ad(o,e=si){if(o===0)return"\xD7\u221E";let t=e/o;return t>=10?`\xD7${Math.round(t)}`:t>=1?t===Math.round(t)?`\xD7${t}`:`\xD7${t.toFixed(1)}`:`\xD7${t.toFixed(1)}`}function eo(o){let e=kt[o];if(!e)return"";let t=od(e.value),n=ad(e.value);return`${t} \xB7 ${n}`}var Ha=class{constructor(){this._element=null,this._isVisible=!1,this._currentCallback=null,this._currentPinBtn=null,this._currentContext=null,this._currentIsActive=!1,this._lastSelectedByContext={audio:null,control:null,oscilloscope:null},this._onDocumentClick=this._handleDocumentClick.bind(this),this._onKeydown=this._handleKeydown.bind(this)}get element(){return this._element||(this._element=this._createMenuElement(),document.body.appendChild(this._element)),this._element}_createMenuElement(){let e=document.createElement("div");e.className="pin-color-menu",e.setAttribute("role","menu"),e.setAttribute("aria-hidden","true");let t=document.createElement("div");t.className="pin-color-menu__title",t.textContent=u("pinColor.title"),e.appendChild(t);let n=document.createElement("div");n.className="pin-color-menu__sections";let i=this._createSection("pinColor.recommended",[],"recommended");n.appendChild(i);let s=this._createSection("pinColor.standard",Hl,"standard");n.appendChild(s);let a=this._createSection("pinColor.special",Wl,"special");return n.appendChild(a),e.appendChild(n),e}_createSection(e,t,n){let i=document.createElement("div");i.className="pin-color-menu__section",i.dataset.section=n;let s=document.createElement("div");s.className="pin-color-menu__section-header",s.textContent=u(e),i.appendChild(s);let a=document.createElement("div");a.className="pin-color-menu__options";for(let r of t){let l=u(`pinColor.${r.toLowerCase()}`),c=eo(r),d=this._createOption(r,l,c);a.appendChild(d)}return i.appendChild(a),i}_createOption(e,t,n){let i=document.createElement("button");i.type="button",i.className="pin-color-menu__option",i.dataset.color=e,i.setAttribute("role","menuitem");let s=document.createElement("span");s.className="pin-color-menu__tick",s.textContent="\u2713",i.appendChild(s);let a=document.createElement("span");a.className="pin-color-menu__indicator",a.style.backgroundColor=sd[e]||"#888",i.appendChild(a);let r=document.createElement("span");r.className="pin-color-menu__text";let l=document.createElement("span");if(l.className="pin-color-menu__label",l.textContent=t,r.appendChild(l),n){let c=document.createElement("span");c.className="pin-color-menu__sublabel",c.textContent=n,r.appendChild(c)}return i.appendChild(r),i.addEventListener("click",c=>{c.preventDefault(),c.stopPropagation(),this._selectColor(e)}),i}_updateRecommendedSection(e){let n=this.element.querySelector('[data-section="recommended"]');if(!n)return;let i=n.querySelector(".pin-color-menu__options");if(!i)return;i.innerHTML="";let s=$a[e]||"WHITE",a=u(`pinColor.${s.toLowerCase()}`),r=eo(s),l=this._createOption(s,a,r);l.classList.add("is-recommended"),i.appendChild(l)}show(e,t,n,{context:i,currentColor:s,isActive:a,onSelect:r}){let l=this.element;this._currentPinBtn=n,this._currentCallback=r,this._currentContext=i,this._currentIsActive=a,this._updateRecommendedSection(i);let c=a&&s?s:this.getNextColor(i);l.querySelectorAll(".pin-color-menu__option").forEach(d=>{let h=d.dataset.color===c;d.classList.toggle("is-selected",h)}),l.style.left=`${e}px`,l.style.top=`${t}px`,l.classList.add("is-visible"),l.setAttribute("aria-hidden","false"),this._isVisible=!0,requestAnimationFrame(()=>{let d=l.getBoundingClientRect(),h={width:window.innerWidth,height:window.innerHeight},p=8,m=e,g=t;d.right>h.width-p&&(m=h.width-d.width-p),d.bottom>h.height-p&&(g=h.height-d.height-p),m<p&&(m=p),g<p&&(g=p),l.style.left=`${m}px`,l.style.top=`${g}px`}),document.addEventListener("click",this._onDocumentClick,{capture:!0}),document.addEventListener("keydown",this._onKeydown)}hide(){if(!this._isVisible)return;let e=this.element;e.classList.remove("is-visible"),e.setAttribute("aria-hidden","true"),this._isVisible=!1,this._currentCallback=null,this._currentPinBtn=null,this._currentContext=null,this._currentIsActive=!1,document.removeEventListener("click",this._onDocumentClick,{capture:!0}),document.removeEventListener("keydown",this._onKeydown)}_selectColor(e){this._currentCallback&&this._currentContext&&(this._lastSelectedByContext[this._currentContext]=e,this._currentCallback(e,!this._currentIsActive)),this.hide()}getNextColor(e){return this._lastSelectedByContext[e]||$a[e]||"WHITE"}getDefaultColor(e){return $a[e]||"WHITE"}_handleDocumentClick(e){if(!this._isVisible)return;this.element.contains(e.target)||(e.preventDefault(),e.stopPropagation(),this.hide())}_handleKeydown(e){e.key==="Escape"&&(e.preventDefault(),this.hide())}destroy(){this.hide(),this._element&&this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}},Ua=null;function Wa(){return Ua||(Ua=new Ha),Ua}var rd=500,Zi=class{constructor(e,{rows:t=63,cols:n=67,frame:i=null,hiddenRows:s=[],hiddenCols:a=[],sourceMap:r=null,destMap:l=null,onToggle:c=null,panelId:d=null,defaultPinColor:h=null,getDefaultPinColor:p=null}={}){this.table=e,this.rows=t,this.cols=n,this.hiddenRows=new Set(s||[]),this.hiddenCols=new Set(a||[]),this.sourceMap=r instanceof Map?r:new Map,this.destMap=l instanceof Map?l:new Map,this._layoutRaf=null,this._built=!1,this._onTableClick=null,this._onContextMenu=null,this._onTouchStart=null,this._onTouchEnd=null,this._onTouchStartSecondFinger=null,this._longPressTimer=null,this._longPressTarget=null,this.frame=this._normalizeFrame(i),this.onToggle=typeof c=="function"?c:null,this.panelId=d,this.defaultPinColor=h,this.getDefaultPinColor=p,this._pinColors=new Map,this.onPinColorChange=null,this.getPinContext=null,this.table&&(this.table.classList.add("matrix-large"),this._applyMatrixStyling(),this._applyLayoutOffsets())}_normalizeFrame(e){let t={squarePercent:90,translateSteps:{x:0,y:0},marginsSteps:{left:0,right:0,top:0,bottom:0},clip:!0,overflowPercent:{left:25,right:60,top:25,bottom:60},maxSizePercent:100};if(!e)return t;let n=typeof e.clip=="boolean"?e.clip:t.clip,i={left:typeof e.overflowPercent?.left=="number"?e.overflowPercent.left:t.overflowPercent.left,right:typeof e.overflowPercent?.right=="number"?e.overflowPercent.right:t.overflowPercent.right,top:typeof e.overflowPercent?.top=="number"?e.overflowPercent.top:t.overflowPercent.top,bottom:typeof e.overflowPercent?.bottom=="number"?e.overflowPercent.bottom:t.overflowPercent.bottom},s=typeof e.maxSizePercent=="number"?e.maxSizePercent:n?t.maxSizePercent:300;return{squarePercent:typeof e.squarePercent=="number"?e.squarePercent:t.squarePercent,translateSteps:{x:typeof e.translateSteps?.x=="number"?e.translateSteps.x:t.translateSteps.x,y:typeof e.translateSteps?.y=="number"?e.translateSteps.y:t.translateSteps.y},marginsSteps:{left:typeof e.marginsSteps?.left=="number"?e.marginsSteps.left:t.marginsSteps.left,right:typeof e.marginsSteps?.right=="number"?e.marginsSteps.right:t.marginsSteps.right,top:typeof e.marginsSteps?.top=="number"?e.marginsSteps.top:t.marginsSteps.top,bottom:typeof e.marginsSteps?.bottom=="number"?e.marginsSteps.bottom:t.marginsSteps.bottom},clip:n,overflowPercent:i,maxSizePercent:s}}_applyMatrixStyling(){if(!this.table)return;let e=7,t=12;this.table.style.setProperty("--matrix-large-pin-size",`${e}px`),this.table.style.setProperty("--matrix-large-cell-size",`${t}px`),this.table.style.background="transparent"}_applyLayoutOffsets(){let e=this.table.closest(".matrix-container");if(!e)return;let t=this.frame.squarePercent,n=(100-t)/2,i=this.cols,s=t/i,a=this.frame.marginsSteps,r=this.frame.translateSteps,l=n+(r.x+a.left)*s,c=n+(r.y+a.top)*s,d=t-(a.left+a.right)*s,h=t-(a.top+a.bottom)*s,p=typeof this.frame.maxSizePercent=="number"?this.frame.maxSizePercent:100;d=Math.max(1,Math.min(p,d)),h=Math.max(1,Math.min(p,h));let m=this.frame.overflowPercent||{left:25,top:25,right:60,bottom:60},g=-Math.abs(m.left||0),_=-Math.abs(m.top||0),y=100-d+Math.abs(m.right||0),f=100-h+Math.abs(m.bottom||0);l=Math.min(y,Math.max(g,l)),c=Math.min(f,Math.max(_,c)),e.style.position="absolute",e.style.left=`${l}%`,e.style.top=`${c}%`,e.style.width=`${d}%`,e.style.height=`${h}%`,e.style.display="flex",e.style.alignItems="center",e.style.justifyContent="center",e.style.overflow=this.frame.clip===!1?"visible":"hidden",e.style.background="transparent",e.dataset.frameLeft=l.toFixed(3),e.dataset.frameTop=c.toFixed(3),e.dataset.frameWidth=d.toFixed(3),e.dataset.frameHeight=h.toFixed(3),e.dataset.frameClip=String(this.frame.clip!==!1)}build(){let e=this.table;if(!e)return;if(this._built){this.resizeToFit();return}e.innerHTML="",this._onTableClick=n=>{let i=n.target?.closest?.("button.pin-btn");if(!i||!e.contains(i)||i.disabled||i.classList.contains("is-hidden-pin"))return;if(this._longPressTriggered){this._longPressTriggered=!1,n.preventDefault(),n.stopPropagation();return}let s=Number(i.dataset.row),a=Number(i.dataset.col),r=!i.classList.contains("active"),l;if(r){let d=this._getPinContext(s,a);l=Wa().getNextColor(d),this._pinColors.set(`${s}:${a}`,l)}else l=this._getEffectivePinColor(s,a);(!this.onToggle||this.onToggle(s,a,r,i,l)!==!1)&&(i.classList.toggle("active",r),r?(this._applyPinColorClass(i,l),Cn(i)):(this._removePinColorClasses(i),Cn(i),this._pinColors.delete(`${s}:${a}`)),document.dispatchEvent(new CustomEvent("synth:userInteraction")))},e.addEventListener("click",this._onTableClick),this._onContextMenu=n=>{let i=n.target?.closest?.("button.pin-btn");!i||!e.contains(i)||i.disabled||i.classList.contains("is-hidden-pin")||(n.preventDefault(),n.stopPropagation(),this._showColorMenu(i,n.clientX,n.clientY))},e.addEventListener("contextmenu",this._onContextMenu),this._onTouchStart=n=>{if(n.touches.length!==1)return;let i=n.target?.closest?.("button.pin-btn");!i||!e.contains(i)||i.disabled||i.classList.contains("is-hidden-pin")||(this._longPressTarget=i,this._longPressStartPos={x:n.touches[0].clientX,y:n.touches[0].clientY},this._longPressTriggered=!1,this._longPressTimer=setTimeout(()=>{this._longPressTriggered=!0;let s=n.touches[0]||this._longPressStartPos;this._showColorMenu(i,s.clientX||this._longPressStartPos.x,s.clientY||this._longPressStartPos.y)},rd))},e.addEventListener("touchstart",this._onTouchStart,{passive:!0}),this._onTouchEnd=n=>{this._cancelLongPress()},e.addEventListener("touchend",this._onTouchEnd),e.addEventListener("touchcancel",this._onTouchEnd),this._onTouchStartSecondFinger=n=>{n.touches.length>1&&this._longPressTimer&&this._cancelLongPress()},document.addEventListener("touchstart",this._onTouchStartSecondFinger,{passive:!0,capture:!0}),e.addEventListener("touchmove",n=>{if(n.touches.length>1){this._cancelLongPress();return}if(this._longPressStartPos&&n.touches.length===1){let i=n.touches[0].clientX-this._longPressStartPos.x,s=n.touches[0].clientY-this._longPressStartPos.y;Math.hypot(i,s)>10&&this._cancelLongPress()}},{passive:!0});let t=document.createElement("tbody");for(let n=0;n<this.rows;n++){let i=document.createElement("tr");for(let s=0;s<this.cols;s++){let a=document.createElement("td"),r=document.createElement("button");r.className="pin-btn",r.dataset.row=String(n),r.dataset.col=String(s),this.hiddenRows.has(n)||this.hiddenCols.has(s)?(r.classList.add("is-hidden-pin"),r.disabled=!0,r.tabIndex=-1,r.setAttribute("aria-hidden","true")):(!this.sourceMap.has(n)||!this.destMap.has(s))&&(r.classList.add("is-inactive-pin"),r.disabled=!0,r.tabIndex=-1),a.appendChild(r),i.appendChild(a)}t.appendChild(i)}e.appendChild(t),this._built=!0,this.resizeToFit()}_cancelLongPress(){this._longPressTimer&&(clearTimeout(this._longPressTimer),this._longPressTimer=null),this._longPressTarget=null,this._longPressStartPos=null}_showColorMenu(e,t,n){let i=Number(e.dataset.row),s=Number(e.dataset.col),a=`${i}:${s}`,r=e.classList.contains("active"),l=r?this._getEffectivePinColor(i,s):null,c=this._getPinContext(i,s);Wa().show(t,n,e,{context:c,currentColor:l,isActive:r,onSelect:(h,p)=>{this._handleColorSelection(i,s,h,p,e)}})}_getPinContext(e,t){return this.getPinContext?this.getPinContext(e,t):this.panelId==="panel-5"?"audio":this.panelId==="panel-6"?"control":"audio"}_handleColorSelection(e,t,n,i,s){let a=`${e}:${t}`,r=s.classList.contains("active");this._pinColors.set(a,n),r?(this._applyPinColorClass(s,n),this.onPinColorChange&&this.onPinColorChange(e,t,n,s),document.dispatchEvent(new CustomEvent("synth:userInteraction"))):i&&(!this.onToggle||this.onToggle(e,t,!0,s,n)!==!1)&&(s.classList.add("active"),this._applyPinColorClass(s,n),document.dispatchEvent(new CustomEvent("synth:userInteraction")))}_setPinColor(e,t,n,i){let s=`${e}:${t}`,a=i?.classList.contains("active");if(n===null?this._pinColors.delete(s):this._pinColors.set(s,n),a&&i){let r=this._getEffectivePinColor(e,t);this._applyPinColorClass(i,r),this.onPinColorChange&&this.onPinColorChange(e,t,r,i),document.dispatchEvent(new CustomEvent("synth:userInteraction"))}}_getEffectivePinColor(e,t){let n=`${e}:${t}`,i=this._pinColors.get(n);if(i)return i;if(this.getDefaultPinColor){let s=this.getDefaultPinColor(e,t);if(s)return s}return this.defaultPinColor||"WHITE"}_applyPinColorClass(e,t){this._removePinColorClasses(e),t&&e.classList.add(`pin-${t.toLowerCase()}`)}_removePinColorClasses(e){e.classList.remove("pin-white","pin-grey","pin-green","pin-red","pin-blue","pin-yellow","pin-cyan","pin-purple")}getPinColor(e,t){return this._pinColors.get(`${e}:${t}`)||null}resizeToFit(){let e=this.table;if(!e)return;let t=e.closest(".matrix-container");t&&(this._layoutRaf&&cancelAnimationFrame(this._layoutRaf),this._layoutRaf=requestAnimationFrame(()=>{this._layoutRaf=null,e.style.transform="none";let n=t.getBoundingClientRect(),i=e.getBoundingClientRect(),s=n.width,a=n.height,r=i.width,l=i.height;if(!s||!a||!r||!l)return;let c=s/r,d=a/l,h=.999,p=Math.min(c,d),m=p<1?p*h:1;e.style.transformOrigin="center center",e.style.transform=`scale(${m})`}))}setToggleHandler(e){this.onToggle=typeof e=="function"?e:null}serialize(){let e=[];return!this.table||!this._built?{connections:e}:(this.table.querySelectorAll("button.pin-btn.active").forEach(n=>{let i=parseInt(n.dataset.row,10),s=parseInt(n.dataset.col,10);if(!isNaN(i)&&!isNaN(s)){let a=this._pinColors.get(`${i}:${s}`);a?e.push([i,s,a]):e.push([i,s])}}),{connections:e})}deserialize(e){if(!e||!Array.isArray(e.connections)||!this.table||!this._built)return;this._pinColors.clear();let t=new Set,n=this.table.querySelectorAll("button.pin-btn.active");n.forEach(s=>{t.add(`${s.dataset.row}:${s.dataset.col}`)}),n.forEach(s=>{let a=parseInt(s.dataset.row,10),r=parseInt(s.dataset.col,10);this.onToggle&&this.onToggle(a,r,!1,s),s.classList.remove("active"),this._removePinColorClasses(s)});let i=new Set;e.connections.forEach(s=>{let a=s[0],r=s[1],l=s[2]||null,c=this.table.querySelector(`button.pin-btn[data-row="${a}"][data-col="${r}"]`);if(c&&!c.disabled&&!c.classList.contains("is-hidden-pin")){l&&this._pinColors.set(`${a}:${r}`,l);let d=this._getEffectivePinColor(a,r);this.onToggle?this.onToggle(a,r,!0,c,d)!==!1&&(c.classList.add("active"),this._applyPinColorClass(c,d),i.add(`${a}:${r}`)):(c.classList.add("active"),this._applyPinColorClass(c,d),i.add(`${a}:${r}`))}});for(let s of t)if(!i.has(s)){let[a,r]=s.split(":"),l=this.table.querySelector(`button.pin-btn[data-row="${a}"][data-col="${r}"]`);l&&Cn(l)}for(let s of i)if(!t.has(s)){let[a,r]=s.split(":"),l=this.table.querySelector(`button.pin-btn[data-row="${a}"][data-col="${r}"]`);l&&Cn(l)}}clearAll(){if(!this.table||!this._built)return;this._pinColors.clear(),this.table.querySelectorAll("button.pin-btn.active").forEach(t=>{let n=parseInt(t.dataset.row,10),i=parseInt(t.dataset.col,10);this.onToggle&&this.onToggle(n,i,!1,t),t.classList.remove("active"),this._removePinColorClasses(t),Cn(t)})}setShowInactivePins(e){if(!this.table||!this._built)return;this.table.querySelectorAll("button.pin-btn").forEach(n=>{if(n.classList.contains("is-hidden-pin"))return;let i=parseInt(n.dataset.row,10),s=parseInt(n.dataset.col,10);(!this.sourceMap.has(i)||!this.destMap.has(s))&&(e?(n.classList.remove("is-inactive-pin"),n.disabled=!1,n.tabIndex=0):(n.classList.add("is-inactive-pin"),n.disabled=!0,n.tabIndex=-1))})}};Oe();function ld(o){if(!o||!o.kind)return null;switch(o.kind){case"inputAmp":return u("matrix.source.inputAmp",{channel:(o.channel??0)+1});case"outputBus":return u("matrix.source.outputBus",{bus:o.bus??1});case"noiseGen":return u("matrix.source.noiseGen",{index:(o.index??0)+1});case"panel3Osc":{let e=(o.oscIndex??0)+1,n=(o.channelId||"sineSaw")==="triPulse"?"matrix.source.panel3Osc.triPulse":"matrix.source.panel3Osc.sineSaw";return u(n,{osc:e})}case"joystick":{let e=o.side==="right"?"R":"L",t=(o.axis||"y").toUpperCase();return u("matrix.source.joystick",{side:e,axis:t})}default:return null}}function cd(o){if(!o||!o.kind)return null;switch(o.kind){case"outputBus":return u("matrix.dest.outputBus",{bus:o.bus??1});case"oscilloscope":{let t=`matrix.dest.oscilloscope.${o.channel||"Y"}`;return u(t)}case"oscFreqCV":return u("matrix.dest.oscFreqCV",{osc:(o.oscIndex??0)+1});case"oscSync":return u("matrix.dest.oscSync",{osc:(o.oscIndex??0)+1});case"oscPWM":return u("matrix.dest.oscPWM",{osc:(o.oscIndex??0)+1});case"outputLevelCV":return u("matrix.dest.outputLevelCV",{bus:(o.busIndex??0)+1});default:return null}}var Ya=class{constructor({autoHideDelay:e=5e3,tapMaxDuration:t=300,tapMaxDistance:n=10}={}){this.autoHideDelay=e,this.tapMaxDuration=t,this.tapMaxDistance=n,this._element=null,this._hideTimeout=null,this._isVisible=!1,this._currentPinBtn=null,this._touchStartTime=0,this._touchStartPos=null,this._touchStartTarget=null,this._wasSingleFinger=!1,this._blockNextClick=!1,this._clickBlockTimeout=null,this._onMouseEnter=this._handleMouseEnter.bind(this),this._onMouseLeave=this._handleMouseLeave.bind(this),this._onTouchStart=this._handleTouchStart.bind(this),this._onTouchEnd=this._handleTouchEnd.bind(this),this._onDocumentTap=this._handleDocumentTap.bind(this),this._onMatrixClick=this._handleMatrixClick.bind(this),this._onMatrixDblClick=this._handleMatrixDblClick.bind(this),this._attachedMatrices=new Map,this._tooltipHideCallback=()=>{this.hide()},this._unregisterTooltipHide=vn(this._tooltipHideCallback)}get element(){return this._element||(this._element=document.createElement("div"),this._element.className="matrix-tooltip",this._element.setAttribute("role","tooltip"),this._element.setAttribute("aria-hidden","true"),document.body.appendChild(this._element)),this._element}attachToMatrix(e,{sourceMap:t,destMap:n,rowBase:i=67,colBase:s=1}){e&&(this._attachedMatrices.set(e,{sourceMap:t,destMap:n,rowBase:i,colBase:s}),window.matchMedia("(hover: hover) and (pointer: fine)").matches&&(e.addEventListener("mouseover",this._onMouseEnter),e.addEventListener("mouseout",this._onMouseLeave)),e.addEventListener("touchstart",this._onTouchStart,{passive:!0}),e.addEventListener("touchend",this._onTouchEnd,{passive:!1}),e.addEventListener("click",this._onMatrixClick,{capture:!0}),e.addEventListener("dblclick",this._onMatrixDblClick,{capture:!0}))}detachFromMatrix(e){e&&(this._attachedMatrices.delete(e),e.removeEventListener("mouseover",this._onMouseEnter),e.removeEventListener("mouseout",this._onMouseLeave),e.removeEventListener("touchstart",this._onTouchStart),e.removeEventListener("touchend",this._onTouchEnd),e.removeEventListener("click",this._onMatrixClick,{capture:!0}),e.removeEventListener("dblclick",this._onMatrixDblClick,{capture:!0}))}show(e,t,{autoHide:n=!0}={}){if(!e||!t)return;_n(this._tooltipHideCallback),this._currentPinBtn&&this._currentPinBtn!==e&&this._currentPinBtn.classList.remove("is-tooltip-target"),this._currentPinBtn=e,e.classList.add("is-tooltip-target");let i=this.element;if(typeof t=="string")i.textContent=t;else{let{text:h,pinInfo:p}=t;p?i.innerHTML=`<div class="matrix-tooltip__route">${this._escapeHtml(h)}</div><div class="matrix-tooltip__pin-info">${this._escapeHtml(p)}</div>`:i.textContent=h}i.setAttribute("aria-hidden","false");let s=e.getBoundingClientRect(),a=i.getBoundingClientRect(),r=s.left+s.width/2-a.width/2,l=s.top-a.height-8,c={width:window.innerWidth,height:window.innerHeight},d=8;r<d?r=d:r+a.width>c.width-d&&(r=c.width-a.width-d),l<d&&(l=s.bottom+8),l+a.height>c.height-d&&(l=Math.max(d,c.height-a.height-d),r=s.right+8,r+a.width>c.width-d&&(r=s.left-a.width-8)),i.style.left=`${r}px`,i.style.top=`${l}px`,i.classList.add("is-visible"),this._isVisible=!0,this._clearHideTimeout(),n&&(this._hideTimeout=setTimeout(()=>this.hide(),this.autoHideDelay),document.addEventListener("touchstart",this._onDocumentTap,{passive:!0,once:!0}))}hide(){this._element&&(this._currentPinBtn&&(this._currentPinBtn.classList.remove("is-tooltip-target"),this._currentPinBtn=null),this._element.classList.remove("is-visible"),this._element.setAttribute("aria-hidden","true"),this._isVisible=!1,this._clearHideTimeout())}destroy(){this.hide(),this._attachedMatrices.forEach((e,t)=>this.detachFromMatrix(t)),this._attachedMatrices.clear(),this._unregisterTooltipHide&&(this._unregisterTooltipHide(),this._unregisterTooltipHide=null),this._element&&this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}_clearHideTimeout(){this._hideTimeout&&(clearTimeout(this._hideTimeout),this._hideTimeout=null)}_getTooltipText(e,t,n,i=null){let{sourceMap:s,destMap:a,rowBase:r,colBase:l}=n,c=s?.get(e),d=a?.get(t);if(!c&&!d)return null;let h=c?ld(c):u("matrix.tooltip.unknownSource",{row:e+r}),p=d?cd(d):u("matrix.tooltip.unknownDest",{col:t+l}),m=u("matrix.tooltip.format",{source:h,dest:p}),g=null;if(i&&i.classList.contains("active")){let _=this._getPinColorFromButton(i);_&&(g=eo(_))}return{text:m,pinInfo:g}}_getPinColorFromButton(e){let t=["pin-white","pin-grey","pin-green","pin-red","pin-blue","pin-yellow","pin-cyan","pin-purple"];for(let n of t)if(e.classList.contains(n))return n.replace("pin-","").toUpperCase();return"WHITE"}_escapeHtml(e){let t=document.createElement("div");return t.textContent=e,t.innerHTML}_getMapsForTable(e){return this._attachedMatrices.get(e)||null}_handleMouseEnter(e){let t=e.target?.closest?.("button.pin-btn");if(!t||t.classList.contains("is-hidden-pin"))return;let n=t.closest("table"),i=this._getMapsForTable(n);if(!i)return;let s=parseInt(t.dataset.row,10),a=parseInt(t.dataset.col,10),r=this._getTooltipText(s,a,i,t);r&&this.show(t,r,{autoHide:!1})}_handleMouseLeave(e){e.target?.closest?.("button.pin-btn")&&this.hide()}_handleTouchStart(e){if(e.touches.length>1){this._wasSingleFinger=!1,this._touchStartTarget=null;return}let t=e.target?.closest?.("button.pin-btn");if(!t||t.classList.contains("is-hidden-pin")||t.disabled){this._touchStartTarget=null;return}this._wasSingleFinger=!0,this._touchStartTime=Date.now(),this._touchStartPos={x:e.touches[0].clientX,y:e.touches[0].clientY},this._touchStartTarget=t}_handleTouchEnd(e){let t=this._touchStartTarget;if(!t||!this._wasSingleFinger){this._resetTouchState();return}if(Date.now()-this._touchStartTime>this.tapMaxDuration){this._resetTouchState();return}if(e.changedTouches.length>0){let d={x:e.changedTouches[0].clientX,y:e.changedTouches[0].clientY};if(Math.hypot(d.x-this._touchStartPos.x,d.y-this._touchStartPos.y)>this.tapMaxDistance){this._resetTouchState();return}}if(this._isVisible&&this._currentPinBtn===t){this._clearHideTimeout(),this._hideTimeout=setTimeout(()=>this.hide(),this.autoHideDelay),this._blockNextClick=!1,this._clickBlockTimeout&&(clearTimeout(this._clickBlockTimeout),this._clickBlockTimeout=null),this._resetTouchState();return}e.preventDefault(),this._blockNextClick=!0,this._clickBlockTimeout&&clearTimeout(this._clickBlockTimeout),this._clickBlockTimeout=setTimeout(()=>{this._blockNextClick=!1},500);let s=t.closest("table"),a=this._getMapsForTable(s);if(!a){this._resetTouchState();return}let r=parseInt(t.dataset.row,10),l=parseInt(t.dataset.col,10),c=this._getTooltipText(r,l,a,t);c&&this.show(t,c),this._resetTouchState()}_resetTouchState(){this._touchStartTime=0,this._touchStartPos=null,this._touchStartTarget=null,this._wasSingleFinger=!1}_handleDocumentTap(e){if(!this._isVisible)return;let t=this._element,n=e.target;if(t&&t.contains(n)){document.addEventListener("touchstart",this._onDocumentTap,{passive:!0,once:!0});return}n?.closest?.("button.pin-btn")||this.hide()}_handleMatrixClick(e){this._blockNextClick&&e.target?.closest?.("button.pin-btn")&&(e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),this._blockNextClick=!1,this._clickBlockTimeout&&(clearTimeout(this._clickBlockTimeout),this._clickBlockTimeout=null))}_handleMatrixDblClick(e){let t=e.target?.closest?.("button.pin-btn");t&&(e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),t.click())}},ja=null;function jl(){return ja||(ja=new Ya),ja}var ud=["Pulse level","Pulse shape","Sine level","Sine symmetry","Triangle level","Sawtooth level","Frequency"],Yl=[Fn,Pa,Et,Pa,Fn,Et,Cl],dd=[{min:0,max:10},{min:-5,max:5},{min:0,max:10},{min:-5,max:5},{min:0,max:10},{min:0,max:10},{min:0,max:10}],to=class{constructor(e={}){this.id=e.id||`sgme-osc-${Date.now()}`,this.title=e.title||"Oscillator",this.size=e.size||{width:320,height:90};let t=e.knobGap??8;this.knobGap=Array.isArray(t)?t:Array(6).fill(t),this.buttonSize=e.buttonSize||{width:18,height:30,indicator:8},this.switchOffset=e.switchOffset||{leftPercent:36,topPx:6},this.knobSize=e.knobSize||42,this.knobInnerPct=e.knobInnerPct||78,this.knobRowOffsetX=e.knobRowOffsetX??0,this.knobRowOffsetY=e.knobRowOffsetY||-6,this.knobOffsets=e.knobOffsets||[0,0,0,0,0,0,0],this.knobLabels=e.knobLabels||ud,this.knobOptions=e.knobOptions||[],this.knobs=[],this.rangeState="hi",this.onRangeChange=e.onRangeChange||null,this.knobRange=e.knobRange||{min:0,max:1,initial:0,pixelsForFullRange:150}}createElement(){let e=document.createElement("div");e.className="sgme-osc",e.id=this.id,e.style.setProperty("--osc-width",`${this.size.width}px`),e.style.setProperty("--osc-height",`${this.size.height}px`),e.style.setProperty("--osc-knob-size",`${this.knobSize}px`),e.style.setProperty("--osc-knob-inner-pct",`${this.knobInnerPct}%`),e.style.setProperty("--osc-knob-row-offset-y",`${this.knobRowOffsetY}px`),e.style.setProperty("--switch-left-percent",`${this.switchOffset.leftPercent}%`),e.style.setProperty("--switch-top-px",`${this.switchOffset.topPx}px`),e.style.setProperty("--osc-button-width",`${this.buttonSize.width}px`),e.style.setProperty("--osc-button-height",`${this.buttonSize.height}px`),e.style.setProperty("--osc-button-indicator-size",`${this.buttonSize.indicator}px`),e.style.width=`${this.size.width}px`,e.style.height=`${this.size.height}px`;let t=document.createElement("div");t.className="sgme-osc__top";let n=document.createElement("div");n.className="sgme-osc__header",n.textContent=this.title,t.appendChild(n);let i=document.createElement("div");i.className="sgme-osc__labels",this.knobLabels.forEach(d=>{let h=document.createElement("span");h.textContent=d,i.appendChild(h)}),t.appendChild(i);let s=document.createElement("div");s.className="output-channel__switch-wrap sgme-osc__switch-wrap";let a=document.createElement("button");a.type="button",a.className="output-channel__switch",a.setAttribute("aria-label",`${this.title} range`);let r=document.createElement("span");r.className="output-channel__switch-indicator",a.appendChild(r),a.addEventListener("click",()=>{this.rangeState=this.rangeState==="hi"?"lo":"hi",this._renderRange(a),typeof this.onRangeChange=="function"&&this.onRangeChange(this.rangeState),Ae(a)}),s.appendChild(a),t.appendChild(s);let l=document.createElement("div");l.className="sgme-osc__bottom";let c=document.createElement("div");return c.className="sgme-osc__knobs",c.style.transform=`translate(${this.knobRowOffsetX}px, ${this.knobRowOffsetY}px)`,this.knobLabels.forEach((d,h)=>{let p=document.createElement("div");p.className="sgme-osc__knob-shell",h>0&&this.knobGap[h-1]&&(p.style.marginLeft=`${this.knobGap[h-1]}px`),Number.isFinite(this.knobOffsets[h])&&(p.style.transform=`translateY(${this.knobOffsets[h]}px)`);let m=document.createElement("div");m.className="knob knob--svg sgme-osc__knob",m.style.width=`${this.knobSize}px`,m.style.height=`${this.knobSize}px`;let g=document.createElement("div");g.className="knob-inner";let _=document.createElement("img");_.className="knob-svg-ring";let y=dd[h]||{min:0,max:10};_.src=y.min<0?"assets/knobs/knob-0-center.svg":"assets/knobs/knob.svg",_.alt="",_.draggable=!1,g.appendChild(_),m.appendChild(g);let f=document.createElement("div");f.className="knob-center",Yl[h]&&f.style.setProperty("--knob-center-color",Yl[h]),m.appendChild(f),p.appendChild(m);let b=document.createElement("div");b.className="knob-value sgme-osc__knob-value",p.appendChild(b),c.appendChild(p);let E={min:this.knobRange.min,max:this.knobRange.max,initial:this.knobRange.initial,pixelsForFullRange:this.knobRange.pixelsForFullRange,scaleMin:y.min,scaleMax:y.max,scaleDecimals:1,valueElement:b},w=this.knobOptions[h]||{},S=new Ct(m,{...E,...w});this.knobs.push(S)}),l.appendChild(c),e.appendChild(t),e.appendChild(l),this._renderRange(a),e}_renderRange(e){let t=this.rangeState==="hi";e.classList.toggle("is-on",t),e.setAttribute("aria-pressed",String(t)),e.setAttribute("data-state",t?"hi":"lo")}serialize(){return{knobs:this.knobs.map(e=>e.getValue()),rangeState:this.rangeState}}deserialize(e){if(e){if(e.rangeState==="hi"||e.rangeState==="lo"){let t=e.rangeState!==this.rangeState;this.rangeState=e.rangeState;let n=document.querySelector(`#${this.id} .output-channel__switch`);n&&(this._renderRange(n),t&&Ae(n))}Array.isArray(e.knobs)&&e.knobs.forEach((t,n)=>{this.knobs[n]&&typeof t=="number"&&this.knobs[n].setValue(t)})}}};var pi=class{constructor(e={}){let{id:t="module",title:n="Module",cssClass:i="module-ui",knobDefs:s=[],knobOptions:a={},knobSize:r=40}=e;this.id=t,this.title=n,this.cssClass=i,this.knobDefs=s,this.knobOptions=a,this.knobSize=r,this.knobInnerPct=e.knobInnerPct??76;let l=e.knobGap??8;this.knobGap=Array.isArray(l)?l:Array(Math.max(0,s.length-1)).fill(l),this.knobRowOffsetX=e.knobRowOffsetX??0,this.knobRowOffsetY=e.knobRowOffsetY??0,this.knobOffsets=e.knobOffsets||new Array(s.length).fill(0),this.element=null,this.knobs={}}createElement(){let e=document.createElement("div");e.id=this.id,e.className=this.cssClass,e.style.setProperty("--module-knob-size",`${this.knobSize}px`),e.style.setProperty("--module-knob-inner-pct",`${this.knobInnerPct}%`);let t=document.createElement("div");t.className=`${this.cssClass}__header`,t.textContent=this.title,e.appendChild(t);let n=document.createElement("div");return n.className=`${this.cssClass}__knobs`,(this.knobRowOffsetX||this.knobRowOffsetY)&&(n.style.transform=`translate(${this.knobRowOffsetX}px, ${this.knobRowOffsetY}px)`),n.style.gap="0",this.knobDefs.forEach((i,s)=>{let a=this._createKnobShell(i.label,i.key);s>0&&this.knobGap[s-1]&&(a.style.marginLeft=`${this.knobGap[s-1]}px`),Number.isFinite(this.knobOffsets[s])&&this.knobOffsets[s]!==0&&(a.style.transform=`translateY(${this.knobOffsets[s]}px)`),n.appendChild(a)}),e.appendChild(n),this.element=e,e}_createKnobShell(e,t){let n=document.createElement("div");n.className=`${this.cssClass}__knob-shell`;let i=document.createElement("div");i.className=`${this.cssClass}__knob-label`,i.textContent=e,n.appendChild(i);let s=document.createElement("div");s.className=`knob knob--svg ${this.cssClass}__knob`;let a=document.createElement("div");a.className="knob-inner";let r=document.createElement("img");r.className="knob-svg-ring",r.src="assets/knobs/knob.svg",r.alt="",r.draggable=!1,a.appendChild(r),s.appendChild(a);let l=document.createElement("div");l.className="knob-center";let c=this.knobDefs.find(g=>g.key===t);c?.color&&l.style.setProperty("--knob-center-color",c.color),s.appendChild(l),n.appendChild(s);let d=document.createElement("div");d.className=`knob-value ${this.cssClass}__knob-value`,n.appendChild(d);let h=this.knobOptions[t]||{},p={valueElement:d,min:h.min??0,max:h.max??1,initial:h.initial??0,onChange:h.onChange||(()=>{}),pixelsForFullRange:h.pixelsForFullRange??150,scaleMin:h.scaleMin??0,scaleMax:h.scaleMax??10,scaleDecimals:h.scaleDecimals??1};h.getTooltipInfo&&(p.getTooltipInfo=h.getTooltipInfo);let m=new Ct(s,p);return this.knobs[t]=m,n}getValue(e){return this.knobs[e]?.getValue()??0}setValue(e,t){this.knobs[e]?.setValue(t)}getElement(){return this.element}serialize(){let e={};for(let t of Object.keys(this.knobs))e[t]=this.knobs[t].getValue();return e}deserialize(e){if(e)for(let t of Object.keys(e))this.knobs[t]&&typeof e[t]=="number"&&this.knobs[t].setValue(e[t])}};var Ji=class extends pi{constructor(e={}){super({id:e.id||"noise-gen",title:e.title||"Noise",cssClass:"noise-generator",knobDefs:[{key:"colour",label:"Colour",color:Fn},{key:"level",label:"Level",color:Et}],knobOptions:e.knobOptions||{},knobSize:e.knobSize||40,knobInnerPct:e.knobInnerPct,knobGap:e.knobGap,knobRowOffsetX:e.knobRowOffsetX,knobRowOffsetY:e.knobRowOffsetY,knobOffsets:e.knobOffsets})}};var no=class extends pi{constructor(e={}){super({id:e.id||"random-voltage",title:e.title||"Random Voltage",cssClass:"random-voltage",knobDefs:[{key:"mean",label:"Mean",color:Oa},{key:"variance",label:"Variance",color:Oa},{key:"voltage1",label:"Voltage 1",color:Et},{key:"voltage2",label:"Voltage 2",color:Et},{key:"key",label:"Key",color:Et}],knobOptions:e.knobOptions||{},knobSize:e.knobSize||40,knobInnerPct:e.knobInnerPct,knobGap:e.knobGap,knobRowOffsetX:e.knobRowOffsetX,knobRowOffsetY:e.knobRowOffsetY,knobOffsets:e.knobOffsets})}};var io=class{constructor(e={}){this.id=e.id||"input-amplifiers",this.title=e.title||"Input Amplifier Level",this.channels=e.channels||8,this.knobConfig=e.knobConfig||{min:0,max:1,initial:0,pixelsForFullRange:150},this.layout={knobGap:e.layout?.knobGap??e.layout?.knobsGap??8,knobSize:e.layout?.knobSize??"sm",knobInnerPct:e.layout?.knobInnerPct??78,knobsRowOffset:e.layout?.knobsRowOffset||{x:0,y:0},knobOffsets:Array.isArray(e.layout?.knobOffsets)?e.layout.knobOffsets:[]},this.onLevelChange=e.onLevelChange||null,this.knobs=[],this.element=null,this.frame=null}createElement(){this.frame=new Ve({id:this.id,title:this.title,className:"synth-module--input-amplifier"}),this.element=this.frame.createElement();let e=document.createElement("div");e.className="input-amplifier__knobs-row",e.style.gap=`${Number.isFinite(Number(this.layout.knobGap))?Number(this.layout.knobGap):8}px`;let t=Number(this.layout.knobsRowOffset?.x)||0,n=Number(this.layout.knobsRowOffset?.y)||0;(t!==0||n!==0)&&(e.style.transform=`translate(${t}px, ${n}px)`);for(let i=0;i<this.channels;i++){let s=this._createChannelKnob(i);e.appendChild(s)}return this.frame.appendToContent(e),this.element}_createChannelKnob(e){let t=document.createElement("div");t.className="input-amplifier__channel";let n=this.layout.knobOffsets?.[e],i=Number(n?.x)||0,s=Number(n?.y)||0;(i!==0||s!==0)&&(t.style.transform=`translate(${i}px, ${s}px)`);let a=document.createElement("div");a.className="input-amplifier__label",a.textContent=`Channel ${e+1}`,t.appendChild(a);let r=document.createElement("div"),l=typeof this.layout.knobSize=="string"&&this.layout.knobSize?` knob--${this.layout.knobSize}`:"";r.className=`knob knob--svg${l} input-amplifier__knob`,typeof this.layout.knobSize=="number"&&Number.isFinite(this.layout.knobSize)&&this.layout.knobSize>0&&(r.style.width=`${this.layout.knobSize}px`,r.style.height=`${this.layout.knobSize}px`);let c=document.createElement("div");c.className="knob-inner";let d=document.createElement("img");d.className="knob-svg-ring",d.src="assets/knobs/knob.svg",d.alt="",d.draggable=!1,c.appendChild(d),r.appendChild(c);let h=document.createElement("div");h.className="knob-center",h.style.setProperty("--knob-center-color",Et),r.appendChild(h),t.appendChild(r);let p=document.createElement("div");p.className="knob-value input-amplifier__value",t.appendChild(p);let m=new Ct(r,{min:this.knobConfig.min,max:this.knobConfig.max,initial:this.knobConfig.initial,pixelsForFullRange:this.knobConfig.pixelsForFullRange,scaleMin:0,scaleMax:10,scaleDecimals:1,valueElement:p,onChange:g=>{this.onLevelChange&&this.onLevelChange(e,g)}});return this.knobs.push(m),t}setLevel(e,t){let n=this.knobs[e];n&&n.setValue(t)}getLevel(e){let t=this.knobs[e];return t?t.getValue():0}getElement(){return this.element}serialize(){return{levels:this.knobs.map(e=>e.getValue())}}deserialize(e){!e||!Array.isArray(e.levels)||e.levels.forEach((t,n)=>{this.knobs[n]&&typeof t=="number"&&this.knobs[n].setValue(t)})}};var Kl={schemaVersion:2,panelId:"panel-1",showFrames:!0,layout:{offset:{x:0,y:0},padding:{top:8,right:10,bottom:8,left:10},gap:4,filtersRow:{height:120,gap:3,offset:{x:0,y:0},knobs:["Frequency","Response","Level"],knobSize:"sm",knobInnerPct:78,knobGap:2,knobsOffset:{x:0,y:0},knobDirection:"vertical"},envelopeShapers:{height:65,gap:4,offset:{x:0,y:0},knobs:["Mode","Delay","Attack","Decay","Sustain","Release","Env Level","Sig Level"],knobSize:"sm",knobInnerPct:78,knobGap:2,knobsOffset:{x:0,y:0},knobDirection:"horizontal",count:3},bottomRow:{height:80,gap:3,offset:{x:0,y:0},ringModulator:{count:3,knobs:["Level"],knobSize:"sm",knobInnerPct:78,knobGap:6,knobsOffset:{x:0,y:0}},reverberation:{count:1,knobs:["Mix","Level"],knobSize:"sm",knobInnerPct:78,knobGap:6,knobsOffset:{x:0,y:0}},echo:{count:1,knobs:["Delay","Mix","Feedback","Level"],knobSize:"sm",knobInnerPct:78,knobGap:6,knobsOffset:{x:0,y:0}}}},modules:{flp1:{visible:!1},flp2:{visible:!1},flp3:{visible:!1},flp4:{visible:!1},fhp1:{visible:!1},fhp2:{visible:!1},fhp3:{visible:!1},fhp4:{visible:!1},envelopeShaper1:{visible:!1},envelopeShaper2:{visible:!1},envelopeShaper3:{visible:!1},ringModulator1:{visible:!1},ringModulator2:{visible:!1},ringModulator3:{visible:!1},reverberation1:{visible:!1},echoADL:{visible:!1}}};var Xl={schemaVersion:2,panelId:"panel-2",showFrames:!1,layout:{offset:{x:0,y:0},padding:{top:10,right:15,bottom:10,left:15},gap:6,oscilloscope:{size:{width:527,height:225},offset:{x:105,y:22},frame:{borderRadius:6,padding:{top:8,right:10,bottom:8,left:10}},display:{size:{width:178,height:142},offset:{x:19,y:10},transparent:!0,beamOffsets:{beam1Y:4,beam2Y:-4},centerOffset:{x:4,y:0}}},frequencyMeter:{size:{width:744,height:143},offset:{x:-7,y:81}},octaveFilterBank:{size:{width:744,height:93},offset:{x:-7,y:76}},inputAmplifierLevel:{size:{width:744,height:93},offset:{x:-7,y:70},knobGap:28.5,knobSize:65,knobInnerPct:78,knobsRowOffset:{x:0,y:18},knobOffsets:[{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0}]},externalTreatmentRow:{gap:2,extTreatmentSend:{size:{width:371,height:94},offset:{x:-7.5,y:65}},extTreatmentReturn:{size:{width:371,height:94},offset:{x:-7.5,y:65}}}},modules:{oscilloscope:{visible:!0},frequencyMeter:{visible:!1},octaveFilterBank:{visible:!1},inputAmplifierLevel:{visible:!0},extTreatmentSend:{visible:!1},extTreatmentReturn:{visible:!1}}};var at={schemaVersion:1,panelId:"panel-3",showFrames:!1,layout:{offset:{x:0,y:0},oscillators:{columns:2,rowsPerColumn:6,oscSize:{width:375,height:103},gap:{x:0,y:.3},airOuter:0,airOuterY:0,topOffset:3.2,reservedHeight:110},modulesRow:{gap:0,noiseSize:{width:169.5,height:110},randomCVSize:{width:411,height:110},padding:{top:0,right:4,bottom:0,left:4}}},oscillatorUI:{knobSize:45,knobInnerPct:76,knobGap:[9.3,9.3,9.3,9.3,9.3,.5],knobRowOffsetX:-2,knobRowOffsetY:-17,knobOffsets:[6,6,6,6,6,6,-18],buttonSize:{width:18,height:30,indicator:8},switchOffset:{leftPercent:36,topPx:6},slotOffset:{x:0,y:0}},noiseUI:{knobSize:65,knobInnerPct:76,knobGap:[15],knobRowOffsetX:3,knobRowOffsetY:28,knobOffsets:[0,0]},randomCVUI:{knobSize:65,knobInnerPct:76,knobGap:[12.9,12.9,12.9,12.9],knobRowOffsetX:1,knobRowOffsetY:28,knobOffsets:[0,0,0,0,0]},oscillatorSlots:[{oscIndex:0,col:0,row:0},{oscIndex:1,col:0,row:1},{oscIndex:2,col:0,row:2},{oscIndex:3,col:0,row:3},{oscIndex:4,col:0,row:4},{oscIndex:5,col:0,row:5},{oscIndex:6,col:1,row:0},{oscIndex:7,col:1,row:1},{oscIndex:8,col:1,row:2},{oscIndex:9,col:1,row:3},{oscIndex:10,col:1,row:4},{oscIndex:11,col:1,row:5}],modules:{noise1:{visible:!0},noise2:{visible:!0},randomCV:{visible:!1}}};var mi={schemaVersion:1,panelId:"panel-5",matrixId:"audio",grid:{rows:63,cols:67,coordSystem:{rowBase:67,colBase:1}},ui:{frame:{squarePercent:90,translateSteps:{x:5.1,y:0},marginsSteps:{left:-7.47,right:-3,top:4.7,bottom:2.7},clip:!0,overflowPercent:{left:25,top:25,right:200,bottom:80},maxSizePercent:300},hiddenCols0:[33,65,66],hiddenRows0:[30,31,32,62]},sources:[{rowSynth:67,source:{kind:"inputAmp",channel:0}},{rowSynth:68,source:{kind:"inputAmp",channel:1}},{rowSynth:69,source:{kind:"inputAmp",channel:2}},{rowSynth:70,source:{kind:"inputAmp",channel:3}},{rowSynth:71,source:{kind:"inputAmp",channel:4}},{rowSynth:72,source:{kind:"inputAmp",channel:5}},{rowSynth:73,source:{kind:"inputAmp",channel:6}},{rowSynth:74,source:{kind:"inputAmp",channel:7}},{rowSynth:75,source:{kind:"outputBus",bus:1}},{rowSynth:76,source:{kind:"outputBus",bus:2}},{rowSynth:77,source:{kind:"outputBus",bus:3}},{rowSynth:78,source:{kind:"outputBus",bus:4}},{rowSynth:79,source:{kind:"outputBus",bus:5}},{rowSynth:80,source:{kind:"outputBus",bus:6}},{rowSynth:81,source:{kind:"outputBus",bus:7}},{rowSynth:82,source:{kind:"outputBus",bus:8}},{rowSynth:89,source:{kind:"noiseGen",index:0}},{rowSynth:90,source:{kind:"noiseGen",index:1}},{rowSynth:91,source:{kind:"panel3Osc",oscIndex:0,channelId:"sineSaw"}},{rowSynth:92,source:{kind:"panel3Osc",oscIndex:0,channelId:"triPulse"}},{rowSynth:93,source:{kind:"panel3Osc",oscIndex:1,channelId:"sineSaw"}},{rowSynth:94,source:{kind:"panel3Osc",oscIndex:1,channelId:"triPulse"}},{rowSynth:95,source:{kind:"panel3Osc",oscIndex:2,channelId:"sineSaw"}},{rowSynth:96,source:{kind:"panel3Osc",oscIndex:2,channelId:"triPulse"}},{rowSynth:97,source:{kind:"panel3Osc",oscIndex:3,channelId:"sineSaw"}},{rowSynth:98,source:{kind:"panel3Osc",oscIndex:3,channelId:"triPulse"}},{rowSynth:99,source:{kind:"panel3Osc",oscIndex:4,channelId:"sineSaw"}},{rowSynth:100,source:{kind:"panel3Osc",oscIndex:4,channelId:"triPulse"}},{rowSynth:101,source:{kind:"panel3Osc",oscIndex:5,channelId:"sineSaw"}},{rowSynth:102,source:{kind:"panel3Osc",oscIndex:5,channelId:"triPulse"}},{rowSynth:103,source:{kind:"panel3Osc",oscIndex:6,channelId:"sineSaw"}},{rowSynth:104,source:{kind:"panel3Osc",oscIndex:6,channelId:"triPulse"}},{rowSynth:105,source:{kind:"panel3Osc",oscIndex:7,channelId:"sineSaw"}},{rowSynth:106,source:{kind:"panel3Osc",oscIndex:7,channelId:"triPulse"}},{rowSynth:107,source:{kind:"panel3Osc",oscIndex:8,channelId:"sineSaw"}},{rowSynth:108,source:{kind:"panel3Osc",oscIndex:8,channelId:"triPulse"}}],destinations:[{colSynth:24,dest:{kind:"oscSync",oscIndex:0}},{colSynth:25,dest:{kind:"oscSync",oscIndex:1}},{colSynth:26,dest:{kind:"oscSync",oscIndex:2}},{colSynth:27,dest:{kind:"oscSync",oscIndex:3}},{colSynth:28,dest:{kind:"oscSync",oscIndex:4}},{colSynth:29,dest:{kind:"oscSync",oscIndex:5}},{colSynth:30,dest:{kind:"oscSync",oscIndex:6}},{colSynth:31,dest:{kind:"oscSync",oscIndex:7}},{colSynth:32,dest:{kind:"oscSync",oscIndex:8}},{colSynth:33,dest:{kind:"oscSync",oscIndex:9}},{colSynth:34,dest:{kind:"oscSync",oscIndex:10}},{colSynth:35,dest:{kind:"oscSync",oscIndex:11}},{colSynth:36,dest:{kind:"outputBus",bus:1}},{colSynth:37,dest:{kind:"outputBus",bus:2}},{colSynth:38,dest:{kind:"outputBus",bus:3}},{colSynth:39,dest:{kind:"outputBus",bus:4}},{colSynth:40,dest:{kind:"outputBus",bus:5}},{colSynth:41,dest:{kind:"outputBus",bus:6}},{colSynth:42,dest:{kind:"outputBus",bus:7}},{colSynth:43,dest:{kind:"outputBus",bus:8}},{colSynth:57,dest:{kind:"oscilloscope",channel:"Y"}},{colSynth:58,dest:{kind:"oscilloscope",channel:"X"}},{colSynth:59,dest:{kind:"oscPWM",oscIndex:0}},{colSynth:60,dest:{kind:"oscPWM",oscIndex:1}},{colSynth:61,dest:{kind:"oscPWM",oscIndex:2}},{colSynth:62,dest:{kind:"oscPWM",oscIndex:3}},{colSynth:63,dest:{kind:"oscPWM",oscIndex:4}},{colSynth:64,dest:{kind:"oscPWM",oscIndex:5}}]};var gi={schemaVersion:1,panelId:"panel-6",matrixId:"control",grid:{rows:63,cols:67,coordSystem:{rowBase:67,colBase:1}},ui:{frame:{squarePercent:90,translateSteps:{x:5.1,y:0},marginsSteps:{left:-7.47,right:-3,top:4.7,bottom:2.7},clip:!0,overflowPercent:{left:25,top:25,right:200,bottom:80},maxSizePercent:300},hiddenCols0:[33],hiddenRows0:[30,31,32]},sources:[{rowSynth:67,source:{kind:"inputAmp",channel:0}},{rowSynth:68,source:{kind:"inputAmp",channel:1}},{rowSynth:69,source:{kind:"inputAmp",channel:2}},{rowSynth:70,source:{kind:"inputAmp",channel:3}},{rowSynth:71,source:{kind:"inputAmp",channel:4}},{rowSynth:72,source:{kind:"inputAmp",channel:5}},{rowSynth:73,source:{kind:"inputAmp",channel:6}},{rowSynth:74,source:{kind:"inputAmp",channel:7}},{rowSynth:75,source:{kind:"outputBus",bus:1}},{rowSynth:76,source:{kind:"outputBus",bus:2}},{rowSynth:77,source:{kind:"outputBus",bus:3}},{rowSynth:78,source:{kind:"outputBus",bus:4}},{rowSynth:79,source:{kind:"outputBus",bus:5}},{rowSynth:80,source:{kind:"outputBus",bus:6}},{rowSynth:81,source:{kind:"outputBus",bus:7}},{rowSynth:82,source:{kind:"outputBus",bus:8}},{rowSynth:83,source:{kind:"panel3Osc",oscIndex:9,channelId:"sineSaw"}},{rowSynth:84,source:{kind:"panel3Osc",oscIndex:9,channelId:"triPulse"}},{rowSynth:85,source:{kind:"panel3Osc",oscIndex:10,channelId:"sineSaw"}},{rowSynth:86,source:{kind:"panel3Osc",oscIndex:10,channelId:"triPulse"}},{rowSynth:87,source:{kind:"panel3Osc",oscIndex:11,channelId:"sineSaw"}},{rowSynth:88,source:{kind:"panel3Osc",oscIndex:11,channelId:"triPulse"}},{rowSynth:117,source:{kind:"joystick",side:"left",axis:"y"}},{rowSynth:118,source:{kind:"joystick",side:"left",axis:"x"}},{rowSynth:119,source:{kind:"joystick",side:"right",axis:"y"}},{rowSynth:120,source:{kind:"joystick",side:"right",axis:"x"}}],destinations:[{colSynth:30,dest:{kind:"oscFreqCV",oscIndex:0}},{colSynth:31,dest:{kind:"oscFreqCV",oscIndex:1}},{colSynth:32,dest:{kind:"oscFreqCV",oscIndex:2}},{colSynth:33,dest:{kind:"oscFreqCV",oscIndex:3}},{colSynth:34,dest:{kind:"oscFreqCV",oscIndex:4}},{colSynth:35,dest:{kind:"oscFreqCV",oscIndex:5}},{colSynth:36,dest:{kind:"oscFreqCV",oscIndex:6}},{colSynth:37,dest:{kind:"oscFreqCV",oscIndex:7}},{colSynth:38,dest:{kind:"oscFreqCV",oscIndex:8}},{colSynth:39,dest:{kind:"oscFreqCV",oscIndex:9}},{colSynth:40,dest:{kind:"oscFreqCV",oscIndex:10}},{colSynth:41,dest:{kind:"oscFreqCV",oscIndex:11}},{colSynth:42,dest:{kind:"outputBus",bus:1}},{colSynth:43,dest:{kind:"outputBus",bus:2}},{colSynth:44,dest:{kind:"outputBus",bus:3}},{colSynth:45,dest:{kind:"outputBus",bus:4}},{colSynth:46,dest:{kind:"outputLevelCV",busIndex:0}},{colSynth:47,dest:{kind:"outputLevelCV",busIndex:1}},{colSynth:48,dest:{kind:"outputLevelCV",busIndex:2}},{colSynth:49,dest:{kind:"outputLevelCV",busIndex:3}},{colSynth:50,dest:{kind:"outputLevelCV",busIndex:4}},{colSynth:51,dest:{kind:"outputLevelCV",busIndex:5}},{colSynth:52,dest:{kind:"outputLevelCV",busIndex:6}},{colSynth:53,dest:{kind:"outputLevelCV",busIndex:7}},{colSynth:63,dest:{kind:"oscilloscope",channel:"Y"}},{colSynth:64,dest:{kind:"oscilloscope",channel:"X"}}]};var Zl={schemaVersion:2,panelId:"panel-7",showFrames:!1,layout:{offset:{x:0,y:18},padding:{top:0,right:10,bottom:10,left:10},upperRow:{gap:2,padding:{top:0,right:0,bottom:0,left:0},offset:{x:0,y:0},joystickSize:{width:215,height:240},sequencerSize:{width:252,height:240},joystickLeft:{knobs:["Range Horizontal","Range Vertical"],knobSize:65,padSize:120,layoutGap:6,knobsGap:23,knobsOffset:{x:15,y:40},padOffset:{x:13,y:40},knobOffsets:[{x:0,y:0},{x:0,y:0}]},joystickRight:{knobs:["Range Horizontal","Range Vertical"],knobSize:65,padSize:120,layoutGap:6,knobsGap:23,knobsOffset:{x:-15,y:40},padOffset:{x:-13,y:40},knobOffsets:[{x:0,y:0},{x:0,y:0}]},sequencer:{switches:["A/B+ Dey 1","B","C+ Key 2","D","E+ Key 3","F","Key 4","Stop Clock"],buttons:["Master Reset","Run Forward","Run Reverse","Stop","Reset Sequence","Step Forward","Step Reverse","Test O/P"],contentPadding:{top:4,right:4,bottom:4,left:4},rowsGap:8,switchesGap:4,buttonsGap:4,switchesOffset:{x:0,y:0},buttonsOffset:{x:0,y:0},clockRateOffset:{x:0,y:0},clockRateKnobOffset:{x:0,y:0},switchOffsets:[{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0}],buttonOffsets:[{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0}],clockRate:{label:"Clock Rate",knobSize:"sm"}}},lowerRow:{gap:.5,padding:{top:3,right:8,bottom:12,left:8},offset:{x:0,y:-2},channelSize:{width:85,height:425},slider:{shellHeight:270,height:250,width:24}}},outputChannelUI:{knobSize:60,knobInnerPct:76,knobGap:23,knobRowOffsetX:0,knobRowOffsetY:20,sliderSize:{width:24,height:125,shellHeight:270},knobButtonGap:28,buttonSliderGap:-35,buttonSize:{width:18,height:30,indicator:8},contentPadding:{top:6,right:4,bottom:8,left:4}},modules:{joystickLeft:{visible:!0},sequencer:{visible:!1},joystickRight:{visible:!0},oc1:{visible:!0},oc2:{visible:!0},oc3:{visible:!0},oc4:{visible:!0},oc5:{visible:!0},oc6:{visible:!0},oc7:{visible:!0},oc8:{visible:!0}}};be();var so=W("OscilloscopeModule"),oo=class extends wt{constructor(e,t="oscilloscope"){super(e,t,"Oscilloscope"),this.inputY=null,this.inputX=null,this.captureNode=null,this.lastData={bufferY:null,bufferX:null,sampleRate:44100,triggered:!1},this._onDataCallbacks=[],this.workletReady=!1,this._workletLoadPromise=null,this.mode="yt",this.triggerEnabled=!0,this.triggerLevel=0,this.bufferSize=1024,this.triggerHysteresis=150,this.schmittHysteresis=.05,this.inputSensitivity=1}async start(){let e=this.getAudioCtx();e&&(this.inputY=e.createGain(),this.inputY.gain.value=this.inputSensitivity,this.inputX=e.createGain(),this.inputX.gain.value=this.inputSensitivity,await this._loadWorklet(),this.workletReady?this._createCaptureNode():(so.warn(" Worklet not available, using fallback"),this._createFallbackCapture()))}async _loadWorklet(){if(this._workletLoadPromise)return this._workletLoadPromise;let e=this.getAudioCtx();if(e)return this._workletLoadPromise=(async()=>{try{await e.audioWorklet.addModule("./assets/js/worklets/scopeCapture.worklet.js"),this.workletReady=!0,so.info(" ScopeCapture worklet loaded")}catch(t){so.error(" Failed to load worklet:",t),this.workletReady=!1}})(),this._workletLoadPromise}_createCaptureNode(){let e=this.getAudioCtx();!e||!this.workletReady||(this.captureNode=new AudioWorkletNode(e,"scope-capture",{numberOfInputs:2,numberOfOutputs:0,processorOptions:{bufferSize:this.bufferSize,triggerHysteresis:this.triggerHysteresis,schmittHysteresis:this.schmittHysteresis}}),We(this.captureNode,"scope-capture"),this.inputY.connect(this.captureNode,0,0),this.inputX.connect(this.captureNode,0,1),this.captureNode.port.onmessage=t=>{if(t.data.type==="scopeData"){this.lastData={bufferY:t.data.bufferY,bufferX:t.data.bufferX,sampleRate:t.data.sampleRate,triggered:t.data.triggered,validLength:t.data.validLength,isAuto:t.data.isAuto};for(let n of this._onDataCallbacks)n(this.lastData)}},this._sendConfig())}_createFallbackCapture(){let e=this.getAudioCtx();e&&(this._analyser=e.createAnalyser(),this._analyser.fftSize=this.bufferSize*2,this._analyserData=new Float32Array(this._analyser.frequencyBinCount),this.inputY.connect(this._analyser),this._fallbackInterval=setInterval(()=>{if(this._analyser){this._analyser.getFloatTimeDomainData(this._analyserData),this.lastData={bufferY:this._analyserData.slice(0,this.bufferSize),bufferX:new Float32Array(this.bufferSize),sampleRate:e.sampleRate,triggered:!1};for(let t of this._onDataCallbacks)t(this.lastData)}},1e3/60))}_sendConfig(){this.captureNode&&(this.captureNode.port.postMessage({type:"setTriggerEnabled",enabled:this.triggerEnabled}),this.captureNode.port.postMessage({type:"setTriggerLevel",level:this.triggerLevel}))}_notifyNoSignal(){let e={bufferY:new Float32Array(this.bufferSize),bufferX:new Float32Array(this.bufferSize),sampleRate:this.engine?.audioCtx?.sampleRate||44100,triggered:!1,noSignal:!0};for(let t of this._onDataCallbacks)t(e)}onData(e){typeof e=="function"&&this._onDataCallbacks.push(e)}offData(e){let t=this._onDataCallbacks.indexOf(e);t!==-1&&this._onDataCallbacks.splice(t,1)}setMode(e){(e==="yt"||e==="xy")&&(this.mode=e)}setTriggerEnabled(e){this.triggerEnabled=e,this.captureNode&&this.captureNode.port.postMessage({type:"setTriggerEnabled",enabled:e})}setTriggerLevel(e){this.triggerLevel=Math.max(-1,Math.min(1,e)),this.captureNode&&this.captureNode.port.postMessage({type:"setTriggerLevel",level:this.triggerLevel})}setBufferSize(e){[512,1024,2048,4096].includes(e)&&(this.bufferSize=e,this.captureNode&&this.captureNode.port.postMessage({type:"setBufferSize",size:e}))}setTriggerHysteresis(e){this.triggerHysteresis=Math.max(0,Math.floor(e)),this.captureNode&&this.captureNode.port.postMessage({type:"setTriggerHysteresis",samples:this.triggerHysteresis})}setSchmittHysteresis(e){this.schmittHysteresis=Math.max(0,Math.min(.5,e)),this.captureNode&&this.captureNode.port.postMessage({type:"setSchmittHysteresis",value:this.schmittHysteresis})}setInputSensitivity(e){this.inputSensitivity=Math.max(.001,Math.min(1,e)),this.inputY&&(this.inputY.gain.value=this.inputSensitivity),this.inputX&&(this.inputX.gain.value=this.inputSensitivity),so.debug(`Input sensitivity set to ${this.inputSensitivity}`)}stop(){this.captureNode&&(this.captureNode.port.postMessage({type:"stop"}),this.captureNode.disconnect(),this.captureNode=null),this._fallbackInterval&&(clearInterval(this._fallbackInterval),this._fallbackInterval=null),this._analyser&&(this._analyser.disconnect(),this._analyser=null),this.inputY&&(this.inputY.disconnect(),this.inputY=null),this.inputX&&(this.inputX.disconnect(),this.inputX=null),this.workletReady=!1,this._workletLoadPromise=null,this._onDataCallbacks=[]}_onDormancyChange(e){if(this.captureNode)try{this.captureNode.port.postMessage({type:"setDormant",dormant:e}),console.log(`[Dormancy] Oscilloscope: ${e?"DORMANT":"ACTIVE"}`)}catch{}}};var ao=class{constructor(e={}){let{container:t,canvas:n,internalWidth:i=600,internalHeight:s=450,useDevicePixelRatio:a=!0,mode:r="yt",lineColor:l="#0f0",lineColor2:c="#0f0",bgColor:d="#000",gridColor:h="#1a1a1a",centerColor:p="#333",lineWidth:m=2,glowBlur:g=0,glowColor:_=null,glowColor2:y=null,showGrid:f=!0,showTriggerIndicator:b=!0,beam1OffsetY:E=0,beam2OffsetY:w=0,centerOffsetX:S=0,centerOffsetY:T=0}=e,A=a&&window.devicePixelRatio||1,C=Math.round(i*A),x=Math.round(s*A);n?this.canvas=n:(this.canvas=document.createElement("canvas"),this.canvas.width=C,this.canvas.height=x,this.canvas.style.cssText=`
        display: block;
        width: 100%;
        height: 100%;
        ${d!=="transparent"?`background: ${d};`:""}
        border-radius: 4px;
      `,t&&t.appendChild(this.canvas)),this.ctx=this.canvas.getContext("2d"),this.width=this.canvas.width,this.height=this.canvas.height,this.dpr=A,this.mode=r,this.lineColor=l,this.lineColor2=c,this.bgColor=d,this.gridColor=h,this.centerColor=p,this.lineWidth=m,this.glowBlur=g,this.glowColor=_||l,this.glowColor2=y||c,this.showGrid=f,this.showTriggerIndicator=b,this.beam1OffsetY=E,this.beam2OffsetY=w,this.centerOffsetX=S,this.centerOffsetY=T,this.timeScale=1,this.ampScale=1,this.lastTriggered=!1,this.animationId=null,this.lastData=null,this._pendingData=null,this._rafId=null,this._isRunning=!1}startRenderLoop(){this._isRunning||(this._isRunning=!0,this._renderFrame())}stopRenderLoop(){this._isRunning=!1,this._rafId&&(cancelAnimationFrame(this._rafId),this._rafId=null)}_renderFrame(){this._isRunning&&(this._pendingData&&(this._drawInternal(this._pendingData),this._pendingData=null),this._rafId=requestAnimationFrame(()=>this._renderFrame()))}updateData(e){this._pendingData=e,this.lastData=e}setTimeScale(e){this.timeScale=Math.max(.1,Math.min(1,e)),this.lastData&&this.draw(this.lastData)}setAmpScale(e){this.ampScale=Math.max(.25,Math.min(4,e)),this.lastData&&this.draw(this.lastData)}setMode(e){(e==="yt"||e==="xy")&&(this.mode=e,this.lastData&&this.draw(this.lastData))}getMode(){return this.mode}toggleMode(){return this.setMode(this.mode==="yt"?"xy":"yt"),this.mode}_drawGrid(){let{ctx:e,width:t,height:n,gridColor:i,centerColor:s}=this;e.strokeStyle=i,e.lineWidth=1;let a=4;for(let r=0;r<=a;r++){let l=n/a*r;e.beginPath(),e.moveTo(0,l),e.lineTo(t,l),e.stroke()}for(let r=0;r<=a;r++){let l=t/a*r;e.beginPath(),e.moveTo(l,0),e.lineTo(l,n),e.stroke()}e.strokeStyle=s,e.beginPath(),e.moveTo(0,n/2),e.lineTo(t,n/2),e.stroke(),e.beginPath(),e.moveTo(t/2,0),e.lineTo(t/2,n),e.stroke()}_drawTriggerIndicator(e,t=!1){if(!this.showTriggerIndicator)return;let{ctx:n,width:i}=this,s=5,a=i-s-5,r=s+5;n.beginPath(),n.arc(a,r,s,0,Math.PI*2),t?n.fillStyle="#f90":e?n.fillStyle="#0f0":n.fillStyle="#600",n.fill(),n.font="8px monospace",n.fillStyle=t?"#f90":e?"#0f0":"#600",n.textAlign="right",n.fillText(t?"AUTO":"TRIG",a-s-3,r+3)}_drawYT(e,t,n,i){let{ctx:s,width:a,height:r,lineWidth:l,glowBlur:c,timeScale:d,ampScale:h}=this,p=i&&i>0?i:e?.length||0,m=Math.floor(p*d),g=r/4,_=r/2,y=this.dpr||1,f=(this.beam1OffsetY||0)*y,b=(this.beam2OffsetY||0)*y;if(e&&e.length>0){let E=g+f;this._drawSingleBeam(e,m,this.lineColor,this.glowColor,E,_)}if(t&&t.length>0){let E=3*g+b;this._drawSingleBeam(t,m,this.lineColor2,this.glowColor2,E,_)}this._drawTriggerIndicator(n)}_drawSingleBeam(e,t,n,i,s,a){let{ctx:r,width:l,lineWidth:c,glowBlur:d,ampScale:h}=this;if(!e||e.length===0||t<=0)return;d>0&&(r.shadowBlur=d,r.shadowColor=i),r.lineWidth=c,r.strokeStyle=n,r.lineCap="round",r.lineJoin="round",r.beginPath();let p=t/l,m=!0,g=a/2;for(let _=0;_<l;_++){let y=Math.floor(_*p),f=Math.min(Math.ceil((_+1)*p),t),b=e[y]??0,E=b;for(let C=y+1;C<f;C++){let x=e[C];x<b&&(b=x),x>E&&(E=x)}let w=b*h,S=E*h,T=s-S*g,A=s-w*g;m?(r.moveTo(_,T),m=!1):r.lineTo(_,T),A-T>1&&r.lineTo(_,A)}r.stroke(),d>0&&(r.shadowBlur=0,r.shadowColor="transparent")}_drawXY(e,t){let{ctx:n,width:i,height:s,lineColor:a,lineWidth:r,glowBlur:l,glowColor:c,dpr:d}=this;if(!e||!t||e.length===0)return;let h=Math.min(e.length,t.length);l>0&&(n.shadowBlur=l,n.shadowColor=c),n.lineWidth=r,n.strokeStyle=a,n.lineCap="round",n.lineJoin="round",n.beginPath();let p=Math.min(h,i),m=h/p,g=(this.centerOffsetX||0)*d,_=(this.centerOffsetY||0)*d;for(let f=0;f<p;f++){let b=Math.floor(f*m),E=Math.floor((f+1)*m),w=0,S=0,T=0;for(let M=b;M<E&&M<h;M++)w+=e[M],S+=t[M],T++;let A=T>0?w/T:0,C=T>0?S/T:0,x=(A+1)/2*i+g,R=(1-C)/2*s+_;f===0?n.moveTo(x,R):n.lineTo(x,R)}n.stroke(),this.glowBlur>0&&(n.shadowBlur=0,n.shadowColor="transparent");let y=e.some(f=>Math.abs(f)>.01);this._drawTriggerIndicator(y)}draw(e){if(this._isRunning){this.updateData(e);return}this._drawInternal(e)}_drawInternal(e){let{ctx:t,width:n,height:i,bgColor:s,showGrid:a}=this;if(e.noSignal){this.drawEmpty();return}this.lastData=e,this.lastTriggered=e.triggered,s==="transparent"?t.clearRect(0,0,n,i):(t.fillStyle=s,t.fillRect(0,0,n,i)),a&&this._drawGrid(),this.mode==="xy"?this._drawXY(e.bufferX,e.bufferY):this._drawYT(e.bufferY,e.bufferX,e.triggered,e.validLength),this._drawTriggerIndicator(e.triggered,e.isAuto)}drawEmpty(){let{ctx:e,width:t,height:n,bgColor:i,showGrid:s,centerColor:a}=this;i==="transparent"?e.clearRect(0,0,t,n):(e.fillStyle=i,e.fillRect(0,0,t,n)),s&&this._drawGrid();let r=this.dpr||1,l=(this.beam1OffsetY||0)*r,c=(this.beam2OffsetY||0)*r,d=n/4+l,h=3*n/4+c;e.lineWidth=this.lineWidth,e.strokeStyle=this.lineColor,e.beginPath(),e.moveTo(0,d),e.lineTo(t,d),e.stroke(),e.strokeStyle=this.lineColor2,e.beginPath(),e.moveTo(0,h),e.lineTo(t,h),e.stroke()}getCanvas(){return this.canvas}refresh(){this.lastData?this.draw(this.lastData):this.drawEmpty()}resize(e,t){this.refresh()}destroy(){this.animationId&&(cancelAnimationFrame(this.animationId),this.animationId=null),this.lastData=null}};var ro=class{constructor(e={}){this.id=e.id||`toggle-${Date.now()}`,this.labelA=e.labelA||"A",this.labelB=e.labelB||"B",this.state=e.initial||"a",this.onChange=e.onChange||null,this.element=null}createElement(){let e=document.createElement("div");return e.className="synth-toggle",e.id=this.id,e.innerHTML=`
      <span class="synth-toggle__label synth-toggle__label-a">${this.labelA}</span>
      <div class="synth-toggle__track">
        <div class="synth-toggle__thumb"></div>
      </div>
      <span class="synth-toggle__label synth-toggle__label-b">${this.labelB}</span>
    `,e.addEventListener("click",()=>this.toggle()),this.element=e,this._render(),e}toggle(){return this.state=this.state==="a"?"b":"a",this._render(),this.onChange&&this.onChange(this.state,this.state==="a"?this.labelA:this.labelB),Ae(this.element),document.dispatchEvent(new CustomEvent("synth:userInteraction")),this.state}setState(e){(e==="a"||e==="b")&&e!==this.state&&(this.state=e,this._render(),Ae(this.element))}getState(){return this.state}getLabel(){return this.state==="a"?this.labelA:this.labelB}_render(){this.element&&(this.element.classList.toggle("is-b",this.state==="b"),this.element.setAttribute("data-state",this.state))}};function Ka(o,e){let t={...o};for(let n of Object.keys(e))e[n]&&typeof e[n]=="object"&&!Array.isArray(e[n])?t[n]=Ka(o[n]||{},e[n]):t[n]=e[n];return t}be();var hd=W("CanvasBackground");var Xa=new Map,es=new Map,Za=!1,pd=1500,Qi=2,Gn=["panel-1","panel-2","panel-3","panel-4"],fi={};function lo(){try{return window.matchMedia&&window.matchMedia("(pointer: coarse)").matches}catch{return!1}}function md(){let o=document.getElementById("viewportOuter");if(!o)return null;let e=document.getElementById("canvasBgLayer"),t=document.getElementById("canvasBg");return e||(e=document.createElement("div"),e.id="canvasBgLayer",e.setAttribute("aria-hidden","true"),o.insertBefore(e,o.firstChild)),t||(t=document.createElement("canvas"),t.id="canvasBg",t.setAttribute("aria-hidden","true"),e.appendChild(t)),{outer:o,layer:e,canvas:t}}function gd(o){let e=`img::${o}`;if(Xa.has(e))return Xa.get(e);let t=new Promise(n=>{let i=new Image;i.decoding="async",i.onload=()=>n(i),i.onerror=()=>n(null),i.src=o});return Xa.set(e,t),t}function Jl(){if(!lo())return;let o=setTimeout(()=>{if(o=null,!Gn.map(n=>fi[n]).filter(Boolean).every(n=>es.has(n))){Za=!0;for(let n of Gn)document.getElementById(n)?.querySelector?.(":scope > .panel-inline-bg")?.classList?.remove("is-canvas-hidden")}},pd);for(let e of Gn){let t=fi[e];t&&gd(t).then(n=>{if(es.set(t,n||null),!n){Za=!0;for(let i of Gn){if(fi[i]!==t)continue;document.getElementById(i)?.querySelector?.(":scope > .panel-inline-bg")?.classList?.remove("is-canvas-hidden")}}o&&Gn.map(a=>fi[a]).filter(Boolean).every(a=>es.has(a))&&(clearTimeout(o),o=null)})}}function Ja(o=1,e=0,t=0){if(!lo()||Za)return!0;let n=md();if(!n)return!1;let{outer:i,canvas:s}=n,a=Math.max(i.clientWidth,1),r=Math.max(i.clientHeight,1),l=Math.max(1,Math.round(a*Qi)),c=Math.max(1,Math.round(r*Qi));s.style.position="absolute",s.style.left="0px",s.style.top="0px",s.style.width=`${a}px`,s.style.height=`${r}px`,s.width!==l&&(s.width=l),s.height!==c&&(s.height=c);let d=s.getContext("2d",{alpha:!1});if(!d)return!1;for(let m of Gn){let g=fi[m];if(g&&!es.has(g))return!1}d.setTransform(Qi,0,0,Qi,0,0),d.fillStyle="#000",d.fillRect(0,0,a,r);let h=1/Qi,p=m=>Math.round(m/h)*h;for(let m of Gn){let g=document.getElementById(m);if(!g)continue;let _=fi[m];if(!_)continue;let y=es.get(_);if(!y)continue;let f=g.offsetLeft||0,b=g.offsetTop||0,E=g.offsetWidth||0,w=g.offsetHeight||0;if(E<=0||w<=0)continue;let S=e+f*o,T=t+b*o,A=E*o,C=w*o;S=p(S),T=p(T),A=p(A),C=p(C),d.drawImage(y,S-.5,T-.5,A+1,C+1)}return!0}function jt(){let o=window.__synthViewTransform||{scale:1,offsetX:0,offsetY:0};Ja(o.scale,o.offsetX,o.offsetY)}async function co(o,e,t=3){let n=document.getElementById(o);if(!n||n.querySelector(":scope > .panel-inline-bg"))return;let i=document.createElement("div");i.className="panel-inline-bg",n.insertBefore(i,n.firstChild);for(let s=0;s<t;s++)try{let a=await fetch(e,{cache:"force-cache"});if(a.ok){let r=await a.text();i.innerHTML=r;let l=i.querySelector("svg");l&&(l.style.cssText="width: 100%; height: 100%; display: block;",l.setAttribute("aria-hidden","true")),n.classList.add("has-inline-bg");return}}catch(a){s<t-1?await new Promise(r=>setTimeout(r,100*(s+1))):hd.warn(` Failed to load ${e} after ${t} attempts:`,a)}n.classList.add("has-inline-bg")}function ts(o,e){let t=document.getElementById(o);t&&(t.style.backgroundImage=`url('${e}')`,t.style.backgroundSize="100% 100%",t.style.backgroundRepeat="no-repeat")}Te();Oe();Oe();var uo=null,Ie=class o{constructor(){this.overlay=null,this.modal=null,this.titleEl=null,this.messageEl=null,this.confirmBtn=null,this.cancelBtn=null,this.rememberRow=null,this.rememberCheckbox=null,this.rememberLabel=null,this._resolve=null,this._currentRememberKey=null,this._create(),this._unsubscribeLocale=Pe(()=>this._updateDefaultTexts())}static async show(e){return uo||(uo=new o),uo._show(e)}static getRememberedChoice(e){let t=localStorage.getItem(`synthigme-confirm-${e}`);return t!==null?{skip:!0,choice:t==="true"}:{skip:!1,choice:!1}}static clearRememberedChoice(e){localStorage.removeItem(`synthigme-confirm-${e}`)}_create(){this.overlay=document.createElement("div"),this.overlay.className="confirm-dialog-overlay",this.overlay.inert=!0,this.modal=document.createElement("div"),this.modal.className="confirm-dialog",this.modal.setAttribute("role","alertdialog"),this.modal.setAttribute("aria-modal","true"),this.modal.setAttribute("aria-labelledby","confirmDialogTitle"),this.titleEl=document.createElement("h2"),this.titleEl.id="confirmDialogTitle",this.titleEl.className="confirm-dialog__title",this.messageEl=document.createElement("p"),this.messageEl.className="confirm-dialog__message",this.rememberRow=document.createElement("div"),this.rememberRow.className="confirm-dialog__remember",this.rememberCheckbox=document.createElement("input"),this.rememberCheckbox.type="checkbox",this.rememberCheckbox.id="confirmDialogRemember",this.rememberCheckbox.className="confirm-dialog__remember-checkbox",this.rememberLabel=document.createElement("label"),this.rememberLabel.htmlFor="confirmDialogRemember",this.rememberLabel.className="confirm-dialog__remember-label",this.rememberLabel.textContent=u("patches.lastSession.remember"),this.rememberRow.appendChild(this.rememberCheckbox),this.rememberRow.appendChild(this.rememberLabel);let e=document.createElement("div");e.className="confirm-dialog__buttons",this.cancelBtn=document.createElement("button"),this.cancelBtn.type="button",this.cancelBtn.className="confirm-dialog__btn confirm-dialog__btn--cancel",this.cancelBtn.textContent=u("patches.lastSession.no"),this.cancelBtn.addEventListener("click",()=>this._handleResponse(!1)),this.confirmBtn=document.createElement("button"),this.confirmBtn.type="button",this.confirmBtn.className="confirm-dialog__btn confirm-dialog__btn--confirm",this.confirmBtn.textContent=u("patches.lastSession.yes"),this.confirmBtn.addEventListener("click",()=>this._handleResponse(!0)),e.appendChild(this.cancelBtn),e.appendChild(this.confirmBtn),this.modal.appendChild(this.titleEl),this.modal.appendChild(this.messageEl),this.modal.appendChild(this.rememberRow),this.modal.appendChild(e),this.overlay.appendChild(this.modal),document.addEventListener("keydown",t=>{t.key==="Escape"&&this._resolve&&this._handleResponse(!1)}),document.body.appendChild(this.overlay)}_updateDefaultTexts(){this.overlay.classList.contains("confirm-dialog-overlay--visible")||(this.rememberLabel.textContent=u("patches.lastSession.remember"),this.cancelBtn.textContent=u("patches.lastSession.no"),this.confirmBtn.textContent=u("patches.lastSession.yes"))}async _show(e){let{title:t,message:n="",confirmText:i,cancelText:s,rememberKey:a=null,rememberText:r}=e;return this.titleEl.textContent=t,this.messageEl.textContent=n,this.messageEl.style.display=n?"block":"none",i&&(this.confirmBtn.textContent=i),s&&(this.cancelBtn.textContent=s),this._currentRememberKey=a,a?(this.rememberRow.style.display="flex",this.rememberCheckbox.checked=!1,r&&(this.rememberLabel.textContent=r)):this.rememberRow.style.display="none",this.overlay.inert=!1,this.overlay.classList.add("confirm-dialog-overlay--visible"),requestAnimationFrame(()=>{this.confirmBtn.focus()}),new Promise(l=>{this._resolve=l})}_handleResponse(e){let t=this.rememberCheckbox.checked;t&&this._currentRememberKey&&localStorage.setItem(`synthigme-confirm-${this._currentRememberKey}`,String(e)),this.overlay.classList.remove("confirm-dialog-overlay--visible"),this.overlay.inert=!0,this._resolve&&(this._resolve({confirmed:e,remember:t}),this._resolve=null)}destroy(){this._unsubscribeLocale&&this._unsubscribeLocale(),this.overlay&&this.overlay.parentNode&&this.overlay.parentNode.removeChild(this.overlay),uo=null}};be();Te();Xn();var br=W("KeyboardShortcuts"),fr=["Tab","Enter","Escape"," ","Space"];function _c(o){let e=o.target,t=e.tagName,n=e.type?.toLowerCase();return!!(t==="TEXTAREA"||t==="SELECT"||t==="INPUT"&&n!=="range"||e.isContentEditable)}var ko={undo:{key:"z",shift:!1,ctrl:!0,alt:!1},redo:{key:"u",shift:!1,ctrl:!0,alt:!1},mute:{key:"m",shift:!1,ctrl:!1,alt:!1},record:{key:"r",shift:!1,ctrl:!1,alt:!1},patches:{key:"p",shift:!1,ctrl:!1,alt:!1},settings:{key:"s",shift:!1,ctrl:!1,alt:!1},fullscreen:{key:"f",shift:!1,ctrl:!1,alt:!1},reset:{key:"i",shift:!0,ctrl:!1,alt:!1},showPanelHints:{key:"Alt",shift:!1,ctrl:!1,alt:!1},signalFlow:{key:"Control",shift:!1,ctrl:!1,alt:!1},panel1:{key:"1",shift:!1,ctrl:!1,alt:!1},panel2:{key:"2",shift:!1,ctrl:!1,alt:!1},panel3:{key:"3",shift:!1,ctrl:!1,alt:!1},panel4:{key:"4",shift:!1,ctrl:!1,alt:!1},panel5:{key:"5",shift:!1,ctrl:!1,alt:!1},panel6:{key:"6",shift:!1,ctrl:!1,alt:!1},panelOutput:{key:"7",shift:!1,ctrl:!1,alt:!1},overview:{key:"0",shift:!1,ctrl:!1,alt:!1}};function Zn(o){mr(o)?hr(o):window.__synthAnimateToPanel?.(o)}var Kd={undo:()=>document.dispatchEvent(new CustomEvent("synth:undo")),redo:()=>document.dispatchEvent(new CustomEvent("synth:redo")),mute:()=>document.dispatchEvent(new CustomEvent("synth:toggleMute")),record:()=>document.dispatchEvent(new CustomEvent("synth:toggleRecording")),patches:()=>document.dispatchEvent(new CustomEvent("synth:togglePatches")),settings:()=>document.dispatchEvent(new CustomEvent("synth:toggleSettings")),fullscreen:async()=>{try{document.fullscreenElement?(typeof window.__synthPrepareForFullscreen=="function"&&window.__synthPrepareForFullscreen(!1),await document.exitFullscreen()):(typeof window.__synthPrepareForFullscreen=="function"&&window.__synthPrepareForFullscreen(!0),await document.documentElement.requestFullscreen())}catch(o){br.error("No se pudo alternar pantalla completa:",o)}},reset:async()=>{if(localStorage.getItem(v.CONFIRM_SYNTH_RESET)==="false"){document.dispatchEvent(new CustomEvent("synth:resetToDefaults"));return}let o=await Ie.show({title:u("synth.reset.confirm"),confirmText:u("common.yes"),cancelText:u("common.no"),rememberKey:"skip-reset-confirm",rememberText:u("common.dontAskAgain")});o.confirmed&&(o.remember&&localStorage.setItem(v.CONFIRM_SYNTH_RESET,"false"),document.dispatchEvent(new CustomEvent("synth:resetToDefaults"))),Ie.clearRememberedChoice("skip-reset-confirm")},panel1:()=>Zn("panel-1"),panel2:()=>Zn("panel-2"),panel3:()=>Zn("panel-3"),panel4:()=>Zn("panel-4"),panel5:()=>Zn("panel-5"),panel6:()=>Zn("panel-6"),panelOutput:()=>Zn("panel-output"),overview:()=>window.__synthAnimateToPanel?.(null)},yr=class{constructor(){this.shortcuts=this._load(),this._boundHandler=this._handleKeyDown.bind(this),this._listeners=new Set}_load(){try{let e=localStorage.getItem(v.KEYBOARD_SHORTCUTS);if(e){let t=JSON.parse(e);return{...ko,...t}}}catch(e){br.warn(" Error loading:",e)}return{...ko}}_save(){try{localStorage.setItem(v.KEYBOARD_SHORTCUTS,JSON.stringify(this.shortcuts))}catch(e){br.warn(" Error saving:",e)}}init(){document.addEventListener("keydown",this._boundHandler),document.addEventListener("keydown",e=>{if(_c(e))return;let t=this.shortcuts.showPanelHints?.key||"Alt";e.key===t&&!e.repeat&&(e.preventDefault(),document.body.classList.add("show-panel-shortcuts"))}),document.addEventListener("keyup",e=>{let t=this.shortcuts.showPanelHints?.key||"Alt";e.key===t&&document.body.classList.remove("show-panel-shortcuts")}),window.addEventListener("blur",()=>{document.body.classList.remove("show-panel-shortcuts")})}destroy(){document.removeEventListener("keydown",this._boundHandler)}_handleKeyDown(e){if(!_c(e)&&!fr.includes(e.key)){for(let[t,n]of Object.entries(this.shortcuts))if(this._matchesBinding(e,n)){e.preventDefault(),document.activeElement&&typeof document.activeElement.blur=="function"&&document.activeElement.blur();let i=Kd[t];i&&i();return}}}_matchesBinding(e,t){if(!t||!t.key)return!1;let n=e.key.toLowerCase()===t.key.toLowerCase(),i=e.shiftKey===!!t.shift,s=(e.ctrlKey||e.metaKey)===!!t.ctrl,a=e.altKey===!!t.alt;return n&&i&&s&&a}getAll(){return{...this.shortcuts}}get(e){return this.shortcuts[e]?{...this.shortcuts[e]}:null}set(e,t){if(fr.includes(t.key))return{success:!1,error:"reserved"};let n=this._findConflict(e,t);return n?{success:!1,conflict:n}:(this.shortcuts[e]={...t},this._save(),this._notifyListeners(),{success:!0})}_findConflict(e,t){for(let[n,i]of Object.entries(this.shortcuts)){if(n===e||!i||!i.key)continue;let s=i.key.toLowerCase()===t.key.toLowerCase(),a=!!i.shift==!!t.shift,r=!!i.ctrl==!!t.ctrl,l=!!i.alt==!!t.alt;if(s&&a&&r&&l)return n}return null}clear(e){this.shortcuts[e]&&(this.shortcuts[e]={key:"",shift:!1,ctrl:!1,alt:!1},this._save(),this._notifyListeners())}resetToDefaults(){this.shortcuts={...ko},this._save(),this._notifyListeners()}formatBinding(e){if(!e||!e.key)return"\u2014";let t=[];return e.ctrl&&t.push("Ctrl"),e.alt&&t.push("Alt"),e.shift&&t.push("Shift"),t.push(e.key.toUpperCase()),t.join("+")}onChange(e){return this._listeners.add(e),()=>this._listeners.delete(e)}_notifyListeners(){this._listeners.forEach(e=>e(this.shortcuts))}getActionIds(){return Object.keys(ko)}isReservedKey(e){return fr.includes(e)}},ve=new yr;function Cc({outer:o,inner:e}={}){if((!o||!e)&&(o=document.getElementById("viewportOuter"),e=document.getElementById("viewportInner")),!o||!e)return;window.__synthNavLocks=window.__synthNavLocks||{zoomLocked:!1,panLocked:!1};let t=window.__synthNavLocks,n=localStorage.getItem(v.MULTITOUCH_CONTROLS)==="true",i=localStorage.getItem(v.SINGLE_FINGER_PAN)!=="false";document.addEventListener("synth:multitouchControlsChange",k=>{n=k.detail?.enabled??!1}),document.addEventListener("synth:singleFingerPanChange",k=>{i=k.detail?.enabled??!0});let s=/Firefox\/\d+/.test(navigator.userAgent);window.__synthIsFirefox=s;let a=[1,1.5,2,2.5,3],r=localStorage.getItem(v.REMEMBER_RESOLUTION)==="true",l=parseFloat(localStorage.getItem(v.RESOLUTION)),d=!s&&r&&a.includes(l)?l:1;window.__synthResolutionFactor=d,window.__synthSetResolutionFactor=k=>{if(s||k===d)return;M(),I();let V=window.__synthAnimateToPanel;typeof V=="function"?(V(null,600),setTimeout(()=>{d=k,window.__synthResolutionFactor=k,gt()},700)):(d=k,window.__synthResolutionFactor=k,gt())};let h=null,p=200,m=3,g=16384,_=1.05,y=!1,f=1,E=localStorage.getItem(v.SHARP_RASTERIZE_ENABLED)==="true";document.addEventListener("synth:sharpRasterizeChange",k=>{E=k.detail?.enabled??!1,E?B():(M(),I(),gt())});let w=1,S=null,T=10,A=0;function C(){x(),A=0,S=requestAnimationFrame(R)}function x(){S&&(cancelAnimationFrame(S),S=null),A=0}function R(){if(S=null,f<=1)return;if(typeof navigator?.scheduling?.isInputPending=="function"&&navigator.scheduling.isInputPending({includeContinuous:!0})&&A<T){A++,S=requestAnimationFrame(R);return}y=!0,gt()}function M(){h&&(clearTimeout(h),h=null),x(),y=!1,f=1}function I(){w>1&&(w=1,e.style.zoom="")}function B(){E&&(d>1||(M(),h=setTimeout(()=>{h=null,Y()},p)))}function Y(){if(!E||d>1)return;let k=Math.min(P,m);if(k<_){w>1&&(I(),gt());return}let V=j.contentWidth||1,G=j.contentHeight||1,H=g/V,oe=g/G,we=Math.min(k,H,oe);we<_||(f=Math.round(we*100)/100,C())}window.__synthSharpMode={get active(){return y},get zoom(){return f},get activeZoom(){return w},get pending(){return S!==null}};let P=1,F=6,z=.95;function $(){if(!j.outerWidth||!j.outerHeight||!j.contentWidth||!j.contentHeight)return .1;let k=j.outerWidth*z/j.contentWidth,V=j.outerHeight*z/j.contentHeight;return Math.min(k,V)}window.__synthNavState={get scale(){return P},getMinScale:$};let N=null;function K(k,V=1e3){Ce=!0,de();let G=window.visualViewport,H=G?G.width:o.clientWidth,oe=G?G.height:o.clientHeight,we=P,it=q,Le=Z,me,Ge,st;if(k){let ot=document.getElementById(k);if(!ot)return;let Pt=ot.getBoundingClientRect(),mn=e.getBoundingClientRect(),nn=(Pt.left-mn.left)/P,Oi=(Pt.top-mn.top)/P,Mn=Pt.width/P,sa=Pt.height/P,oa=8,As=Math.min(H,oe)*.01,Rs=oa+As,ra=Math.max(100,H-Rs*2),au=Math.max(100,oe-Rs*2),ru=ra/Mn,lu=au/sa;me=Math.min(ru,lu,F);let cu=Mn*me,uu=sa*me;Ge=(H-cu)/2-nn*me,st=(oe-uu)/2-Oi*me,N=k}else{me=$();let ot=j.contentWidth*me,Pt=j.contentHeight*me;Ge=(j.outerWidth-ot)/2,st=(j.outerHeight-Pt)/2,N=null}let Tt=performance.now();function Mt(ot){return ot<.5?4*ot*ot*ot:1-Math.pow(-2*ot+2,3)/2}function Tn(ot){let Pt=ot-Tt,mn=Math.min(Pt/V,1),nn=Mt(mn);P=we+(me-we)*nn,q=it+(Ge-it)*nn,Z=Le+(st-Le)*nn,gt(),mn<1?requestAnimationFrame(Tn):(Ti(),B(),Qo())}M(),document.dispatchEvent(new Event("synth:dismissTooltips")),requestAnimationFrame(Tn)}window.__synthAnimateToPanel=K,window.__synthGetFocusedPanel=()=>N,window.__synthResetFocusedPanel=()=>{N=null};let te=.45,Q=.7,ge="is-low-zoom",Se=500,ne=.35,ce=.92,ue=.25,Ne=.002,ke=.05,O=!1,q=0,Z=0,De=!1,Be=0;function ze(k){let V=window.devicePixelRatio||1,H=(k<.6?24:12)*V;return H?Math.round(k*H)/H:k}let xe=new Map;function At(k){return k?!!k.closest('.knob, .knob-inner, .knob-cap, .pin-btn, .joystick-pad, .panel7-joystick-pad, .joystick-handle, .output-fader, .slider, .fader, .switch, .toggle, [data-prevent-pan="true"]'):!1}function nt(){let k=0,V=0;xe.forEach(oe=>{k++,oe||V++});let G=n?k>=2&&V>=1:k>=2,H=window.__synthNavGestureActive;window.__synthNavGestureActive=G,o.classList.toggle("is-gesturing",G),G&&!H&&document.dispatchEvent(new Event("synth:dismissTooltips"))}let j={contentWidth:0,contentHeight:0,outerWidth:0,outerHeight:0,outerLeft:0,outerTop:0},Ce=!0,X=(()=>{try{return window.matchMedia&&window.matchMedia("(pointer: coarse)").matches}catch{return!1}})();function fe(){let k=e.querySelectorAll(".panel");if(!k||k.length===0)return{width:e.scrollWidth,height:e.scrollHeight};let V=0,G=0;return k.forEach(H=>{let oe=(H.offsetLeft||0)+(H.offsetWidth||0),we=(H.offsetTop||0)+(H.offsetHeight||0);oe>V&&(V=oe),we>G&&(G=we)}),{width:V,height:G}}function de(){let k=o.getBoundingClientRect(),V=fe();j.contentWidth=V.width,j.contentHeight=V.height,j.outerWidth=o.clientWidth,j.outerHeight=o.clientHeight,j.outerLeft=k.left,j.outerTop=k.top,Ce=!1}let Fe=null;function ie(){Fe||(Fe=requestAnimationFrame(()=>{Fe=null,gt()}))}function Ke(){if(O)return;let k=j.contentWidth,V=j.contentHeight;if(!k||!V)return;let G=j.outerWidth,H=j.outerHeight;if(!G||!H)return;let oe=k*P,we=V*P;if(!0){let Le=G*ue,me=H*ue,Ge=G-Le-oe,st=Le;Ge<=st?q=Math.min(Math.max(q,Ge),st):q=(Ge+st)/2;let Tt=H-me-we,Mt=me;Tt<=Mt?Z=Math.min(Math.max(Z,Tt),Mt):Z=(Tt+Mt)/2;return}if(oe<=G)q=(G-oe)/2;else{let Le=G-oe;q=Math.min(Math.max(q,Le),0)}if(we<=H)Z=(H-we)/2;else{let Le=H-we;Z=Math.min(Math.max(Z,Le),0)}}let Gt=!1,mt=null;function Vr(){return Gt?P<Q:P<te}function Gr(k){k!==Gt&&(Gt=k,e.classList.toggle(ge,Gt))}function Ti(){if(Vr()){mt&&(clearTimeout(mt),mt=null),Gr(!0);return}Gt&&(mt&&(clearTimeout(mt),mt=null),mt=setTimeout(()=>{mt=null,Vr()||Gr(!1)},Se))}function gt(){Ce&&de(),Ke();let k=window.devicePixelRatio||1;k>0&&(q=Math.round(q*k)/k,Z=Math.round(Z*k)/k);let V=Ja(P,q,Z);if(!lo()||V){let G=1;if(y&&f>1?G=f:d>1?G=d:w>1&&(G=w),G>1){let H=P/G;G!==w&&(e.style.zoom=G),e.style.transform=`translate3d(${q/G}px, ${Z/G}px, 0) scale(${H})`}else w>1&&(e.style.zoom=""),e.style.transform=`translate3d(${q}px, ${Z}px, 0) scale(${P})`;w=G,window.__synthViewTransform={scale:P,offsetX:q,offsetY:Z}}X&&Ti()}if(de(),Be=j.outerWidth,gt(),window.visualViewport){let k=0,V=5,G=()=>{if(window.__synthFullscreenTransition||document.fullscreenElement)return;if(De){window.visualViewport.removeEventListener("resize",G);return}k++,Ce=!0,de();let H=$();P=Math.min(F,Math.max(H,ze(H)));let oe=j.contentWidth*P,we=j.contentHeight*P;q=(j.outerWidth-oe)/2,Z=(j.outerHeight-we)/2,ie(),k>=V&&window.visualViewport.removeEventListener("resize",G)};window.visualViewport.addEventListener("resize",G),setTimeout(()=>{window.visualViewport.removeEventListener("resize",G)},4e3)}function Mi(){if(!o||!e)return;de();let k=j.contentWidth,V=j.contentHeight;if(!k||!V)return;let G=j.outerWidth,H=j.outerHeight;if(!G||!H)return;let oe=$(),it=Math.min(F,Math.max(oe,oe));P=Math.min(F,Math.max(oe,ze(it)));let Le=k*P,me=V*P,Ge=(G-Le)/2,st=(H-me)/2;q=Ge,Z=st,ie()}requestAnimationFrame(()=>{if(Mi(),localStorage.getItem(v.REMEMBER_VISUAL_LAYOUT)==="true")try{let k=JSON.parse(localStorage.getItem(v.VIEWPORT_STATE));k&&typeof k.scale=="number"&&(P=k.scale,q=k.offsetX||0,Z=k.offsetY||0,N=k.focusedPanelId||null,De=!0,ie())}catch{}});function nu(k){if(!o||!e)return;M(),I(),window.__synthFullscreenTransition=!0;let V,G;k?window.matchMedia("(orientation: landscape)").matches?(V=Math.max(screen.availWidth||screen.width,screen.availHeight||screen.height),G=Math.min(screen.availWidth||screen.width,screen.availHeight||screen.height)):(V=Math.min(screen.availWidth||screen.width,screen.availHeight||screen.height),G=Math.max(screen.availWidth||screen.width,screen.availHeight||screen.height)):(V=o.clientWidth,G=o.clientHeight);let H=j.contentWidth,oe=j.contentHeight;if(!H||!oe||!V||!G)return;let we=V*z/H,it=G*z/oe,Le=Math.min(we,it),me=Math.min(F,Math.max(Le,ze(Le))),Ge=H*me,st=oe*me,Tt=(V-Ge)/2,Mt=(G-st)/2;if(P=me,q=Tt,Z=Mt,d>1){let Tn=P/d;e.style.zoom=d,e.style.transform=`translate3d(${q/d}px, ${Z/d}px, 0) scale(${Tn})`}else e.style.zoom="",e.style.transform=`translate3d(${q}px, ${Z}px, 0) scale(${P})`;window.__synthViewTransform={scale:P,offsetX:q,offsetY:Z}}window.__synthPrepareForFullscreen=nu,window.__synthSerializeViewportState=()=>({scale:P,offsetX:q,offsetY:Z,focusedPanelId:N}),window.__synthRestoreViewportState=k=>{!k||typeof k.scale!="number"||(P=k.scale,q=k.offsetX||0,Z=k.offsetY||0,N=k.focusedPanelId||null,De=!0,ie())};function ws(){if(localStorage.getItem(v.REMEMBER_VISUAL_LAYOUT)==="true")try{let k=window.__synthSerializeViewportState();localStorage.setItem(v.VIEWPORT_STATE,JSON.stringify(k))}catch{}}let xs=null,iu=2e3;function Qo(){xs&&clearTimeout(xs),xs=setTimeout(()=>{xs=null,ws()},iu)}window.addEventListener("beforeunload",ws),document.addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"&&ws()}),document.addEventListener("synth:settingChanged",k=>{k.detail?.key==="rememberVisualLayout"&&k.detail.value&&ws()});function ea(k){O!==k&&(O=k,ie())}function Rn(){De=!0,Qo()}let qr=.15;function su(k){if(!k)return!1;let V=k.tagName;return!!(V==="TEXTAREA"||V==="SELECT"||V==="INPUT"&&k.type?.toLowerCase()!=="range"||k.isContentEditable)}window.addEventListener("keydown",k=>{if(k.key==="Shift"&&ea(!0),(k.ctrlKey||k.metaKey)&&!k.altKey){let G=k.key;if(G==="+"||G==="="){k.preventDefault(),window.__synthFocusedPip&&window.__synthZoomFocusedPip?window.__synthZoomFocusedPip("in"):document.dispatchEvent(new CustomEvent("synth:zoomIn"));return}if(G==="-"||G==="_"){k.preventDefault(),window.__synthFocusedPip&&window.__synthZoomFocusedPip?window.__synthZoomFocusedPip("out"):document.dispatchEvent(new CustomEvent("synth:zoomOut"));return}if(G==="0"){k.preventDefault(),window.__synthFocusedPip&&window.__synthZoomFocusedPip?window.__synthZoomFocusedPip("reset"):document.dispatchEvent(new CustomEvent("synth:zoomReset"));return}}if(su(k.target)||k.ctrlKey||k.metaKey||k.altKey)return;let V={ArrowLeft:[1,0],ArrowRight:[-1,0],ArrowUp:[0,1],ArrowDown:[0,-1]}[k.key];if(V){if(k.preventDefault(),window.__synthFocusedPip&&window.__synthPanFocusedPip){window.__synthPanFocusedPip(-V[0],-V[1]);return}M();let G=(j.outerWidth||o.clientWidth)*qr,H=(j.outerHeight||o.clientHeight)*qr;q+=V[0]*G,Z+=V[1]*H,ie(),Rn(),B()}}),window.addEventListener("keyup",k=>{k.key==="Shift"&&ea(!1)}),window.addEventListener("blur",()=>{ea(!1)}),o.addEventListener("pointerdown",k=>{if(k.pointerType!=="touch")return;let V=At(k.target);xe.set(k.pointerId,V),nt(),ye.has(k.pointerId)||(ye.set(k.pointerId,{x:k.clientX,y:k.clientY,pointerType:k.pointerType,isInteractive:V}),pn())},!0),o.addEventListener("pointermove",k=>{if(k.pointerType!=="touch"||!ye.has(k.pointerId))return;let V=ye.get(k.pointerId);ye.set(k.pointerId,{x:k.clientX,y:k.clientY,pointerType:V?.pointerType,isInteractive:V?.isInteractive})},!0);let $r=k=>{k.pointerType==="touch"&&(xe.delete(k.pointerId),nt(),ye.has(k.pointerId)&&(ye.delete(k.pointerId),pn(),ye.size<2&&(en=null,qt=null),Rt===k.pointerId&&(hn=!1,Rt=null)))};o.addEventListener("pointerup",$r,!0),o.addEventListener("pointercancel",$r,!0);function Ur(k){if(!k)return!1;let V=".knob, .knob-inner, .pin-btn, .joystick-pad, .panel7-joystick-pad, .joystick-handle, .output-fader";return k.closest('[data-prevent-pan="true"]')?!0:!!k.closest(V)}function Ls(k,V,G,{snap:H=!1}={}){let oe=(k-q)/P,we=(V-Z)/P,it=$(),Le=Math.min(F,Math.max(it,G));P=H?ze(Le):Le,q=k-oe*P,Z=V-we*P,ie()}o.addEventListener("wheel",k=>{if(Ce=!0,k.ctrlKey||k.metaKey){if(k.preventDefault(),t.zoomLocked)return;M();let we=k.clientX-(j.outerLeft||0),it=k.clientY-(j.outerTop||0),Le=k.deltaY<0?1.1:.9,me=$(),Ge=Math.min(F,Math.max(me,P*Le));Ls(we,it,Ge),Rn(),B(),X||Ti();return}if(k.preventDefault(),t.panLocked)return;M();let G=k.deltaMode===1?16:k.deltaMode===2?j.outerHeight||o.clientHeight:1,H=k.deltaX*G*ne*ce,oe=k.deltaY*G*ne*ce;q-=H,Z-=oe,ie(),Rn(),B()},{passive:!1});let hn=!1,Rt=null,ta=0,na=0,Hr=!1,ye=new Map,en=null,qt=null,Wr=!1,ia=null,jr=!1,ou=0,ni=!1;window.__synthNavGestureActive=!1;function pn(){let k=0,V=0;ye.forEach(H=>{H&&H.pointerType==="touch"&&(k+=1,H.isInteractive||V++)}),ou=k;let G=n?k>=2&&V>=1:k>=2;G!==ni&&(ni=G,window.__synthNavGestureActive=ni,o.classList.toggle("is-gesturing",ni),ni&&M())}o.addEventListener("pointerdown",k=>{let V=Ur(k.target);ye.set(k.pointerId,{x:k.clientX,y:k.clientY,pointerType:k.pointerType,isInteractive:V}),pn();let G=k.pointerType==="mouse"||k.pointerType==="pen",H=k.pointerType==="touch"&&i&&!t.panLocked;(G||H)&&ye.size===1&&!Ur(k.target)&&(M(),hn=!0,Rt=k.pointerId,ta=k.clientX,na=k.clientY)}),o.addEventListener("pointermove",k=>{if(!ye.has(k.pointerId))return;let V=ye.get(k.pointerId);if(ye.set(k.pointerId,{x:k.clientX,y:k.clientY,pointerType:V?.pointerType,isInteractive:V?.isInteractive}),ye.size===2&&ni){Ce=!0,k.preventDefault();let G=Array.from(ye.values()),[H,oe]=G,we=H.x-oe.x,it=H.y-oe.y,Le=Math.hypot(we,it),me=(H.x+oe.x)/2,Ge=(H.y+oe.y)/2,st=me-(j.outerLeft||0),Tt=Ge-(j.outerTop||0),Mt=j.outerWidth||o.clientWidth||0,Tn=j.outerHeight||o.clientHeight||0,ot=t.panLocked?Mt/2:st,Pt=t.panLocked?Tn/2:Tt;ia={x:ot,y:Pt};let mn=!1,nn=!1;if(qt){let Oi=me-qt.x,Mn=Ge-qt.y;t.panLocked||(Math.abs(Oi)>ke||Math.abs(Mn)>ke)&&(q+=Oi,Z+=Mn,mn=!0)}if(en!=null){let Mn=Math.max(en,180),oa=Math.max(Le,180)/Mn,aa=.12,As=Math.max(1-aa,Math.min(1+aa,oa));if(!t.zoomLocked&&Math.abs(As-1)>Ne){M();let Rs=$(),ra=Math.min(F,Math.max(Rs,P*As));Ls(ot,Pt,ra,{snap:!1}),nn=!0}}en=Le,qt={x:me,y:Ge},(nn||mn)&&(nn&&(jr=!0),ie(),Rn()),hn=!1,Rt=null;return}if(ye.size===1&&hn&&Rt===k.pointerId){if(t.panLocked){hn=!1,Rt=null;return}let G=k.clientX-ta,H=k.clientY-na;ta=k.clientX,na=k.clientY,(Math.abs(G)>1||Math.abs(H)>1)&&(Hr=!0,q+=G,Z+=H,ie(),Rn())}},{passive:!1}),o.addEventListener("pointerup",k=>{ye.delete(k.pointerId),pn(),ye.size<2&&(en=null,qt=null),Rt===k.pointerId&&(hn=!1,Rt=null,Hr=!1),ye.size===0&&(jr=!1,Wr=!1,ia=null,Ti("pinch"),B(),ie(),k.pointerType==="touch"&&requestAnimationFrame(()=>jt()))}),o.addEventListener("pointercancel",k=>{ye.delete(k.pointerId),pn(),ye.size<2&&(en=null,qt=null),Rt===k.pointerId&&(hn=!1,Rt=null),ye.size===0&&(Wr=!1,ia=null,Ti("pinch"),B(),ie(),k.pointerType==="touch"&&requestAnimationFrame(()=>jt()))}),document.addEventListener("contextmenu",k=>{let V=k.target.tagName;V==="INPUT"||V==="TEXTAREA"||k.target.isContentEditable||k.target.closest?.("button.pin-btn")||k.target.closest?.(".panel")||k.target.closest?.(".pip-placeholder")||k.target.closest?.(".panel-note")||k.target.id!=="viewportInner"&&(k.preventDefault(),k.stopImmediatePropagation())},{capture:!0}),o.oncontextmenu=k=>!!(k.target.closest?.(".pip-placeholder")||k.target.id==="viewportInner"),document.addEventListener("pointerup",k=>{ye.has(k.pointerId)&&(ye.delete(k.pointerId),pn(),ye.size<2&&(en=null,qt=null)),xe.has(k.pointerId)&&(xe.delete(k.pointerId),nt())},{capture:!0}),document.addEventListener("pointercancel",k=>{ye.has(k.pointerId)&&(ye.delete(k.pointerId),pn(),ye.size<2&&(en=null,qt=null)),xe.has(k.pointerId)&&(xe.delete(k.pointerId),nt())},{capture:!0}),document.addEventListener("visibilitychange",()=>{document.hidden&&(ye.clear(),xe.clear(),pn(),en=null,qt=null,hn=!1,Rt=null,window.__synthPipGestureActive=!1)});let tn=null,Pi=()=>{M();let k=Be,V=j.outerWidth,G=j.outerHeight,H=P,oe=q,we=Z,it=V>0?(V/2-oe)/H:0,Le=G>0?(G/2-we)/H:0;de();let me=j.outerWidth,Ge=j.outerHeight;if(Be=me,k>0&&me>0&&Math.abs(me-k)>10){let st=me/k,Tt=H*st,Mt=$();P=Math.min(F,Math.max(Mt,ze(Tt))),q=me/2-it*P,Z=Ge/2-Le*P}if(de(),Ke(),ie(),De){B();return}window.__synthResetFocusedPanel&&window.__synthResetFocusedPanel(),Mi(),B()};window.addEventListener("resize",()=>{if(window.__synthFullscreenTransition){Pi();return}tn&&clearTimeout(tn),tn=setTimeout(()=>{if(tn=null,window.__synthNavGestureActive){tn=setTimeout(()=>{tn=null,window.__synthNavGestureActive||Pi()},180);return}Pi()},90)},{passive:!0}),document.addEventListener("synth:zoomIn",()=>{Ce=!0,de(),M();let k=(j.outerWidth||o.clientWidth)/2,V=(j.outerHeight||o.clientHeight)/2,G=$(),H=Math.min(F,Math.max(G,P*1.25));Ls(k,V,H),Rn(),B()}),document.addEventListener("synth:zoomOut",()=>{Ce=!0,de(),M();let k=(j.outerWidth||o.clientWidth)/2,V=(j.outerHeight||o.clientHeight)/2,G=$(),H=Math.min(F,Math.max(G,P*.8));Ls(k,V,H),Rn(),B()}),document.addEventListener("synth:zoomReset",()=>{M(),Ce=!0,de(),Mi(),gt(),De=!1,N=null,window.__synthResetFocusedPanel&&window.__synthResetFocusedPanel(),B(),Qo()}),document.addEventListener("fullscreenchange",()=>{M(),window.__synthFullscreenTransition=!0,tn&&(clearTimeout(tn),tn=null),Ce=!0,de(),Mi(),gt(),jt(),requestAnimationFrame(()=>{Ce=!0,de(),Mi(),gt(),jt(),requestAnimationFrame(()=>{Ce=!0,Pi(),gt(),jt(),document.dispatchEvent(new CustomEvent("synth:fullscreenComplete")),setTimeout(()=>{window.__synthFullscreenTransition=!1,Ce=!0,de(),Pi(),gt(),jt(),document.dispatchEvent(new CustomEvent("synth:fullscreenComplete")),B()},400)})})})}var Ec=[{actionId:"panel1",panelId:"panel-1"},{actionId:"panel2",panelId:"panel-2"},{actionId:"panel3",panelId:"panel-3"},{actionId:"panel4",panelId:"panel-4"},{actionId:"panel5",panelId:"panel-5"},{actionId:"panel6",panelId:"panel-6"},{actionId:"panelOutput",panelId:"panel-output"}];function Sc(o){let e=ve.get(o);return!e||!e.key?"\u2014":e.ctrl||e.alt||e.shift?ve.formatBinding(e):e.key.toUpperCase()}function Xd(){Ec.forEach(({actionId:o,panelId:e})=>{let t=Sc(o),i=document.getElementById(e)?.querySelector(".panel-shortcut-badge");i&&(i.textContent=t,i.setAttribute("title",`Shortcut: ${t}`));let s=document.querySelector(`.pip-container[data-panel-id="${e}"] .pip-shortcut-badge`);s&&(s.textContent=t)})}function kc(){Ec.forEach(({actionId:o,panelId:e})=>{let t=document.getElementById(e);if(!t||t.querySelector(".panel-shortcut-badge"))return;let n=Sc(o),i=document.createElement("span");i.className="panel-shortcut-badge",i.textContent=n,i.setAttribute("aria-hidden","true"),i.setAttribute("title",`Shortcut: ${n}`),t.appendChild(i)}),ve.onChange(()=>Xd())}function wc(){let o=["panel-1","panel-2","panel-3","panel-4","panel-5","panel-6","panel-output"],n=["button","input","select","textarea","a",".knob",".knob-inner",".knob-cap",".knob-wrap",".slider",".switch",".toggle",".fader",".output-fader",".output-channel__slider",".output-channel__switch",".synth-toggle",".pin-btn",".matrix-cell",".joystick-pad",".joystick-handle",".panel7-joystick-pad",".panel7-seq-switch",".panel7-seq-button",".sgme-osc__knob",".noise-generator__knob",".random-voltage__knob",".panel-zoom-btn",'[role="button"]','[role="slider"]','[draggable="true"]','[data-prevent-pan="true"]'].join(",");o.forEach(i=>{let s=document.getElementById(i);if(!s)return;let a=0,r=0,l=0,c=0,d=0,h=0,p=0;function m(_){return!_||_===s?!1:!!_.closest(n)}function g(){let _=window.__synthAnimateToPanel,y=window.__synthGetFocusedPanel;_&&(y&&y()===i?_(null):_(i))}s.addEventListener("click",_=>{if(s.classList.contains("panel--pipped")||m(_.target)||Date.now()-p<500)return;let y=Date.now(),f=_.clientX-r,b=_.clientY-l,E=Math.sqrt(f*f+b*b);y-a<300&&E<50?(_.preventDefault(),_.stopPropagation(),g(),a=0):(a=y,r=_.clientX,l=_.clientY)}),s.addEventListener("dblclick",_=>{s.classList.contains("panel--pipped")||m(_.target)||(_.preventDefault(),_.stopPropagation())}),s.addEventListener("touchend",_=>{if(s.classList.contains("panel--pipped")||m(_.target))return;if(p=Date.now(),window.__synthNavGestureActive){c=0;return}if(_.touches&&_.touches.length>0||_.changedTouches&&_.changedTouches.length>1){c=0;return}let y=_.changedTouches[0],f=Date.now(),b=f-c,E=y.clientX-d,w=y.clientY-h,S=Math.sqrt(E*E+w*w);b<300&&S<50?(_.preventDefault(),g(),c=0):(c=f,d=y.clientX,h=y.clientY)},{passive:!1})})}Oe();be();var xo=W("ServiceWorker"),un=null,Jn=null,xc=!1,wo=[];function Lo(o){return wo.push(o),(Jn||un?.waiting)&&o(!0),()=>{let e=wo.indexOf(o);e>=0&&wo.splice(e,1)}}function Lc(){wo.forEach(o=>{try{o(!0)}catch(e){xo.error(" Error en callback:",e)}})}function Ac(){if(typeof window.oscAPI<"u"){xo.info("Entorno Electron detectado, saltando registro de Service Worker");return}if(!("serviceWorker"in navigator))return;navigator.serviceWorker.addEventListener("controllerchange",()=>{xc||(xc=!0,window.location.reload())});let o=async e=>{if(!e||!navigator.serviceWorker.controller)return;Jn=e,Lc(),(await Ie.show({title:u("update.available"),confirmText:u("update.installNow"),cancelText:u("update.later")})).confirmed&&e.postMessage({type:"SKIP_WAITING"})};navigator.serviceWorker.register("./sw.js",{updateViaCache:"none"}).then(e=>{un=e,e.update&&e.update().catch(()=>{}),e.waiting&&(Jn=e.waiting,o(e.waiting)),e.addEventListener("updatefound",()=>{let t=e.installing;t&&t.addEventListener("statechange",()=>{t.state==="installed"&&o(t)})})}).catch(e=>{xo.error("No se pudo registrar el service worker:",e)})}async function Rc(){if(!un)return{found:!1,waiting:!1,error:"no-sw"};try{await un.update(),await new Promise(e=>setTimeout(e,1e3));let o=!!un.waiting;return o&&(Jn=un.waiting,Lc()),{found:o,waiting:o}}catch(o){return xo.error(" Error checking for updates:",o),{found:!1,waiting:!1,error:o.message}}}function Tc(){return Jn?(Jn.postMessage({type:"SKIP_WAITING"}),!0):un?.waiting?(un.waiting.postMessage({type:"SKIP_WAITING"}),!0):!1}function ds(){return!!(Jn||un?.waiting)}Oe();be();Xn();Te();var Zd=W("Quickbar");function Ee(o,e){o.setAttribute("aria-label",e),o.setAttribute("data-tooltip",e)}var Jd=400,ki=null,Ao=null;function Si(){ki&&(ki.classList.remove("tooltip-visible"),ki=null),Ao&&(clearTimeout(Ao),Ao=null)}function Qd(o){let e=0,t=0,n=!1;o.addEventListener("touchstart",i=>{let s=i.touches[0];e=s.clientX,t=s.clientY,n=!1,Ao=setTimeout(()=>{Si(),o.classList.add("tooltip-visible"),ki=o,n=!0,navigator.vibrate&&navigator.vibrate(15)},Jd)},{passive:!0}),o.addEventListener("touchmove",i=>{let s=i.touches[0],a=Math.abs(s.clientX-e),r=Math.abs(s.clientY-t);(a>10||r>10)&&Si()},{passive:!0}),o.addEventListener("touchend",i=>{n?(i.preventDefault(),setTimeout(Si,1500)):Si()}),o.addEventListener("touchcancel",()=>{Si()},{passive:!0})}function eh(o){window.matchMedia&&window.matchMedia("(pointer: coarse)").matches&&(o.forEach(t=>Qd(t)),document.addEventListener("touchstart",t=>{ki&&!ki.contains(t.target)&&Si()},{passive:!0}))}function Mc(){let o=(()=>{try{return window.matchMedia&&window.matchMedia("(pointer: coarse)").matches}catch{return!1}})();if(document.getElementById("mobileQuickbar"))return;window.__synthNavLocks=window.__synthNavLocks||{zoomLocked:!1,panLocked:!1};let e=window.__synthNavLocks,t="./assets/icons/ui-sprite.svg",n=O=>`
    <svg viewBox="0 0 24 24" width="18" height="18" aria-hidden="true" focusable="false"
      fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <use href="${t}#${O}"></use>
    </svg>
  `,i=document.createElement("div");i.id="mobileQuickbar",i.className="mobile-quickbar mobile-quickbar--collapsed",i.setAttribute("data-prevent-pan","true");let s=document.createElement("div");s.className="mobile-quickbar__fixed";let a=document.createElement("button");a.type="button",a.className="mobile-quickbar__btn mobile-quickbar__mute",a.id="btnGlobalMute",Ee(a,u("quickbar.mute")),a.setAttribute("aria-pressed","false"),a.innerHTML=n("ti-volume");let r=document.createElement("button");r.type="button",r.className="mobile-quickbar__tab",Ee(r,u("quickbar.open")),r.setAttribute("aria-expanded","false"),r.innerHTML=n("ti-menu-2");let l=document.createElement("div");l.className="mobile-quickbar__group";let c=document.createElement("button");c.type="button",c.className="mobile-quickbar__btn",Ee(c,u(e.panLocked?"quickbar.pan.unlock":"quickbar.pan.lock")),c.setAttribute("aria-pressed",String(!!e.panLocked)),c.innerHTML=n("ti-hand-stop");let d=document.createElement("button");d.type="button",d.className="mobile-quickbar__btn",Ee(d,u(e.zoomLocked?"quickbar.zoom.unlock":"quickbar.zoom.lock")),d.setAttribute("aria-pressed",String(!!e.zoomLocked)),d.innerHTML=n("ti-zoom-cancel");let h=document.createElement("button");h.type="button",h.className="mobile-quickbar__btn",h.id="btnPatches";let p=!1;Ee(h,u("quickbar.patches")),h.innerHTML=n("ti-files"),h.setAttribute("aria-pressed","false");let m=document.createElement("button");m.type="button",m.className="mobile-quickbar__btn",m.id="btnUndo",m.disabled=!0,Ee(m,u("quickbar.undo")),m.innerHTML=n("ti-arrow-back-up");let g=document.createElement("button");g.type="button",g.className="mobile-quickbar__btn",g.id="btnRedo",g.disabled=!0,Ee(g,u("quickbar.redo")),g.innerHTML=n("ti-arrow-forward-up");function _(O,q){m.disabled=!O,m.classList.toggle("is-disabled",!O),g.disabled=!q,g.classList.toggle("is-disabled",!q)}m.addEventListener("click",()=>{document.dispatchEvent(new CustomEvent("synth:undo"))}),g.addEventListener("click",()=>{document.dispatchEvent(new CustomEvent("synth:redo"))}),an.onChange(_);function y(O){p=O,h.setAttribute("aria-pressed",String(O)),h.classList.toggle("is-active",O)}h.addEventListener("click",()=>{document.dispatchEvent(new CustomEvent("synth:togglePatches"))}),document.addEventListener("synth:patchBrowserChanged",O=>{y(O.detail?.open??!1)});let f=document.createElement("div");f.className="mobile-quickbar__pip-container";let b=document.createElement("button");b.type="button",b.className="mobile-quickbar__btn",b.id="btnPip",Ee(b,u("quickbar.pip","Paneles flotantes")),b.innerHTML=n("ti-picture-in-picture");let E=document.createElement("div");E.className="pip-menu",Yn.forEach(({id:O,name:q})=>{let Z=document.createElement("button");Z.type="button",Z.className="pip-menu__item",Z.dataset.panelId=O,Z.textContent=q(),Z.addEventListener("click",De=>{De.stopPropagation(),dr(O),A()}),E.appendChild(Z)});let w=document.createElement("div");w.className="pip-menu__separator",E.appendChild(w);let S=document.createElement("button");S.type="button",S.className="pip-menu__item pip-menu__item--action",S.textContent=u("pip.detachAll","Extraer todos"),S.addEventListener("click",O=>{O.stopPropagation(),pr(),A()}),E.appendChild(S);let T=document.createElement("button");T.type="button",T.className="pip-menu__item pip-menu__item--action",T.textContent=u("pip.attachAll","Devolver todos"),T.addEventListener("click",O=>{O.stopPropagation(),Ei(),A()}),E.appendChild(T);function A(){let O=Kn(),q=Yn.length;E.querySelectorAll(".pip-menu__item[data-panel-id]").forEach(Be=>{let ze=O.includes(Be.dataset.panelId);Be.classList.toggle("is-active",ze),Be.setAttribute("aria-pressed",String(ze))}),b.classList.toggle("has-active-pips",O.length>0);let Z=O.length>=q;S.disabled=Z,S.classList.toggle("is-disabled",Z);let De=O.length===0;T.disabled=De,T.classList.toggle("is-disabled",De)}let C=!1;function x(O){C=typeof O=="boolean"?O:!C,E.classList.toggle("is-open",C),b.setAttribute("aria-expanded",String(C)),C&&A()}b.addEventListener("click",O=>{O.stopPropagation(),x()}),document.addEventListener("click",O=>{C&&!f.contains(O.target)&&x(!1)}),window.addEventListener("pip:open",A),window.addEventListener("pip:close",A),f.appendChild(b),f.appendChild(E);let R=document.createElement("button");R.type="button",R.className="mobile-quickbar__btn",Ee(R,u(document.fullscreenElement?"quickbar.fullscreen.exit":"quickbar.fullscreen")),R.setAttribute("aria-pressed",String(!!document.fullscreenElement)),R.innerHTML=n("ti-arrows-maximize");let M=document.createElement("button");M.type="button",M.className="mobile-quickbar__btn",M.id="btnGeneralSettings",Ee(M,u("quickbar.settings")),M.innerHTML=n("ti-settings");let I=document.createElement("span");I.className="quickbar-update-badge",I.hidden=!0,M.appendChild(I),ds()&&(I.hidden=!1),Lo(O=>{I.hidden=!O}),M.addEventListener("click",()=>{document.dispatchEvent(new CustomEvent("synth:toggleSettings"))});let B=["(display-mode: standalone)"].map(O=>window.matchMedia?window.matchMedia(O):null).filter(Boolean),Y=()=>{let O=B.some(Z=>Z.matches),q=typeof window.navigator<"u"&&"standalone"in window.navigator?window.navigator.standalone:!1;return O||!!q},P=!!(document.documentElement&&document.documentElement.requestFullscreen),F=()=>!P,z=()=>{c.setAttribute("aria-pressed",String(!!e.panLocked)),d.setAttribute("aria-pressed",String(!!e.zoomLocked)),R.setAttribute("aria-pressed",String(!!document.fullscreenElement)),Ee(c,u(e.panLocked?"quickbar.pan.unlock":"quickbar.pan.lock")),Ee(d,u(e.zoomLocked?"quickbar.zoom.unlock":"quickbar.zoom.lock")),Ee(R,u(document.fullscreenElement?"quickbar.fullscreen.exit":"quickbar.fullscreen")),c.classList.toggle("is-active",!!e.panLocked),d.classList.toggle("is-active",!!e.zoomLocked),R.classList.toggle("is-active",!!document.fullscreenElement),c.hidden=!1,c.disabled=!1,d.hidden=!1,d.disabled=!1,R.hidden=F(),R.disabled=R.hidden},$=!1;function N(O){$=!!O,i.classList.toggle("mobile-quickbar--collapsed",!$),i.classList.toggle("mobile-quickbar--expanded",$),r.setAttribute("aria-expanded",String($)),Ee(r,u($?"quickbar.close":"quickbar.open"))}r.addEventListener("click",()=>{N(!$)}),c.addEventListener("click",()=>{e.panLocked=!e.panLocked,z(),document.dispatchEvent(new CustomEvent("synth:panLockChange",{detail:{enabled:e.panLocked}}))}),d.addEventListener("click",()=>{e.zoomLocked=!e.zoomLocked,z(),document.dispatchEvent(new CustomEvent("synth:zoomLockChange",{detail:{enabled:e.zoomLocked}}))}),R.addEventListener("click",async()=>{if(!R.disabled)try{document.fullscreenElement?(typeof window.__synthPrepareForFullscreen=="function"&&window.__synthPrepareForFullscreen(!1),await document.exitFullscreen()):(typeof window.__synthPrepareForFullscreen=="function"&&window.__synthPrepareForFullscreen(!0),await document.documentElement.requestFullscreen())}catch(O){Zd.error("No se pudo alternar pantalla completa:",O)}finally{z()}}),document.addEventListener("synth:panLockChange",O=>{e.panLocked=O.detail?.enabled??!1,z()}),document.addEventListener("synth:zoomLockChange",O=>{e.zoomLocked=O.detail?.enabled??!1,z()}),document.addEventListener("fullscreenchange",z),B.forEach(O=>O.addEventListener("change",z));let K=!1;function te(O){K=O,a.innerHTML=n(O?"ti-volume-off":"ti-volume"),Ee(a,u(O?"quickbar.unmute":"quickbar.mute")),a.setAttribute("aria-pressed",String(O)),a.classList.toggle("is-muted",O)}a.addEventListener("click",()=>{document.dispatchEvent(new CustomEvent("synth:toggleMute"))}),document.addEventListener("synth:muteChanged",O=>{te(O.detail?.muted??!1)}),ve.init();let Q=document.createElement("button");Q.type="button",Q.className="mobile-quickbar__btn",Q.id="btnRecord",Ee(Q,u("quickbar.record")),Q.innerHTML=n("ti-circle");let ge=!1;function Se(O){ge=O,Q.innerHTML=n(O?"ti-player-stop":"ti-circle"),Ee(Q,u(O?"quickbar.stopRecording":"quickbar.record")),Q.setAttribute("aria-pressed",String(O)),Q.classList.toggle("is-recording",O)}Q.addEventListener("click",()=>{document.dispatchEvent(new CustomEvent("synth:toggleRecording"))}),document.addEventListener("synth:recordingChanged",O=>{Se(O.detail?.recording??!1)});let ne=document.createElement("button");ne.type="button",ne.className="mobile-quickbar__btn mobile-quickbar__btn--danger",ne.id="btnReset",Ee(ne,u("quickbar.reset")),ne.innerHTML=n("ti-refresh"),ne.addEventListener("click",async()=>{if(localStorage.getItem(v.CONFIRM_SYNTH_RESET)==="false"){document.dispatchEvent(new CustomEvent("synth:resetToDefaults"));return}let O=await Ie.show({title:u("synth.reset.confirm"),confirmText:u("common.yes"),cancelText:u("common.no"),rememberKey:"skip-reset-confirm",rememberText:u("common.dontAskAgain")});O.confirmed&&(O.remember&&localStorage.setItem(v.CONFIRM_SYNTH_RESET,"false"),document.dispatchEvent(new CustomEvent("synth:resetToDefaults"))),Ie.clearRememberedChoice("skip-reset-confirm")});let ce=document.createElement("button");ce.type="button",ce.className="mobile-quickbar__btn",ce.id="btnOsc";let ue=!1;console.log("[Quickbar] oscBridge.isAvailable():",J.isAvailable()),console.log("[Quickbar] window.oscAPI:",typeof window.oscAPI);function Ne(O){ue=O,ce.innerHTML=n(O?"ti-broadcast":"ti-broadcast-off"),Ee(ce,u(O?"quickbar.oscOn":"quickbar.oscOff")),ce.setAttribute("aria-pressed",String(O)),ce.classList.toggle("is-osc-active",O)}Ne(!1),J.isAvailable()||(ce.style.display="none"),ce.addEventListener("click",()=>{document.dispatchEvent(new CustomEvent("osc:toggle"))}),document.addEventListener("osc:statusChanged",O=>{Ne(O.detail?.enabled??!1)}),l.appendChild(c),l.appendChild(d),l.appendChild(m),l.appendChild(g),l.appendChild(h),l.appendChild(f),l.appendChild(Q),l.appendChild(ne),l.appendChild(ce),l.appendChild(R),l.appendChild(M),s.appendChild(a),s.appendChild(r),i.appendChild(l),i.appendChild(s),document.body.appendChild(i),z(),eh([a,r,c,d,m,g,h,b,Q,ne,ce,R,M]),Pe(()=>{Ee(a,u(K?"quickbar.unmute":"quickbar.mute")),Ee(r,u($?"quickbar.close":"quickbar.open")),Ee(m,u("quickbar.undo")),Ee(g,u("quickbar.redo")),Ee(h,u("quickbar.patches")),Ee(b,u("quickbar.pip","Paneles flotantes")),Ee(Q,u(ge?"quickbar.stopRecording":"quickbar.record")),Ee(ne,u("quickbar.reset")),Ee(ce,u(ue?"quickbar.oscOn":"quickbar.oscOff")),Ee(M,u("quickbar.settings")),z(),E.querySelectorAll(".pip-menu__item").forEach((O,q)=>{Yn[q]&&(O.textContent=Yn[q].name())})});function ke(O){i.style.display=O?"":"none";let q=document.getElementById("floatingMuteBtn");O?q&&(q.style.display="none"):(q||(q=document.createElement("button"),q.id="floatingMuteBtn",q.type="button",q.className="mobile-quickbar__btn mobile-quickbar__mute floating-mute-btn",q.innerHTML=a.innerHTML,q.setAttribute("aria-pressed",a.getAttribute("aria-pressed")),q.setAttribute("aria-label",a.getAttribute("aria-label")),q.addEventListener("click",()=>{document.dispatchEvent(new CustomEvent("synth:toggleMute"))}),document.body.appendChild(q)),q.style.display="",q.innerHTML=a.innerHTML,q.setAttribute("aria-pressed",a.getAttribute("aria-pressed")),q.classList.toggle("is-muted",K)),document.dispatchEvent(new CustomEvent("synth:quickbarVisibilityChanged",{detail:{visible:O}}))}if(document.addEventListener("synth:toggleQuickbar",O=>{let q=O.detail?.visible??!i.style.display!=="none";ke(q);try{localStorage.setItem("synthigme-quickbar-visible",String(q))}catch{}}),document.addEventListener("synth:muteChanged",()=>{let O=document.getElementById("floatingMuteBtn");O&&(O.innerHTML=a.innerHTML,O.setAttribute("aria-pressed",a.getAttribute("aria-pressed")),O.classList.toggle("is-muted",K))}),typeof window.menuAPI<"u")try{localStorage.getItem("synthigme-quickbar-visible")==="false"&&ke(!1)}catch{}}Oe();be();Te();var le=W("AudioSettingsModal"),Ro=class{constructor(e={}){let{outputCount:t=8,inputCount:n=8,physicalChannels:i=2,physicalInputChannels:s=2,channelLabels:a=["L","R"],inputChannelLabels:r=["Mic/L","R"],onRoutingChange:l,onInputRoutingChange:c,onOutputDeviceChange:d,onInputDeviceChange:h,onStereoBusRoutingChange:p}=e;this.outputCount=t,this.inputCount=n,this.physicalChannels=i,this.channelLabels=a,this.physicalInputChannels=s,this.inputChannelLabels=r,this.onRoutingChange=l,this.onInputRoutingChange=c,this.onOutputDeviceChange=d,this.onInputDeviceChange=h,this.onStereoBusRoutingChange=p,this.stereoBusLabels=["Pan1-4L","Pan1-4R","Pan5-8L","Pan5-8R"],this.stereoBusCount=this.stereoBusLabels.length,this.totalOutputSources=this.stereoBusCount+this.outputCount,this.outputMode=localStorage.getItem(v.OUTPUT_MODE)||"stereo",this.multichannelAvailable=!1;let m=this._loadStereoBusRouting();this.stereoBusRouting=m||this._getDefaultStereoBusRouting(),this.onOutputModeChange=e.onOutputModeChange,this.selectedOutputDevice=localStorage.getItem(v.OUTPUT_DEVICE)||"default",this.selectedInputDevice=localStorage.getItem(v.INPUT_DEVICE)||"default",this.availableOutputDevices=[],this.availableInputDevices=[],this.outputDeviceSelect=null,this.inputDeviceSelect=null,this.outputModeRadios=null,this.channelInfoElement=null,this.matrixContainer=null,this.outputRouting=null,this._routingInitialized=!1;let g=this._loadInputRouting();this.inputRouting=g||this._getDefaultInputRouting(),g?le.info(" Input routing loaded from localStorage:",this.inputRouting):le.info(" Using default input routing (no saved data)");let _=this._loadInputMultichannelRouting();this.inputMultichannelRouting=_||this._getDefaultInputMultichannelRouting(),this.inputMultichannelLabels=Array.from({length:8},(y,f)=>`input_amp_${f+1}`),this.overlay=null,this.modal=null,this.isOpen=!1,this.outputToggleButtons=[],this.inputToggleButtons=[],this.inputMatrixContainer=null,this._textElements={},this._create(),this._unsubscribeLocale=Pe(()=>this._updateTexts())}_getDefaultRouting(){let e=this.outputMode==="multichannel";return Array.from({length:this.outputCount},(t,n)=>Array.from({length:this.physicalChannels},(i,s)=>e?s===n+4:!1))}_getRoutingStorageKey(){return this.outputMode==="multichannel"?v.AUDIO_ROUTING_MULTICHANNEL:v.AUDIO_ROUTING}_loadRouting(){try{let e=this._getRoutingStorageKey(),t=localStorage.getItem(e);if(!t)return null;let n=JSON.parse(t);return Array.isArray(n)?Array.from({length:this.outputCount},(i,s)=>{let a=n[s];return Array.isArray(a)?[...a]:a&&typeof a.left=="boolean"?[a.left,a.right]:[]}):null}catch(e){return le.warn(" Error loading routing from localStorage:",e),null}}_saveRouting(){try{let e=this._getRoutingStorageKey(),t=JSON.stringify(this.outputRouting);localStorage.setItem(e,t)}catch(e){le.warn("[AudioSettingsModal] Error saving routing to localStorage:",e)}}_getStereoBusRoutingStorageKey(){return this.outputMode==="multichannel"?v.STEREO_BUS_ROUTING_MULTICHANNEL:v.STEREO_BUS_ROUTING}_getDefaultStereoBusRouting(){let e=this.physicalChannels||2;return this.outputMode==="multichannel"?[Array.from({length:e},(t,n)=>n===0),Array.from({length:e},(t,n)=>n===1),Array.from({length:e},(t,n)=>n===2),Array.from({length:e},(t,n)=>n===3)]:[Array.from({length:e},(t,n)=>n===0),Array.from({length:e},(t,n)=>n===1),Array.from({length:e},(t,n)=>n===0),Array.from({length:e},(t,n)=>n===1)]}_loadStereoBusRouting(){try{let e=this._getStereoBusRoutingStorageKey(),t=localStorage.getItem(e);if(!t)return null;let n=JSON.parse(t);if(!Array.isArray(n)||n.length!==4)return null;let i=this.physicalChannels||2;return n.map(s=>Array.from({length:i},(a,r)=>Array.isArray(s)&&s[r]===!0))}catch(e){return le.warn(" Error loading stereo bus routing:",e),null}}_saveStereoBusRouting(){try{let e=this._getStereoBusRoutingStorageKey();localStorage.setItem(e,JSON.stringify(this.stereoBusRouting))}catch(e){le.warn("[AudioSettingsModal] Error saving stereo bus routing:",e)}}applyStereoBusRoutingToEngine(e){if(e){for(let t=0;t<this.stereoBusCount;t++){let i=(this.stereoBusRouting[t]||[]).map(s=>s?1:0);e(t,i)}le.info(" Stereo bus routing applied to engine:",this.stereoBusRouting)}}_getDefaultInputRouting(){return Array.from({length:this.physicalInputChannels},(e,t)=>Array.from({length:this.inputCount},(n,i)=>t===i))}_loadInputRouting(){try{let e=localStorage.getItem(v.INPUT_ROUTING);if(!e)return null;let t=JSON.parse(e);return Array.isArray(t)?Array.from({length:this.physicalInputChannels},(n,i)=>{let s=t[i];return Array.isArray(s)?Array.from({length:this.inputCount},(a,r)=>s[r]===!0):Array.from({length:this.inputCount},(a,r)=>i===r)}):null}catch(e){return le.warn(" Error loading input routing:",e),null}}_saveInputRouting(){try{localStorage.setItem(v.INPUT_ROUTING,JSON.stringify(this.inputRouting)),le.info(" Input routing saved to localStorage")}catch(e){le.warn(" Error saving input routing:",e)}}updatePhysicalInputChannels(e,t){let n=this.physicalInputChannels;this.physicalInputChannels=e,this.inputChannelLabels=t||this._generateDefaultInputLabels(e),le.info(` Physical input channels changed: ${n} \u2192 ${e}`),this.inputRouting=Array.from({length:e},(i,s)=>s<this.inputRouting.length?this.inputRouting[s]:Array.from({length:this.inputCount},(a,r)=>s===r)),this._updateInputChannelInfo(),this.inputMatrixContainer&&this._buildInputMatrix(),this._saveInputRouting()}_generateDefaultInputLabels(e){return e===1?["Mono"]:e===2?["L","R"]:Array.from({length:e},(t,n)=>`In ${n+1}`)}_updateInputChannelInfo(){this.inputChannelInfoElement&&(this.inputChannelInfoElement.textContent=this.physicalInputChannels===1?u("audio.channel.mono"):this.physicalInputChannels===2?u("audio.channel.stereo"):`${this.physicalInputChannels}ch`)}_getDefaultInputMultichannelRouting(){return Array.from({length:8},(e,t)=>Array.from({length:this.inputCount},(n,i)=>t===i))}_loadInputMultichannelRouting(){try{let e=localStorage.getItem(v.INPUT_ROUTING_MULTICHANNEL);if(!e)return null;let t=JSON.parse(e);return Array.isArray(t)?Array.from({length:8},(n,i)=>{let s=t[i];return Array.isArray(s)?Array.from({length:this.inputCount},(a,r)=>s[r]===!0):Array.from({length:this.inputCount},(a,r)=>i===r)}):null}catch(e){return le.warn(" Error loading input multichannel routing:",e),null}}_saveInputMultichannelRouting(){try{localStorage.setItem(v.INPUT_ROUTING_MULTICHANNEL,JSON.stringify(this.inputMultichannelRouting)),le.info(" Input multichannel routing saved to localStorage")}catch(e){le.warn(" Error saving input multichannel routing:",e)}}updatePhysicalChannels(e,t){let n=this.physicalChannels,i=e>=12,s=i?"multichannel":"stereo";if(!this._routingInitialized){this.physicalChannels=e,this.channelLabels=t||this._generateDefaultLabels(e),this.outputMode=s,localStorage.setItem(v.OUTPUT_MODE,s);let c=this._loadRouting();c?this.outputRouting=c:this.outputRouting=null;let d=this._loadStereoBusRouting();d&&(this.stereoBusRouting=d),this._resizeRoutingArrays(e),this._resizeStereoBusRoutingArrays(e),this._routingInitialized=!0,this._updateChannelInfo(),this.matrixContainer&&this._rebuildMatrix(),this._saveRouting(),this._saveStereoBusRouting();return}let a=n>=12,r=a!==i,l=a?"multichannel":"stereo";if(r){this.outputMode=l,this._saveRouting(),this._saveStereoBusRouting(),this.outputRouting=null,this.outputMode=s,localStorage.setItem(v.OUTPUT_MODE,s);let c=this._loadRouting();c&&(this.outputRouting=c)}if(this.physicalChannels=e,this.channelLabels=t||this._generateDefaultLabels(e),r){let c=this._loadStereoBusRouting();c?this.stereoBusRouting=c:this.stereoBusRouting=this._getDefaultStereoBusRouting()}this._resizeRoutingArrays(e),this._resizeStereoBusRoutingArrays(e),this._updateChannelInfo(),this.matrixContainer&&this._rebuildMatrix(),this._saveRouting(),r&&this._saveStereoBusRouting()}_resizeRoutingArrays(e){let t=e>=12;this.outputRouting=Array.from({length:this.outputCount},(n,i)=>{let s=this.outputRouting?.[i];return s&&s.length>0?Array.from({length:e},(a,r)=>r<s.length?s[r]===!0:!1):Array.from({length:e},(a,r)=>t?r===i+4:!1)})}_resizeStereoBusRoutingArrays(e){let t=e>=12;this.stereoBusRouting=Array.from({length:this.stereoBusCount},(n,i)=>{let s=this.stereoBusRouting?.[i];return s&&s.length>0?Array.from({length:e},(a,r)=>r<s.length?s[r]===!0:!1):Array.from({length:e},(a,r)=>{if(t)return r===i;let l=i%2;return r===l})})}_generateDefaultLabels(e){return{2:["L","R"],4:["FL","FR","RL","RR"],6:["FL","FR","C","LFE","RL","RR"],8:["FL","FR","C","LFE","RL","RR","SL","SR"]}[e]||Array.from({length:e},(n,i)=>`Ch${i+1}`)}_updateChannelInfo(){if(!this.channelInfoElement)return;let e=this._getConfigurationName(this.physicalChannels);this.channelInfoElement.textContent=`${this.physicalChannels} (${e})`,this.channelInfoElement.title=`${this.channelLabels.join(", ")}`}_getConfigurationName(e){return{1:u("audio.channel.mono"),2:u("audio.channel.stereo"),4:u("audio.channel.quad"),6:u("audio.channel.surround")}[e]||`${e}ch`}_updateTexts(){let e=this._textElements;e.title&&(e.title.textContent=u("audio.title")),e.closeBtn&&e.closeBtn.setAttribute("aria-label",u("audio.close")),e.outputTitle&&(e.outputTitle.textContent=u("audio.outputs.title")),e.outputDeviceLabel&&(e.outputDeviceLabel.textContent=u("audio.device.output")),e.outputChannelLabel&&(e.outputChannelLabel.textContent=u("audio.outputs.channels")+" "),e.outputDesc&&(e.outputDesc.textContent=u("audio.outputs.description")),e.resetBtn&&(e.resetBtn.textContent=u("audio.outputs.reset")),e.inputTitle&&(e.inputTitle.textContent=u("audio.inputs.title")),e.inputDeviceLabel&&(e.inputDeviceLabel.textContent=u("audio.device.input")),e.inputChannelLabel&&(e.inputChannelLabel.textContent=u("audio.inputs.channels")+" "),e.inputDesc&&(e.inputDesc.textContent=u("audio.inputs.description")),e.inputPermissionBtn&&(e.inputPermissionBtn.textContent=u("audio.inputs.enable")),e.latencyLabel&&(e.latencyLabel.textContent=u("audio.latency.label")||"Latencia:"),this._updateChannelInfo(),this._updateInputChannelInfo()}async _enumerateDevices(e=!1,t=!1){try{if(e){if(localStorage.getItem(v.MIC_PERMISSION_DENIED)==="true"&&!t){le.info(" Microphone permission was previously denied, skipping request"),this._showPermissionDeniedMessage();return}try{le.info(" Requesting microphone permission via getUserMedia..."),(await navigator.mediaDevices.getUserMedia({audio:!0})).getTracks().forEach(a=>a.stop()),localStorage.removeItem(v.MIC_PERMISSION_DENIED),this._hidePermissionDeniedMessage(),le.info(" Microphone permission granted")}catch(s){le.warn(" getUserMedia error:",s.name,s.message),(s.name==="NotAllowedError"||s.name==="PermissionDeniedError")&&(le.warn(" Microphone permission denied by user"),localStorage.setItem(v.MIC_PERMISSION_DENIED,"true"),this._showPermissionDeniedMessage())}}let n=await navigator.mediaDevices.enumerateDevices();this.availableOutputDevices=n.filter(i=>i.kind==="audiooutput"),this.availableInputDevices=n.filter(i=>i.kind==="audioinput"),await this._checkMultichannelAvailability(),this._hasMediaPermission=n.some(i=>i.label&&i.label.length>0),this._updateDeviceSelects()}catch(n){le.warn(" Error enumerating devices:",n),this._showDeviceError()}}async _checkMultichannelAvailability(){if(this.multichannelAvailable=!1,!!window.multichannelAPI)try{let e=await window.multichannelAPI.checkAvailability();this.multichannelAvailable=e.available,e.available?le.info(" 12-channel native audio available (Electron/PipeWire)"):le.info(" Multichannel not available:",e.reason),this._updateOutputModeUI()}catch(e){le.warn(" Error checking multichannel availability:",e)}}isMultichannelMode(){return this.outputMode==="multichannel"}setOutputMode(e,t=!0){e!==this.outputMode&&(e==="multichannel"&&!this.multichannelAvailable||(this.outputMode=e,localStorage.setItem(v.OUTPUT_MODE,e),le.info(` Output mode changed to: ${e}`),this._updateOutputModeUI(),this._updateDeviceSelectorVisibility(),this._updateLatencyVisibility(),this._updateInputSectionVisibility(),t&&this.onOutputModeChange&&this.onOutputModeChange(e)))}_updateOutputModeUI(){if(!this.outputModeRadios)return;let e=this.outputModeRadios.querySelector('input[value="multichannel"]'),t=this.outputModeRadios.querySelector(".mode-multichannel-label");e&&(e.disabled=!this.multichannelAvailable),t&&(this.multichannelAvailable?(t.classList.remove("disabled"),t.title=""):(t.classList.add("disabled"),t.title=u("audio.mode.unavailable")));let n=this.outputModeRadios.querySelector(`input[value="${this.outputMode}"]`);n&&(n.checked=!0)}_updateDeviceSelectorVisibility(){if(!this.outputDeviceSelect)return;let e=this.outputMode==="multichannel";this.outputDeviceSelect.disabled=e;let t=this.outputDeviceSelect.closest(".audio-settings-device-selector");t&&t.classList.toggle("disabled",e)}isMultichannelDevice(){return this.outputMode==="multichannel"}_showDeviceError(){let e=u("audio.device.error")||"Error loading devices";if(this.outputDeviceSelect){this.outputDeviceSelect.innerHTML="";let t=document.createElement("option");t.value="default",t.textContent=e,this.outputDeviceSelect.appendChild(t)}if(this.inputDeviceSelect){this.inputDeviceSelect.innerHTML="";let t=document.createElement("option");t.value="default",t.textContent=e,this.inputDeviceSelect.appendChild(t)}}refreshDevices(e=!1,t=!1){return this._enumerateDevices(e,t)}_showPermissionDeniedMessage(){if(this._permissionDeniedBanner)return;let e=document.createElement("div");e.className="audio-settings-permission-denied",e.innerHTML=`
      <div class="permission-denied-icon">\u26A0\uFE0F</div>
      <div class="permission-denied-text">
        <strong>${u("audio.permission.denied.title")||"Microphone access denied"}</strong>
        <p>${u("audio.permission.denied.message")||"Enable microphone in browser settings to use audio input."}</p>
      </div>
      <button class="permission-denied-retry">${u("audio.permission.retry")||"Retry"}</button>
    `;let t=e.querySelector(".permission-denied-retry");t.addEventListener("click",async()=>{localStorage.removeItem(v.MIC_PERMISSION_DENIED),this._hidePermissionDeniedMessage(),t.textContent="...",t.disabled=!0,await new Promise(n=>setTimeout(n,300));try{le.info(" Retrying microphone permission request..."),(await navigator.mediaDevices.getUserMedia({audio:!0})).getTracks().forEach(i=>i.stop()),le.info(" Microphone permission granted on retry!"),await this._enumerateDevices(!1)}catch(n){le.warn(" Microphone permission still denied:",n.name,n.message),localStorage.setItem(v.MIC_PERMISSION_DENIED,"true"),this._showPermissionDeniedMessage()}}),this._permissionDeniedBanner=e,this.inputDeviceSelect?.parentElement&&this.inputDeviceSelect.parentElement.after(e)}_hidePermissionDeniedMessage(){this._permissionDeniedBanner&&(this._permissionDeniedBanner.remove(),this._permissionDeniedBanner=null)}isMicrophonePermissionDenied(){return localStorage.getItem(v.MIC_PERMISSION_DENIED)==="true"}clearMicrophonePermissionDenied(){localStorage.removeItem(v.MIC_PERMISSION_DENIED),this._hidePermissionDeniedMessage()}_updateDeviceSelects(){if(this.outputDeviceSelect){this.outputDeviceSelect.innerHTML="";let e=document.createElement("option");e.value="default",e.textContent=u("audio.device.default"),this.outputDeviceSelect.appendChild(e),this.availableOutputDevices.forEach(t=>{let n=document.createElement("option");n.value=t.deviceId,n.textContent=t.label||`${u("audio.device.system")} ${t.deviceId.slice(0,8)}...`,t.deviceId===this.selectedOutputDevice&&(n.selected=!0),this.outputDeviceSelect.appendChild(n)})}if(this.inputDeviceSelect){this.inputDeviceSelect.innerHTML="";let e=document.createElement("option");e.value="default",e.textContent=u("audio.device.default"),this.inputDeviceSelect.appendChild(e),this.availableInputDevices.forEach(t=>{let n=document.createElement("option");n.value=t.deviceId,n.textContent=t.label||`${u("audio.device.system")} ${t.deviceId.slice(0,8)}...`,t.deviceId===this.selectedInputDevice&&(n.selected=!0),this.inputDeviceSelect.appendChild(n)})}this._updatePermissionButton()}_updatePermissionButton(){this.permissionBtn&&(this._hasMediaPermission?this.permissionBtn.style.display="none":this.permissionBtn.style.display="inline-block"),this.inputPermissionBtn&&(this._hasMediaPermission?this.inputPermissionBtn.style.display="none":this.inputPermissionBtn.style.display="inline-block")}_createDeviceSelector(e,t){let n=document.createElement("div");n.className="audio-settings-device-selector";let i=document.createElement("label");i.className="audio-settings-device-selector__label",i.textContent=e;let s=document.createElement("select");s.className="audio-settings-device-selector__select";let a=document.createElement("option");return a.value="default",a.textContent=u("audio.device.loading"),s.appendChild(a),s.addEventListener("change",()=>{let r=s.value;t?(this.selectedOutputDevice=r,localStorage.setItem(v.OUTPUT_DEVICE,r),this._updateLatencyVisibility(),this.onOutputDeviceChange&&this.onOutputDeviceChange(r)):(this.selectedInputDevice=r,localStorage.setItem(v.INPUT_DEVICE,r),this.onInputDeviceChange&&this.onInputDeviceChange(r))}),s.addEventListener("focus",()=>{this.modal&&(this.modal.style.transform="translateZ(0)",requestAnimationFrame(()=>{this.modal.style.transform=""}))}),s.addEventListener("blur",()=>{this.modal&&this.modal.offsetHeight}),n.appendChild(i),n.appendChild(s),{wrapper:n,select:s,label:i}}createEmbeddableContent(){let e=document.createElement("div");e.className="audio-settings-content";let t=this._createOutputSection();e.appendChild(t);let n=this._createLatencySection();e.appendChild(n);let i=this._createInputSection();return e.appendChild(i),this.refreshDevices(),e}_create(){this.overlay=document.createElement("div"),this.overlay.className="audio-settings-overlay",this.overlay.setAttribute("aria-hidden","true"),this.modal=document.createElement("div"),this.modal.className="audio-settings-modal",this.modal.setAttribute("role","dialog"),this.modal.setAttribute("aria-labelledby","audioSettingsTitle"),this.modal.setAttribute("aria-modal","true");let e=document.createElement("div");e.className="audio-settings-modal__header",this._textElements.title=document.createElement("h2"),this._textElements.title.id="audioSettingsTitle",this._textElements.title.className="audio-settings-modal__title",this._textElements.title.textContent=u("audio.title"),this._textElements.closeBtn=document.createElement("button"),this._textElements.closeBtn.type="button",this._textElements.closeBtn.className="audio-settings-modal__close",this._textElements.closeBtn.setAttribute("aria-label",u("audio.close")),this._textElements.closeBtn.innerHTML="\xD7",this._textElements.closeBtn.addEventListener("click",()=>this.close()),e.appendChild(this._textElements.title),e.appendChild(this._textElements.closeBtn);let t=document.createElement("div");t.className="audio-settings-modal__content";let n=this._createOutputSection();t.appendChild(n);let i=this._createLatencySection();t.appendChild(i);let s=this._createInputSection();t.appendChild(s),this.modal.appendChild(e),this.modal.appendChild(t),this.overlay.appendChild(this.modal),this.overlay.addEventListener("click",a=>{a.target===this.overlay&&this.close()}),document.addEventListener("keydown",a=>{a.key==="Escape"&&this.isOpen&&this.close()}),document.body.appendChild(this.overlay)}_createOutputSection(){let e=document.createElement("div");e.className="audio-settings-section",this._textElements.outputTitle=document.createElement("h3"),this._textElements.outputTitle.className="audio-settings-section__title",this._textElements.outputTitle.textContent=u("audio.outputs.title"),e.appendChild(this._textElements.outputTitle);let t=document.createElement("div");t.className="audio-settings-mode",this._textElements.modeTitle=document.createElement("label"),this._textElements.modeTitle.className="audio-settings-mode__title",this._textElements.modeTitle.textContent=u("audio.mode.title"),t.appendChild(this._textElements.modeTitle),this.outputModeRadios=document.createElement("div"),this.outputModeRadios.className="audio-settings-mode__radios";let n=document.createElement("label");n.className="audio-settings-mode__option mode-stereo-label";let i=document.createElement("input");i.type="radio",i.name="output-mode",i.value="stereo",i.checked=this.outputMode==="stereo",i.addEventListener("change",()=>this.setOutputMode("stereo")),n.appendChild(i),n.appendChild(document.createTextNode(" "+u("audio.mode.stereo"))),this.outputModeRadios.appendChild(n);let s=document.createElement("label");s.className="audio-settings-mode__option mode-multichannel-label";let a=document.createElement("input");a.type="radio",a.name="output-mode",a.value="multichannel",a.checked=this.outputMode==="multichannel",a.disabled=!this.multichannelAvailable,a.addEventListener("change",()=>this.setOutputMode("multichannel")),s.appendChild(a),s.appendChild(document.createTextNode(" "+u("audio.mode.multichannel"))),this.multichannelAvailable||(s.classList.add("disabled"),s.title=u("audio.mode.unavailable")),this.outputModeRadios.appendChild(s),t.appendChild(this.outputModeRadios),this._textElements.modeDesc=document.createElement("p"),this._textElements.modeDesc.className="audio-settings-mode__desc",this._textElements.modeDesc.textContent=u("audio.mode.multichannel.desc"),this._textElements.modeDesc.style.display=this.outputMode==="multichannel"?"block":"none",t.appendChild(this._textElements.modeDesc),e.appendChild(t);let{wrapper:r,select:l,label:c}=this._createDeviceSelector(u("audio.device.output"),!0);this.outputDeviceSelect=l,this._textElements.outputDeviceLabel=c,this.outputMode==="multichannel"&&(l.disabled=!0,r.classList.add("disabled")),e.appendChild(r),this.permissionBtn=document.createElement("button"),this.permissionBtn.className="audio-settings-permission-btn",this.permissionBtn.textContent="\u{1F3A4} "+u("audio.device.output"),this.permissionBtn.style.display="none",this.permissionBtn.addEventListener("click",async()=>{await this._enumerateDevices(!0)}),e.appendChild(this.permissionBtn);let d=document.createElement("div");d.className="audio-settings-channel-info",this.channelInfoElement=document.createElement("span"),this.channelInfoElement.className="audio-settings-channel-info__value",this._updateChannelInfo(),this._textElements.outputChannelLabel=document.createElement("span"),this._textElements.outputChannelLabel.className="audio-settings-channel-info__label",this._textElements.outputChannelLabel.textContent=u("audio.outputs.channels")+" ",d.appendChild(this._textElements.outputChannelLabel),d.appendChild(this.channelInfoElement),e.appendChild(d),this._textElements.outputDesc=document.createElement("p"),this._textElements.outputDesc.className="audio-settings-section__desc",this._textElements.outputDesc.textContent=u("audio.outputs.description"),e.appendChild(this._textElements.outputDesc),this.matrixContainer=document.createElement("div"),this.matrixContainer.className="routing-matrix-container",this._buildMatrix(),e.appendChild(this.matrixContainer);let h=document.createElement("div");return h.className="audio-settings-reset",this._textElements.resetBtn=document.createElement("button"),this._textElements.resetBtn.type="button",this._textElements.resetBtn.className="audio-settings-reset__btn",this._textElements.resetBtn.textContent=u("audio.outputs.reset"),this._textElements.resetBtn.addEventListener("click",()=>this.resetRoutingToDefaults()),h.appendChild(this._textElements.resetBtn),e.appendChild(h),e}_createLatencySection(){let e=document.createElement("div");e.className="audio-settings-section audio-settings-latency",this._textElements.latencyTitle=document.createElement("h3"),this._textElements.latencyTitle.className="audio-settings-section__title",this._textElements.latencyTitle.textContent=u("audio.latency.title")||"Latencia",e.appendChild(this._textElements.latencyTitle),this._textElements.latencyDesc=document.createElement("p"),this._textElements.latencyDesc.className="audio-settings-section__desc audio-settings-latency__desc",this._textElements.latencyDesc.textContent=u("audio.latency.description")||"Ajusta el buffer de audio. Menor latencia = respuesta m\xE1s r\xE1pida pero mayor riesgo de clicks.",e.appendChild(this._textElements.latencyDesc);let t=document.createElement("div");t.className="audio-settings-latency__row",this._textElements.webAudioLatencyLabel=document.createElement("label"),this._textElements.webAudioLatencyLabel.className="audio-settings-latency__label",this._textElements.webAudioLatencyLabel.textContent=u("audio.latency.webAudio")||"Buffer Web Audio:",t.appendChild(this._textElements.webAudioLatencyLabel),this.webAudioLatencySelect=document.createElement("select"),this.webAudioLatencySelect.className="audio-settings-latency__select",[{value:"interactive",label:u("audio.latency.interactive")||"~10ms (Interactivo)",ms:10},{value:"balanced",label:u("audio.latency.balanced")||"~25ms (Equilibrado)",ms:25},{value:"playback",label:u("audio.latency.playback")||"~50ms (Reproducci\xF3n)",ms:50},{value:"0.1",label:u("audio.latency.safe")||"~100ms (Seguro)",ms:100},{value:"0.2",label:u("audio.latency.maximum")||"~200ms (M\xE1ximo)",ms:200}].forEach(r=>{let l=document.createElement("option");l.value=r.value,l.textContent=r.label,l.dataset.ms=r.ms,this.webAudioLatencySelect.appendChild(l)});let i=localStorage.getItem(v.LATENCY_MODE)||"balanced";this.webAudioLatencySelect.value=i,this._webAudioLatencyMs=this._getWebAudioLatencyMs(i),this.webAudioLatencySelect.addEventListener("change",()=>{let r=this.webAudioLatencySelect.value;localStorage.setItem(v.LATENCY_MODE,r),this._webAudioLatencyMs=this._getWebAudioLatencyMs(r),this._updateTotalLatency(),this._showWebAudioLatencyMessage()}),t.appendChild(this.webAudioLatencySelect),e.appendChild(t),this.webAudioLatencyMessage=document.createElement("div"),this.webAudioLatencyMessage.className="audio-settings-latency__message",this.webAudioLatencyMessage.style.display="none",e.appendChild(this.webAudioLatencyMessage),this.multichannelLatencyRow=document.createElement("div"),this.multichannelLatencyRow.className="audio-settings-latency__row audio-settings-latency__row--multichannel",this.multichannelLatencyRow.style.display="none",this._textElements.multichannelLatencyLabel=document.createElement("label"),this._textElements.multichannelLatencyLabel.className="audio-settings-latency__label",this._textElements.multichannelLatencyLabel.textContent=u("audio.latency.multichannel")||"Buffer Multicanal:",this.multichannelLatencyRow.appendChild(this._textElements.multichannelLatencyLabel),this.multichannelLatencySelect=document.createElement("select"),this.multichannelLatencySelect.className="audio-settings-latency__select",[{value:10,label:"~10ms ("+(u("audio.latency.veryLow")||"muy baja")+")"},{value:21,label:"~21ms ("+(u("audio.latency.low")||"baja")+")"},{value:42,label:"~42ms ("+(u("audio.latency.normal")||"normal")+") \u2713"},{value:85,label:"~85ms ("+(u("audio.latency.high")||"alta")+")"},{value:170,label:"~170ms ("+(u("audio.latency.veryHigh")||"muy alta")+")"}].forEach(r=>{let l=document.createElement("option");l.value=r.value,l.textContent=r.label,this.multichannelLatencySelect.appendChild(l)});let a=localStorage.getItem(v.AUDIO_LATENCY)||"42";return this.multichannelLatencySelect.value=a,this._multichannelLatencyMs=parseInt(a,10),this.multichannelLatencySelect.addEventListener("change",()=>{let r=parseInt(this.multichannelLatencySelect.value,10);this._multichannelLatencyMs=r,localStorage.setItem(v.AUDIO_LATENCY,r.toString()),this._updateTotalLatency(),window.multichannelAPI?.setLatency&&window.multichannelAPI.setLatency(r),this._showMultichannelLatencyMessage()}),this.multichannelLatencyRow.appendChild(this.multichannelLatencySelect),e.appendChild(this.multichannelLatencyRow),this.multichannelLatencyMessage=document.createElement("div"),this.multichannelLatencyMessage.className="audio-settings-latency__message audio-settings-latency__message--multichannel",this.multichannelLatencyMessage.style.display="none",e.appendChild(this.multichannelLatencyMessage),this.totalLatencyRow=document.createElement("div"),this.totalLatencyRow.className="audio-settings-latency__total",this._textElements.totalLatencyLabel=document.createElement("span"),this._textElements.totalLatencyLabel.className="audio-settings-latency__total-label",this._textElements.totalLatencyLabel.textContent=u("audio.latency.total")||"Latencia total estimada:",this.totalLatencyRow.appendChild(this._textElements.totalLatencyLabel),this.totalLatencyValue=document.createElement("span"),this.totalLatencyValue.className="audio-settings-latency__total-value",this.totalLatencyRow.appendChild(this.totalLatencyValue),e.appendChild(this.totalLatencyRow),setTimeout(()=>{this._updateLatencyVisibility()},0),e}_getWebAudioLatencyMs(e){return{interactive:10,balanced:25,playback:50,"0.1":100,"0.2":200}[e]||25}_updateTotalLatency(){if(!this.totalLatencyValue)return;let e=this.outputMode==="multichannel",t=this._webAudioLatencyMs||25,n=e?this._multichannelLatencyMs||42:0,i=t+n,s=`~${i}ms`;e&&(s+=` (${t} + ${n})`),this.totalLatencyValue.textContent=s,this.totalLatencyValue.classList.remove("latency-low","latency-medium","latency-high"),i<=35?this.totalLatencyValue.classList.add("latency-low"):i<=75?this.totalLatencyValue.classList.add("latency-medium"):this.totalLatencyValue.classList.add("latency-high")}_updateLatencyVisibility(){if(!this.multichannelLatencyRow)return;let e=this.outputMode==="multichannel";this.multichannelLatencyRow.style.display=e?"flex":"none",this._textElements.modeDesc&&(this._textElements.modeDesc.style.display=e?"block":"none"),this._updateTotalLatency()}_updateInputSectionVisibility(){if(!this.inputStereoContent||!this.inputMultichannelContent)return;let e=this.outputMode==="multichannel";this.inputStereoContent.style.display=e?"none":"block",this.inputMultichannelContent.style.display=e?"block":"none",e&&this._buildInputMultichannelMatrix(),this._textElements.inputTitle&&(this._textElements.inputTitle.textContent=e?u("audio.inputs.multichannel.title"):u("audio.inputs.title"))}_showWebAudioLatencyMessage(){this.webAudioLatencyMessage&&(this.webAudioLatencyMessage.textContent=u("audio.latency.restartRequired")||"\u26A0\uFE0F Reinicia la aplicaci\xF3n para aplicar el cambio",this.webAudioLatencyMessage.style.display="block",setTimeout(()=>{this.webAudioLatencyMessage&&(this.webAudioLatencyMessage.style.display="none")},5e3))}_showMultichannelLatencyMessage(){this.multichannelLatencyMessage&&(this.multichannelLatencyMessage.textContent=u("audio.latency.reconnectRequired")||"\u26A0\uFE0F Desactiva y reactiva el dispositivo para aplicar",this.multichannelLatencyMessage.style.display="block",setTimeout(()=>{this.multichannelLatencyMessage&&(this.multichannelLatencyMessage.style.display="none")},5e3))}getConfiguredLatencyMs(){return this._multichannelLatencyMs||42}_buildMatrix(){if(!this.outputRouting){le.info(" _buildMatrix: skipping, outputRouting not initialized yet");return}let e=document.createElement("div");e.className="routing-matrix";let t=document.createElement("div");t.className="routing-matrix__header";let n=document.createElement("div");n.className="routing-matrix__corner",t.appendChild(n),this.channelLabels.forEach((i,s)=>{let a=document.createElement("div");a.className="routing-matrix__header-cell",a.textContent=i,a.title=`Canal ${s+1}: ${i}`,t.appendChild(a)}),e.appendChild(t),this.outputToggleButtons=[];for(let i=0;i<this.stereoBusCount;i++){let s=document.createElement("div");s.className="routing-matrix__row routing-matrix__row--stereo";let a=document.createElement("div");a.className="routing-matrix__row-label",a.textContent=this.stereoBusLabels[i],s.appendChild(a);let r=[];for(let l=0;l<this.physicalChannels;l++){let c=this._createStereoBusToggleButton(i,l);s.appendChild(c),r.push(c)}this.outputToggleButtons.push(r),e.appendChild(s)}for(let i=0;i<this.outputCount;i++){let s=document.createElement("div");s.className="routing-matrix__row";let a=document.createElement("div");a.className="routing-matrix__row-label",a.textContent=`Out ${i+1}`,s.appendChild(a);let r=[];for(let l=0;l<this.physicalChannels;l++){let c=this._createToggleButton(i,l);s.appendChild(c),r.push(c)}this.outputToggleButtons.push(r),e.appendChild(s)}this.matrixContainer.innerHTML="",this.matrixContainer.appendChild(e)}_createStereoBusToggleButton(e,t){let n=document.createElement("button");n.type="button",n.className="routing-matrix__toggle routing-matrix__toggle--stereo",this.stereoBusRouting[e]||(this.stereoBusRouting[e]=Array(this.physicalChannels).fill(!1));let i=this.stereoBusRouting[e][t]===!0;return n.setAttribute("aria-pressed",String(i)),n.dataset.stereoBus=e,n.dataset.channel=t,n.title=`${this.stereoBusLabels[e]} \u2192 ${this.channelLabels[t]||`Ch${t+1}`}`,i&&n.classList.add("routing-matrix__toggle--active"),n.addEventListener("click",()=>this._toggleStereoBusRouting(e,t,n)),n}_toggleStereoBusRouting(e,t,n){this.stereoBusRouting[e]||(this.stereoBusRouting[e]=Array(this.physicalChannels).fill(!1)),this.stereoBusRouting[e][t]=!this.stereoBusRouting[e][t];let i=this.stereoBusRouting[e][t];if(n.classList.toggle("routing-matrix__toggle--active",i),n.setAttribute("aria-pressed",String(i)),this._saveStereoBusRouting(),this.onStereoBusRoutingChange){let s=this.stereoBusRouting[e].map(a=>a?1:0);this.onStereoBusRoutingChange(e,s)}}_rebuildMatrix(){this._buildMatrix()}_createToggleButton(e,t){let n=document.createElement("button");n.type="button",n.className="routing-matrix__toggle",this.outputRouting[e]||(this.outputRouting[e]=Array(this.physicalChannels).fill(!1));let i=this.outputRouting[e][t]===!0;return n.setAttribute("aria-pressed",String(i)),n.dataset.bus=e,n.dataset.channel=t,n.title=`Out ${e+1} \u2192 ${this.channelLabels[t]||`Ch${t+1}`}`,i&&n.classList.add("routing-matrix__toggle--active"),n.addEventListener("click",()=>this._toggleRouting(e,t,n)),n}_toggleRouting(e,t,n){this.outputRouting[e]||(this.outputRouting[e]=Array(this.physicalChannels).fill(!1)),this.outputRouting[e][t]=!this.outputRouting[e][t];let i=this.outputRouting[e][t];if(n.classList.toggle("routing-matrix__toggle--active",i),n.setAttribute("aria-pressed",String(i)),this._saveRouting(),this.onRoutingChange){let s=this.outputRouting[e].map(a=>a?1:0);this.onRoutingChange(e,s)}}_createInputSection(){let e=document.createElement("div");e.className="audio-settings-section",this.inputSection=e,this._textElements.inputTitle=document.createElement("h3"),this._textElements.inputTitle.className="audio-settings-section__title",this._textElements.inputTitle.textContent=u("audio.inputs.title"),e.appendChild(this._textElements.inputTitle),this.inputStereoContent=document.createElement("div"),this.inputStereoContent.className="audio-settings-input-stereo";let{wrapper:t,select:n,label:i}=this._createDeviceSelector(u("audio.device.input"),!1);this.inputDeviceSelect=n,this._textElements.inputDeviceLabel=i,this.inputStereoContent.appendChild(t),this._textElements.inputPermissionBtn=document.createElement("button"),this._textElements.inputPermissionBtn.className="audio-settings-permission-btn",this._textElements.inputPermissionBtn.textContent=u("audio.inputs.enable"),this._textElements.inputPermissionBtn.style.display="none",this._textElements.inputPermissionBtn.addEventListener("click",async()=>{await this._enumerateDevices(!0)}),this.inputPermissionBtn=this._textElements.inputPermissionBtn,this.inputStereoContent.appendChild(this._textElements.inputPermissionBtn);let s=document.createElement("div");s.className="audio-settings-channel-info",this.inputChannelInfoElement=document.createElement("span"),this.inputChannelInfoElement.className="audio-settings-channel-info__value",this._updateInputChannelInfo(),this._textElements.inputChannelLabel=document.createElement("span"),this._textElements.inputChannelLabel.className="audio-settings-channel-info__label",this._textElements.inputChannelLabel.textContent=u("audio.inputs.channels")+" ",s.appendChild(this._textElements.inputChannelLabel),s.appendChild(this.inputChannelInfoElement),this.inputStereoContent.appendChild(s),this._textElements.inputDesc=document.createElement("p"),this._textElements.inputDesc.className="audio-settings-section__desc",this._textElements.inputDesc.textContent=u("audio.inputs.description"),this.inputStereoContent.appendChild(this._textElements.inputDesc),this.inputMatrixContainer=document.createElement("div"),this.inputMatrixContainer.className="routing-matrix-container",this._buildInputMatrix(),this.inputStereoContent.appendChild(this.inputMatrixContainer);let a=document.createElement("div");a.className="audio-settings-reset",this._textElements.inputResetBtn=document.createElement("button"),this._textElements.inputResetBtn.type="button",this._textElements.inputResetBtn.className="audio-settings-reset__btn",this._textElements.inputResetBtn.textContent=u("audio.inputs.reset"),this._textElements.inputResetBtn.addEventListener("click",()=>this.resetInputRoutingToDefaults()),a.appendChild(this._textElements.inputResetBtn),this.inputStereoContent.appendChild(a),e.appendChild(this.inputStereoContent),this.inputMultichannelContent=document.createElement("div"),this.inputMultichannelContent.className="audio-settings-input-multichannel",this.inputMultichannelContent.style.display="none",this._textElements.inputMultichannelDesc=document.createElement("p"),this._textElements.inputMultichannelDesc.className="audio-settings-section__desc",this._textElements.inputMultichannelDesc.textContent=u("audio.inputs.multichannel.description"),this.inputMultichannelContent.appendChild(this._textElements.inputMultichannelDesc),this.inputMultichannelMatrixContainer=document.createElement("div"),this.inputMultichannelMatrixContainer.className="routing-matrix-container",this._buildInputMultichannelMatrix(),this.inputMultichannelContent.appendChild(this.inputMultichannelMatrixContainer);let r=document.createElement("div");return r.className="audio-settings-reset",this._textElements.inputMcResetBtn=document.createElement("button"),this._textElements.inputMcResetBtn.type="button",this._textElements.inputMcResetBtn.className="audio-settings-reset__btn",this._textElements.inputMcResetBtn.textContent=u("audio.inputs.reset"),this._textElements.inputMcResetBtn.addEventListener("click",()=>this.resetInputMultichannelRoutingToDefaults()),r.appendChild(this._textElements.inputMcResetBtn),this.inputMultichannelContent.appendChild(r),e.appendChild(this.inputMultichannelContent),this._updateInputSectionVisibility(),e}_buildInputMatrix(){let e=document.createElement("div");e.className="routing-matrix";let t=document.createElement("div");t.className="routing-matrix__header";let n=document.createElement("div");n.className="routing-matrix__corner",t.appendChild(n);for(let i=0;i<this.inputCount;i++){let s=document.createElement("div");s.className="routing-matrix__header-cell",s.textContent=`Ch${i+1}`,s.title=`Input Amplifier ${i+1}`,t.appendChild(s)}e.appendChild(t),this.inputToggleButtons=[];for(let i=0;i<this.physicalInputChannels;i++){let s=document.createElement("div");s.className="routing-matrix__row";let a=document.createElement("div");a.className="routing-matrix__row-label",a.textContent=this.inputChannelLabels[i]||`In ${i+1}`,s.appendChild(a);let r=[];for(let l=0;l<this.inputCount;l++){let c=this._createInputToggleButton(i,l);s.appendChild(c),r.push(c)}this.inputToggleButtons.push(r),e.appendChild(s)}this.inputMatrixContainer.innerHTML="",this.inputMatrixContainer.appendChild(e)}_createInputToggleButton(e,t){let n=document.createElement("button");n.type="button",n.className="routing-matrix__toggle",this.inputRouting[e]||(this.inputRouting[e]=Array(this.inputCount).fill(!1));let i=this.inputRouting[e][t]===!0;return n.setAttribute("aria-pressed",String(i)),n.dataset.sysInput=e,n.dataset.synthChannel=t,n.title=`${this.inputChannelLabels[e]||`In ${e+1}`} \u2192 Ch${t+1}`,i&&n.classList.add("routing-matrix__toggle--active"),n.addEventListener("click",()=>this._toggleInputRouting(e,t,n)),n}_toggleInputRouting(e,t,n){this.inputRouting[e]||(this.inputRouting[e]=Array(this.inputCount).fill(!1)),this.inputRouting[e][t]=!this.inputRouting[e][t];let i=this.inputRouting[e][t];if(n.classList.toggle("routing-matrix__toggle--active",i),n.setAttribute("aria-pressed",String(i)),this._saveInputRouting(),this.onInputRoutingChange){let s=this.inputRouting[e].map(a=>a?1:0);this.onInputRoutingChange(e,s)}}getInputRouting(){return this.inputRouting}setInputRouting(e){this.inputRouting=e,this._saveInputRouting(),this.inputMatrixContainer&&this._buildInputMatrix()}applyInputRoutingToEngine(){if(this.onInputRoutingChange)for(let e=0;e<this.physicalInputChannels;e++){if(!this.inputRouting[e])continue;let t=this.inputRouting[e].map(n=>n?1:0);this.onInputRoutingChange(e,t)}}_buildInputMultichannelMatrix(){if(!this.inputMultichannelMatrixContainer){le.warn("Input multichannel matrix container not found");return}let e=document.createElement("div");e.className="routing-matrix";let t=document.createElement("div");t.className="routing-matrix__header";let n=document.createElement("div");n.className="routing-matrix__corner",t.appendChild(n);for(let i=0;i<this.inputCount;i++){let s=document.createElement("div");s.className="routing-matrix__header-cell",s.textContent=`Ch${i+1}`,s.title=`Input Amplifier ${i+1}`,t.appendChild(s)}e.appendChild(t),this.inputMultichannelToggleButtons=[];for(let i=0;i<8;i++){let s=document.createElement("div");s.className="routing-matrix__row";let a=document.createElement("div");a.className="routing-matrix__row-label",a.textContent=this.inputMultichannelLabels[i],s.appendChild(a);let r=[];for(let l=0;l<this.inputCount;l++){let c=this._createInputMultichannelToggleButton(i,l);s.appendChild(c),r.push(c)}this.inputMultichannelToggleButtons.push(r),e.appendChild(s)}this.inputMultichannelMatrixContainer.innerHTML="",this.inputMultichannelMatrixContainer.appendChild(e)}_createInputMultichannelToggleButton(e,t){let n=document.createElement("button");n.type="button",n.className="routing-matrix__toggle",this.inputMultichannelRouting[e]||(this.inputMultichannelRouting[e]=Array(this.inputCount).fill(!1));let i=this.inputMultichannelRouting[e][t]===!0;return n.setAttribute("aria-pressed",String(i)),n.dataset.pwPort=e,n.dataset.synthChannel=t,n.title=`${this.inputMultichannelLabels[e]} \u2192 Ch${t+1}`,i&&n.classList.add("routing-matrix__toggle--active"),n.addEventListener("click",()=>this._toggleInputMultichannelRouting(e,t,n)),n}_toggleInputMultichannelRouting(e,t,n){this.inputMultichannelRouting[e]||(this.inputMultichannelRouting[e]=Array(this.inputCount).fill(!1)),this.inputMultichannelRouting[e][t]=!this.inputMultichannelRouting[e][t];let i=this.inputMultichannelRouting[e][t];if(n.classList.toggle("routing-matrix__toggle--active",i),n.setAttribute("aria-pressed",String(i)),this._saveInputMultichannelRouting(),this.onInputMultichannelRoutingChange){let s=this.inputMultichannelRouting[e].map(a=>a?1:0);this.onInputMultichannelRoutingChange(e,s)}}getInputMultichannelRouting(){return this.inputMultichannelRouting}applyInputMultichannelRoutingToEngine(){if(this.onInputMultichannelRoutingChange)for(let e=0;e<8;e++){if(!this.inputMultichannelRouting[e])continue;let t=this.inputMultichannelRouting[e].map(n=>n?1:0);this.onInputMultichannelRoutingChange(e,t)}}open(){this.isOpen||(this.isOpen=!0,this.overlay.classList.add("audio-settings-overlay--visible"),this.overlay.setAttribute("aria-hidden","false"),this._enumerateDevices(),this._updateLatencyVisibility(),requestAnimationFrame(()=>{let e=this.modal.querySelector(".audio-settings-modal__close");e&&e.focus()}))}close(){this.isOpen&&(this.isOpen=!1,this.overlay.classList.remove("audio-settings-overlay--visible"),this.overlay.setAttribute("aria-hidden","true"))}toggle(){this.isOpen?this.close():this.open()}getRouting(){return this.outputRouting.map(e=>[...e])}getRoutingLegacy(){return this.outputRouting.map(e=>({left:e[0]===!0,right:e[1]===!0}))}setRouting(e){Array.isArray(e)&&e.forEach((t,n)=>{if(n>=this.outputCount)return;Array.isArray(t)?this.outputRouting[n]=Array.from({length:this.physicalChannels},(s,a)=>t[a]===!0):t&&typeof t.left=="boolean"&&(this.outputRouting[n]=Array.from({length:this.physicalChannels},(s,a)=>a===0?t.left:a===1?t.right:!1));let i=this.outputToggleButtons[n];i&&Array.isArray(i)&&i.forEach((s,a)=>{if(s&&this.outputRouting[n]){let r=this.outputRouting[n][a]===!0;s.classList.toggle("routing-matrix__toggle--active",r),s.setAttribute("aria-pressed",String(r))}})})}resetRoutingToDefaults(){if(this.stereoBusRouting=this._getDefaultStereoBusRouting(),this._saveStereoBusRouting(),this.outputRouting=this._getDefaultRouting(),this._saveRouting(),this.matrixContainer&&this._rebuildMatrix(),this.onStereoBusRoutingChange)for(let e=0;e<this.stereoBusCount;e++){let t=this.stereoBusRouting[e].map(n=>n?1:0);this.onStereoBusRoutingChange(e,t)}le.info(" Routing reset to defaults for mode:",this.outputMode)}resetInputRoutingToDefaults(){if(this.inputRouting=this._getDefaultInputRouting(),this._saveInputRouting(),this.inputMatrixContainer&&this._buildInputMatrix(),this.onInputRoutingChange)for(let e=0;e<this.inputRouting.length;e++){let t=this.inputRouting[e].map(n=>n?1:0);this.onInputRoutingChange(e,t)}le.info(" Input routing reset to defaults")}resetInputMultichannelRoutingToDefaults(){if(this.inputMultichannelRouting=this._getDefaultInputMultichannelRouting(),this._saveInputMultichannelRouting(),this.inputMultichannelMatrixContainer&&this._buildInputMultichannelMatrix(),this.onInputMultichannelRoutingChange)for(let e=0;e<this.inputMultichannelRouting.length;e++){let t=this.inputMultichannelRouting[e].map(n=>n?1:0);this.onInputMultichannelRoutingChange(e,t)}le.info(" Input multichannel routing reset to defaults")}applyRoutingToEngine(e){if(typeof e!="function")return{warnings:[]};if(!this.outputRouting)return le.info(" applyRoutingToEngine: skipping, outputRouting not initialized yet"),{warnings:[]};let t=[];for(let n=0;n<this.outputCount;n++){let i=(this.outputRouting[n]||[]).map(a=>a?1:0),s=e(n,i);s&&s.ignored&&s.ignored.length>0&&t.push(`Out ${n+1}: canales ${s.ignored.map(a=>this.channelLabels[a]||`Ch${a+1}`).join(", ")} ignorados`)}return t.length>0&&le.warn(" Routing warnings:",t),{warnings:t}}showRoutingWarnings(e){!e||e.length===0||le.warn(" Advertencias de ruteo:",e.join("; "))}};Oe();Te();var To=class{constructor(e={}){let{recordingEngine:t,outputCount:n=8}=e;this.recordingEngine=t,this.outputCount=n,this.stereoSourceLabels=["Pan1-4L","Pan1-4R","Pan5-8L","Pan5-8R"],this.stereoSourceCount=this.stereoSourceLabels.length,this.totalSources=this.stereoSourceCount+this.outputCount,this.overlay=null,this.modal=null,this.isOpen=!1,this.toggleButtons=[],this.matrixContainer=null,this.embeddedMatrixContainer=null,this._textElements={},this._create(),this._unsubscribeLocale=Pe(()=>this._updateTexts())}createEmbeddableContent(){let e=document.createElement("div");e.className="recording-settings-content";let t=this._createFormatSection();e.appendChild(t);let n=this._createBitrateSection();e.appendChild(n),this._embeddedBitrateSection=n;let i=this._createTrackCountSection();e.appendChild(i),this._embeddedTrackSection=i;let s=document.createElement("div");s.className="recording-settings-section";let a=document.createElement("h3");a.className="recording-settings-section__title",a.textContent=u("recording.routing.title");let r=document.createElement("p");r.className="recording-settings-section__description",r.textContent=u("recording.routing.description");let l=document.createElement("div");return l.className="recording-settings-matrix-container",this.embeddedMatrixContainer=l,s.appendChild(a),s.appendChild(r),s.appendChild(l),e.appendChild(s),this._embeddedMatrixSection=s,this._buildMatrixInContainer(l),this._updateFormatDependentUI(),e}_buildMatrixInContainer(e){e.innerHTML="";let t=this.recordingEngine.trackCount,n=document.createElement("div");n.className="recording-routing-matrix",n.style.setProperty("--track-count",t);let i=document.createElement("div");i.className="recording-routing-matrix__header";let s=document.createElement("div");s.className="recording-routing-matrix__corner",i.appendChild(s);for(let a=0;a<t;a++){let r=document.createElement("div");r.className="recording-routing-matrix__header-cell",r.textContent=`T${a+1}`,r.title=`${u("recording.track")} ${a+1}`,i.appendChild(r)}n.appendChild(i);for(let a=0;a<this.stereoSourceCount;a++){let r=document.createElement("div");r.className="recording-routing-matrix__row recording-routing-matrix__row--stereo";let l=document.createElement("div");l.className="recording-routing-matrix__row-label",l.textContent=this.stereoSourceLabels[a],r.appendChild(l);for(let c=0;c<t;c++){let d=this._createToggleButton(a,c);r.appendChild(d)}n.appendChild(r)}for(let a=0;a<this.outputCount;a++){let r=this.stereoSourceCount+a,l=document.createElement("div");l.className="recording-routing-matrix__row";let c=document.createElement("div");c.className="recording-routing-matrix__row-label",c.textContent=`Out ${a+1}`,l.appendChild(c);for(let d=0;d<t;d++){let h=this._createToggleButton(r,d);l.appendChild(h)}n.appendChild(l)}e.appendChild(n)}_create(){this.overlay=document.createElement("div"),this.overlay.className="recording-settings-overlay",this.overlay.setAttribute("role","dialog"),this.overlay.setAttribute("aria-modal","true"),this.overlay.setAttribute("aria-labelledby","recording-settings-title"),this.modal=document.createElement("div"),this.modal.className="recording-settings-modal";let e=document.createElement("div");e.className="recording-settings-modal__header";let t=document.createElement("h2");t.id="recording-settings-title",t.className="recording-settings-modal__title",t.textContent=u("recording.title"),this._textElements.title=t;let n=document.createElement("button");n.type="button",n.className="recording-settings-modal__close",n.setAttribute("aria-label",u("recording.close")),n.innerHTML="\xD7",n.addEventListener("click",()=>this.close()),this._textElements.closeBtn=n,e.appendChild(t),e.appendChild(n);let i=document.createElement("div");i.className="recording-settings-modal__body";let s=this._createTrackCountSection();i.appendChild(s);let a=document.createElement("div");a.className="recording-settings-section";let r=document.createElement("h3");r.className="recording-settings-section__title",r.textContent=u("recording.routing.title"),this._textElements.matrixTitle=r;let l=document.createElement("p");l.className="recording-settings-section__description",l.textContent=u("recording.routing.description"),this._textElements.matrixDesc=l,this.matrixContainer=document.createElement("div"),this.matrixContainer.className="recording-settings-matrix-container",a.appendChild(r),a.appendChild(l),a.appendChild(this.matrixContainer),i.appendChild(a),this._rebuildMatrix(),this.modal.appendChild(e),this.modal.appendChild(i),this.overlay.appendChild(this.modal),document.body.appendChild(this.overlay),this.overlay.addEventListener("click",c=>{c.target===this.overlay&&this.close()}),this.overlay.addEventListener("keydown",c=>{c.key==="Escape"&&this.close()})}_createFormatSection(){let e=document.createElement("div");e.className="recording-settings-section";let t=document.createElement("div");t.className="recording-settings-row";let n=document.createElement("label");n.className="recording-settings-row__label",n.textContent=u("recording.format.label"),n.htmlFor="recording-format",this._textElements.formatLabel=n;let i=document.createElement("div");i.className="recording-settings-select-wrapper",this.formatSelect=document.createElement("select"),this.formatSelect.className="recording-settings-select",this.formatSelect.id="recording-format";let s=ai.FORMATS;for(let[r,l]of Object.entries(s)){let c=document.createElement("option");c.value=r,c.textContent=r==="wav"?u("recording.format.wav"):u("recording.format.webmOpus"),r===this.recordingEngine.format&&(c.selected=!0),this.formatSelect.appendChild(c)}this.formatSelect.addEventListener("change",()=>{this.recordingEngine.format=this.formatSelect.value,this._updateFormatDependentUI(),this._updateTrackCountOptions(),this.trackCountSelect&&(this.trackCountSelect.value=String(this.recordingEngine.trackCount)),this.matrixContainer&&this._rebuildMatrix(),this.embeddedMatrixContainer&&this._buildMatrixInContainer(this.embeddedMatrixContainer)}),i.appendChild(this.formatSelect),t.appendChild(n),t.appendChild(i),e.appendChild(t);let a=document.createElement("p");return a.className="recording-settings-section__description recording-settings-format-desc",this._formatDescElement=a,this._updateFormatDescription(),e.appendChild(a),e}_createBitrateSection(){let e=document.createElement("div");e.className="recording-settings-section";let t=document.createElement("div");t.className="recording-settings-row";let n=document.createElement("label");n.className="recording-settings-row__label",n.textContent=u("recording.bitrate.label"),n.htmlFor="recording-bitrate",this._textElements.bitrateLabel=n;let i=document.createElement("div");i.className="recording-settings-select-wrapper",this.bitrateSelect=document.createElement("select"),this.bitrateSelect.className="recording-settings-select",this.bitrateSelect.id="recording-bitrate";let s=[{value:64e3,label:"64 kbps"},{value:128e3,label:"128 kbps"},{value:192e3,label:`192 kbps (${u("recording.bitrate.recommended")})`},{value:256e3,label:"256 kbps"},{value:32e4,label:"320 kbps"}];for(let{value:a,label:r}of s){let l=document.createElement("option");l.value=String(a),l.textContent=r,a===this.recordingEngine.bitrate&&(l.selected=!0),this.bitrateSelect.appendChild(l)}return this.bitrateSelect.addEventListener("change",()=>{this.recordingEngine.bitrate=parseInt(this.bitrateSelect.value,10)}),i.appendChild(this.bitrateSelect),t.appendChild(n),t.appendChild(i),e.appendChild(t),e}_updateFormatDescription(){if(!this._formatDescElement)return;this.recordingEngine.format==="wav"?this._formatDescElement.textContent=u("recording.format.wavDesc"):this._formatDescElement.textContent=u("recording.format.webmOpusDesc")}_updateFormatDependentUI(){let e=this.recordingEngine.formatInfo.lossy;this._embeddedBitrateSection&&(this._embeddedBitrateSection.style.display=e?"":"none"),this._modalBitrateSection&&(this._modalBitrateSection.style.display=e?"":"none"),this._embeddedTrackSection&&(this._embeddedTrackSection.style.display=e?"none":""),this._modalTrackSection&&(this._modalTrackSection.style.display=e?"none":""),this._updateFormatDescription()}_updateTrackCountOptions(){if(!this.trackCountSelect)return;let e=this.recordingEngine.formatInfo.maxTracks,t=this.recordingEngine.trackCount;Array.from(this.trackCountSelect.options).forEach(n=>{let i=parseInt(n.value,10);n.disabled=i>e}),t>e&&(this.trackCountSelect.value=String(e))}_createTrackCountSection(){let e=document.createElement("div");e.className="recording-settings-section";let t=document.createElement("div");t.className="recording-settings-row";let n=document.createElement("label");n.className="recording-settings-row__label",n.textContent=u("recording.tracks.label"),n.htmlFor="recording-track-count",this._textElements.trackLabel=n;let i=document.createElement("div");i.className="recording-settings-select-wrapper",this.trackCountSelect=document.createElement("select"),this.trackCountSelect.className="recording-settings-select",this.trackCountSelect.id="recording-track-count";for(let s=1;s<=12;s++){let a=document.createElement("option");a.value=String(s),a.textContent=s===1?u("recording.tracks.mono"):s===2?u("recording.tracks.stereo"):`${s} ${u("recording.tracks.tracks")}`,s===this.recordingEngine.trackCount&&(a.selected=!0),this.trackCountSelect.appendChild(a)}return this.trackCountSelect.addEventListener("change",()=>{let s=parseInt(this.trackCountSelect.value,10);this.recordingEngine.trackCount=s,this.matrixContainer&&this._rebuildMatrix(),this.embeddedMatrixContainer&&this._buildMatrixInContainer(this.embeddedMatrixContainer)}),i.appendChild(this.trackCountSelect),t.appendChild(n),t.appendChild(i),e.appendChild(t),e}_rebuildMatrix(){if(!this.matrixContainer)return;this.matrixContainer.innerHTML="",this.toggleButtons=[];let e=this.recordingEngine.trackCount,t=document.createElement("div");t.className="recording-routing-matrix",t.style.setProperty("--track-count",e);let n=document.createElement("div");n.className="recording-routing-matrix__header";let i=document.createElement("div");i.className="recording-routing-matrix__corner",n.appendChild(i);for(let s=0;s<e;s++){let a=document.createElement("div");a.className="recording-routing-matrix__header-cell",a.textContent=`T${s+1}`,a.title=`${u("recording.track")} ${s+1}`,n.appendChild(a)}t.appendChild(n);for(let s=0;s<this.outputCount;s++){let a=document.createElement("div");a.className="recording-routing-matrix__row";let r=document.createElement("div");r.className="recording-routing-matrix__row-label",r.textContent=`Out ${s+1}`,a.appendChild(r);for(let l=0;l<e;l++){let c=this._createToggleButton(s,l);a.appendChild(c)}t.appendChild(a)}for(let s=0;s<this.stereoSourceLabels.length;s++){let a=this.outputCount+s,r=document.createElement("div");r.className="recording-routing-matrix__row recording-routing-matrix__row--stereo";let l=document.createElement("div");l.className="recording-routing-matrix__row-label",l.textContent=this.stereoSourceLabels[s],r.appendChild(l);for(let c=0;c<e;c++){let d=this._createToggleButton(a,c);r.appendChild(d)}t.appendChild(r)}this.matrixContainer.appendChild(t)}_createToggleButton(e,t){let n=document.createElement("button");n.type="button",n.className="recording-routing-matrix__toggle";let i=this.recordingEngine.getRouting(e,t)===1;return n.setAttribute("aria-pressed",String(i)),n.dataset.bus=e,n.dataset.track=t,i&&n.classList.add("recording-routing-matrix__toggle--active"),n.addEventListener("click",()=>{let a=!n.classList.contains("recording-routing-matrix__toggle--active");this.recordingEngine.setRouting(e,t,a),n.classList.toggle("recording-routing-matrix__toggle--active",a),n.setAttribute("aria-pressed",String(a))}),this.toggleButtons.push({btn:n,busIndex:e,trackIndex:t}),n}_updateTexts(){let e=this._textElements;e.title&&(e.title.textContent=u("recording.title")),e.closeBtn&&e.closeBtn.setAttribute("aria-label",u("recording.close")),e.formatLabel&&(e.formatLabel.textContent=u("recording.format.label")),e.bitrateLabel&&(e.bitrateLabel.textContent=u("recording.bitrate.label")),e.trackLabel&&(e.trackLabel.textContent=u("recording.tracks.label")),e.matrixTitle&&(e.matrixTitle.textContent=u("recording.routing.title")),e.matrixDesc&&(e.matrixDesc.textContent=u("recording.routing.description")),this.formatSelect&&Array.from(this.formatSelect.options).forEach(t=>{t.value==="wav"?t.textContent=u("recording.format.wav"):t.value==="webm-opus"&&(t.textContent=u("recording.format.webmOpus"))}),this.bitrateSelect&&Array.from(this.bitrateSelect.options).forEach(t=>{let n=parseInt(t.value,10),i=n/1e3;t.textContent=n===192e3?`${i} kbps (${u("recording.bitrate.recommended")})`:`${i} kbps`}),this._updateFormatDescription(),this.trackCountSelect&&Array.from(this.trackCountSelect.options).forEach((t,n)=>{let i=n+1;t.textContent=i===1?u("recording.tracks.mono"):i===2?u("recording.tracks.stereo"):`${i} ${u("recording.tracks.tracks")}`})}open(){if(this.isOpen)return;this._rebuildMatrix(),this.overlay.classList.add("recording-settings-overlay--visible"),this.isOpen=!0;let e=this.modal.querySelector(".recording-settings-modal__close");e&&e.focus()}close(){this.isOpen&&(this.overlay.classList.remove("recording-settings-overlay--visible"),this.isOpen=!1)}toggle(){this.isOpen?this.close():this.open()}destroy(){this._unsubscribeLocale&&this._unsubscribeLocale(),this.overlay&&this.overlay.parentNode&&this.overlay.parentNode.removeChild(this.overlay)}};Oe();var Mo=class{constructor(){this._overlay=null,this._timerInterval=null,this._startTime=0,this._create(),this._bindEvents(),this._unsubscribeLocale=Pe(()=>this._updateTexts())}_create(){this._overlay=document.createElement("div"),this._overlay.className="recording-overlay",this._overlay.setAttribute("aria-live","polite"),this._overlay.setAttribute("aria-atomic","true");let e=document.createElement("div");e.className="recording-overlay__indicator";let t=document.createElement("span");t.className="recording-overlay__dot";let n=document.createElement("span");n.className="recording-overlay__label",n.textContent="REC";let i=document.createElement("span");i.className="recording-overlay__timer",i.textContent="00:00",this._timerElement=i,e.appendChild(t),e.appendChild(n),e.appendChild(i),this._overlay.appendChild(e),document.body.appendChild(this._overlay)}_bindEvents(){document.addEventListener("synth:recordingChanged",e=>{e.detail?.recording??!1?this.show():this.hide()})}show(){this._overlay.classList.add("recording-overlay--visible"),this._overlay.setAttribute("aria-label",u("recording.overlay.recording")),this._startTime=Date.now(),this._updateTimer(),this._timerInterval=setInterval(()=>this._updateTimer(),1e3)}hide(){this._overlay.classList.remove("recording-overlay--visible"),this._timerInterval&&(clearInterval(this._timerInterval),this._timerInterval=null),this._timerElement&&(this._timerElement.textContent="00:00")}_updateTimer(){if(!this._timerElement)return;let e=Math.floor((Date.now()-this._startTime)/1e3),t=String(Math.floor(e/60)).padStart(2,"0"),n=String(e%60).padStart(2,"0");this._timerElement.textContent=`${t}:${n}`}_updateTexts(){this._overlay.classList.contains("recording-overlay--visible")&&this._overlay.setAttribute("aria-label",u("recording.overlay.recording"))}destroy(){this._unsubscribeLocale&&this._unsubscribeLocale(),this._timerInterval&&clearInterval(this._timerInterval),this._overlay?.parentNode&&this._overlay.parentNode.removeChild(this._overlay)}};Oe();Te();be();var wi=W("WakeLock"),Qn=class o{constructor({storageKey:e,onStateChange:t}){this.storageKey=e,this.onStateChange=t,this.sentinel=null,this.enabled=this._loadPreference(),this.isActive=!1,this._setupVisibilityHandler(),this.enabled&&o.isSupported()&&this._acquire()}static isSupported(){return"wakeLock"in navigator}async enable(){return this.enabled=!0,this._savePreference(!0),o.isSupported()?this._acquire():(wi.warn("Wake Lock API not supported"),!1)}async disable(){return this.enabled=!1,this._savePreference(!1),this._release()}isEnabled(){return this.enabled}isLockActive(){return this.isActive}async _acquire(){if(!o.isSupported()||!this.enabled||document.visibilityState!=="visible")return!1;if(this.sentinel&&!this.sentinel.released)return!0;try{return this.sentinel=await navigator.wakeLock.request("screen"),this.isActive=!0,wi.info("Wake lock acquired"),this.sentinel.addEventListener("release",()=>{this.isActive=!1,wi.info("Wake lock released by system"),this.onStateChange?.(!1)}),this.onStateChange?.(!0),!0}catch(e){return this.isActive=!1,wi.warn("Failed to acquire wake lock:",e.message),!1}}async _release(){if(this.sentinel){try{await this.sentinel.release(),wi.info("Wake lock released")}catch(e){wi.warn("Error releasing wake lock:",e.message)}this.sentinel=null,this.isActive=!1,this.onStateChange?.(!1)}}_setupVisibilityHandler(){document.addEventListener("visibilitychange",async()=>{document.visibilityState==="visible"&&this.enabled&&await this._acquire()})}_loadPreference(){let e=localStorage.getItem(this.storageKey);return e===null?!0:e==="true"}_savePreference(e){localStorage.setItem(this.storageKey,String(e))}destroy(){this._release()}};Pn();var Po=class{constructor(e={}){let{onResolutionChange:t,onAutoSaveIntervalChange:n,onSaveOnExitChange:i,onRestoreOnStartChange:s,onWakeLockChange:a,audioSettingsModal:r,recordingSettingsModal:l}=e;this.onResolutionChange=t,this.onAutoSaveIntervalChange=n,this.onSaveOnExitChange=i,this.onRestoreOnStartChange=s,this.onWakeLockChange=a,this.audioSettingsModal=r,this.recordingSettingsModal=l,this.activeTab="general";let c=/Android|iPhone|iPad|iPod/i.test(navigator.userAgent);this.resolutionFactors=[1,1.5,2,2.5,3],this.isMobile=c,this.mobileWarningThreshold=2,this.currentResolution=1,this.rememberResolution=!1;let d=localStorage.getItem(v.AUTOSAVE_INTERVAL);this.autoSaveInterval=d&&Di.hasOwnProperty(d)?d:"off",this.saveOnExit=localStorage.getItem(v.SAVE_ON_EXIT)==="true",this.restoreOnStart=localStorage.getItem(v.RESTORE_ON_START)==="true";let h=localStorage.getItem(v.ASK_BEFORE_RESTORE);this.askBeforeRestore=h===null?!0:h==="true",this.optimizationsDebug=localStorage.getItem(v.OPTIMIZATIONS_DEBUG)==="true";let p=localStorage.getItem(v.DORMANCY_ENABLED);this.dormancyEnabled=p===null?!0:p==="true",this.dormancyDebug=localStorage.getItem(v.DORMANCY_DEBUG)==="true";let m=localStorage.getItem(v.FILTER_BYPASS_ENABLED);this.filterBypassEnabled=m===null?!0:m==="true",this.filterBypassDebug=localStorage.getItem(v.FILTER_BYPASS_DEBUG)==="true";let g=localStorage.getItem(v.LATENCY_MODE),_=Bi()?"playback":"interactive";this.latencyMode=g||_;let y=localStorage.getItem(v.DSP_ENABLED);this.dspEnabled=y===null?!0:y==="true";let f=localStorage.getItem(v.DSP_START_ENABLED);this.dspStartEnabled=f===null?!0:f==="true";let b=localStorage.getItem(v.VOLTAGE_SOFT_CLIP_ENABLED);this.voltageSoftClipEnabled=b===null?!0:b==="true";let E=localStorage.getItem(v.VOLTAGE_PIN_TOLERANCE_ENABLED);this.voltagePinToleranceEnabled=E===null?!0:E==="true";let w=localStorage.getItem(v.VOLTAGE_THERMAL_DRIFT_ENABLED);this.voltageThermalDriftEnabled=w===null?!0:w==="true",this.isFirefox=/Firefox\/\d+/.test(navigator.userAgent),this.knobStyle=localStorage.getItem(v.KNOB_STYLE)||"svg",this._applyKnobStyle(this.knobStyle),this.overlay=null,this.modal=null,this.isOpen=!1,this.languageSelect=null,this.resolutionSelect=null,this._create(),this._unsubscribeLocale=Pe(()=>this._updateTexts()),this._unsubscribeUpdate=Lo(S=>{S&&this.updateCheckBtn&&this._showUpdateAvailable()})}open(e){this.isOpen||(this.isOpen=!0,this._syncCheckboxesFromStorage(),e&&["general","interface","audio","advanced","osc","about"].includes(e)&&this._switchTab(e),this.overlay.classList.add("settings-overlay--visible"),this.overlay.setAttribute("aria-hidden","false"),requestAnimationFrame(()=>{let t=this.modal.querySelector(".settings-modal__close");t&&t.focus()}))}close(){this.isOpen&&(this.isOpen=!1,this.overlay.classList.remove("settings-overlay--visible"),this.overlay.setAttribute("aria-hidden","true"))}_syncCheckboxesFromStorage(){let e=(i,s)=>{let a=localStorage.getItem(i);return a===null?s:a==="true"};this.inactivePinsCheckbox&&(this.showInactivePins=e(v.SHOW_INACTIVE_PINS,!1),this.inactivePinsCheckbox.checked=this.showInactivePins),this.faderLinearCheckbox&&(this.faderLinearResponse=e(v.FADER_LINEAR_RESPONSE,!0),this.faderLinearCheckbox.checked=this.faderLinearResponse),this.tooltipVoltageCheckbox&&(this.showTooltipVoltage=e(v.TOOLTIP_SHOW_VOLTAGE,!0),this.tooltipVoltageCheckbox.checked=this.showTooltipVoltage),this.tooltipAudioCheckbox&&(this.showTooltipAudio=e(v.TOOLTIP_SHOW_AUDIO_VALUES,!0),this.tooltipAudioCheckbox.checked=this.showTooltipAudio),this.pipRememberCheckbox&&(this.rememberPips=e(v.REMEMBER_VISUAL_LAYOUT,!1),this.pipRememberCheckbox.checked=this.rememberPips),this.sharpRasterizeCheckbox&&(this.sharpRasterizeEnabled=e(v.SHARP_RASTERIZE_ENABLED,!1),this.sharpRasterizeCheckbox.checked=this.sharpRasterizeEnabled),this.singleFingerPanCheckbox&&(this.singleFingerPanEnabled=e(v.SINGLE_FINGER_PAN,!0),this.singleFingerPanCheckbox.checked=this.singleFingerPanEnabled),this.multitouchControlsCheckbox&&(this.multitouchControlsEnabled=e(v.MULTITOUCH_CONTROLS,!1),this.multitouchControlsCheckbox.checked=this.multitouchControlsEnabled);let t=localStorage.getItem(v.KNOB_STYLE)||"svg",n=this.modal?.querySelector(`#knobStyle-${t}`);n&&(n.checked=!0),this._applyKnobStyle(t),this.optimizationsDebugCheckbox&&(this.optimizationsDebug=e(v.OPTIMIZATIONS_DEBUG,!1),this.optimizationsDebugCheckbox.checked=this.optimizationsDebug),this.dormancyEnabledCheckbox&&(this.dormancyEnabled=e(v.DORMANCY_ENABLED,!0),this.dormancyEnabledCheckbox.checked=this.dormancyEnabled),this.dormancyDebugCheckbox&&(this.dormancyDebug=e(v.DORMANCY_DEBUG,!1),this.dormancyDebugCheckbox.checked=this.dormancyDebug),this.filterBypassEnabledCheckbox&&(this.filterBypassEnabled=e(v.FILTER_BYPASS_ENABLED,!0),this.filterBypassEnabledCheckbox.checked=this.filterBypassEnabled),this.filterBypassDebugCheckbox&&(this.filterBypassDebug=e(v.FILTER_BYPASS_DEBUG,!1),this.filterBypassDebugCheckbox.checked=this.filterBypassDebug),this.voltageSoftClipCheckbox&&(this.voltageSoftClipEnabled=e(v.VOLTAGE_SOFT_CLIP_ENABLED,!0),this.voltageSoftClipCheckbox.checked=this.voltageSoftClipEnabled),this.voltagePinToleranceCheckbox&&(this.voltagePinToleranceEnabled=e(v.VOLTAGE_PIN_TOLERANCE_ENABLED,!0),this.voltagePinToleranceCheckbox.checked=this.voltagePinToleranceEnabled),this.voltageThermalDriftCheckbox&&(this.voltageThermalDriftEnabled=e(v.VOLTAGE_THERMAL_DRIFT_ENABLED,!0),this.voltageThermalDriftCheckbox.checked=this.voltageThermalDriftEnabled),this.telemetryEnabledCheckbox&&(this.telemetryEnabledCheckbox.checked=e(v.TELEMETRY_ENABLED,!1)),this.dspEnabledCheckbox&&(this.dspEnabled=e(v.DSP_ENABLED,!0),this.dspEnabledCheckbox.checked=this.dspEnabled),this.dspStartEnabledCheckbox&&(this.dspStartEnabled=e(v.DSP_START_ENABLED,!0),this.dspStartEnabledCheckbox.checked=this.dspStartEnabled),this.confirmResetCheckbox&&(this.confirmResetCheckbox.checked=localStorage.getItem(v.CONFIRM_SYNTH_RESET)!=="false")}toggle(){this.isOpen?this.close():this.open()}getResolution(){return this.currentResolution}_create(){this.overlay=document.createElement("div"),this.overlay.className="settings-overlay",this.overlay.setAttribute("aria-hidden","true"),this.modal=document.createElement("div"),this.modal.className="settings-modal settings-modal--tabbed",this.modal.setAttribute("role","dialog"),this.modal.setAttribute("aria-labelledby","settingsTitle"),this.modal.setAttribute("aria-modal","true");let e=document.createElement("div");e.className="settings-modal__header",this.titleElement=document.createElement("h2"),this.titleElement.id="settingsTitle",this.titleElement.className="settings-modal__title",this.titleElement.textContent=u("settings.title");let t=document.createElement("button");t.type="button",t.className="settings-modal__close",t.setAttribute("aria-label",u("settings.close")),t.innerHTML="&times;",t.addEventListener("click",()=>this.close()),e.appendChild(this.titleElement),e.appendChild(t);let n=document.createElement("div");n.className="settings-modal__layout";let i=this._createTabs(),s=this._createTabDropdown(),a=document.createElement("div");a.className="settings-modal__content-area";let r=document.createElement("div");r.className="settings-modal__content-header",this.contentTitleElement=document.createElement("h3"),this.contentTitleElement.className="settings-modal__content-title",this.contentTitleElement.textContent=u("settings.tab.general"),r.appendChild(this.contentTitleElement);let l=document.createElement("div");l.className="settings-modal__body",this.tabContents={},this.tabContentCreated={general:!1,interface:!1,audio:!1,advanced:!1,about:!1},this.tabContents.general=this._createGeneralTabContent(),this.tabContentCreated.general=!0,l.appendChild(this.tabContents.general),this.bodyElement=l,this._switchTab("general"),a.appendChild(r),a.appendChild(l),n.appendChild(i),n.appendChild(s),n.appendChild(a),this.modal.appendChild(e),this.modal.appendChild(n),this.overlay.appendChild(this.modal),this.overlay.addEventListener("click",c=>{c.target===this.overlay&&this.close()}),document.addEventListener("keydown",c=>{c.key==="Escape"&&this.isOpen&&this.close()}),document.body.appendChild(this.overlay)}_getTabIcon(e){return{general:`<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <circle cx="12" cy="12" r="3"/>
        <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/>
      </svg>`,interface:`<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <rect x="2" y="3" width="20" height="14" rx="2" ry="2"/>
        <line x1="8" y1="21" x2="16" y2="21"/>
        <line x1="12" y1="17" x2="12" y2="21"/>
      </svg>`,audio:`<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"/>
        <path d="M19.07 4.93a10 10 0 0 1 0 14.14"/>
        <path d="M15.54 8.46a5 5 0 0 1 0 7.07"/>
      </svg>`,advanced:`<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <line x1="4" y1="21" x2="4" y2="14"/>
        <line x1="4" y1="10" x2="4" y2="3"/>
        <line x1="12" y1="21" x2="12" y2="12"/>
        <line x1="12" y1="8" x2="12" y2="3"/>
        <line x1="20" y1="21" x2="20" y2="16"/>
        <line x1="20" y1="12" x2="20" y2="3"/>
        <line x1="1" y1="14" x2="7" y2="14"/>
        <line x1="9" y1="8" x2="15" y2="8"/>
        <line x1="17" y1="16" x2="23" y2="16"/>
      </svg>`,osc:`<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M22 12h-4l-3 9L9 3l-3 9H2"/>
      </svg>`,about:`<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <circle cx="12" cy="12" r="10"/>
        <line x1="12" y1="16" x2="12" y2="12"/>
        <line x1="12" y1="8" x2="12.01" y2="8"/>
      </svg>`}[e]||""}_createTabs(){let e=document.createElement("div");e.className="settings-modal__tabs",e.setAttribute("role","tablist");let t=[{id:"general",label:u("settings.tab.general")},{id:"interface",label:u("settings.tab.interface")},{id:"audio",label:u("settings.tab.audio")},{id:"advanced",label:u("settings.tab.advanced")},{id:"osc",label:u("settings.tab.osc")},{id:"about",label:u("settings.tab.about")}];return this.tabButtons={},this.tabLabels={},t.forEach(n=>{let i=document.createElement("button");i.type="button",i.className="settings-modal__tab",i.dataset.tab=n.id,i.setAttribute("role","tab"),i.setAttribute("aria-selected","false");let s=document.createElement("span");s.className="settings-modal__tab-icon",s.innerHTML=this._getTabIcon(n.id);let a=document.createElement("span");a.className="settings-modal__tab-label",a.textContent=n.label,i.appendChild(s),i.appendChild(a),i.addEventListener("click",()=>this._switchTab(n.id)),this.tabButtons[n.id]=i,this.tabLabels[n.id]=n.label,e.appendChild(i)}),e}_createTabDropdown(){let e=document.createElement("div");e.className="settings-modal__tab-dropdown";let t=document.createElement("select");return t.className="settings-modal__tab-select",t.setAttribute("aria-label",u("settings.tab.select")),[{id:"general",label:u("settings.tab.general")},{id:"interface",label:u("settings.tab.interface")},{id:"audio",label:u("settings.tab.audio")},{id:"advanced",label:u("settings.tab.advanced")},{id:"osc",label:u("settings.tab.osc")},{id:"about",label:u("settings.tab.about")}].forEach(i=>{let s=document.createElement("option");s.value=i.id,s.textContent=i.label,t.appendChild(s)}),t.addEventListener("change",i=>{this._switchTab(i.target.value)}),this.tabSelectElement=t,e.appendChild(t),e}_switchTab(e){if(this.activeTab=e,!this.tabContentCreated[e]){let t;switch(e){case"interface":t=this._createInterfaceTabContent();break;case"audio":t=this._createAudioTabContent();break;case"advanced":t=this._createAdvancedTabContent();break;case"osc":t=this._createOSCTabContent();break;case"about":t=this._createAboutTabContent();break;default:return}this.tabContents[e]=t,this.tabContentCreated[e]=!0,this.bodyElement.appendChild(t)}Object.entries(this.tabButtons).forEach(([t,n])=>{let i=t===e;n.classList.toggle("settings-modal__tab--active",i),n.setAttribute("aria-selected",i?"true":"false")}),this.tabSelectElement&&this.tabSelectElement.value!==e&&(this.tabSelectElement.value=e),this.contentTitleElement&&this.tabLabels[e]&&(this.contentTitleElement.textContent=this.tabLabels[e]),this.tabContents&&Object.entries(this.tabContents).forEach(([t,n])=>{n.classList.toggle("settings-tab-content--active",t===e)}),e==="audio"&&this.audioSettingsModal&&this.audioSettingsModal.refreshDevices()}_createGeneralTabContent(){let e=document.createElement("div");return e.className="settings-tab-content",e.dataset.tab="general",e.appendChild(this._createLanguageSection()),e.appendChild(this._createAutoSaveSection()),e.appendChild(this._createConfirmResetSection()),e.appendChild(this._createWakeLockSection()),e.appendChild(this._createUpdatesSection()),e.appendChild(this._createTelemetrySection()),e}_createInterfaceTabContent(){let e=document.createElement("div");return e.className="settings-tab-content",e.dataset.tab="interface",e.appendChild(this._createInactivePinsSection()),e.appendChild(this._createPipSection()),e.appendChild(this._createParamInfoSection()),e.appendChild(this._createGlowSection()),e.appendChild(this._createSignalFlowSection()),e.appendChild(this._createFaderResponseSection()),e.appendChild(this._createKnobStyleSection()),e.appendChild(this._createSharpRasterizeSection()),e.appendChild(this._createTouchInteractionSection()),e.appendChild(this._createShortcutsSection()),e}_createAudioTabContent(){let e=document.createElement("div");if(e.className="settings-tab-content",e.dataset.tab="audio",e.appendChild(this._createDSPSection()),this.audioSettingsModal){let t=this.audioSettingsModal.createEmbeddableContent();e.appendChild(t)}else{let t=document.createElement("p");t.className="settings-section__description",t.textContent="Audio settings not available",e.appendChild(t)}if(this.recordingSettingsModal){let t=this.recordingSettingsModal.createEmbeddableContent();e.appendChild(t)}return e}_createDSPSection(){let e=document.createElement("section");e.className="settings-section",this.dspTitleElement=document.createElement("h3"),this.dspTitleElement.className="settings-section__title",this.dspTitleElement.textContent=u("settings.dsp"),e.appendChild(this.dspTitleElement),this.dspDescElement=document.createElement("p"),this.dspDescElement.className="settings-section__description",this.dspDescElement.textContent=u("settings.dsp.description"),e.appendChild(this.dspDescElement);let t=document.createElement("div");t.className="settings-row settings-row--checkbox",this.dspEnabledCheckbox=document.createElement("input"),this.dspEnabledCheckbox.type="checkbox",this.dspEnabledCheckbox.id="dspEnabledCheckbox",this.dspEnabledCheckbox.className="settings-checkbox",this.dspEnabledCheckbox.checked=this.dspEnabled,this.dspEnabledLabelElement=document.createElement("label"),this.dspEnabledLabelElement.className="settings-checkbox-label",this.dspEnabledLabelElement.htmlFor="dspEnabledCheckbox",this.dspEnabledLabelElement.textContent=u("settings.dsp.enabled"),this.dspEnabledCheckbox.addEventListener("change",()=>{this.dspEnabled=this.dspEnabledCheckbox.checked,document.dispatchEvent(new CustomEvent("synth:toggleDSP",{detail:{enabled:this.dspEnabled}}))}),t.appendChild(this.dspEnabledCheckbox),t.appendChild(this.dspEnabledLabelElement),e.appendChild(t);let n=document.createElement("div");return n.className="settings-row settings-row--checkbox",this.dspStartEnabledCheckbox=document.createElement("input"),this.dspStartEnabledCheckbox.type="checkbox",this.dspStartEnabledCheckbox.id="dspStartEnabledCheckbox",this.dspStartEnabledCheckbox.className="settings-checkbox",this.dspStartEnabledCheckbox.checked=this.dspStartEnabled,this.dspStartEnabledLabelElement=document.createElement("label"),this.dspStartEnabledLabelElement.className="settings-checkbox-label",this.dspStartEnabledLabelElement.htmlFor="dspStartEnabledCheckbox",this.dspStartEnabledLabelElement.textContent=u("settings.dsp.startEnabled"),this.dspStartEnabledCheckbox.addEventListener("change",()=>{this.dspStartEnabled=this.dspStartEnabledCheckbox.checked,localStorage.setItem(v.DSP_START_ENABLED,String(this.dspStartEnabled))}),n.appendChild(this.dspStartEnabledCheckbox),n.appendChild(this.dspStartEnabledLabelElement),e.appendChild(n),document.addEventListener("synth:dspChanged",i=>{this.dspEnabled=i.detail?.enabled??!0,this.dspEnabledCheckbox&&(this.dspEnabledCheckbox.checked=this.dspEnabled)}),e}_createAdvancedTabContent(){let e=document.createElement("div");return e.className="settings-tab-content",e.dataset.tab="advanced",e.appendChild(this._createOptimizationsSection()),e.appendChild(this._createVoltageEmulationSection()),e.appendChild(this._createResetSection()),e}_createOSCTabContent(){let e=document.createElement("div");return e.className="settings-tab-content",e.dataset.tab="osc",e.appendChild(this._createOSCDescriptionSection()),e.appendChild(this._createOSCEnableSection()),e.appendChild(this._createOSCSuperColliderSection()),e.appendChild(this._createOSCPortSection()),e.appendChild(this._createOSCModeSection()),e.appendChild(this._createOSCPrefixSection()),e.appendChild(this._createOSCTargetsSection()),e.appendChild(this._createOSCLogSection()),e}_createOSCDescriptionSection(){let e=document.createElement("section");e.className="settings-section";let t=document.createElement("h3");t.className="settings-section__title",t.textContent=u("settings.osc.title"),e.appendChild(t);let n=document.createElement("p");n.className="settings-section__description",n.textContent=u("settings.osc.description"),e.appendChild(n);let i=document.createElement("div");i.className="settings-row";let s=document.createElement("span");s.className="settings-row__label",s.textContent=u("settings.osc.status"),i.appendChild(s);let a=document.createElement("span");return a.className="settings-row__value osc-status",a.id="osc-status-indicator",this._updateOSCStatusIndicator(a),i.appendChild(a),e.appendChild(i),e}async _updateOSCStatusIndicator(e){if(!(typeof window.oscAPI<"u")){e.textContent=u("settings.osc.electronOnly"),e.classList.add("osc-status--disabled");return}try{(await window.oscAPI.getStatus()).running?(e.textContent=u("settings.osc.status.running"),e.classList.remove("osc-status--stopped","osc-status--error","osc-status--disabled"),e.classList.add("osc-status--running")):(e.textContent=u("settings.osc.status.stopped"),e.classList.remove("osc-status--running","osc-status--error","osc-status--disabled"),e.classList.add("osc-status--stopped"))}catch{e.textContent=u("settings.osc.status.error"),e.classList.remove("osc-status--running","osc-status--stopped","osc-status--disabled"),e.classList.add("osc-status--error")}}_createOSCEnableSection(){let e=document.createElement("section");e.className="settings-section";let t=typeof window.oscAPI<"u",n=document.createElement("div");n.className="settings-row";let i=document.createElement("label");i.className="settings-row__label",i.htmlFor="osc-enable-checkbox",i.textContent=u("settings.osc.enable"),n.appendChild(i);let s=document.createElement("input");if(s.type="checkbox",s.id="osc-enable-checkbox",s.className="settings-checkbox",s.disabled=!t,t&&window.oscAPI.getStatus&&window.oscAPI.getStatus().then(a=>{s.checked=a?.running??!1}),s.addEventListener("change",async()=>{document.dispatchEvent(new CustomEvent("osc:toggle"))}),document.addEventListener("osc:statusChanged",a=>{s.checked=a.detail?.enabled??!1;let r=document.getElementById("osc-status-indicator");r&&this._updateOSCStatusIndicator(r)}),n.appendChild(s),e.appendChild(n),!t){let a=document.createElement("p");a.className="settings-section__warning",a.textContent=u("settings.osc.electronOnly"),e.appendChild(a)}return e}_createOSCSuperColliderSection(){let e=document.createElement("section");e.className="settings-section";let t=document.createElement("h3");t.className="settings-section__title",t.textContent=u("settings.osc.supercollider"),e.appendChild(t);let n=typeof window.oscAPI<"u",i=localStorage.getItem(v.OSC_SUPERCOLLIDER_SEND)==="true",s=localStorage.getItem(v.OSC_SUPERCOLLIDER_RECEIVE)==="true",a=document.createElement("div");a.className="settings-row";let r=document.createElement("label");r.className="settings-row__label",r.htmlFor="osc-sc-send-checkbox",r.textContent=u("settings.osc.supercollider.send"),a.appendChild(r);let l=document.createElement("input");l.type="checkbox",l.id="osc-sc-send-checkbox",l.className="settings-checkbox",l.checked=i,l.disabled=!n,l.addEventListener("change",async()=>{let b=l.checked;localStorage.setItem(v.OSC_SUPERCOLLIDER_SEND,b),document.dispatchEvent(new CustomEvent("synth:settingChanged",{detail:{key:"oscSendToSC",value:b}}));let E="127.0.0.1",w=parseInt(localStorage.getItem(v.OSC_SUPERCOLLIDER_PORT)||"57120",10);b?await this._addOSCTarget(E,w):await this._removeOSCTarget(E,w);let S=document.getElementById("osc-targets-list");S&&this._loadOSCTargets(S)}),a.appendChild(l),e.appendChild(a);let c=document.createElement("div");c.className="settings-row",c.style.marginLeft="20px",c.style.marginTop="8px";let d=document.createElement("label");d.className="settings-row__label",d.htmlFor="osc-sc-port-input",d.textContent=u("settings.osc.supercollider.port","Puerto SC"),d.style.minWidth="80px",c.appendChild(d);let h=localStorage.getItem(v.OSC_SUPERCOLLIDER_PORT)||"57120",p=document.createElement("input");p.type="number",p.id="osc-sc-port-input",p.className="settings-input",p.value=h,p.min="1024",p.max="65535",p.style.width="80px",p.disabled=!n,p.addEventListener("change",async()=>{let b=parseInt(p.value,10);if(b>=1024&&b<=65535){let E=parseInt(localStorage.getItem(v.OSC_SUPERCOLLIDER_PORT)||"57120",10);if(localStorage.setItem(v.OSC_SUPERCOLLIDER_PORT,b.toString()),l.checked){await this._removeOSCTarget("127.0.0.1",E),await this._addOSCTarget("127.0.0.1",b);let w=document.getElementById("osc-targets-list");w&&this._loadOSCTargets(w)}}else p.value=h}),c.appendChild(p),e.appendChild(c);let m=document.createElement("p");m.className="settings-section__description",m.textContent=u("settings.osc.supercollider.send.description"),e.appendChild(m);let g=document.createElement("div");g.className="settings-row";let _=document.createElement("label");_.className="settings-row__label",_.htmlFor="osc-sc-receive-checkbox",_.textContent=u("settings.osc.supercollider.receive"),g.appendChild(_);let y=document.createElement("input");y.type="checkbox",y.id="osc-sc-receive-checkbox",y.className="settings-checkbox",y.checked=s,y.disabled=!n,y.addEventListener("change",()=>{localStorage.setItem(v.OSC_SUPERCOLLIDER_RECEIVE,y.checked),document.dispatchEvent(new CustomEvent("synth:settingChanged",{detail:{key:"oscReceiveFromSC",value:y.checked}}))}),g.appendChild(y),e.appendChild(g);let f=document.createElement("p");return f.className="settings-section__description",f.textContent=u("settings.osc.supercollider.receive.description"),e.appendChild(f),e}_createOSCPortSection(){let e=document.createElement("section");e.className="settings-section";let t=document.createElement("h3");t.className="settings-section__title",t.textContent=u("settings.osc.port","Puerto de escucha"),e.appendChild(t);let n=document.createElement("p");n.className="settings-section__description",n.textContent=u("settings.osc.port.description","Puerto UDP donde SynthiGME recibe mensajes OSC. Cambiar si otro programa (ej: SuperCollider) usa el puerto por defecto."),e.appendChild(n);let i=typeof window.oscAPI<"u",s=localStorage.getItem(v.OSC_PORT)||"57121",a=document.createElement("div");a.className="settings-row";let r=document.createElement("input");r.type="number",r.id="osc-port-input",r.className="settings-input",r.value=s,r.min="1024",r.max="65535",r.placeholder="57121",r.disabled=!i,r.style.width="100px",r.addEventListener("change",()=>{let c=parseInt(r.value,10);c>=1024&&c<=65535?localStorage.setItem(v.OSC_PORT,c.toString()):r.value=s});let l=document.createElement("span");return l.className="settings-label",l.textContent=u("settings.osc.port.note","(Requiere reiniciar OSC)"),l.style.marginLeft="10px",l.style.opacity="0.7",l.style.fontSize="0.9em",a.appendChild(r),a.appendChild(l),e.appendChild(a),e}_createOSCModeSection(){let e=document.createElement("section");e.className="settings-section";let t=document.createElement("h3");t.className="settings-section__title",t.textContent=u("settings.osc.mode"),e.appendChild(t);let n=typeof window.oscAPI<"u",i=localStorage.getItem(v.OSC_MODE)||"peer";return[{value:"peer",label:u("settings.osc.mode.peer")},{value:"master",label:u("settings.osc.mode.master")},{value:"slave",label:u("settings.osc.mode.slave")}].forEach(a=>{let r=document.createElement("div");r.className="settings-row";let l=document.createElement("input");l.type="radio",l.name="osc-mode",l.id=`osc-mode-${a.value}`,l.value=a.value,l.checked=i===a.value,l.disabled=!n,l.addEventListener("change",()=>{localStorage.setItem(v.OSC_MODE,a.value)});let c=document.createElement("label");c.htmlFor=l.id,c.textContent=a.label,r.appendChild(l),r.appendChild(c),e.appendChild(r)}),e}_createOSCPrefixSection(){let e=document.createElement("section");e.className="settings-section";let t=document.createElement("h3");t.className="settings-section__title",t.textContent=u("settings.osc.prefix"),e.appendChild(t);let n=document.createElement("p");n.className="settings-section__description",n.textContent=u("settings.osc.prefix.description"),e.appendChild(n);let i=typeof window.oscAPI<"u",s=localStorage.getItem(v.OSC_PREFIX)||"SynthiGME",a=document.createElement("div");a.className="settings-row";let r=document.createElement("input");return r.type="text",r.id="osc-prefix-input",r.className="settings-input",r.value=s,r.placeholder="SynthiGME",r.disabled=!i,r.addEventListener("change",()=>{let l=r.value.trim();l.startsWith("/")||(l="/"+l),l.endsWith("/")||(l=l+"/"),r.value=l,localStorage.setItem(v.OSC_PREFIX,l)}),a.appendChild(r),e.appendChild(a),e}_createOSCTargetsSection(){let e=document.createElement("section");e.className="settings-section";let t=document.createElement("h3");t.className="settings-section__title",t.textContent=u("settings.osc.targets"),e.appendChild(t);let n=document.createElement("p");n.className="settings-section__description",n.textContent=u("settings.osc.targets.description"),e.appendChild(n);let i=typeof window.oscAPI<"u",s=document.createElement("div");s.className="osc-targets-list",s.id="osc-targets-list",e.appendChild(s),this._loadOSCTargets(s);let a=document.createElement("div");a.className="osc-targets-add";let r=document.createElement("input");r.type="text",r.className="settings-input osc-targets-add__ip",r.placeholder=u("settings.osc.targets.ip"),r.disabled=!i;let l=document.createElement("input");l.type="number",l.className="settings-input osc-targets-add__port",l.placeholder=u("settings.osc.targets.port"),l.value="57120",l.min="1",l.max="65535",l.disabled=!i;let c=document.createElement("button");return c.type="button",c.className="settings-button",c.textContent=u("settings.osc.targets.add"),c.disabled=!i,c.addEventListener("click",async()=>{let d=r.value.trim(),h=parseInt(l.value,10);d&&h>0&&h<=65535&&(await this._addOSCTarget(d,h),r.value="",this._loadOSCTargets(s))}),a.appendChild(r),a.appendChild(l),a.appendChild(c),e.appendChild(a),e}async _loadOSCTargets(e){if(e.innerHTML="",typeof window.oscAPI<"u")try{(await window.oscAPI.getTargets()).forEach(i=>{let s=document.createElement("div");s.className="osc-target-row";let a=document.createElement("span");a.className="osc-target-row__address",a.textContent=`${i.ip}:${i.port}`,s.appendChild(a);let r=document.createElement("button");r.type="button",r.className="settings-button settings-button--danger",r.textContent=u("settings.osc.targets.remove"),r.addEventListener("click",async()=>{await this._removeOSCTarget(i.ip,i.port),this._loadOSCTargets(e)}),s.appendChild(r),e.appendChild(s)})}catch(n){console.error("Error loading OSC targets:",n)}}async _addOSCTarget(e,t){if(!(typeof window.oscAPI>"u"))try{await window.oscAPI.addTarget(e,t);let n=JSON.parse(localStorage.getItem(v.OSC_UNICAST_TARGETS)||"[]");n.some(i=>i.ip===e&&i.port===t)||(n.push({ip:e,port:t}),localStorage.setItem(v.OSC_UNICAST_TARGETS,JSON.stringify(n)))}catch(n){console.error("Error adding OSC target:",n)}}async _removeOSCTarget(e,t){if(!(typeof window.oscAPI>"u"))try{await window.oscAPI.removeTarget(e,t);let i=JSON.parse(localStorage.getItem(v.OSC_UNICAST_TARGETS)||"[]").filter(s=>!(s.ip===e&&s.port===t));localStorage.setItem(v.OSC_UNICAST_TARGETS,JSON.stringify(i))}catch(n){console.error("Error removing OSC target:",n)}}_createOSCLogSection(){let e=document.createElement("section");e.className="settings-section";let t=document.createElement("h3");t.className="settings-section__title",t.textContent=u("settings.osc.log"),e.appendChild(t);let n=typeof window.oscAPI<"u",i=localStorage.getItem(v.OSC_LOG_VISIBLE)==="true",s=document.createElement("div");s.className="settings-row";let a=document.createElement("label");a.className="settings-row__label",a.htmlFor="osc-log-checkbox",a.textContent=u("settings.osc.log.show"),s.appendChild(a);let r=document.createElement("input");return r.type="checkbox",r.id="osc-log-checkbox",r.className="settings-checkbox",r.checked=i,r.disabled=!n,r.addEventListener("change",()=>{localStorage.setItem(v.OSC_LOG_VISIBLE,r.checked),document.dispatchEvent(new CustomEvent("synth:settingChanged",{detail:{key:"oscLogVisible",value:r.checked}})),window.dispatchEvent(new CustomEvent("osc:log-visibility",{detail:{visible:r.checked}}))}),s.appendChild(r),e.appendChild(s),e}_createAboutTabContent(){let e=document.createElement("div");return e.className="settings-tab-content",e.dataset.tab="about",e.appendChild(this._createAboutDescriptionSection()),e.appendChild(this._createAboutInfoSection()),e.appendChild(this._createAboutLinksSection()),e.appendChild(this._createAboutCreditsSection()),e}_createAboutDescriptionSection(){let e=document.createElement("div");e.className="settings-section";let t=document.createElement("h3");t.className="settings-section__title",t.textContent="SynthiGME-web";let n=document.createElement("p");return n.className="settings-section__description settings-about__description",n.textContent=u("settings.about.description"),this.aboutDescElement=n,e.appendChild(t),e.appendChild(n),e}_createAboutInfoSection(){let e=document.createElement("div");e.className="settings-section";let t=document.createElement("h3");t.className="settings-section__title",t.textContent=u("settings.about.info"),this.aboutInfoTitleElement=t;let n=document.createElement("dl");n.className="settings-about__info-list";let i=document.createElement("dt");i.textContent=u("settings.about.version"),this.aboutVersionLabelElement=i;let s=document.createElement("dd");s.textContent=window.__synthBuildVersion||"0.0.1",n.appendChild(i),n.appendChild(s);let a=document.createElement("dt");a.textContent=u("settings.about.author"),this.aboutAuthorLabelElement=a;let r=document.createElement("dd");r.textContent="Carlos Arturo Guerra Parra",n.appendChild(a),n.appendChild(r);let l=document.createElement("dt");l.textContent=u("settings.about.license"),this.aboutLicenseLabelElement=l;let c=document.createElement("dd");return c.textContent="MIT License",n.appendChild(l),n.appendChild(c),e.appendChild(t),e.appendChild(n),e}_createAboutLinksSection(){let e=document.createElement("div");e.className="settings-section";let t=document.createElement("h3");t.className="settings-section__title",t.textContent=u("settings.about.links"),this.aboutLinksTitleElement=t;let n=document.createElement("ul");n.className="settings-about__links-list";let i=document.createElement("li"),s=document.createElement("a");s.href="https://github.com/mesjetiu/SynthiGME-web",s.target="_blank",s.rel="noopener noreferrer",s.textContent=u("settings.about.repository"),this.aboutRepoLinkElement=s,i.appendChild(s),n.appendChild(i);let a=document.createElement("li"),r=document.createElement("a");r.href="https://github.com/mesjetiu/SynthiGME-web/issues",r.target="_blank",r.rel="noopener noreferrer",r.textContent=u("settings.about.issues"),this.aboutIssuesLinkElement=r,a.appendChild(r),n.appendChild(a);let l=document.createElement("li"),c=document.createElement("a");c.href="https://t.me/synthigme",c.target="_blank",c.rel="noopener noreferrer",c.textContent=u("settings.about.telegram"),this.aboutTelegramLinkElement=c,l.appendChild(c),n.appendChild(l);let d=document.createElement("li"),h=document.createElement("a");h.href="https://fuzzygab.uclm.es/",h.target="_blank",h.rel="noopener noreferrer",h.textContent="Fuzzy Gab",d.appendChild(h),n.appendChild(d);let p=document.createElement("li"),m=document.createElement("a");return m.href="https://github.com/mesjetiu/SynthiGME",m.target="_blank",m.rel="noopener noreferrer",m.textContent=u("settings.about.originalProject"),this.aboutOriginalLinkElement=m,p.appendChild(m),n.appendChild(p),e.appendChild(t),e.appendChild(n),e}_createAboutCreditsSection(){let e=document.createElement("div");e.className="settings-section";let t=document.createElement("h3");t.className="settings-section__title",t.textContent=u("settings.about.credits"),this.aboutCreditsTitleElement=t;let n=document.createElement("ul");n.className="settings-about__credits-list";let i=document.createElement("li"),s=document.createElement("span");s.className="settings-about__credit-label",s.textContent=u("settings.about.credits.development"),this.aboutDevelopmentLabelElement=s;let a=document.createElement("span");a.textContent="Carlos Arturo Guerra Parra (Fuzzy Gab)",i.appendChild(s),i.appendChild(a),n.appendChild(i);let r=document.createElement("li"),l=document.createElement("span");l.className="settings-about__credit-label",l.textContent=u("settings.about.credits.appIcons"),this.aboutAppIconsLabelElement=l;let c=document.createElement("span");c.textContent="Sylvia Molina Muro (Fuzzy Gab)",r.appendChild(l),r.appendChild(c),n.appendChild(r);let d=document.createElement("li"),h=document.createElement("span");h.className="settings-about__credit-label",h.textContent=u("settings.about.credits.uiIcons"),this.aboutUiIconsLabelElement=h;let p=document.createElement("a");p.href="https://tabler.io/icons",p.target="_blank",p.rel="noopener noreferrer",p.textContent="Tabler Icons (MIT)",d.appendChild(h),d.appendChild(p),n.appendChild(d);let m=document.createElement("li"),g=document.createElement("span");g.className="settings-about__credit-label",g.textContent=u("settings.about.credits.inspiration"),this.aboutInspirationLabelElement=g;let _=document.createElement("span");return _.textContent="EMS Synthi 100 \u2013 Gabinete de M\xFAsica Electroac\xFAstica de Cuenca",m.appendChild(g),m.appendChild(_),n.appendChild(m),e.appendChild(t),e.appendChild(n),e}_createLanguageSection(){let e=document.createElement("div");e.className="settings-section",this.languageTitleElement=document.createElement("h3"),this.languageTitleElement.className="settings-section__title",this.languageTitleElement.textContent=u("settings.language");let t=document.createElement("div");t.className="settings-select-wrapper",this.languageSelect=document.createElement("select"),this.languageSelect.className="settings-select";let n=hi(),i=Xi();return n.forEach(s=>{let a=document.createElement("option");a.value=s,a.textContent=u(`settings.language.${s}`),a.selected=s===i,this.languageSelect.appendChild(a)}),this.languageSelect.addEventListener("change",async()=>{let s=this.languageSelect.value;await qa(s)}),t.appendChild(this.languageSelect),e.appendChild(this.languageTitleElement),e.appendChild(t),e}_createResolutionSection(){let e=document.createElement("div");e.className="settings-section",this.resolutionTitleElement=document.createElement("h3"),this.resolutionTitleElement.className="settings-section__title",this.resolutionTitleElement.textContent=u("settings.scale"),this.resolutionDescElement=document.createElement("p"),this.resolutionDescElement.className="settings-section__description",this.resolutionDescElement.textContent=u("settings.scale.description");let t=document.createElement("div");t.className="settings-row settings-row--select",this.resolutionSelectLabelElement=document.createElement("label"),this.resolutionSelectLabelElement.className="settings-row__label",this.resolutionSelectLabelElement.textContent=u("settings.scale.current"),this.resolutionSelectLabelElement.setAttribute("for","resolutionSelect"),this.resolutionSelect=document.createElement("select"),this.resolutionSelect.id="resolutionSelect",this.resolutionSelect.className="settings-select",this.resolutionFactors.forEach(i=>{let s=document.createElement("option");s.value=i,s.textContent=`${i}\xD7`,i===this.currentResolution&&(s.selected=!0),this.resolutionSelect.appendChild(s)}),this.resolutionSelect.addEventListener("change",()=>{let i=parseFloat(this.resolutionSelect.value);this._setResolution(i)}),t.appendChild(this.resolutionSelectLabelElement),t.appendChild(this.resolutionSelect);let n=document.createElement("div");return n.className="settings-row settings-row--checkbox",this.rememberResolutionCheckbox=document.createElement("input"),this.rememberResolutionCheckbox.type="checkbox",this.rememberResolutionCheckbox.id="rememberResolutionCheckbox",this.rememberResolutionCheckbox.className="settings-checkbox",this.rememberResolutionCheckbox.checked=this.rememberResolution,this.rememberResolutionLabelElement=document.createElement("label"),this.rememberResolutionLabelElement.className="settings-checkbox-label",this.rememberResolutionLabelElement.setAttribute("for","rememberResolutionCheckbox"),this.rememberResolutionLabelElement.textContent=u("settings.scale.remember"),this.rememberResolutionCheckbox.addEventListener("change",()=>{this.rememberResolution=this.rememberResolutionCheckbox.checked,localStorage.setItem(v.REMEMBER_RESOLUTION,String(this.rememberResolution)),this.rememberResolution&&localStorage.setItem(v.RESOLUTION,String(this.currentResolution))}),n.appendChild(this.rememberResolutionCheckbox),n.appendChild(this.rememberResolutionLabelElement),e.appendChild(this.resolutionTitleElement),e.appendChild(this.resolutionDescElement),e.appendChild(t),e.appendChild(n),e}_createInactivePinsSection(){let e=document.createElement("div");e.className="settings-section",this.inactivePinsTitleElement=document.createElement("h3"),this.inactivePinsTitleElement.className="settings-section__title",this.inactivePinsTitleElement.textContent=u("settings.display.inactivePins"),e.appendChild(this.inactivePinsTitleElement),this.inactivePinsDescElement=document.createElement("p"),this.inactivePinsDescElement.className="settings-section__description",this.inactivePinsDescElement.textContent=u("settings.display.inactivePins.description"),e.appendChild(this.inactivePinsDescElement);let t=document.createElement("div");t.className="settings-row settings-row--checkbox",this.inactivePinsCheckbox=document.createElement("input"),this.inactivePinsCheckbox.type="checkbox",this.inactivePinsCheckbox.id="inactivePinsCheckbox",this.inactivePinsCheckbox.className="settings-checkbox";let n=localStorage.getItem(v.SHOW_INACTIVE_PINS);return this.showInactivePins=n==="true",this.inactivePinsCheckbox.checked=this.showInactivePins,this.inactivePinsLabelElement=document.createElement("label"),this.inactivePinsLabelElement.className="settings-checkbox-label",this.inactivePinsLabelElement.htmlFor="inactivePinsCheckbox",this.inactivePinsLabelElement.textContent=u("settings.display.inactivePins.show"),this.inactivePinsCheckbox.addEventListener("change",()=>{this._setShowInactivePins(this.inactivePinsCheckbox.checked)}),t.appendChild(this.inactivePinsCheckbox),t.appendChild(this.inactivePinsLabelElement),e.appendChild(t),e}_setShowInactivePins(e){this.showInactivePins=e,localStorage.setItem(v.SHOW_INACTIVE_PINS,String(e)),document.dispatchEvent(new CustomEvent("synth:showInactivePinsChange",{detail:{show:e}}))}getShowInactivePins(){return this.showInactivePins}_createSharpRasterizeSection(){let e=document.createElement("div");e.className="settings-section",this.sharpRasterizeTitleElement=document.createElement("h3"),this.sharpRasterizeTitleElement.className="settings-section__title",this.sharpRasterizeTitleElement.textContent=u("settings.display.sharpRasterize"),e.appendChild(this.sharpRasterizeTitleElement),this.sharpRasterizeDescElement=document.createElement("p"),this.sharpRasterizeDescElement.className="settings-section__description",this.sharpRasterizeDescElement.textContent=u("settings.display.sharpRasterize.description"),e.appendChild(this.sharpRasterizeDescElement);let t=document.createElement("div");t.className="settings-row settings-row--checkbox",this.sharpRasterizeCheckbox=document.createElement("input"),this.sharpRasterizeCheckbox.type="checkbox",this.sharpRasterizeCheckbox.id="sharpRasterizeCheckbox",this.sharpRasterizeCheckbox.className="settings-checkbox";let n=localStorage.getItem(v.SHARP_RASTERIZE_ENABLED);return this.sharpRasterizeEnabled=n==="true",this.sharpRasterizeCheckbox.checked=this.sharpRasterizeEnabled,this.sharpRasterizeLabelElement=document.createElement("label"),this.sharpRasterizeLabelElement.className="settings-checkbox-label",this.sharpRasterizeLabelElement.htmlFor="sharpRasterizeCheckbox",this.sharpRasterizeLabelElement.textContent=u("settings.display.sharpRasterize.enable"),this.sharpRasterizeCheckbox.addEventListener("change",()=>{this._setSharpRasterize(this.sharpRasterizeCheckbox.checked)}),t.appendChild(this.sharpRasterizeCheckbox),t.appendChild(this.sharpRasterizeLabelElement),e.appendChild(t),e}_setSharpRasterize(e){this.sharpRasterizeEnabled=e,localStorage.setItem(v.SHARP_RASTERIZE_ENABLED,String(e)),document.dispatchEvent(new CustomEvent("synth:sharpRasterizeChange",{detail:{enabled:e}}))}_createTouchInteractionSection(){let e=document.createElement("div");e.className="settings-section",this.touchInteractionTitleElement=document.createElement("h3"),this.touchInteractionTitleElement.className="settings-section__title",this.touchInteractionTitleElement.textContent=u("settings.display.touchInteraction"),e.appendChild(this.touchInteractionTitleElement),this.touchInteractionDescElement=document.createElement("p"),this.touchInteractionDescElement.className="settings-section__description",this.touchInteractionDescElement.textContent=u("settings.display.touchInteraction.description"),e.appendChild(this.touchInteractionDescElement);let t=document.createElement("div");t.className="settings-row settings-row--checkbox",this.singleFingerPanCheckbox=document.createElement("input"),this.singleFingerPanCheckbox.type="checkbox",this.singleFingerPanCheckbox.id="singleFingerPanCheckbox",this.singleFingerPanCheckbox.className="settings-checkbox";let n=localStorage.getItem(v.SINGLE_FINGER_PAN);this.singleFingerPanEnabled=n!=="false",this.singleFingerPanCheckbox.checked=this.singleFingerPanEnabled,this.singleFingerPanLabelElement=document.createElement("label"),this.singleFingerPanLabelElement.className="settings-checkbox-label",this.singleFingerPanLabelElement.htmlFor="singleFingerPanCheckbox",this.singleFingerPanLabelElement.textContent=u("settings.display.touchInteraction.singleFingerPan"),this.singleFingerPanCheckbox.addEventListener("change",()=>{this._setSingleFingerPan(this.singleFingerPanCheckbox.checked)}),t.appendChild(this.singleFingerPanCheckbox),t.appendChild(this.singleFingerPanLabelElement),e.appendChild(t);let i=document.createElement("p");i.className="settings-section__description settings-section__description--sub",i.textContent=u("settings.display.touchInteraction.singleFingerPan.description"),e.appendChild(i);let s=document.createElement("div");s.className="settings-row settings-row--checkbox",this.multitouchControlsCheckbox=document.createElement("input"),this.multitouchControlsCheckbox.type="checkbox",this.multitouchControlsCheckbox.id="multitouchControlsCheckbox",this.multitouchControlsCheckbox.className="settings-checkbox";let a=localStorage.getItem(v.MULTITOUCH_CONTROLS);this.multitouchControlsEnabled=a==="true",this.multitouchControlsCheckbox.checked=this.multitouchControlsEnabled,this.multitouchControlsLabelElement=document.createElement("label"),this.multitouchControlsLabelElement.className="settings-checkbox-label",this.multitouchControlsLabelElement.htmlFor="multitouchControlsCheckbox",this.multitouchControlsLabelElement.textContent=u("settings.display.touchInteraction.multitouch"),this.multitouchControlsCheckbox.addEventListener("change",()=>{this._setMultitouchControls(this.multitouchControlsCheckbox.checked)}),s.appendChild(this.multitouchControlsCheckbox),s.appendChild(this.multitouchControlsLabelElement),e.appendChild(s);let r=document.createElement("p");return r.className="settings-section__description settings-section__description--sub",r.textContent=u("settings.display.touchInteraction.multitouch.description"),e.appendChild(r),e}_setSingleFingerPan(e){this.singleFingerPanEnabled=e,localStorage.setItem(v.SINGLE_FINGER_PAN,String(e)),document.dispatchEvent(new CustomEvent("synth:singleFingerPanChange",{detail:{enabled:e}}))}_setMultitouchControls(e){this.multitouchControlsEnabled=e,localStorage.setItem(v.MULTITOUCH_CONTROLS,String(e)),document.dispatchEvent(new CustomEvent("synth:multitouchControlsChange",{detail:{enabled:e}}))}_createPipSection(){let e=document.createElement("div");e.className="settings-section",this.pipTitleElement=document.createElement("h3"),this.pipTitleElement.className="settings-section__title",this.pipTitleElement.textContent=u("settings.display.pip"),e.appendChild(this.pipTitleElement),this.pipDescElement=document.createElement("p"),this.pipDescElement.className="settings-section__description",this.pipDescElement.textContent=u("settings.display.pip.description"),e.appendChild(this.pipDescElement);let t=document.createElement("div");t.className="settings-row settings-row--checkbox",this.pipRememberCheckbox=document.createElement("input"),this.pipRememberCheckbox.type="checkbox",this.pipRememberCheckbox.id="pipRememberCheckbox",this.pipRememberCheckbox.className="settings-checkbox";let n=localStorage.getItem(v.REMEMBER_VISUAL_LAYOUT);return this.rememberPips=n==="true",this.pipRememberCheckbox.checked=this.rememberPips,this.pipRememberLabelElement=document.createElement("label"),this.pipRememberLabelElement.className="settings-checkbox-label",this.pipRememberLabelElement.htmlFor="pipRememberCheckbox",this.pipRememberLabelElement.textContent=u("settings.display.pip.remember"),this.pipRememberCheckbox.addEventListener("change",()=>{this._setRememberPips(this.pipRememberCheckbox.checked)}),t.appendChild(this.pipRememberCheckbox),t.appendChild(this.pipRememberLabelElement),e.appendChild(t),e}_setRememberPips(e){this.rememberPips=e,localStorage.setItem(v.REMEMBER_VISUAL_LAYOUT,String(e)),document.dispatchEvent(new CustomEvent("synth:settingChanged",{detail:{key:"rememberVisualLayout",value:e}})),e||(localStorage.removeItem(v.PIP_STATE),localStorage.removeItem(v.VIEWPORT_STATE))}_createParamInfoSection(){let e=document.createElement("div");e.className="settings-section",this.paramInfoTitleElement=document.createElement("h3"),this.paramInfoTitleElement.className="settings-section__title",this.paramInfoTitleElement.textContent=u("settings.display.paramInfo"),e.appendChild(this.paramInfoTitleElement),this.paramInfoDescElement=document.createElement("p"),this.paramInfoDescElement.className="settings-section__description",this.paramInfoDescElement.textContent=u("settings.display.paramInfo.description"),e.appendChild(this.paramInfoDescElement);let t=document.createElement("div");t.className="settings-row settings-row--checkbox",this.tooltipVoltageCheckbox=document.createElement("input"),this.tooltipVoltageCheckbox.type="checkbox",this.tooltipVoltageCheckbox.id="tooltipVoltageCheckbox",this.tooltipVoltageCheckbox.className="settings-checkbox";let n=localStorage.getItem(v.TOOLTIP_SHOW_VOLTAGE);this.showTooltipVoltage=n!=="false",this.tooltipVoltageCheckbox.checked=this.showTooltipVoltage,this.tooltipVoltageLabelElement=document.createElement("label"),this.tooltipVoltageLabelElement.className="settings-checkbox-label",this.tooltipVoltageLabelElement.htmlFor="tooltipVoltageCheckbox",this.tooltipVoltageLabelElement.textContent=u("settings.display.paramInfo.voltage"),this.tooltipVoltageCheckbox.addEventListener("change",()=>{this.showTooltipVoltage=this.tooltipVoltageCheckbox.checked,localStorage.setItem(v.TOOLTIP_SHOW_VOLTAGE,String(this.showTooltipVoltage)),document.dispatchEvent(new CustomEvent("synth:settingChanged",{detail:{key:"tooltipShowVoltage",value:this.showTooltipVoltage}}))}),t.appendChild(this.tooltipVoltageCheckbox),t.appendChild(this.tooltipVoltageLabelElement),e.appendChild(t);let i=document.createElement("div");i.className="settings-row settings-row--checkbox",this.tooltipAudioCheckbox=document.createElement("input"),this.tooltipAudioCheckbox.type="checkbox",this.tooltipAudioCheckbox.id="tooltipAudioCheckbox",this.tooltipAudioCheckbox.className="settings-checkbox";let s=localStorage.getItem(v.TOOLTIP_SHOW_AUDIO_VALUES);return this.showTooltipAudio=s!=="false",this.tooltipAudioCheckbox.checked=this.showTooltipAudio,this.tooltipAudioLabelElement=document.createElement("label"),this.tooltipAudioLabelElement.className="settings-checkbox-label",this.tooltipAudioLabelElement.htmlFor="tooltipAudioCheckbox",this.tooltipAudioLabelElement.textContent=u("settings.display.paramInfo.audio"),this.tooltipAudioCheckbox.addEventListener("change",()=>{this.showTooltipAudio=this.tooltipAudioCheckbox.checked,localStorage.setItem(v.TOOLTIP_SHOW_AUDIO_VALUES,String(this.showTooltipAudio)),document.dispatchEvent(new CustomEvent("synth:settingChanged",{detail:{key:"tooltipShowAudioValues",value:this.showTooltipAudio}}))}),i.appendChild(this.tooltipAudioCheckbox),i.appendChild(this.tooltipAudioLabelElement),e.appendChild(i),e}_createGlowSection(){let e=document.createElement("div");e.className="settings-section",this.glowTitleElement=document.createElement("h3"),this.glowTitleElement.className="settings-section__title",this.glowTitleElement.textContent=u("settings.display.glow"),e.appendChild(this.glowTitleElement),this.glowDescElement=document.createElement("p"),this.glowDescElement.className="settings-section__description",this.glowDescElement.textContent=u("settings.display.glow.description"),e.appendChild(this.glowDescElement);let t=yl(),n=Ma();this._glowRadios={};for(let i of n){let s=document.createElement("div");s.className="settings-row settings-row--checkbox";let a=document.createElement("input");a.type="radio",a.name="glowPreset",a.id=`glowPreset-${i}`,a.value=i,a.className="settings-checkbox",a.checked=i===t;let r=document.createElement("label");r.className="settings-checkbox-label",r.htmlFor=`glowPreset-${i}`,r.textContent=u(`settings.display.glow.${i}`),a.addEventListener("change",()=>{a.checked&&vl(i)}),this._glowRadios[i]=a,s.appendChild(a),s.appendChild(r),e.appendChild(s)}return e}_createSignalFlowSection(){let e=document.createElement("div");e.className="settings-section",this.signalFlowTitleElement=document.createElement("h3"),this.signalFlowTitleElement.className="settings-section__title",this.signalFlowTitleElement.textContent=u("settings.signalFlow"),e.appendChild(this.signalFlowTitleElement),this.signalFlowDescElement=document.createElement("p"),this.signalFlowDescElement.className="settings-section__description",this.signalFlowDescElement.textContent=u("settings.signalFlow.description"),e.appendChild(this.signalFlowDescElement);let t=document.createElement("div");t.className="settings-row settings-row--checkbox",this.signalFlowEnabledCheckbox=document.createElement("input"),this.signalFlowEnabledCheckbox.type="checkbox",this.signalFlowEnabledCheckbox.id="signalFlowEnabled",this.signalFlowEnabledCheckbox.className="settings-checkbox";let n=localStorage.getItem(v.SIGNAL_FLOW_ENABLED);this.signalFlowEnabledCheckbox.checked=n!=="false";let i=document.createElement("label");i.className="settings-checkbox-label",i.htmlFor="signalFlowEnabled",i.textContent=u("settings.signalFlow.enabled"),this.signalFlowEnabledCheckbox.addEventListener("change",()=>{let c=this.signalFlowEnabledCheckbox.checked;localStorage.setItem(v.SIGNAL_FLOW_ENABLED,String(c)),this.signalFlowNoModifierCheckbox.disabled=!c,document.dispatchEvent(new CustomEvent("synth:signalFlowEnabledChanged",{detail:{enabled:c}}))}),t.appendChild(this.signalFlowEnabledCheckbox),t.appendChild(i),e.appendChild(t);let s=document.createElement("div");s.className="settings-row settings-row--checkbox settings-row--indent",this.signalFlowNoModifierCheckbox=document.createElement("input"),this.signalFlowNoModifierCheckbox.type="checkbox",this.signalFlowNoModifierCheckbox.id="signalFlowNoModifier",this.signalFlowNoModifierCheckbox.className="settings-checkbox";let r=localStorage.getItem(v.SIGNAL_FLOW_REQUIRE_MODIFIER)==="true";this.signalFlowNoModifierCheckbox.checked=!r,this.signalFlowNoModifierCheckbox.disabled=!this.signalFlowEnabledCheckbox.checked;let l=document.createElement("label");return l.className="settings-checkbox-label",l.htmlFor="signalFlowNoModifier",l.textContent=u("settings.signalFlow.noModifier"),this.signalFlowNoModifierCheckbox.addEventListener("change",()=>{let c=this.signalFlowNoModifierCheckbox.checked;localStorage.setItem(v.SIGNAL_FLOW_REQUIRE_MODIFIER,String(!c)),document.dispatchEvent(new CustomEvent("synth:signalFlowModeChanged",{detail:{requireModifier:!c}}))}),s.appendChild(this.signalFlowNoModifierCheckbox),s.appendChild(l),e.appendChild(s),e}_createFaderResponseSection(){let e=document.createElement("div");e.className="settings-section",this.faderResponseTitleElement=document.createElement("h3"),this.faderResponseTitleElement.className="settings-section__title",this.faderResponseTitleElement.textContent=u("settings.display.faderResponse"),e.appendChild(this.faderResponseTitleElement),this.faderResponseDescElement=document.createElement("p"),this.faderResponseDescElement.className="settings-section__description",this.faderResponseDescElement.textContent=u("settings.display.faderResponse.description"),e.appendChild(this.faderResponseDescElement);let t=document.createElement("div");t.className="settings-row settings-row--checkbox",this.faderLinearCheckbox=document.createElement("input"),this.faderLinearCheckbox.type="checkbox",this.faderLinearCheckbox.id="faderLinearCheckbox",this.faderLinearCheckbox.className="settings-checkbox";let n=localStorage.getItem(v.FADER_LINEAR_RESPONSE);return this.faderLinearResponse=n===null?!0:n==="true",this.faderLinearCheckbox.checked=this.faderLinearResponse,this.faderLinearLabelElement=document.createElement("label"),this.faderLinearLabelElement.className="settings-checkbox-label",this.faderLinearLabelElement.htmlFor="faderLinearCheckbox",this.faderLinearLabelElement.textContent=u("settings.display.faderResponse.linear"),this.faderLinearCheckbox.addEventListener("change",()=>{this.faderLinearResponse=this.faderLinearCheckbox.checked,localStorage.setItem(v.FADER_LINEAR_RESPONSE,String(this.faderLinearResponse)),document.dispatchEvent(new CustomEvent("synth:faderResponseChanged",{detail:{linear:this.faderLinearResponse}}))}),t.appendChild(this.faderLinearCheckbox),t.appendChild(this.faderLinearLabelElement),e.appendChild(t),e}_createKnobStyleSection(){let e=document.createElement("div");e.className="settings-section",this.knobStyleTitleElement=document.createElement("h3"),this.knobStyleTitleElement.className="settings-section__title",this.knobStyleTitleElement.textContent=u("settings.display.knobStyle"),e.appendChild(this.knobStyleTitleElement),this.knobStyleDescElement=document.createElement("p"),this.knobStyleDescElement.className="settings-section__description",this.knobStyleDescElement.textContent=u("settings.display.knobStyle.description"),e.appendChild(this.knobStyleDescElement);let t=localStorage.getItem(v.KNOB_STYLE)||"svg",n=(i,s)=>{let a=document.createElement("div");a.className="settings-row settings-row--checkbox";let r=document.createElement("input");r.type="radio",r.name="knobStyle",r.id=`knobStyle-${i}`,r.value=i,r.className="settings-checkbox",r.checked=t===i;let l=document.createElement("label");return l.className="settings-checkbox-label",l.htmlFor=`knobStyle-${i}`,l.textContent=u(s),r.addEventListener("change",()=>{r.checked&&(localStorage.setItem(v.KNOB_STYLE,i),this._applyKnobStyle(i))}),a.appendChild(r),a.appendChild(l),a};return e.appendChild(n("svg","settings.display.knobStyle.svg")),e.appendChild(n("css","settings.display.knobStyle.css")),this._applyKnobStyle(t),e}_applyKnobStyle(e){e==="css"?document.body.classList.add("knob-style-css"):document.body.classList.remove("knob-style-css")}_createOptimizationsSection(){let e=document.createElement("div");e.className="settings-section",this.optimizationsTitleElement=document.createElement("h3"),this.optimizationsTitleElement.className="settings-section__title",this.optimizationsTitleElement.textContent=u("settings.optimizations"),e.appendChild(this.optimizationsTitleElement),this.optimizationsDescElement=document.createElement("p"),this.optimizationsDescElement.className="settings-section__description",this.optimizationsDescElement.textContent=u("settings.optimizations.description"),e.appendChild(this.optimizationsDescElement);let t=document.createElement("div");return t.className="settings-row settings-row--checkbox",this.optimizationsDebugCheckbox=document.createElement("input"),this.optimizationsDebugCheckbox.type="checkbox",this.optimizationsDebugCheckbox.id="optimizationsDebugCheckbox",this.optimizationsDebugCheckbox.className="settings-checkbox",this.optimizationsDebugCheckbox.checked=this.optimizationsDebug,this.optimizationsDebugLabelElement=document.createElement("label"),this.optimizationsDebugLabelElement.className="settings-checkbox-label",this.optimizationsDebugLabelElement.htmlFor="optimizationsDebugCheckbox",this.optimizationsDebugLabelElement.textContent=u("settings.optimizations.debugGlobal"),this.optimizationsDebugCheckbox.addEventListener("change",()=>{this._setOptimizationsDebug(this.optimizationsDebugCheckbox.checked)}),t.appendChild(this.optimizationsDebugCheckbox),t.appendChild(this.optimizationsDebugLabelElement),e.appendChild(t),e.appendChild(this._createDormancySubsection()),e.appendChild(this._createFilterBypassSubsection()),e}_createDormancySubsection(){let e=document.createElement("div");e.className="settings-subsection",this.dormancyTitleElement=document.createElement("h4"),this.dormancyTitleElement.className="settings-subsection__title",this.dormancyTitleElement.textContent=u("settings.dormancy"),e.appendChild(this.dormancyTitleElement),this.dormancyDescElement=document.createElement("p"),this.dormancyDescElement.className="settings-subsection__description",this.dormancyDescElement.textContent=u("settings.dormancy.description"),e.appendChild(this.dormancyDescElement);let t=document.createElement("div");t.className="settings-row settings-row--checkbox",this.dormancyEnabledCheckbox=document.createElement("input"),this.dormancyEnabledCheckbox.type="checkbox",this.dormancyEnabledCheckbox.id="dormancyEnabledCheckbox",this.dormancyEnabledCheckbox.className="settings-checkbox",this.dormancyEnabledCheckbox.checked=this.dormancyEnabled,this.dormancyEnabledLabelElement=document.createElement("label"),this.dormancyEnabledLabelElement.className="settings-checkbox-label",this.dormancyEnabledLabelElement.htmlFor="dormancyEnabledCheckbox",this.dormancyEnabledLabelElement.textContent=u("settings.dormancy.enabled"),this.dormancyEnabledCheckbox.addEventListener("change",()=>{this._setDormancyEnabled(this.dormancyEnabledCheckbox.checked)}),t.appendChild(this.dormancyEnabledCheckbox),t.appendChild(this.dormancyEnabledLabelElement),e.appendChild(t);let n=document.createElement("div");return n.className="settings-row settings-row--checkbox settings-row--indent",this.dormancyDebugCheckbox=document.createElement("input"),this.dormancyDebugCheckbox.type="checkbox",this.dormancyDebugCheckbox.id="dormancyDebugCheckbox",this.dormancyDebugCheckbox.className="settings-checkbox",this.dormancyDebugCheckbox.checked=this.dormancyDebug,this.dormancyDebugLabelElement=document.createElement("label"),this.dormancyDebugLabelElement.className="settings-checkbox-label",this.dormancyDebugLabelElement.htmlFor="dormancyDebugCheckbox",this.dormancyDebugLabelElement.textContent=u("settings.dormancy.debug"),this.dormancyDebugCheckbox.addEventListener("change",()=>{this._setDormancyDebug(this.dormancyDebugCheckbox.checked)}),n.appendChild(this.dormancyDebugCheckbox),n.appendChild(this.dormancyDebugLabelElement),e.appendChild(n),e}_createFilterBypassSubsection(){let e=document.createElement("div");e.className="settings-subsection",this.filterBypassTitleElement=document.createElement("h4"),this.filterBypassTitleElement.className="settings-subsection__title",this.filterBypassTitleElement.textContent=u("settings.filterBypass"),e.appendChild(this.filterBypassTitleElement),this.filterBypassDescElement=document.createElement("p"),this.filterBypassDescElement.className="settings-subsection__description",this.filterBypassDescElement.textContent=u("settings.filterBypass.description"),e.appendChild(this.filterBypassDescElement);let t=document.createElement("div");t.className="settings-row settings-row--checkbox",this.filterBypassEnabledCheckbox=document.createElement("input"),this.filterBypassEnabledCheckbox.type="checkbox",this.filterBypassEnabledCheckbox.id="filterBypassEnabledCheckbox",this.filterBypassEnabledCheckbox.className="settings-checkbox",this.filterBypassEnabledCheckbox.checked=this.filterBypassEnabled,this.filterBypassEnabledLabelElement=document.createElement("label"),this.filterBypassEnabledLabelElement.className="settings-checkbox-label",this.filterBypassEnabledLabelElement.htmlFor="filterBypassEnabledCheckbox",this.filterBypassEnabledLabelElement.textContent=u("settings.filterBypass.enabled"),this.filterBypassEnabledCheckbox.addEventListener("change",()=>{this._setFilterBypassEnabled(this.filterBypassEnabledCheckbox.checked)}),t.appendChild(this.filterBypassEnabledCheckbox),t.appendChild(this.filterBypassEnabledLabelElement),e.appendChild(t);let n=document.createElement("div");return n.className="settings-row settings-row--checkbox settings-row--indent",this.filterBypassDebugCheckbox=document.createElement("input"),this.filterBypassDebugCheckbox.type="checkbox",this.filterBypassDebugCheckbox.id="filterBypassDebugCheckbox",this.filterBypassDebugCheckbox.className="settings-checkbox",this.filterBypassDebugCheckbox.checked=this.filterBypassDebug,this.filterBypassDebugLabelElement=document.createElement("label"),this.filterBypassDebugLabelElement.className="settings-checkbox-label",this.filterBypassDebugLabelElement.htmlFor="filterBypassDebugCheckbox",this.filterBypassDebugLabelElement.textContent=u("settings.filterBypass.debug"),this.filterBypassDebugCheckbox.addEventListener("change",()=>{this._setFilterBypassDebug(this.filterBypassDebugCheckbox.checked)}),n.appendChild(this.filterBypassDebugCheckbox),n.appendChild(this.filterBypassDebugLabelElement),e.appendChild(n),e}_createLatencyModeSubsection(){let e=document.createElement("div");e.className="settings-subsection",this.latencyModeTitleElement=document.createElement("h4"),this.latencyModeTitleElement.className="settings-subsection__title",this.latencyModeTitleElement.textContent=u("settings.latencyMode"),e.appendChild(this.latencyModeTitleElement),this.latencyModeDescElement=document.createElement("p"),this.latencyModeDescElement.className="settings-subsection__description",this.latencyModeDescElement.textContent=u("settings.latencyMode.description"),e.appendChild(this.latencyModeDescElement);let t=document.createElement("div");t.className="settings-row";let n=document.createElement("div");return n.className="settings-select-wrapper",this.latencyModeSelect=document.createElement("select"),this.latencyModeSelect.className="settings-select",this.latencyModeSelect.id="latencyModeSelect",[{value:"interactive",label:"settings.latencyMode.interactive"},{value:"balanced",label:"settings.latencyMode.balanced"},{value:"playback",label:"settings.latencyMode.playback"},{value:"0.1",label:"settings.latencyMode.safe"},{value:"0.2",label:"settings.latencyMode.maximum"}].forEach(s=>{let a=document.createElement("option");a.value=s.value,a.textContent=u(s.label),this.latencyModeSelect.appendChild(a)}),this.latencyModeSelect.value=this.latencyMode,this.latencyModeSelect.addEventListener("change",()=>{this._setLatencyMode(this.latencyModeSelect.value)}),n.appendChild(this.latencyModeSelect),t.appendChild(n),e.appendChild(t),e}_setLatencyMode(e){let t=this.latencyMode;e!==t&&(this.latencyMode=e,localStorage.setItem(v.LATENCY_MODE,e),se(u("settings.latencyMode.restartRequired"),3e3))}_setOptimizationsDebug(e){this.optimizationsDebug=e,localStorage.setItem(v.OPTIMIZATIONS_DEBUG,String(e)),document.dispatchEvent(new CustomEvent("synth:optimizationsDebugChange",{detail:{enabled:e}}))}_setDormancyEnabled(e){this.dormancyEnabled=e,localStorage.setItem(v.DORMANCY_ENABLED,String(e)),document.dispatchEvent(new CustomEvent("synth:dormancyEnabledChange",{detail:{enabled:e}}))}_setDormancyDebug(e){this.dormancyDebug=e,localStorage.setItem(v.DORMANCY_DEBUG,String(e)),document.dispatchEvent(new CustomEvent("synth:dormancyDebugChange",{detail:{enabled:e}}))}_setFilterBypassEnabled(e){this.filterBypassEnabled=e,localStorage.setItem(v.FILTER_BYPASS_ENABLED,String(e)),document.dispatchEvent(new CustomEvent("synth:filterBypassEnabledChange",{detail:{enabled:e}}))}_setFilterBypassDebug(e){this.filterBypassDebug=e,localStorage.setItem(v.FILTER_BYPASS_DEBUG,String(e)),document.dispatchEvent(new CustomEvent("synth:filterBypassDebugChange",{detail:{enabled:e}}))}_createVoltageEmulationSection(){let e=document.createElement("div");e.className="settings-section",this.voltageEmulationTitleElement=document.createElement("h3"),this.voltageEmulationTitleElement.className="settings-section__title",this.voltageEmulationTitleElement.textContent=u("settings.voltageEmulation"),e.appendChild(this.voltageEmulationTitleElement),this.voltageEmulationDescElement=document.createElement("p"),this.voltageEmulationDescElement.className="settings-section__description",this.voltageEmulationDescElement.textContent=u("settings.voltageEmulation.description"),e.appendChild(this.voltageEmulationDescElement);let t=document.createElement("div");t.className="settings-row settings-row--checkbox",this.voltageSoftClipCheckbox=document.createElement("input"),this.voltageSoftClipCheckbox.type="checkbox",this.voltageSoftClipCheckbox.id="voltageSoftClipCheckbox",this.voltageSoftClipCheckbox.className="settings-checkbox",this.voltageSoftClipCheckbox.checked=this.voltageSoftClipEnabled,this.voltageSoftClipLabelElement=document.createElement("label"),this.voltageSoftClipLabelElement.className="settings-checkbox-label",this.voltageSoftClipLabelElement.htmlFor="voltageSoftClipCheckbox",this.voltageSoftClipLabelElement.textContent=u("settings.voltageEmulation.softClip"),this.voltageSoftClipCheckbox.addEventListener("change",()=>{this._setVoltageSoftClipEnabled(this.voltageSoftClipCheckbox.checked)}),t.appendChild(this.voltageSoftClipCheckbox),t.appendChild(this.voltageSoftClipLabelElement),e.appendChild(t);let n=document.createElement("p");n.className="settings-row--indent settings-checkbox-description",n.textContent=u("settings.voltageEmulation.softClip.description"),this.voltageSoftClipDescElement=n,e.appendChild(n);let i=document.createElement("div");i.className="settings-row settings-row--checkbox",this.voltagePinToleranceCheckbox=document.createElement("input"),this.voltagePinToleranceCheckbox.type="checkbox",this.voltagePinToleranceCheckbox.id="voltagePinToleranceCheckbox",this.voltagePinToleranceCheckbox.className="settings-checkbox",this.voltagePinToleranceCheckbox.checked=this.voltagePinToleranceEnabled,this.voltagePinToleranceLabelElement=document.createElement("label"),this.voltagePinToleranceLabelElement.className="settings-checkbox-label",this.voltagePinToleranceLabelElement.htmlFor="voltagePinToleranceCheckbox",this.voltagePinToleranceLabelElement.textContent=u("settings.voltageEmulation.pinTolerance"),this.voltagePinToleranceCheckbox.addEventListener("change",()=>{this._setVoltagePinToleranceEnabled(this.voltagePinToleranceCheckbox.checked)}),i.appendChild(this.voltagePinToleranceCheckbox),i.appendChild(this.voltagePinToleranceLabelElement),e.appendChild(i);let s=document.createElement("p");s.className="settings-row--indent settings-checkbox-description",s.textContent=u("settings.voltageEmulation.pinTolerance.description"),this.voltagePinToleranceDescElement=s,e.appendChild(s);let a=document.createElement("div");a.className="settings-row settings-row--checkbox",this.voltageThermalDriftCheckbox=document.createElement("input"),this.voltageThermalDriftCheckbox.type="checkbox",this.voltageThermalDriftCheckbox.id="voltageThermalDriftCheckbox",this.voltageThermalDriftCheckbox.className="settings-checkbox",this.voltageThermalDriftCheckbox.checked=this.voltageThermalDriftEnabled,this.voltageThermalDriftLabelElement=document.createElement("label"),this.voltageThermalDriftLabelElement.className="settings-checkbox-label",this.voltageThermalDriftLabelElement.htmlFor="voltageThermalDriftCheckbox",this.voltageThermalDriftLabelElement.textContent=u("settings.voltageEmulation.thermalDrift"),this.voltageThermalDriftCheckbox.addEventListener("change",()=>{this._setVoltageThermalDriftEnabled(this.voltageThermalDriftCheckbox.checked)}),a.appendChild(this.voltageThermalDriftCheckbox),a.appendChild(this.voltageThermalDriftLabelElement),e.appendChild(a);let r=document.createElement("p");return r.className="settings-row--indent settings-checkbox-description",r.textContent=u("settings.voltageEmulation.thermalDrift.description"),this.voltageThermalDriftDescElement=r,e.appendChild(r),e}_setVoltageSoftClipEnabled(e){this.voltageSoftClipEnabled=e,localStorage.setItem(v.VOLTAGE_SOFT_CLIP_ENABLED,String(e)),document.dispatchEvent(new CustomEvent("synth:voltageSoftClipChange",{detail:{enabled:e}}))}_setVoltagePinToleranceEnabled(e){this.voltagePinToleranceEnabled=e,localStorage.setItem(v.VOLTAGE_PIN_TOLERANCE_ENABLED,String(e)),document.dispatchEvent(new CustomEvent("synth:voltagePinToleranceChange",{detail:{enabled:e}}))}_setVoltageThermalDriftEnabled(e){this.voltageThermalDriftEnabled=e,localStorage.setItem(v.VOLTAGE_THERMAL_DRIFT_ENABLED,String(e)),document.dispatchEvent(new CustomEvent("synth:voltageThermalDriftChange",{detail:{enabled:e}}))}_createUpdatesSection(){let e=document.createElement("div");e.className="settings-section",this.updatesTitleElement=document.createElement("h3"),this.updatesTitleElement.className="settings-section__title",this.updatesTitleElement.textContent=u("settings.updates");let t=document.createElement("div");t.className="settings-version-row",this.versionLabelElement=document.createElement("span"),this.versionLabelElement.className="settings-version-label",this.versionLabelElement.textContent=u("settings.updates.version");let n=document.createElement("span");return n.className="settings-version-value",n.textContent=window.__synthBuildVersion||"-",t.appendChild(this.versionLabelElement),t.appendChild(n),this.updateCheckBtn=document.createElement("button"),this.updateCheckBtn.type="button",this.updateCheckBtn.className="settings-update-btn",this.updateCheckBtn.textContent=u("settings.updates.check"),this.updateCheckBtn.addEventListener("click",()=>this._handleCheckUpdate()),this.updateStatusElement=document.createElement("div"),this.updateStatusElement.className="settings-update-status",ds()&&this._showUpdateAvailable(),e.appendChild(this.updatesTitleElement),e.appendChild(t),e.appendChild(this.updateCheckBtn),e.appendChild(this.updateStatusElement),e}_createTelemetrySection(){let e=document.createElement("div");e.className="settings-section",this.telemetryTitleElement=document.createElement("h3"),this.telemetryTitleElement.className="settings-section__title",this.telemetryTitleElement.textContent=u("settings.telemetry"),e.appendChild(this.telemetryTitleElement),this.telemetryDescElement=document.createElement("p"),this.telemetryDescElement.className="settings-section__description",this.telemetryDescElement.textContent=u("settings.telemetry.description"),e.appendChild(this.telemetryDescElement);let t=document.createElement("div");return t.className="settings-row settings-row--checkbox",this.telemetryEnabledCheckbox=document.createElement("input"),this.telemetryEnabledCheckbox.type="checkbox",this.telemetryEnabledCheckbox.id="telemetryEnabledCheckbox",this.telemetryEnabledCheckbox.className="settings-checkbox",this.telemetryEnabledCheckbox.checked=localStorage.getItem(v.TELEMETRY_ENABLED)==="true",this.telemetryEnabledLabelElement=document.createElement("label"),this.telemetryEnabledLabelElement.className="settings-checkbox-label",this.telemetryEnabledLabelElement.htmlFor="telemetryEnabledCheckbox",this.telemetryEnabledLabelElement.textContent=u("settings.telemetry.label"),this.telemetryEnabledCheckbox.addEventListener("change",()=>{let n=this.telemetryEnabledCheckbox.checked;Vi(n),document.dispatchEvent(new CustomEvent("synth:telemetryEnabledChange",{detail:{enabled:n}}))}),t.appendChild(this.telemetryEnabledCheckbox),t.appendChild(this.telemetryEnabledLabelElement),e.appendChild(t),e}_createConfirmResetSection(){let e=document.createElement("div");e.className="settings-section";let t=document.createElement("div");return t.className="settings-row settings-row--checkbox",this.confirmResetCheckbox=document.createElement("input"),this.confirmResetCheckbox.type="checkbox",this.confirmResetCheckbox.id="confirmResetCheckbox",this.confirmResetCheckbox.className="settings-checkbox",this.confirmResetCheckbox.checked=localStorage.getItem(v.CONFIRM_SYNTH_RESET)!=="false",this.confirmResetLabelElement=document.createElement("label"),this.confirmResetLabelElement.className="settings-checkbox-label",this.confirmResetLabelElement.htmlFor="confirmResetCheckbox",this.confirmResetLabelElement.textContent=u("settings.synth.confirmReset"),this.confirmResetCheckbox.addEventListener("change",()=>{this.confirmResetCheckbox.checked?localStorage.removeItem(v.CONFIRM_SYNTH_RESET):localStorage.setItem(v.CONFIRM_SYNTH_RESET,"false")}),t.appendChild(this.confirmResetCheckbox),t.appendChild(this.confirmResetLabelElement),e.appendChild(t),e}_createResetSection(){let e=document.createElement("div");return e.className="settings-section settings-section--danger",this.resetTitleElement=document.createElement("h3"),this.resetTitleElement.className="settings-section__title",this.resetTitleElement.textContent=u("settings.reset"),this.resetDescElement=document.createElement("p"),this.resetDescElement.className="settings-section__description",this.resetDescElement.textContent=u("settings.reset.description"),this.resetBtn=document.createElement("button"),this.resetBtn.type="button",this.resetBtn.className="settings-reset-btn settings-reset-btn--danger",this.resetBtn.textContent=u("settings.reset.button"),this.resetBtn.addEventListener("click",()=>this._handleReset()),e.appendChild(this.resetTitleElement),e.appendChild(this.resetDescElement),e.appendChild(this.resetBtn),e}async _handleReset(){if(!(await Ie.show({title:u("settings.reset.confirm"),confirmText:u("common.yes"),cancelText:u("common.no")})).confirmed)return;let t=[];for(let n=0;n<localStorage.length;n++){let i=localStorage.key(n);i&&i.startsWith(U)&&t.push(i)}t.forEach(n=>localStorage.removeItem(n)),window.location.reload()}_createAutoSaveSection(){let e=document.createElement("div");e.className="settings-section",this.autoSaveTitleElement=document.createElement("h3"),this.autoSaveTitleElement.className="settings-section__title",this.autoSaveTitleElement.textContent=u("settings.autosave"),e.appendChild(this.autoSaveTitleElement),this.autoSaveDescElement=document.createElement("p"),this.autoSaveDescElement.className="settings-section__description",this.autoSaveDescElement.textContent=u("settings.autosave.description"),e.appendChild(this.autoSaveDescElement);let t=document.createElement("div");t.className="settings-row",this.intervalLabelElement=document.createElement("label"),this.intervalLabelElement.className="settings-row__label",this.intervalLabelElement.textContent=u("settings.autosave.interval");let n=document.createElement("div");n.className="settings-select-wrapper",this.intervalSelect=document.createElement("select"),this.intervalSelect.className="settings-select",["off","30s","1m","5m","10m"].forEach(r=>{let l=document.createElement("option");l.value=r,l.textContent=u(`settings.autosave.interval.${r}`),l.selected=r===this.autoSaveInterval,this.intervalSelect.appendChild(l)}),this.intervalSelect.addEventListener("change",()=>{this._setAutoSaveInterval(this.intervalSelect.value)}),n.appendChild(this.intervalSelect),t.appendChild(this.intervalLabelElement),t.appendChild(n),e.appendChild(t);let s=document.createElement("div");s.className="settings-row settings-row--checkbox",this.saveOnExitCheckbox=document.createElement("input"),this.saveOnExitCheckbox.type="checkbox",this.saveOnExitCheckbox.id="saveOnExitCheckbox",this.saveOnExitCheckbox.className="settings-checkbox",this.saveOnExitCheckbox.checked=this.saveOnExit,this.saveOnExitLabelElement=document.createElement("label"),this.saveOnExitLabelElement.className="settings-checkbox-label",this.saveOnExitLabelElement.htmlFor="saveOnExitCheckbox",this.saveOnExitLabelElement.textContent=u("settings.autosave.onExit"),this.saveOnExitCheckbox.addEventListener("change",()=>{this._setSaveOnExit(this.saveOnExitCheckbox.checked)}),s.appendChild(this.saveOnExitCheckbox),s.appendChild(this.saveOnExitLabelElement),e.appendChild(s);let a=document.createElement("div");return a.className="settings-row settings-row--checkbox",this.restoreOnStartCheckbox=document.createElement("input"),this.restoreOnStartCheckbox.type="checkbox",this.restoreOnStartCheckbox.id="restoreOnStartCheckbox",this.restoreOnStartCheckbox.className="settings-checkbox",this.restoreOnStartCheckbox.checked=this.restoreOnStart,this.restoreOnStartLabelElement=document.createElement("label"),this.restoreOnStartLabelElement.className="settings-checkbox-label",this.restoreOnStartLabelElement.htmlFor="restoreOnStartCheckbox",this.restoreOnStartLabelElement.textContent=u("settings.autosave.restoreOnStart"),this.restoreOnStartCheckbox.addEventListener("change",()=>{this._setRestoreOnStart(this.restoreOnStartCheckbox.checked),this._updateAskBeforeRestoreVisibility()}),a.appendChild(this.restoreOnStartCheckbox),a.appendChild(this.restoreOnStartLabelElement),e.appendChild(a),this.askBeforeRestoreRow=document.createElement("div"),this.askBeforeRestoreRow.className="settings-row settings-row--checkbox settings-row--indent",this.askBeforeRestoreCheckbox=document.createElement("input"),this.askBeforeRestoreCheckbox.type="checkbox",this.askBeforeRestoreCheckbox.id="askBeforeRestoreCheckbox",this.askBeforeRestoreCheckbox.className="settings-checkbox",this.askBeforeRestoreCheckbox.checked=this.askBeforeRestore,this.askBeforeRestoreLabelElement=document.createElement("label"),this.askBeforeRestoreLabelElement.className="settings-checkbox-label",this.askBeforeRestoreLabelElement.htmlFor="askBeforeRestoreCheckbox",this.askBeforeRestoreLabelElement.textContent=u("settings.autosave.askBeforeRestore"),this.askBeforeRestoreCheckbox.addEventListener("change",()=>{this._setAskBeforeRestore(this.askBeforeRestoreCheckbox.checked)}),this.askBeforeRestoreRow.appendChild(this.askBeforeRestoreCheckbox),this.askBeforeRestoreRow.appendChild(this.askBeforeRestoreLabelElement),e.appendChild(this.askBeforeRestoreRow),this._updateAskBeforeRestoreVisibility(),e}_createWakeLockSection(){let e=document.createElement("div");e.className="settings-section",this.wakeLockTitleElement=document.createElement("h3"),this.wakeLockTitleElement.className="settings-section__title",this.wakeLockTitleElement.textContent=u("settings.wakelock"),e.appendChild(this.wakeLockTitleElement),this.wakeLockDescElement=document.createElement("p"),this.wakeLockDescElement.className="settings-section__description";let t=Qn.isSupported();this.wakeLockDescElement.textContent=t?u("settings.wakelock.description"):u("settings.wakelock.unsupported"),e.appendChild(this.wakeLockDescElement);let n=document.createElement("div");n.className="settings-row settings-row--checkbox",this.wakeLockCheckbox=document.createElement("input"),this.wakeLockCheckbox.type="checkbox",this.wakeLockCheckbox.id="wakeLockCheckbox",this.wakeLockCheckbox.className="settings-checkbox";let i=localStorage.getItem(v.WAKE_LOCK_ENABLED);return this.wakeLockEnabled=i===null?!0:i==="true",this.wakeLockCheckbox.checked=this.wakeLockEnabled,t||(this.wakeLockCheckbox.disabled=!0,n.classList.add("settings-row--disabled")),this.wakeLockLabelElement=document.createElement("label"),this.wakeLockLabelElement.className="settings-checkbox-label",this.wakeLockLabelElement.htmlFor="wakeLockCheckbox",this.wakeLockLabelElement.textContent=u("settings.wakelock"),this.wakeLockCheckbox.addEventListener("change",()=>{this._setWakeLockEnabled(this.wakeLockCheckbox.checked)}),n.appendChild(this.wakeLockCheckbox),n.appendChild(this.wakeLockLabelElement),e.appendChild(n),e}_setWakeLockEnabled(e){this.wakeLockEnabled=e,localStorage.setItem(v.WAKE_LOCK_ENABLED,String(e)),this.onWakeLockChange&&this.onWakeLockChange(e)}getWakeLockEnabled(){return this.wakeLockEnabled}_createShortcutsSection(){let e=document.createElement("div");e.className="settings-section",this.shortcutsTitleElement=document.createElement("h3"),this.shortcutsTitleElement.className="settings-section__title",this.shortcutsTitleElement.textContent=u("settings.shortcuts"),e.appendChild(this.shortcutsTitleElement),this.shortcutsDescElement=document.createElement("p"),this.shortcutsDescElement.className="settings-section__description",this.shortcutsDescElement.textContent=u("settings.shortcuts.description"),e.appendChild(this.shortcutsDescElement);let t=document.createElement("p");t.className="settings-section__description settings-section__note",t.textContent=u("settings.shortcuts.knobModifiers"),e.appendChild(t);let n=document.createElement("div");n.className="settings-shortcuts-list";let i=ve.getActionIds();this.shortcutInputs={},i.forEach(a=>{let r=this._createShortcutRow(a);n.appendChild(r)}),e.appendChild(n);let s=document.createElement("div");return s.className="settings-row",s.style.marginTop="12px",this.resetShortcutsButton=document.createElement("button"),this.resetShortcutsButton.className="settings-shortcuts-reset",this.resetShortcutsButton.textContent=u("settings.shortcuts.resetDefaults"),this.resetShortcutsButton.addEventListener("click",()=>{ve.resetToDefaults(),this._updateAllShortcutInputs()}),s.appendChild(this.resetShortcutsButton),e.appendChild(s),e}_createShortcutRow(e){let t=document.createElement("div");t.className="settings-shortcut-row";let n=document.createElement("span");if(n.className="settings-shortcut-label",n.textContent=u(`settings.shortcuts.${e}`),n.dataset.i18n=`settings.shortcuts.${e}`,e==="showPanelHints")return this._createShowPanelHintsRow(t,n,e);if(e==="signalFlow")return this._createSignalFlowRow(t,n,e);let i=document.createElement("div");i.className="settings-shortcut-input-wrapper";let s=document.createElement("input");s.type="text",s.className="settings-shortcut-input",s.readOnly=!0,s.dataset.actionId=e;let a=ve.get(e);s.value=a?ve.formatBinding(a):u("settings.shortcuts.none"),a||s.classList.add("empty"),this.shortcutInputs[e]=s;let r=document.createElement("span");r.className="settings-shortcut-conflict",r.style.display="none",s.addEventListener("click",()=>{this._startShortcutCapture(s,e,r)});let l=document.createElement("button");return l.type="button",l.className="settings-shortcut-clear",l.innerHTML="\xD7",l.title="Clear",l.addEventListener("click",c=>{c.stopPropagation(),ve.clear(e),s.value=u("settings.shortcuts.none"),s.classList.add("empty"),s.classList.remove("conflict"),r.style.display="none"}),i.appendChild(s),i.appendChild(l),t.appendChild(n),t.appendChild(i),t.appendChild(r),t}_createShowPanelHintsRow(e,t,n){let i=document.createElement("div");i.className="settings-shortcut-input-wrapper";let s=document.createElement("select");s.className="settings-shortcut-input settings-shortcut-select",s.dataset.actionId=n;let a=document.createElement("option");a.value="Alt",a.textContent="Alt";let r=document.createElement("option");r.value="Control",r.textContent="Ctrl",s.appendChild(a),s.appendChild(r);let l=ve.get(n);return s.value=l?.key||"Alt",this.shortcutInputs[n]=s,s.addEventListener("change",()=>{ve.set(n,{key:s.value,shift:!1,ctrl:!1,alt:!1})}),i.appendChild(s),e.appendChild(t),e.appendChild(i),e}_createSignalFlowRow(e,t,n){let i=document.createElement("div");i.className="settings-shortcut-input-wrapper";let s=document.createElement("select");s.className="settings-shortcut-input settings-shortcut-select",s.dataset.actionId=n;let a=document.createElement("option");a.value="Control",a.textContent="Ctrl";let r=document.createElement("option");r.value="Alt",r.textContent="Alt",s.appendChild(a),s.appendChild(r);let l=ve.get(n);return s.value=l?.key||"Control",this.shortcutInputs[n]=s,s.addEventListener("change",()=>{ve.set(n,{key:s.value,shift:!1,ctrl:!1,alt:!1}),document.dispatchEvent(new CustomEvent("synth:signalFlowKeyChanged",{detail:{key:s.value}}))}),i.appendChild(s),e.appendChild(t),e.appendChild(i),e}_startShortcutCapture(e,t,n){this._activeShortcutCapture&&this._cancelShortcutCapture(),e.classList.add("recording"),e.value=u("settings.shortcuts.press"),n.style.display="none",this._activeShortcutCapture={input:e,actionId:t,conflictSpan:n,handler:i=>{if(["Shift","Control","Alt","Meta"].includes(i.key))return;i.preventDefault(),i.stopPropagation();let s=i.key.toUpperCase();if(ve.isReservedKey(s)){e.value=u("settings.shortcuts.reserved"),e.classList.add("conflict"),setTimeout(()=>{this._cancelShortcutCapture();let l=ve.get(t);e.value=l?ve.formatBinding(l):u("settings.shortcuts.none"),e.classList.remove("conflict"),l||e.classList.add("empty")},1500);return}let a={key:s,shift:i.shiftKey,ctrl:i.ctrlKey,alt:i.altKey},r=ve.set(t,a);r.conflict?(e.classList.add("conflict"),n.textContent=u("settings.shortcuts.conflict").replace("{action}",u(`settings.shortcuts.${r.conflict}`)),n.style.display="inline",e.value=ve.formatBinding(a),setTimeout(()=>{let l=ve.get(t);e.value=l?ve.formatBinding(l):u("settings.shortcuts.none"),e.classList.remove("conflict"),n.style.display="none",l||e.classList.add("empty")},2e3)):(e.value=ve.formatBinding(a),e.classList.remove("empty")),this._endShortcutCapture()}},document.addEventListener("keydown",this._activeShortcutCapture.handler,!0),this._activeShortcutCapture.blurHandler=()=>{this._cancelShortcutCapture()},e.addEventListener("blur",this._activeShortcutCapture.blurHandler)}_endShortcutCapture(){if(!this._activeShortcutCapture)return;let{input:e,handler:t,blurHandler:n}=this._activeShortcutCapture;e.classList.remove("recording"),document.removeEventListener("keydown",t,!0),e.removeEventListener("blur",n),this._activeShortcutCapture=null}_cancelShortcutCapture(){if(!this._activeShortcutCapture)return;let{input:e,actionId:t}=this._activeShortcutCapture,n=ve.get(t);e.value=n?ve.formatBinding(n):u("settings.shortcuts.none"),n||e.classList.add("empty"),this._endShortcutCapture()}_updateAllShortcutInputs(){if(this.shortcutInputs)for(let[e,t]of Object.entries(this.shortcutInputs)){let n=ve.get(e);if(e==="showPanelHints"&&t.tagName==="SELECT"){t.value=n?.key||"Alt";continue}t.value=n?ve.formatBinding(n):u("settings.shortcuts.none"),t.classList.remove("conflict"),n?t.classList.remove("empty"):t.classList.add("empty");let i=t.closest(".settings-shortcut-row")?.querySelector(".settings-shortcut-conflict");i&&(i.style.display="none")}}_setAutoSaveInterval(e){Di.hasOwnProperty(e)&&(this.autoSaveInterval=e,localStorage.setItem(v.AUTOSAVE_INTERVAL,e),this.onAutoSaveIntervalChange&&this.onAutoSaveIntervalChange(Di[e],e))}_setSaveOnExit(e){this.saveOnExit=e,localStorage.setItem(v.SAVE_ON_EXIT,String(e)),this.onSaveOnExitChange&&this.onSaveOnExitChange(e)}_setRestoreOnStart(e){this.restoreOnStart=e,localStorage.setItem(v.RESTORE_ON_START,String(e)),this.onRestoreOnStartChange&&this.onRestoreOnStartChange(e)}_setAskBeforeRestore(e){this.askBeforeRestore=e,localStorage.setItem(v.ASK_BEFORE_RESTORE,String(e)),e&&Ie.clearRememberedChoice("restore-last-session")}_updateAskBeforeRestoreVisibility(){this.askBeforeRestoreRow&&(this.askBeforeRestoreRow.style.display=this.restoreOnStart?"flex":"none")}setAskBeforeRestore(e){this.askBeforeRestore=e,localStorage.setItem(v.ASK_BEFORE_RESTORE,String(e)),this.askBeforeRestoreCheckbox&&(this.askBeforeRestoreCheckbox.checked=e)}getAskBeforeRestore(){return this.askBeforeRestore}getAutoSaveIntervalMs(){return Di[this.autoSaveInterval]||0}getSaveOnExit(){return this.saveOnExit}getRestoreOnStart(){return this.restoreOnStart}_showUpdateAvailable(){this.updateCheckBtn.textContent=u("settings.updates.installAndReload"),this.updateCheckBtn.classList.add("settings-update-btn--available"),this.updateStatusElement.textContent=u("settings.updates.pendingInstall"),this.updateStatusElement.className="settings-update-status settings-update-status--available",this._isUpdateAvailable=!0}async _handleCheckUpdate(){if(typeof window.oscAPI<"u"){window.open("https://github.com/mesjetiu/SynthiGME-web/releases","_blank");return}if(this._isUpdateAvailable||ds()){this.updateCheckBtn.disabled=!0,this.updateCheckBtn.textContent=u("settings.updates.installing"),Tc();return}this.updateCheckBtn.disabled=!0,this.updateCheckBtn.textContent=u("settings.updates.checking"),this.updateStatusElement.textContent="",this.updateStatusElement.className="settings-update-status";try{let t=await Rc();t.error?(this.updateStatusElement.textContent=u("settings.updates.error"),this.updateStatusElement.className="settings-update-status settings-update-status--error"):t.found?this._showUpdateAvailable():(this.updateStatusElement.textContent=u("settings.updates.upToDate"),this.updateStatusElement.className="settings-update-status settings-update-status--ok")}catch{this.updateStatusElement.textContent=u("settings.updates.error"),this.updateStatusElement.className="settings-update-status settings-update-status--error"}this.updateCheckBtn.disabled=!1,this._isUpdateAvailable||(this.updateCheckBtn.textContent=u("settings.updates.check"))}_setResolution(e){e!==this.currentResolution&&(this.currentResolution=e,this.rememberResolution&&localStorage.setItem(v.RESOLUTION,e),this.resolutionSelect&&(this.resolutionSelect.value=String(e)),this.onResolutionChange&&this.onResolutionChange(e),typeof window.__synthSetResolutionFactor=="function"&&window.__synthSetResolutionFactor(e),this.isMobile&&e>this.mobileWarningThreshold?se(u("toast.resolution.mobileWarning",{factor:e}),{level:"warning"}):se(u("toast.resolution",{factor:e})))}_updateTexts(){if(this.titleElement&&(this.titleElement.textContent=u("settings.title")),this.languageTitleElement&&(this.languageTitleElement.textContent=u("settings.language")),this.resolutionTitleElement&&(this.resolutionTitleElement.textContent=u("settings.scale")),this.resolutionDescElement&&(this.resolutionDescElement.textContent=u("settings.scale.description")),this.updatesTitleElement&&(this.updatesTitleElement.textContent=u("settings.updates")),this.versionLabelElement&&(this.versionLabelElement.textContent=u("settings.updates.version")),this.updateCheckBtn&&!this.updateCheckBtn.disabled&&(this._isUpdateAvailable?this.updateCheckBtn.textContent=u("settings.updates.install"):this.updateCheckBtn.textContent=u("settings.updates.check")),this.updateStatusElement){let t=this.updateStatusElement.className;t.includes("--available")?this.updateStatusElement.textContent=u("settings.updates.available"):t.includes("--ok")?this.updateStatusElement.textContent=u("settings.updates.upToDate"):t.includes("--error")&&(this.updateStatusElement.textContent=u("settings.updates.error"))}if(this.languageSelect&&this.languageSelect.querySelectorAll("option").forEach(n=>{n.textContent=u(`settings.language.${n.value}`)}),this.autoSaveTitleElement&&(this.autoSaveTitleElement.textContent=u("settings.autosave")),this.autoSaveDescElement&&(this.autoSaveDescElement.textContent=u("settings.autosave.description")),this.intervalLabelElement&&(this.intervalLabelElement.textContent=u("settings.autosave.interval")),this.intervalSelect&&this.intervalSelect.querySelectorAll("option").forEach(n=>{n.textContent=u(`settings.autosave.interval.${n.value}`)}),this.saveOnExitLabelElement&&(this.saveOnExitLabelElement.textContent=u("settings.autosave.onExit")),this.restoreOnStartLabelElement&&(this.restoreOnStartLabelElement.textContent=u("settings.autosave.restoreOnStart")),this.askBeforeRestoreLabelElement&&(this.askBeforeRestoreLabelElement.textContent=u("settings.autosave.askBeforeRestore")),this.wakeLockTitleElement&&(this.wakeLockTitleElement.textContent=u("settings.wakelock")),this.wakeLockDescElement){let t=Qn.isSupported();this.wakeLockDescElement.textContent=t?u("settings.wakelock.description"):u("settings.wakelock.unsupported")}this.wakeLockLabelElement&&(this.wakeLockLabelElement.textContent=u("settings.wakelock")),this.telemetryTitleElement&&(this.telemetryTitleElement.textContent=u("settings.telemetry")),this.telemetryDescElement&&(this.telemetryDescElement.textContent=u("settings.telemetry.description")),this.telemetryEnabledLabelElement&&(this.telemetryEnabledLabelElement.textContent=u("settings.telemetry.label")),this.confirmResetLabelElement&&(this.confirmResetLabelElement.textContent=u("settings.synth.confirmReset")),this.resetTitleElement&&(this.resetTitleElement.textContent=u("settings.reset")),this.resetDescElement&&(this.resetDescElement.textContent=u("settings.reset.description")),this.resetBtn&&(this.resetBtn.textContent=u("settings.reset.button")),this.recordingTitleElement&&(this.recordingTitleElement.textContent=u("settings.recording")),this.recordingDescElement&&(this.recordingDescElement.textContent=u("settings.recording.description")),this.recordingSettingsBtn&&(this.recordingSettingsBtn.textContent=u("settings.recording.configure"));let e=this.modal?.querySelector(".settings-modal__close");if(e&&e.setAttribute("aria-label",u("settings.close")),this.tabButtons&&(this.tabButtons.general&&(this.tabButtons.general.textContent=u("settings.tab.general")),this.tabButtons.interface&&(this.tabButtons.interface.textContent=u("settings.tab.interface")),this.tabButtons.audio&&(this.tabButtons.audio.textContent=u("settings.tab.audio")),this.tabButtons.advanced&&(this.tabButtons.advanced.textContent=u("settings.tab.advanced")),this.tabButtons.about&&(this.tabButtons.about.textContent=u("settings.tab.about"))),this.inactivePinsTitleElement&&(this.inactivePinsTitleElement.textContent=u("settings.display.inactivePins")),this.inactivePinsDescElement&&(this.inactivePinsDescElement.textContent=u("settings.display.inactivePins.description")),this.inactivePinsLabelElement&&(this.inactivePinsLabelElement.textContent=u("settings.display.inactivePins.show")),this.sharpRasterizeTitleElement&&(this.sharpRasterizeTitleElement.textContent=u("settings.display.sharpRasterize")),this.sharpRasterizeDescElement&&(this.sharpRasterizeDescElement.textContent=u("settings.display.sharpRasterize.description")),this.sharpRasterizeLabelElement&&(this.sharpRasterizeLabelElement.textContent=u("settings.display.sharpRasterize.enable")),this.pipTitleElement&&(this.pipTitleElement.textContent=u("settings.display.pip")),this.pipDescElement&&(this.pipDescElement.textContent=u("settings.display.pip.description")),this.pipRememberLabelElement&&(this.pipRememberLabelElement.textContent=u("settings.display.pip.remember")),this.paramInfoTitleElement&&(this.paramInfoTitleElement.textContent=u("settings.display.paramInfo")),this.paramInfoDescElement&&(this.paramInfoDescElement.textContent=u("settings.display.paramInfo.description")),this.tooltipVoltageLabelElement&&(this.tooltipVoltageLabelElement.textContent=u("settings.display.paramInfo.voltage")),this.tooltipAudioLabelElement&&(this.tooltipAudioLabelElement.textContent=u("settings.display.paramInfo.audio")),this.glowTitleElement&&(this.glowTitleElement.textContent=u("settings.display.glow")),this.glowDescElement&&(this.glowDescElement.textContent=u("settings.display.glow.description")),this._glowRadios)for(let t of Ma()){let n=this._glowRadios[t]?.parentElement?.querySelector("label");n&&(n.textContent=u(`settings.display.glow.${t}`))}if(this.faderResponseTitleElement&&(this.faderResponseTitleElement.textContent=u("settings.display.faderResponse")),this.faderResponseDescElement&&(this.faderResponseDescElement.textContent=u("settings.display.faderResponse.description")),this.faderLinearLabelElement&&(this.faderLinearLabelElement.textContent=u("settings.display.faderResponse.linear")),this.knobStyleTitleElement&&(this.knobStyleTitleElement.textContent=u("settings.display.knobStyle")),this.knobStyleDescElement&&(this.knobStyleDescElement.textContent=u("settings.display.knobStyle.description")),this.aboutDescElement&&(this.aboutDescElement.textContent=u("settings.about.description")),this.aboutInfoTitleElement&&(this.aboutInfoTitleElement.textContent=u("settings.about.info")),this.aboutVersionLabelElement&&(this.aboutVersionLabelElement.textContent=u("settings.about.version")),this.aboutAuthorLabelElement&&(this.aboutAuthorLabelElement.textContent=u("settings.about.author")),this.aboutLicenseLabelElement&&(this.aboutLicenseLabelElement.textContent=u("settings.about.license")),this.aboutLinksTitleElement&&(this.aboutLinksTitleElement.textContent=u("settings.about.links")),this.aboutRepoLinkElement&&(this.aboutRepoLinkElement.textContent=u("settings.about.repository")),this.aboutIssuesLinkElement&&(this.aboutIssuesLinkElement.textContent=u("settings.about.issues")),this.aboutTelegramLinkElement&&(this.aboutTelegramLinkElement.textContent=u("settings.about.telegram")),this.aboutOriginalLinkElement&&(this.aboutOriginalLinkElement.textContent=u("settings.about.originalProject")),this.aboutCreditsTitleElement&&(this.aboutCreditsTitleElement.textContent=u("settings.about.credits")),this.aboutAppIconsLabelElement&&(this.aboutAppIconsLabelElement.textContent=u("settings.about.credits.appIcons")),this.aboutUiIconsLabelElement&&(this.aboutUiIconsLabelElement.textContent=u("settings.about.credits.uiIcons")),this.aboutInspirationLabelElement&&(this.aboutInspirationLabelElement.textContent=u("settings.about.credits.inspiration")),this.shortcutsTitleElement&&(this.shortcutsTitleElement.textContent=u("settings.shortcuts")),this.shortcutsDescElement&&(this.shortcutsDescElement.textContent=u("settings.shortcuts.description")),this.resetShortcutsButton&&(this.resetShortcutsButton.textContent=u("settings.shortcuts.resetDefaults")),this.shortcutInputs&&this.modal?.querySelectorAll(".settings-shortcut-row")?.forEach(n=>{let i=n.querySelector(".settings-shortcut-label");i?.dataset.i18n&&(i.textContent=u(i.dataset.i18n));let s=n.querySelector(".settings-shortcut-input");s?.classList.contains("empty")&&(s.value=u("settings.shortcuts.none"))}),this.optimizationsTitleElement&&(this.optimizationsTitleElement.textContent=u("settings.optimizations")),this.optimizationsDescElement&&(this.optimizationsDescElement.textContent=u("settings.optimizations.description")),this.optimizationsDebugLabelElement&&(this.optimizationsDebugLabelElement.textContent=u("settings.optimizations.debugGlobal")),this.dormancyTitleElement&&(this.dormancyTitleElement.textContent=u("settings.dormancy")),this.dormancyDescElement&&(this.dormancyDescElement.textContent=u("settings.dormancy.description")),this.dormancyEnabledLabelElement&&(this.dormancyEnabledLabelElement.textContent=u("settings.dormancy.enabled")),this.dormancyDebugLabelElement&&(this.dormancyDebugLabelElement.textContent=u("settings.dormancy.debug")),this.filterBypassTitleElement&&(this.filterBypassTitleElement.textContent=u("settings.filterBypass")),this.filterBypassDescElement&&(this.filterBypassDescElement.textContent=u("settings.filterBypass.description")),this.filterBypassEnabledLabelElement&&(this.filterBypassEnabledLabelElement.textContent=u("settings.filterBypass.enabled")),this.filterBypassDebugLabelElement&&(this.filterBypassDebugLabelElement.textContent=u("settings.filterBypass.debug")),this.latencyModeTitleElement&&(this.latencyModeTitleElement.textContent=u("settings.latencyMode")),this.latencyModeDescElement&&(this.latencyModeDescElement.textContent=u("settings.latencyMode.description")),this.latencyModeSelect){let t={interactive:"settings.latencyMode.interactive",balanced:"settings.latencyMode.balanced",playback:"settings.latencyMode.playback","0.1":"settings.latencyMode.safe","0.2":"settings.latencyMode.maximum"};this.latencyModeSelect.querySelectorAll("option").forEach(i=>{let s=t[i.value];s&&(i.textContent=u(s))})}}destroy(){this._unsubscribeLocale&&this._unsubscribeLocale(),this.overlay&&this.overlay.parentNode&&this.overlay.parentNode.removeChild(this.overlay)}};Oe();Oe();var Oo=null,hs=class o{constructor(){this.overlay=null,this.modal=null,this.titleEl=null,this.inputEl=null,this.confirmBtn=null,this.cancelBtn=null,this._resolve=null,this._create(),this._unsubscribeLocale=Pe(()=>this._updateDefaultTexts())}static async show(e){return Oo||(Oo=new o),Oo._show(e)}_create(){this.overlay=document.createElement("div"),this.overlay.className="input-dialog-overlay",this.overlay.setAttribute("aria-hidden","true"),this.modal=document.createElement("div"),this.modal.className="input-dialog",this.modal.setAttribute("role","dialog"),this.modal.setAttribute("aria-modal","true"),this.modal.setAttribute("aria-labelledby","inputDialogTitle"),this.titleEl=document.createElement("h2"),this.titleEl.id="inputDialogTitle",this.titleEl.className="input-dialog__title",this.inputEl=document.createElement("input"),this.inputEl.type="text",this.inputEl.className="input-dialog__input",this.inputEl.autocomplete="off",this.inputEl.spellcheck=!1,this.inputEl.addEventListener("keydown",t=>{t.key==="Enter"&&this._resolve&&(t.preventDefault(),this._handleResponse(!0))});let e=document.createElement("div");e.className="input-dialog__buttons",this.cancelBtn=document.createElement("button"),this.cancelBtn.type="button",this.cancelBtn.className="input-dialog__btn input-dialog__btn--cancel",this.cancelBtn.textContent=u("common.cancel"),this.cancelBtn.addEventListener("click",()=>this._handleResponse(!1)),this.confirmBtn=document.createElement("button"),this.confirmBtn.type="button",this.confirmBtn.className="input-dialog__btn input-dialog__btn--confirm",this.confirmBtn.textContent=u("common.ok"),this.confirmBtn.addEventListener("click",()=>this._handleResponse(!0)),e.appendChild(this.cancelBtn),e.appendChild(this.confirmBtn),this.modal.appendChild(this.titleEl),this.modal.appendChild(this.inputEl),this.modal.appendChild(e),this.overlay.appendChild(this.modal),document.addEventListener("keydown",t=>{t.key==="Escape"&&this._resolve&&this._handleResponse(!1)}),document.body.appendChild(this.overlay)}_updateDefaultTexts(){this.overlay.classList.contains("input-dialog-overlay--visible")||(this.cancelBtn.textContent=u("common.cancel"),this.confirmBtn.textContent=u("common.ok"))}async _show(e){let{title:t,placeholder:n="",defaultValue:i="",confirmText:s,cancelText:a}=e;return this.titleEl.textContent=t,this.inputEl.placeholder=n,this.inputEl.value=i,s&&(this.confirmBtn.textContent=s),a&&(this.cancelBtn.textContent=a),this.overlay.classList.add("input-dialog-overlay--visible"),this.overlay.setAttribute("aria-hidden","false"),requestAnimationFrame(()=>{this.inputEl.focus(),this.inputEl.select()}),new Promise(r=>{this._resolve=r})}_handleResponse(e){let t=this.inputEl.value.trim();this.overlay.classList.remove("input-dialog-overlay--visible"),this.overlay.setAttribute("aria-hidden","true"),this._resolve&&(this._resolve({confirmed:e,value:t}),this._resolve=null)}destroy(){this._unsubscribeLocale&&this._unsubscribeLocale(),this.overlay&&this.overlay.parentNode&&this.overlay.parentNode.removeChild(this.overlay),Oo=null}};be();Te();Xn();po();function Io(o="Init"){return{formatVersion:2,appVersion:window.__synthBuildVersion||"dev",savedAt:new Date().toISOString(),name:o,modules:{},matrix:{audio:[],control:[]},routing:{outputs:{},inputs:{}}}}be();be();var xb=W("Migrations");function _r(o){return(o.formatVersion||1)<2}be();var ih=W("Storage"),sh="synthigme-patches",oh=1,Kt="patches";var Do=null;async function Bo(){return Do||new Promise((o,e)=>{let t=indexedDB.open(sh,oh);t.onerror=()=>{ih.error(" Error opening IndexedDB:",t.error),e(t.error)},t.onsuccess=()=>{Do=t.result,o(Do)},t.onupgradeneeded=n=>{let i=n.target.result;if(!i.objectStoreNames.contains(Kt)){let s=i.createObjectStore(Kt,{keyPath:"id",autoIncrement:!0});s.createIndex("name","name",{unique:!1}),s.createIndex("savedAt","savedAt",{unique:!1}),s.createIndex("category","category",{unique:!1})}}})}async function xi(o,e=null){let t=await Bo();return new Promise((n,i)=>{let a=t.transaction([Kt],"readwrite").objectStore(Kt),r={...o,formatVersion:o.formatVersion??2,appVersion:o.appVersion||window.__synthBuildVersion||"dev",savedAt:new Date().toISOString()};e!==null&&(r.id=e);let l=e!==null?a.put(r):a.add(r);l.onsuccess=()=>n(l.result),l.onerror=()=>i(l.error)})}async function ps(o){let e=await Bo();return new Promise((t,n)=>{let a=e.transaction([Kt],"readonly").objectStore(Kt).get(o);a.onsuccess=()=>t(a.result||null),a.onerror=()=>n(a.error)})}async function Cr(o={}){let{sortBy:e="savedAt",descending:t=!0}=o,n=await Bo();return new Promise((i,s)=>{let l=n.transaction([Kt],"readonly").objectStore(Kt).getAll();l.onsuccess=()=>{let c=l.result.map(d=>({id:d.id,name:d.name,savedAt:d.savedAt,category:d.category,formatVersion:d.formatVersion,appVersion:d.appVersion,hasVisualState:Array.isArray(d.pipState)&&d.pipState.length>0||d.viewportState!=null}));c.sort((d,h)=>{let p=d[e]||"",m=h[e]||"",g=p<m?-1:p>m?1:0;return t?-g:g}),i(c)},l.onerror=()=>s(l.error)})}async function Er(o){let e=await Bo();return new Promise((t,n)=>{let a=e.transaction([Kt],"readwrite").objectStore(Kt).delete(o);a.onsuccess=()=>t(),a.onerror=()=>n(a.error)})}async function Sr(o,e){let t=await ps(o);if(!t)throw new Error(`Patch with id ${o} not found`);t.name=e,await xi(t,o)}function kr(o,e){let n=(e||o.name||"patch").replace(/[^a-z0-9_-]/gi,"_"),i=JSON.stringify(o,null,2),s=new Blob([i],{type:"application/json"}),a=URL.createObjectURL(s),r=document.createElement("a");r.href=a,r.download=`${n}.sgme.json`,r.style.display="none",document.body.appendChild(r),setTimeout(()=>{r.click(),document.body.removeChild(r),URL.revokeObjectURL(a)},0)}function wr(){return new Promise((o,e)=>{let t=document.createElement("input");t.type="file",t.accept=".json,.sgme.json",t.onchange=async n=>{let i=n.target.files[0];if(!i){e(new Error("No file selected"));return}try{let s=await i.text(),a=JSON.parse(s);o(a)}catch(s){e(new Error(`Failed to parse file: ${s.message}`))}},t.click()})}var $b=W("State");var pt=W("PatchBrowser"),ah="./assets/icons/ui-sprite.svg";function zo(o){return`
    <svg viewBox="0 0 24 24" width="18" height="18" aria-hidden="true" focusable="false"
      fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <use href="${ah}#${o}"></use>
    </svg>
  `}var Fo=class{constructor(e={}){this.onLoad=e.onLoad,this.onSave=e.onSave,this.patches=[],this.selectedPatchId=null,this.searchQuery="",this.modal=null,this.patchList=null,this.searchInput=null,this.nameInput=null,this.saveNewBtn=null,this.overwriteBtn=null,this.includeVisualCheckbox=null,this.isOpen=!1,this._isDragging=!1,this._dragOffset={x:0,y:0},this._dragPointerId=null,this._create(),this._unsubscribeLocale=Pe(()=>this._updateTexts())}async open(){this.isOpen||(this.isOpen=!0,await this._loadPatches(),this._render(),this.modal.style.left||this._centerModal(),this.modal.classList.add("patch-browser-modal--visible"),this.modal.setAttribute("aria-hidden","false"),document.dispatchEvent(new CustomEvent("synth:patchBrowserChanged",{detail:{open:!0}})),requestAnimationFrame(()=>{this.nameInput?.focus(),this.nameInput?.select()}))}close(){this.isOpen&&(this.isOpen=!1,this.modal.classList.remove("patch-browser-modal--visible"),this.modal.setAttribute("aria-hidden","true"),this.selectedPatchId=null,this._updateActionButtons(),document.dispatchEvent(new CustomEvent("synth:patchBrowserChanged",{detail:{open:!1}})))}toggle(){this.isOpen?this.close():this.open()}async _loadPatches(){try{this.patches=await Cr({sortBy:"savedAt",descending:!0})}catch(e){pt.error(" Error loading patches:",e),this.patches=[]}}_create(){this.modal=document.createElement("div"),this.modal.className="patch-browser-modal",this.modal.setAttribute("role","dialog"),this.modal.setAttribute("aria-labelledby","patchBrowserTitle"),this.modal.setAttribute("aria-hidden","true");let e=document.createElement("div");e.className="patch-browser__header",this._setupDrag(e),this.titleElement=document.createElement("h2"),this.titleElement.id="patchBrowserTitle",this.titleElement.className="patch-browser__title",this.titleElement.textContent=u("patches.title");let t=document.createElement("button");t.type="button",t.className="patch-browser__close",t.setAttribute("aria-label",u("patches.close")),t.innerHTML="&times;",t.addEventListener("click",()=>this.close()),e.appendChild(this.titleElement),e.appendChild(t);let n=document.createElement("div");n.className="patch-browser__save-zone",this.nameInput=document.createElement("input"),this.nameInput.type="text",this.nameInput.className="patch-browser__name-input",this.nameInput.placeholder=u("patches.defaultName"),this.nameInput.value=u("patches.defaultName"),this.nameInput.autocomplete="off",this.nameInput.spellcheck=!1,this.nameInput.addEventListener("input",()=>this._updateSaveButtons()),this.nameInput.addEventListener("keydown",d=>{d.key==="Enter"&&(d.preventDefault(),this.selectedPatchId!==null&&!this.overwriteBtn.disabled?this._handleOverwrite():this._handleSaveNew())});let i=document.createElement("div");i.className="patch-browser__save-buttons",this.saveNewBtn=document.createElement("button"),this.saveNewBtn.type="button",this.saveNewBtn.className="patch-browser__btn patch-browser__btn--primary",this.saveNewBtn.innerHTML=`${zo("ti-device-floppy")} <span>${u("patches.saveNew")}</span>`,this.saveNewBtn.addEventListener("click",()=>this._handleSaveNew()),this.overwriteBtn=document.createElement("button"),this.overwriteBtn.type="button",this.overwriteBtn.className="patch-browser__btn patch-browser__btn--overwrite",this.overwriteBtn.innerHTML=`${zo("ti-device-floppy")} <span>${u("patches.overwrite")}</span>`,this.overwriteBtn.disabled=!0,this.overwriteBtn.addEventListener("click",()=>this._handleOverwrite()),i.appendChild(this.saveNewBtn),i.appendChild(this.overwriteBtn);let s=document.createElement("label");s.className="patch-browser__visual-check",this.includeVisualCheckbox=document.createElement("input"),this.includeVisualCheckbox.type="checkbox",this.includeVisualCheckbox.checked=this._getVisualPref(),this.includeVisualCheckbox.addEventListener("change",()=>{this._setVisualPref(this.includeVisualCheckbox.checked)}),this.includeVisualLabel=document.createElement("span"),this.includeVisualLabel.textContent=u("patches.includeVisual"),s.appendChild(this.includeVisualCheckbox),s.appendChild(this.includeVisualLabel),n.appendChild(this.nameInput),n.appendChild(i),n.appendChild(s);let a=document.createElement("div");a.className="patch-browser__controls";let r=document.createElement("div");r.className="patch-browser__search",r.innerHTML=zo("ti-search"),this.searchInput=document.createElement("input"),this.searchInput.type="text",this.searchInput.className="patch-browser__search-input",this.searchInput.placeholder=u("patches.search"),this.searchInput.addEventListener("input",d=>{this.searchQuery=d.target.value.toLowerCase(),this._render()}),r.appendChild(this.searchInput);let l=document.createElement("div");l.className="patch-browser__actions",this.loadBtn=document.createElement("button"),this.loadBtn.type="button",this.loadBtn.className="patch-browser__action-btn",this.loadBtn.textContent=u("patches.load"),this.loadBtn.disabled=!0,this.loadBtn.addEventListener("click",()=>this._handleLoad()),this.exportBtn=document.createElement("button"),this.exportBtn.type="button",this.exportBtn.className="patch-browser__action-btn",this.exportBtn.textContent=u("patches.export"),this.exportBtn.disabled=!0,this.exportBtn.addEventListener("click",()=>this._handleExport()),this.renameBtn=document.createElement("button"),this.renameBtn.type="button",this.renameBtn.className="patch-browser__action-btn",this.renameBtn.textContent=u("patches.rename"),this.renameBtn.disabled=!0,this.renameBtn.addEventListener("click",()=>this._handleRename()),this.deleteBtn=document.createElement("button"),this.deleteBtn.type="button",this.deleteBtn.className="patch-browser__action-btn patch-browser__action-btn--danger",this.deleteBtn.textContent=u("patches.delete"),this.deleteBtn.disabled=!0,this.deleteBtn.addEventListener("click",()=>this._handleDelete()),l.appendChild(this.loadBtn),l.appendChild(this.exportBtn),l.appendChild(this.renameBtn),l.appendChild(this.deleteBtn),a.appendChild(r),a.appendChild(l),this.patchList=document.createElement("div"),this.patchList.className="patch-browser__list";let c=document.createElement("div");c.className="patch-browser__footer",this.importBtn=document.createElement("button"),this.importBtn.type="button",this.importBtn.className="patch-browser__btn",this.importBtn.innerHTML=`${zo("ti-upload")} <span>${u("patches.import")}</span>`,this.importBtn.addEventListener("click",()=>this._handleImport()),c.appendChild(this.importBtn),this.modal.appendChild(e),this.modal.appendChild(n),this.modal.appendChild(a),this.modal.appendChild(this.patchList),this.modal.appendChild(c),document.addEventListener("keydown",d=>{d.key==="Escape"&&this.isOpen&&this.close()}),document.body.appendChild(this.modal)}_setupDrag(e){e.style.cursor="grab",e.style.touchAction="none",e.addEventListener("pointerdown",t=>{if(t.button!==0||t.target.closest(".patch-browser__close"))return;this._isDragging=!0,this._dragPointerId=t.pointerId;let n=this.modal.getBoundingClientRect();this._dragOffset.x=t.clientX-n.left,this._dragOffset.y=t.clientY-n.top,this.modal.classList.add("patch-browser-modal--dragging"),e.style.cursor="grabbing",e.setPointerCapture(t.pointerId),t.preventDefault()}),e.addEventListener("pointermove",t=>{if(!this._isDragging||t.pointerId!==this._dragPointerId)return;let n=Math.max(0,Math.min(window.innerWidth-60,t.clientX-this._dragOffset.x)),i=Math.max(0,Math.min(window.innerHeight-40,t.clientY-this._dragOffset.y));this.modal.style.left=`${n}px`,this.modal.style.top=`${i}px`}),e.addEventListener("pointerup",t=>{if(!(!this._isDragging||t.pointerId!==this._dragPointerId)){this._isDragging=!1,this._dragPointerId=null,this.modal.classList.remove("patch-browser-modal--dragging"),e.style.cursor="grab";try{e.releasePointerCapture(t.pointerId)}catch{}}}),e.addEventListener("pointercancel",t=>{!this._isDragging||t.pointerId!==this._dragPointerId||(this._isDragging=!1,this._dragPointerId=null,this.modal.classList.remove("patch-browser-modal--dragging"),e.style.cursor="grab")})}_centerModal(){this.modal.style.visibility="hidden",this.modal.style.opacity="0",this.modal.style.display="flex";let e=this.modal.getBoundingClientRect(),t=Math.max(0,(window.innerWidth-e.width)/2),n=Math.max(0,(window.innerHeight-e.height)/2);this.modal.style.left=`${t}px`,this.modal.style.top=`${n}px`,this.modal.style.removeProperty("visibility"),this.modal.style.removeProperty("opacity"),this.modal.style.removeProperty("display")}_render(){this.patchList.innerHTML="";let e=this.patches.filter(t=>!this.searchQuery||t.name.toLowerCase().includes(this.searchQuery));if(e.length===0){let t=document.createElement("div");t.className="patch-browser__empty",t.textContent=this.searchQuery?u("patches.search")+": "+this.searchQuery:u("patches.empty"),this.patchList.appendChild(t);return}for(let t of e){let n=this._createPatchItem(t);this.patchList.appendChild(n)}}_createPatchItem(e){let t=document.createElement("div");t.className="patch-browser__item",t.dataset.id=e.id,e.id===this.selectedPatchId&&t.classList.add("patch-browser__item--selected");let n=document.createElement("span");n.className="patch-browser__radio",n.innerHTML=e.id===this.selectedPatchId?"\u25CF":"\u25CB";let i=document.createElement("div");i.className="patch-browser__item-info";let s=document.createElement("div");if(s.className="patch-browser__item-name",s.textContent=e.name,_r(e)){let r=document.createElement("span");r.className="patch-browser__version-badge",r.textContent="\u26A0\uFE0F",r.title=u("patches.versionWarning"),s.appendChild(r)}if(e.hasVisualState){let r=document.createElement("span");r.className="patch-browser__visual-badge",r.textContent="\u{1F5BC}",r.title=u("patches.hasVisual"),s.appendChild(r)}let a=document.createElement("div");return a.className="patch-browser__item-date",a.textContent=this._formatDate(e.savedAt),i.appendChild(s),i.appendChild(a),t.appendChild(n),t.appendChild(i),t.addEventListener("click",()=>{this._selectPatch(e.id)}),t.addEventListener("dblclick",()=>{this._selectPatch(e.id),this._handleLoadDirect()}),t}_selectPatch(e){if(this.selectedPatchId===e)this.selectedPatchId=null,this.nameInput.value=u("patches.defaultName");else{this.selectedPatchId=e;let t=this.patches.find(n=>n.id===e);t&&(this.nameInput.value=t.name)}this._render(),this._updateActionButtons(),this._updateSaveButtons()}_updateActionButtons(){let e=this.selectedPatchId!==null;this.loadBtn.disabled=!e,this.exportBtn.disabled=!e,this.renameBtn.disabled=!e,this.deleteBtn.disabled=!e}_updateSaveButtons(){let e=this.nameInput.value.trim();this.saveNewBtn.disabled=!e,this.overwriteBtn.disabled=!e||this.selectedPatchId===null}_formatDate(e){if(!e)return"";try{return new Date(e).toLocaleDateString(void 0,{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return e}}_getVisualPref(){return localStorage.getItem(v.PATCH_INCLUDE_VISUAL)!=="false"}_setVisualPref(e){localStorage.setItem(v.PATCH_INCLUDE_VISUAL,String(e))}_maybeAddVisualState(e){return this.includeVisualCheckbox?.checked&&(e.pipState=So(),typeof window.__synthSerializeViewportState=="function"&&(e.viewportState=window.__synthSerializeViewportState()),e.notesState=ar()),e}_maybeRestoreVisualState(e){if(this.includeVisualCheckbox?.checked){if(e?.pipState&&Array.isArray(e.pipState)){Ei();for(let t of e.pipState)document.getElementById(t.panelId)&&wn(t.panelId,t);pt.info("Visual layout restored:",e.pipState.length,"PIPs")}if(e?.notesState&&Array.isArray(e.notesState)&&(rr(e.notesState),pt.info("Notas restauradas:",e.notesState.length)),e?.viewportState&&typeof window.__synthRestoreViewportState=="function"){let t=e.viewportState;requestAnimationFrame(()=>{requestAnimationFrame(()=>{window.__synthRestoreViewportState(t),pt.info("Viewport state restored")})})}}}async _handleSaveNew(){let e=this.nameInput.value.trim();if(e)try{let t;if(this.onSave){let n=await this.onSave();t={name:e,...n}}else t=Io(e);this._maybeAddVisualState(t),await xi(t),await this._loadPatches(),this._render(),se(u("patches.saved"),{level:"success"})}catch(t){pt.error(" Error saving:",t),se(u("patches.errorSaving"),{level:"error"})}}async _handleOverwrite(){if(this.selectedPatchId===null)return;let e=this.nameInput.value.trim();if(!e)return;let t=this.patches.find(i=>i.id===this.selectedPatchId);if(!(!t||!(await Ie.show({title:u("patches.confirmOverwrite",{name:t.name}),confirmText:u("common.yes"),cancelText:u("common.no")})).confirmed))try{let i;if(this.onSave){let s=await this.onSave();i={name:e,...s}}else i=Io(e);this._maybeAddVisualState(i),await xi(i,this.selectedPatchId),await this._loadPatches(),this._render(),se(u("patches.overwritten"),{level:"success"})}catch(i){pt.error(" Error overwriting:",i),se(u("patches.errorSaving"),{level:"error"})}}async _handleSave(){if(this.selectedPatchId!==null)await this._handleOverwrite();else if(this.nameInput?.value?.trim()&&this.isOpen)await this._handleSaveNew();else{let t=await hs.show({title:u("patches.namePrompt"),placeholder:u("patches.defaultName"),defaultValue:u("patches.defaultName"),confirmText:u("patches.saveCurrent"),cancelText:u("common.cancel")});if(!t.confirmed||!t.value)return;this.nameInput&&(this.nameInput.value=t.value),await this._handleSaveNew()}}async _handleLoad(){if(!this.selectedPatchId)return;let e=this.patches.find(n=>n.id===this.selectedPatchId);!e||!(await Ie.show({title:u("patches.confirmLoad",{name:e.name}),confirmText:u("common.yes"),cancelText:u("common.no")})).confirmed||await this._loadPatchById(this.selectedPatchId,e.name)}async _handleLoadDirect(){if(!this.selectedPatchId)return;let e=this.patches.find(t=>t.id===this.selectedPatchId);e&&await this._loadPatchById(this.selectedPatchId,e.name)}async _loadPatchById(e,t){try{let n=await ps(e);this.onLoad&&this.onLoad(n),this._maybeRestoreVisualState(n),se(u("patches.loadedName",{name:t}))}catch(n){pt.error(" Error loading:",n),se(u("patches.errorLoading"))}}async _handleExport(){if(this.selectedPatchId)try{pt.info(" Exporting patch ID:",this.selectedPatchId);let e=await ps(this.selectedPatchId);pt.info(" Loaded patch:",e?e.name:"null"),e?(kr(e),se(u("patches.exported"),{level:"success"})):(pt.warn(" Patch not found in IndexedDB"),se(u("patches.errorExporting"),{level:"error"}))}catch(e){pt.error(" Error exporting:",e),se(u("patches.errorExporting"),{level:"error"})}}async _handleRename(){if(!this.selectedPatchId)return;let e=this.patches.find(n=>n.id===this.selectedPatchId);if(!e)return;let t=await hs.show({title:u("patches.renamePrompt"),placeholder:e.name,defaultValue:e.name,confirmText:u("patches.rename"),cancelText:u("common.cancel")});if(!(!t.confirmed||!t.value||t.value===e.name))try{await Sr(this.selectedPatchId,t.value),this.nameInput.value=t.value,await this._loadPatches(),this._render(),se(u("patches.renamed"),{level:"success"})}catch(n){pt.error(" Error renaming:",n),se(u("patches.errorRenaming"),{level:"error"})}}async _handleImport(){try{let e=await wr();await xi(e),await this._loadPatches(),this._render(),se(u("patches.imported"),{level:"success"})}catch(e){pt.error(" Error importing:",e)}}async _handleDelete(){if(!this.selectedPatchId)return;let e=this.patches.find(n=>n.id===this.selectedPatchId);if(!(!e||!(await Ie.show({title:u("patches.confirmDelete",{name:e.name}),confirmText:u("common.yes"),cancelText:u("common.no")})).confirmed))try{await Er(this.selectedPatchId),this.selectedPatchId=null,this.nameInput.value=u("patches.defaultName"),await this._loadPatches(),this._render(),this._updateActionButtons(),this._updateSaveButtons(),se(u("patches.deleted"),{level:"success"})}catch(n){pt.error(" Error deleting:",n)}}_updateTexts(){this.titleElement&&(this.titleElement.textContent=u("patches.title")),this.saveNewBtn&&(this.saveNewBtn.querySelector("span").textContent=u("patches.saveNew")),this.overwriteBtn&&(this.overwriteBtn.querySelector("span").textContent=u("patches.overwrite")),this.importBtn&&(this.importBtn.querySelector("span").textContent=u("patches.import")),this.includeVisualLabel&&(this.includeVisualLabel.textContent=u("patches.includeVisual")),this.nameInput&&(this.nameInput.placeholder=u("patches.defaultName")),this.searchInput&&(this.searchInput.placeholder=u("patches.search")),this.loadBtn&&(this.loadBtn.textContent=u("patches.load")),this.exportBtn&&(this.exportBtn.textContent=u("patches.export")),this.renameBtn&&(this.renameBtn.textContent=u("patches.rename")),this.deleteBtn&&(this.deleteBtn.textContent=u("patches.delete"));let e=this.modal?.querySelector(".patch-browser__close");e&&e.setAttribute("aria-label",u("patches.close")),this.isOpen&&this._render()}destroy(){this._unsubscribeLocale&&this._unsubscribeLocale(),this.modal?.parentNode&&this.modal.parentNode.removeChild(this.modal)}};var ei=!1,ti=null,fs=0,bs=0,ys=0,Vo=0,Lr=-9999,Ar=-9999,dn=!1,vs=null,_s=null,Li=null,qo={},rh="electroacoustic",Go={};for(let o=0;o<128;o++)Go[o]=440*Math.pow(2,(o-69)/12);var lh={C:0,D:2,E:4,F:5,G:7,A:9,B:11};function D(o,e){let t=o.includes("#")?1:0;return lh[o[0]]+t+(e+1)*12}var ch=160,Xt=60/ch,uh=[[D("E",5),0,.5],[D("E",5),.5,.5],[D("E",5),1,.5],[D("C",5),1.5,.5],[D("E",5),2,1],[D("G",5),3,1.5],[D("G",4),4.5,1],[D("C",5),6,.75],[D("G",4),6.75,.75],[D("E",4),7.5,.75],[D("A",4),8.5,.5],[D("B",4),9,.5],[D("A#",4),9.5,.25],[D("A",4),9.75,.75],[D("G",4),10.5,.33],[D("E",5),11,.33],[D("G",5),11.33,.33],[D("A",5),11.66,.5],[D("F",5),12.25,.5],[D("G",5),12.75,.25],[D("E",5),13.25,.5],[D("C",5),13.75,.5],[D("D",5),14.25,.5],[D("B",4),14.75,.5],[D("C",5),16,.5],[D("E",5),16.5,.5],[D("G",5),17,.5],[D("C",6),17.5,2]],dh=[[D("C",3),0,1],[D("G",2),1,1],[D("C",3),2,1.5],[D("G",2),3.5,1],[D("E",2),4.5,1.5],[D("C",3),6,.75],[D("G",2),6.75,.75],[D("C",3),7.5,1],[D("F",2),8.5,1],[D("G",2),9.5,1],[D("C",3),10.5,.5],[D("E",3),11,.5],[D("C",3),11.5,.5],[D("A",2),12,.5],[D("F",2),12.5,.5],[D("G",2),13,.5],[D("C",3),13.5,.5],[D("G",2),14,.75],[D("G",2),14.75,.75],[D("C",3),16,.5],[D("E",3),16.5,.5],[D("G",3),17,.5],[D("C",3),17.5,2]],hh=[[D("C",4),0,.25],[D("E",4),.25,.25],[D("G",4),.5,.25],[D("C",4),1,.25],[D("E",4),1.25,.25],[D("G",4),1.5,.25],[D("C",4),2,.25],[D("E",4),2.25,.25],[D("G",4),2.5,.25],[D("C",4),3,.25],[D("E",4),3.25,.25],[D("G",4),3.5,.25],[D("C",4),4,.25],[D("E",4),4.25,.25],[D("G",3),4.5,.25],[D("B",3),4.75,.25],[D("D",4),5,.25],[D("C",4),6,.25],[D("E",4),6.25,.25],[D("G",4),6.5,.25],[D("C",4),7,.25],[D("E",4),7.25,.25],[D("G",4),7.5,.25],[D("F",4),8,.25],[D("A",4),8.25,.25],[D("C",5),8.5,.25],[D("G",4),9,.25],[D("B",4),9.25,.25],[D("D",5),9.5,.25],[D("C",4),10,.25],[D("E",4),10.25,.25],[D("G",4),10.5,.25],[D("C",4),11,.25],[D("E",4),11.25,.25],[D("G",4),11.5,.25],[D("F",4),12,.25],[D("A",4),12.25,.25],[D("C",5),12.5,.25],[D("G",4),13,.25],[D("B",4),13.25,.25],[D("D",5),13.5,.25],[D("G",4),14,.25],[D("B",4),14.25,.25],[D("D",5),14.5,.25],[D("G",4),15,.25],[D("B",4),15.25,.25],[D("D",5),15.5,.25]],ph=[["kick",0,.25],["hat",.5,.1],["kick",1,.25],["hat",1.5,.1],["snare",2,.2],["hat",2.5,.1],["kick",3,.25],["hat",3.5,.1],["snare",4,.2],["hat",4.5,.1],["kick",5,.25],["hat",5.5,.1],["kick",6,.25],["hat",6.5,.1],["kick",7,.25],["hat",7.5,.1],["snare",8,.2],["hat",8.5,.1],["kick",9,.25],["hat",9.5,.1],["snare",10,.2],["hat",10.5,.1],["kick",11,.25],["hat",11.5,.1],["kick",12,.25],["hat",12.5,.1],["snare",13,.2],["hat",13.5,.1],["kick",14,.25],["snare",14.5,.2],["kick",15,.25],["snare",15.5,.2],["kick",16,.15],["snare",16.2,.15],["kick",16.4,.15],["snare",16.6,.15],["kick",16.8,.15],["snare",17,.15],["kick",17.3,.5]];function mh(o,e,t,n,i,s=.12){let a=o.createOscillator(),r=o.createGain();a.type="square",a.frequency.setValueAtTime(t,n),r.gain.setValueAtTime(0,n),r.gain.linearRampToValueAtTime(s,n+.01),r.gain.setValueAtTime(s,n+i*.7),r.gain.linearRampToValueAtTime(0,n+i*.95),a.connect(r).connect(e),a.start(n),a.stop(n+i)}function gh(o,e,t,n,i,s=.18){let a=o.createOscillator(),r=o.createGain();a.type="triangle",a.frequency.setValueAtTime(t,n),r.gain.setValueAtTime(s,n),r.gain.setValueAtTime(s,n+i*.8),r.gain.linearRampToValueAtTime(0,n+i),a.connect(r).connect(e),a.start(n),a.stop(n+i)}function fh(o,e,t,n,i,s=.06){let a=o.createOscillator(),r=o.createGain();a.type="square",a.frequency.setValueAtTime(t,n),r.gain.setValueAtTime(0,n),r.gain.linearRampToValueAtTime(s,n+.005),r.gain.setValueAtTime(s*.8,n+i*.5),r.gain.linearRampToValueAtTime(0,n+i*.9),a.connect(r).connect(e),a.start(n),a.stop(n+i)}function bh(o,e,t,n,i){let s=o.sampleRate*Math.max(i,.15),a=o.createBuffer(1,s,o.sampleRate),r=a.getChannelData(0);for(let h=0;h<s;h++)r[h]=Math.random()*2-1;let l=o.createBufferSource();l.buffer=a;let c=o.createBiquadFilter(),d=o.createGain();if(t==="kick"){c.type="lowpass",c.frequency.setValueAtTime(300,n),c.frequency.exponentialRampToValueAtTime(60,n+.1),d.gain.setValueAtTime(.35,n),d.gain.exponentialRampToValueAtTime(.001,n+.15);let h=o.createOscillator(),p=o.createGain();h.type="sine",h.frequency.setValueAtTime(150,n),h.frequency.exponentialRampToValueAtTime(30,n+.12),p.gain.setValueAtTime(.4,n),p.gain.exponentialRampToValueAtTime(.001,n+.12),h.connect(p).connect(e),h.start(n),h.stop(n+.15)}else t==="snare"?(c.type="highpass",c.frequency.setValueAtTime(1e3,n),d.gain.setValueAtTime(.15,n),d.gain.exponentialRampToValueAtTime(.001,n+.12)):(c.type="highpass",c.frequency.setValueAtTime(8e3,n),d.gain.setValueAtTime(.08,n),d.gain.exponentialRampToValueAtTime(.001,n+.05));l.connect(c).connect(d).connect(e),l.start(n),l.stop(n+Math.max(i,.2))}function yh(o,e){let t=o.currentTime+.1;for(let[n,i,s]of uh)mh(o,e,Go[n],t+i*Xt,s*Xt);for(let[n,i,s]of dh)gh(o,e,Go[n],t+i*Xt,s*Xt);for(let[n,i,s]of hh)fh(o,e,Go[n],t+i*Xt,s*Xt);for(let[n,i,s]of ph)bh(o,e,n,t+i*Xt,s*Xt);return{totalDurationSec:19.5*Xt+1.5,burstTimes:[0,2,3,6,8.5,11.66,16,17.5].map(n=>n*Xt)}}qo.chiptune=yh;function vh(o,e=3,t=2.5){let n=o.sampleRate,i=Math.ceil(n*e),s=o.createBuffer(2,i,n);for(let r=0;r<2;r++){let l=s.getChannelData(r);for(let c=0;c<i;c++)l[c]=(Math.random()*2-1)*Math.pow(1-c/i,t)}let a=o.createConvolver();return a.buffer=s,a}function _h(o,e=.37,t=.53,n=.45,i=.3){let s=o.createGain(),a=o.createGain(),r=o.createDelay(2),l=o.createDelay(2),c=o.createGain(),d=o.createGain(),h=o.createGain(),p=o.createChannelMerger(2);return r.delayTime.value=e,l.delayTime.value=t,c.gain.value=n,d.gain.value=n,h.gain.value=i,s.connect(a),s.connect(r),r.connect(c),c.connect(l),r.connect(p,0,0),s.connect(l),l.connect(d),d.connect(r),l.connect(p,0,1),p.connect(h),h.connect(a),{input:s,output:a}}function et(o,e,t,n,i,s,{fadeIn:a=.01,fadeOut:r=.05}={}){let l=o.createOscillator(),c=o.createGain();l.type="sine",l.frequency.setValueAtTime(t,n),c.gain.setValueAtTime(0,n),c.gain.linearRampToValueAtTime(s,n+Math.min(a,i*.4));let d=n+i-Math.min(r,i*.4);c.gain.setValueAtTime(s,d),c.gain.linearRampToValueAtTime(0,n+i),l.connect(c).connect(e),l.start(n),l.stop(n+i+.02)}function xn(o,e,t,n,i,s){let a=o.createOscillator(),r=o.createGain();a.type="sine",a.frequency.setValueAtTime(t,n),r.gain.setValueAtTime(s,n),r.gain.exponentialRampToValueAtTime(1e-4,n+Math.max(i,.01)),a.connect(r).connect(e),a.start(n),a.stop(n+i+.02)}function Zt(o,e,t,n,i,s,a){let r=o.createOscillator(),l=o.createGain();r.type="sine",r.frequency.setValueAtTime(Math.max(t,1),i),r.frequency.exponentialRampToValueAtTime(Math.max(n,1),i+s),l.gain.setValueAtTime(0,i),l.gain.linearRampToValueAtTime(a,i+.05),l.gain.setValueAtTime(a,i+s*.7),l.gain.linearRampToValueAtTime(0,i+s),r.connect(l).connect(e),r.start(i),r.stop(i+s+.02)}function Ln(o,e,t,n,i,s,a,r){let l=Math.ceil(o.sampleRate*(a+.1)),c=o.createBuffer(1,l,o.sampleRate),d=c.getChannelData(0);for(let g=0;g<l;g++)d[g]=Math.random()*2-1;let h=o.createBufferSource();h.buffer=c;let p=o.createBiquadFilter();p.type="bandpass",p.Q.setValueAtTime(i,s),p.frequency.setValueAtTime(Math.max(t,1),s),p.frequency.exponentialRampToValueAtTime(Math.max(n,1),s+a);let m=o.createGain();m.gain.setValueAtTime(0,s),m.gain.linearRampToValueAtTime(r,s+.02),m.gain.setValueAtTime(r*.8,s+a*.6),m.gain.linearRampToValueAtTime(0,s+a),h.connect(p).connect(m).connect(e),h.start(s),h.stop(s+a+.02)}function Jt(o,e,t,n,i,s,a,r,l,c){let d=o.createOscillator(),h=o.createOscillator(),p=o.createGain(),m=o.createGain();d.type="sine",d.frequency.setValueAtTime(t,r),h.type="sine",h.frequency.setValueAtTime(Math.max(n,.1),r),h.frequency.exponentialRampToValueAtTime(Math.max(i,.1),r+l),p.gain.setValueAtTime(s*n,r),p.gain.linearRampToValueAtTime(a*i,r+l),m.gain.setValueAtTime(0,r),m.gain.linearRampToValueAtTime(c,r+.1),m.gain.setValueAtTime(c,r+l*.7),m.gain.linearRampToValueAtTime(0,r+l),h.connect(p).connect(d.frequency),d.connect(m).connect(e),d.start(r),h.start(r),d.stop(r+l+.02),h.stop(r+l+.02)}function Ch(o,e){let t=o.currentTime+.05,n=vh(o,3.5,2.2),i=o.createGain();i.gain.value=.25,n.connect(i).connect(e);let s=_h(o,.31,.47,.4,.2);s.output.connect(e);let a=o.createGain();a.gain.value=1,a.connect(e);let r=o.createGain();r.gain.value=1,r.connect(e),r.connect(n),r.connect(s.input),Ln(o,r,60,2e3,2,t,.6,.2),et(o,a,55,t,7,.16,{fadeIn:.3,fadeOut:2}),et(o,a,56.5,t+.1,6.5,.12,{fadeIn:.5,fadeOut:1.5}),et(o,a,27.5,t+.05,5,.12,{fadeIn:.1,fadeOut:2}),et(o,r,82.5,t+.5,5,.08,{fadeIn:.3,fadeOut:1}),et(o,r,83.8,t+.7,4.5,.06,{fadeIn:.3,fadeOut:1}),et(o,r,110,t+1.2,4,.07,{fadeIn:.2,fadeOut:1.5}),et(o,r,165,t+2,3.5,.04,{fadeIn:.15,fadeOut:1.2}),et(o,r,220,t+2.5,3,.035,{fadeIn:.1,fadeOut:1}),Zt(o,r,20,110,t,3,.1),Jt(o,r,55,.3,8,.1,3,t+.5,5,.04);let l=[[880,5,.22,.09],[1320,5.3,.1,.07],[440,5.7,.3,.1],[2200,6,.05,.06],[550,6.2,.18,.08],[1760,6.5,.08,.05],[330,6.65,.35,.09],[3300,6.8,.03,.04],[660,6.95,.12,.08],[1100,7.08,.07,.06],[2640,7.18,.04,.05],[440,7.28,.2,.07],[1650,7.36,.05,.05],[880,7.42,.08,.06],[3960,7.48,.02,.04],[220,7.54,.25,.08],[1320,7.6,.03,.05],[550,7.65,.04,.06],[2200,7.7,.025,.04],[770,7.74,.03,.05],[1100,7.77,.02,.04],[3300,7.8,.015,.03],[440,7.82,.015,.05],[1760,7.84,.01,.04],[660,7.86,.01,.04],[2200,7.88,.01,.03],[880,7.9,.01,.04],[330,7.92,.015,.05],[1650,7.94,.01,.03],[550,7.96,.01,.04],[2200,8.3,.08,.06],[440,8.5,.15,.07],[1320,8.8,.1,.05],[660,9.1,.18,.06],[3300,9.3,.05,.04],[880,9.5,.12,.05]];for(let[h,p,m,g]of l)xn(o,r,h,t+p,m,g);Ln(o,r,1e3,3e3,12,t+5,4,.025),Zt(o,r,80,4500,t+9,4,.1),Ln(o,r,400,7e3,8,t+9.5,3.5,.08),Zt(o,r,5e3,100,t+10.5,3,.08),Jt(o,r,220,1,120,.5,15,t+11.5,3,.08),Zt(o,r,150,6e3,t+12.5,2.5,.07),Zt(o,r,7e3,80,t+13,2.5,.07),Jt(o,r,440,50,300,4,18,t+13.5,2,.06),Ln(o,r,200,1e4,1.5,t+15,.12,.16),xn(o,r,1760,t+14,.15,.1),xn(o,r,2640,t+14.3,.1,.08),xn(o,r,3520,t+14.5,.08,.07),Jt(o,r,110,2,250,1,25,t+15.5,4.5,.1),Jt(o,r,330,5,180,2,18,t+16,4,.08),Zt(o,r,25,1e4,t+16,3.5,.09),Zt(o,r,12e3,30,t+16.5,4,.08),Ln(o,r,80,14e3,1,t+17,.2,.2),Jt(o,r,880,15,600,4,30,t+17.5,3.5,.07),Jt(o,r,1320,7,400,2,20,t+18,3,.05),et(o,r,233,t+18,4,.06,{fadeIn:.3,fadeOut:2}),et(o,r,247,t+18.3,3.5,.05,{fadeIn:.2,fadeOut:2}),et(o,r,262,t+18.5,3,.04,{fadeIn:.2,fadeOut:2});let c=[3520,1760,440,7040,880,2640,5280,330,1320,660];for(let h=0;h<25;h++){let p=19.5+h*.09,m=c[h%c.length]*(.7+Math.random()*.6);xn(o,r,m,t+p,.02+Math.random()*.08,.04+Math.random()*.05)}Ln(o,r,1e4,150,4,t+20,2.5,.09),Jt(o,r,55,1,400,5,35,t+21.5,1.5,.12),xn(o,r,4400,t+22.5,.3,.1);let d=[[220,23,1.5,.08],[440,23.5,1.2,.06],[330,24.5,1.8,.07],[660,25,.8,.05],[165,25.8,2,.07],[550,26.3,1,.05],[880,26.8,.6,.04],[110,27.3,2.5,.08],[1320,27.8,.4,.04],[275,28.3,1.5,.06]];for(let[h,p,m,g]of d)et(o,r,h,t+p,m,g,{fadeIn:.01,fadeOut:m*.8});return Zt(o,r,2500,150,t+23.5,5,.05),Jt(o,r,110,.3,12,.15,3,t+24.5,4,.04),Ln(o,r,900,250,25,t+25.5,3,.03),Zt(o,r,80,800,t+27,2,.04),et(o,r,4400,t+28.5,4.5,.03,{fadeIn:.8,fadeOut:3.5}),et(o,r,4e3,t+29,4,.025,{fadeIn:.5,fadeOut:3}),Zt(o,r,1500,30,t+29.5,5,.07),et(o,a,55,t+30,5,.06,{fadeIn:.2,fadeOut:4.5}),et(o,a,110,t+30.5,4.5,.04,{fadeIn:.15,fadeOut:4}),Jt(o,r,55,.1,3,.05,1,t+31,3,.02),Ln(o,r,2500,200,6,t+32,2.5,.018),xn(o,r,3520,t+34,.5,.025),xn(o,r,1760,t+34.5,.3,.015),{totalDurationSec:35,burstTimes:[0,2,5,6.8,9,12,15,17,19,21.5,23,26,29,32]}}qo.electroacoustic=Ch;var Pc=[[130,50,200],[50,130,220],[35,175,150],[200,50,90],[200,145,30],[70,195,120],[170,80,200],[220,70,50]];function Eh(o,e){let t=e.width/(e.height||1),n=Math.max(e.width,e.height);return o.classList.contains("pin-btn")?"dot":o.classList.contains("knob")||o.classList.contains("knob-inner")||o.classList.contains("panel7-joystick-pad")?"circle":n<20&&t>.7&&t<1.4?"dot":n<60&&t>.7&&t<1.4?"circle":"rect"}var Oc=2e3,Sh=50;function kh(){let e=[],t=[".synth-module",".sgme-osc",".noise-generator",".random-voltage",".output-channel-module",".input-amplifier-module",".input-amplifiers-module",".panel7-joystick",".panel7-sequencer",".panel1-placeholder",".panel2-placeholder",".matrix-container"].join(","),n=[".knob",".output-channel__slider-shell",".panel7-joystick-pad",".panel7-seq-button",".panel7-seq-switch",".output-channel__switch",".knob-value",".sgme-osc__header",".synth-module__header",".noise-generator__header",".random-voltage__header"].join(","),i=new Set(["CANVAS","SVG","PATH","CIRCLE","RECT","LINE","POLYLINE","POLYGON","TEXT","TSPAN","BR","SCRIPT","STYLE","LINK"]);for(let d of document.querySelectorAll(".panel")){let h=d.getBoundingClientRect();h.width>1&&h.height>1&&e.push({el:d,rect:h,priority:0})}for(let d of document.querySelectorAll(".panel-note")){let h=d.getBoundingClientRect();h.width>1&&h.height>1&&e.push({el:d,rect:h,priority:0})}for(let d of document.querySelectorAll(t)){let h=d.getBoundingClientRect();h.width>1&&h.height>1&&e.push({el:d,rect:h,priority:1})}for(let d of document.querySelectorAll(n)){if(i.has(d.tagName)||d.closest('.tooltip, [role="tooltip"]'))continue;let h=d.getBoundingClientRect();h.width>1&&h.height>1&&e.push({el:d,rect:h,priority:2})}let s=[...document.querySelectorAll(".pin-btn")].filter(d=>{if(i.has(d.tagName)||d.closest('.tooltip, [role="tooltip"]'))return!1;let h=d.getBoundingClientRect();return h.width>1&&h.height>1});for(let d=s.length-1;d>0;d--){let h=Math.floor(Math.random()*(d+1));[s[d],s[h]]=[s[h],s[d]]}for(let d of s.slice(0,Sh)){let h=d.getBoundingClientRect();e.push({el:d,rect:h,priority:3})}let a=e;if(e.length>Oc){let d=e.filter(p=>p.priority<=1),h=e.filter(p=>p.priority>=2);for(let p=h.length-1;p>0;p--){let m=Math.floor(Math.random()*(p+1));[h[p],h[m]]=[h[m],h[p]]}a=[...d,...h.slice(0,Math.max(Oc-d.length,0))]}let r=window.innerWidth||1200,l=window.innerHeight||800,c=[];for(let d=0;d<a.length;d++){let{el:h,rect:p}=a[d],m=Eh(h,p),[g,_,y]=Pc[d%Pc.length],f=h.classList.contains("pin-btn")||m==="dot";c.push({x:p.left,y:p.top,w:f?Math.max(p.width,8):Math.max(p.width,4),h:f?Math.max(p.height,8):Math.max(p.height,4),shape:m,fillStyle:f?`rgba(${g},${_},${y},0.95)`:`rgba(${g},${_},${y},0.80)`,strokeStyle:f?"rgba(255,255,255,0.8)":`rgba(${g},${_},${y},0.85)`,delay:Math.random()*400,tx:(Math.random()-.5)*r*1.4,ty:(Math.random()-.5)*l*1.2,rot:m==="dot"?0:(Math.random()-.5)*1800,sc:m==="dot"?1:.3+Math.random()*2.5,wFreqX:.4+Math.random()*2.5,wFreqY:.6+Math.random()*2.5,wAmpX:15+Math.random()*120,wAmpY:15+Math.random()*120,spiralR:8+Math.random()*70,spiralSpd:(Math.random()-.5)*6})}return c}var ms=[0,.06,.2,.4,.6,.75,.85,1],Ic=[0,0,.5,1,.55,.15,0,0],Nc=[0,0,.5,1,.55,.15,0,0],Dc=[0,0,.3,1,.85,.15,0,0],Bc=[1,1,1,1,1,1,1,1],$o=.06,wh=Math.PI/180,Rr=6e3;function zc(o,e){return o===2?.7+e*.2:o===3?e:o===4?1.05:1}function xh(o){return o<.5?2*o*o:-1+(4-2*o)*o}function Lh(o,e,t=0){let n=0;for(;n<ms.length-2&&ms[n+1]<=o;)n++;let i=ms[n+1]-ms[n],s=xh(Math.max(0,Math.min(1,(o-ms[n])/i))),a=(b,E)=>b+(E-b)*s,r=a(Ic[n],Ic[n+1])*e.tx,l=a(Nc[n],Nc[n+1])*e.ty,c=o<$o?0:Math.min(1,(o-$o)/.12),d=Math.sin(o*Math.PI)*c,h=6.283185,p=(e.wAmpX||0)*Math.sin(t*(e.wFreqX||0)*h)*d,m=(e.wAmpY||0)*Math.cos(t*(e.wFreqY||0)*h)*d,g=t*(e.spiralSpd||0),_=(e.spiralR||0)*d,y=r+p+Math.cos(g)*_,f=l+m+Math.sin(g)*_;return{tx:y,ty:f,rot:a(Dc[n],Dc[n+1])*e.rot,scale:a(zc(n,e.sc),zc(n+1,e.sc)),alpha:a(Bc[n],Bc[n+1])}}function Ah(o,e,t,n){let i=o.getContext("2d");if(!i)return;let s=Math.min(window.devicePixelRatio||1,2),a=window.innerWidth,r=window.innerHeight;o.width=a*s,o.height=r*s,i.scale(s,s);for(let m of e){m.vx=0,m.vy=0,m.ox=0,m.oy=0;let g=m.w*m.h;m.mass=.5+Math.sqrt(g)/40,m.driftAngle=Math.random()*6.283185,m.driftSpeed=200+Math.random()*300}let l=performance.now(),c=l,d=t+Rr,h=2e3;function p(m){let g=Math.min((m-c)/1e3,.05);c=m;let _=m-l;if(_>=d||!o.parentElement)return;i.clearRect(0,0,a,r);let y;_<h?y=_/h:_>t?y=Math.max(0,1-(_-t)/Rr):y=1,n.style.background=`rgba(5, 5, 15, ${y.toFixed(3)})`;for(let f of e){let b=_-f.delay;if(b<0)continue;let E=Math.min(b/(t-f.delay),1),w=b/1e3,{tx:S,ty:T,rot:A,scale:C,alpha:x}=Lh(E,f,w),R=E>.75?Math.max(0,1-(E-.75)/.25):1;if(dn&&R>0&&g>0){let ue=f.x+f.w/2+S+f.ox,Ne=f.y+f.h/2+T+f.oy,ke=Lr-ue,O=Ar-Ne,q=Math.sqrt(ke*ke+O*O)||1,Be=4e3/(1+q/500),ze=1.5,xe=ke/q*Be+ke*ze,At=O/q*Be+O*ze;f.vx+=xe/f.mass*g*R,f.vy+=At/f.mass*g*R}let M=E<$o?0:Math.min(1,(E-$o)/.15);if(!dn&&g>0&&R>0&&M>0){f.driftAngle+=(Math.random()-.5)*2.5*g;let ue=f.driftSpeed*M*(1+E*2);f.vx+=Math.cos(f.driftAngle)*ue/f.mass*g,f.vy+=Math.sin(f.driftAngle)*ue/f.mass*g}let I=.15,B=f.x+f.w/2+f.ox,Y=f.y+f.h/2+f.oy,P=-a*I,F=a*(1+I),z=-r*I,$=r*(1+I),N=120;B<P?f.vx+=N*g:B>F&&(f.vx-=N*g),Y<z?f.vy+=N*g:Y>$&&(f.vy-=N*g);let te=Math.min((dn?.97:.955)+(f.mass-1)*.004,.985);if(f.vx*=Math.pow(te,g*60),f.vy*=Math.pow(te,g*60),f.ox+=f.vx*g,f.oy+=f.vy*g,R<1){let ue=1-Math.pow(R,.5);f.ox*=1-ue,f.oy*=1-ue,f.vx*=1-ue*.5,f.vy*=1-ue*.5}let Q=x*y;if(Q<.01)continue;let ge=f.x+f.w/2+S+f.ox,Se=f.y+f.h/2+T+f.oy,ne=f.w/2,ce=f.h/2;if(i.save(),i.globalAlpha=Q,i.translate(ge,Se),i.rotate(A*wh),i.scale(C,C),i.fillStyle=f.fillStyle,i.strokeStyle=f.strokeStyle,i.lineWidth=1,f.shape==="circle"||f.shape==="dot"){let ue=f.shape==="dot"?Math.max(ne,4):ne,Ne=f.shape==="dot"?Math.max(ce,4):ce;i.beginPath(),i.ellipse(0,0,ue,Ne,0,0,Math.PI*2),i.fill(),i.stroke()}else i.beginPath(),i.roundRect?i.roundRect(-ne,-ce,f.w,f.h,4):i.rect(-ne,-ce,f.w,f.h),i.fill(),i.stroke();i.restore()}fs=requestAnimationFrame(p)}fs=requestAnimationFrame(p)}function Rh(o,e,t){if(!o||o.state==="closed")return;let n=o.currentTime,i=o.createStereoPanner();i.pan.setValueAtTime((e-.5)*1.8,n),i.connect(o.destination);let s=80+(1-t)*3e3,a=()=>.6+Math.random()*.8;switch(Math.floor(Math.random()*5)){case 0:{let l=[1.41,2.76,3.14,.71,1.73,5.19,7.13],c=l[Math.floor(Math.random()*l.length)],d=o.createOscillator(),h=o.createOscillator(),p=o.createGain(),m=o.createGain();d.type="sine",h.type="sine",d.frequency.setValueAtTime(s*a(),n),d.frequency.exponentialRampToValueAtTime(Math.max(s*.15,20),n+.6),h.frequency.setValueAtTime(s*c,n);let g=400+Math.random()*1200;p.gain.setValueAtTime(g,n),p.gain.exponentialRampToValueAtTime(1,n+.3),h.connect(p).connect(d.frequency),m.gain.setValueAtTime(.35,n),m.gain.exponentialRampToValueAtTime(.001,n+.6),d.connect(m).connect(i),d.start(n),h.start(n),d.stop(n+.65),h.stop(n+.65);break}case 1:{let l=o.createOscillator(),c=o.createOscillator(),d=o.createGain(),h=o.createGain();l.type="sawtooth",c.type="square";let p=60+Math.random()*100,m=2e3+Math.random()*4e3;l.frequency.setValueAtTime(p,n),l.frequency.exponentialRampToValueAtTime(m,n+.2),l.frequency.exponentialRampToValueAtTime(Math.max(p*.5,20),n+.5),c.frequency.setValueAtTime(m,n),c.frequency.exponentialRampToValueAtTime(Math.max(p,20),n+.3),d.gain.setValueAtTime(.25,n),d.gain.exponentialRampToValueAtTime(.001,n+.5),h.gain.setValueAtTime(.15,n),h.gain.exponentialRampToValueAtTime(.001,n+.35);let g=o.createBiquadFilter();g.type="bandpass",g.frequency.setValueAtTime(s,n),g.Q.setValueAtTime(6+Math.random()*10,n),l.connect(d).connect(g),c.connect(h).connect(g),g.connect(i),l.start(n),c.start(n),l.stop(n+.55),c.stop(n+.4);break}case 2:{let l=Math.ceil(o.sampleRate*.25),c=o.createBuffer(1,l,o.sampleRate),d=c.getChannelData(0);for(let f=0;f<l;f++)d[f]=Math.random()*2-1;let h=o.createBufferSource();h.buffer=c;let p=o.createBiquadFilter(),m=o.createBiquadFilter();p.type="bandpass",p.frequency.setValueAtTime(s*2,n),p.frequency.exponentialRampToValueAtTime(Math.max(s*.1,20),n+.2),p.Q.setValueAtTime(15+Math.random()*20,n),m.type="highpass",m.frequency.setValueAtTime(200,n);let g=o.createGain();g.gain.setValueAtTime(.4,n),g.gain.exponentialRampToValueAtTime(.001,n+.22),h.connect(p).connect(m).connect(g).connect(i),h.start(n),h.stop(n+.25);let _=o.createOscillator(),y=o.createGain();_.type="sine",_.frequency.setValueAtTime(s*.5,n),_.frequency.exponentialRampToValueAtTime(Math.max(s*.1,20),n+.15),y.gain.setValueAtTime(.3,n),y.gain.exponentialRampToValueAtTime(.001,n+.2),_.connect(y).connect(i),_.start(n),_.stop(n+.25);break}case 3:{let l=[1,1.5,2,2.67,3.5,4.75],c=3+Math.floor(Math.random()*3);for(let h=l.length-1;h>0;h--){let p=Math.floor(Math.random()*(h+1));[l[h],l[p]]=[l[p],l[h]]}let d=s*(.3+Math.random()*.7);for(let h=0;h<c;h++){let p=o.createOscillator(),m=o.createGain();p.type=["sine","triangle","square"][Math.floor(Math.random()*3)];let g=d*l[h]*a();p.frequency.setValueAtTime(Math.max(g,20),n),p.frequency.exponentialRampToValueAtTime(Math.max(g*.7,20),n+.3);let _=h*.015;m.gain.setValueAtTime(0,n),m.gain.linearRampToValueAtTime(.18/c,n+_+.005),m.gain.exponentialRampToValueAtTime(.001,n+.3+_),p.connect(m).connect(i),p.start(n+_),p.stop(n+.35+_)}break}case 4:{let l=o.createOscillator(),c=o.createOscillator(),d=o.createGain(),h=o.createGain();l.type="sine",c.type="square";let p=s*a();l.frequency.setValueAtTime(p,n),c.frequency.setValueAtTime(p*(2+Math.random()*6),n),c.frequency.exponentialRampToValueAtTime(Math.max(p*.5,20),n+.15),d.gain.setValueAtTime(p*4,n),d.gain.exponentialRampToValueAtTime(1,n+.1),c.connect(d).connect(l.frequency),h.gain.setValueAtTime(.3,n),h.gain.exponentialRampToValueAtTime(.001,n+.15),l.connect(h).connect(i),l.start(n),c.start(n),l.stop(n+.2),c.stop(n+.2);for(let m=1;m<=3;m++){let g=n+m*.08,_=o.createOscillator(),y=o.createGain();_.type="sine";let f=p*Math.pow(.75,m);_.frequency.setValueAtTime(Math.max(f,20),g),_.frequency.exponentialRampToValueAtTime(Math.max(f*.5,20),g+.1);let b=.2/(m+1);y.gain.setValueAtTime(b,g),y.gain.exponentialRampToValueAtTime(.001,g+.12),_.connect(y).connect(i),_.start(g),_.stop(g+.15)}break}}}function Th(o,e,t){if(!o||o.state==="closed")return;Cs();let n=o.currentTime,i=60+(1-t)*1500,s=o.createOscillator();s.type="sawtooth",s.frequency.setValueAtTime(i,n);let a=o.createOscillator();a.type="square",a.frequency.setValueAtTime(i*.501,n);let r=o.createOscillator();r.type="sine";let l=1.5+e*5;r.frequency.setValueAtTime(i*l,n);let c=o.createGain();c.gain.setValueAtTime(i*(.5+e*3),n),r.connect(c),c.connect(s.frequency);let d=o.createOscillator(),h=o.createGain();d.type="sine",d.frequency.setValueAtTime(4+e*12,n),h.gain.setValueAtTime(i*.04,n),d.connect(h),h.connect(s.frequency),h.connect(a.frequency);let p=o.createOscillator(),m=o.createGain();p.type="triangle",p.frequency.setValueAtTime(.3+e*2,n),m.gain.setValueAtTime(1500+t*2e3,n),p.connect(m);let g=o.createGain();g.gain.setValueAtTime(1,n);let _=o.createGain();_.gain.setValueAtTime(.6,n);let y=o.createGain();y.gain.setValueAtTime(.4,n),s.connect(_).connect(g),a.connect(y).connect(g);let f=o.createBiquadFilter();f.type="lowpass",f.frequency.setValueAtTime(400+(1-t)*4e3,n),f.Q.setValueAtTime(5+e*15,n),m.connect(f.frequency);let b=o.createBiquadFilter();b.type="peaking",b.frequency.setValueAtTime(i*3,n),b.gain.setValueAtTime(8,n),b.Q.setValueAtTime(4,n);let E=o.createWaveShaper(),w=new Float32Array(256);for(let A=0;A<256;A++){let C=A/128-1;w[A]=(Math.PI+3)*C/(Math.PI+3*Math.abs(C))}E.curve=w,E.oversample="2x";let S=o.createGain();S.gain.setValueAtTime(0,n),S.gain.linearRampToValueAtTime(.22,n+.15);let T=o.createStereoPanner();T.pan.setValueAtTime((e-.5)*1.4,n),g.connect(f).connect(E).connect(b).connect(S).connect(T).connect(o.destination),s.start(n),a.start(n),r.start(n),d.start(n),p.start(n),Li={osc1:s,osc2:a,osc3:r,lfo1:d,lfo2:p,filter:f,filter2:b,master:S,panner:T,lfo1Gain:h,lfo2Gain:m,fmGain:c,ctx:o}}function Mh(o,e){if(!Li)return;let{osc1:t,osc2:n,osc3:i,lfo1:s,lfo2:a,filter:r,filter2:l,panner:c,lfo1Gain:d,lfo2Gain:h,fmGain:p,ctx:m}=Li;if(!m||m.state==="closed")return;let g=m.currentTime,_=60+(1-e)*1500,y=g+.06;t.frequency.exponentialRampToValueAtTime(Math.max(_,20),y),n.frequency.exponentialRampToValueAtTime(Math.max(_*.501,20),y);let f=1.5+o*5;i.frequency.exponentialRampToValueAtTime(Math.max(_*f,20),y),p.gain.linearRampToValueAtTime(_*(.5+o*3),y),s.frequency.linearRampToValueAtTime(4+o*12,y),d.gain.linearRampToValueAtTime(_*.04,y),a.frequency.linearRampToValueAtTime(.3+o*2,y),h.gain.linearRampToValueAtTime(1500+e*2e3,y),r.frequency.exponentialRampToValueAtTime(Math.max(400+(1-e)*4e3,20),y),r.Q.linearRampToValueAtTime(5+o*15,y),l.frequency.exponentialRampToValueAtTime(Math.max(_*3,20),y),c.pan.linearRampToValueAtTime((o-.5)*1.4,y)}function Cs(){if(!Li)return;let{osc1:o,osc2:e,osc3:t,lfo1:n,lfo2:i,master:s,ctx:a}=Li;if(a&&a.state!=="closed")try{let r=a.currentTime;s.gain.cancelScheduledValues(r),s.gain.setValueAtTime(s.gain.value,r),s.gain.linearRampToValueAtTime(0,r+.2);let l=r+.25;o.stop(l),e.stop(l),t.stop(l),n.stop(l),i.stop(l)}catch{}Li=null}function Ph(o){let e=document.createElement("div");e.id="easter-egg-overlay",e.style.cssText=["position: fixed","top: 0","left: 0","width: 100vw","height: 100vh","z-index: 9999","background: rgba(5, 5, 15, 0)","cursor: default","touch-action: none","opacity: 0","transition: opacity 0.8s ease-in","pointer-events: auto","overflow: hidden"].join(";");let t=document.createElement("canvas");t.style.cssText="position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none",e.appendChild(t);let n=document.createElement("div");n.textContent="\u{1F50A} doble click o Esc para cerrar",n.style.cssText=["position: absolute","bottom: 20px","left: 50%","transform: translateX(-50%)","color: rgba(255,255,255,0.35)","font-family: monospace","font-size: 14px","z-index: 10000","pointer-events: none"].join(";"),e.appendChild(n),document.body.appendChild(e),e.offsetHeight,requestAnimationFrame(()=>{requestAnimationFrame(()=>{e.style.opacity="1"})});let i=!1;return e.addEventListener("pointerdown",s=>{i=!0,Lr=s.clientX,Ar=s.clientY,dn=!0,e.setPointerCapture(s.pointerId);let a=s.clientX/(window.innerWidth||1),r=s.clientY/(window.innerHeight||1);_s&&(Rh(_s,a,r),Th(_s,a,r))}),e.addEventListener("pointermove",s=>{if(!i)return;Lr=s.clientX,Ar=s.clientY,dn=!0;let a=s.clientX/(window.innerWidth||1),r=s.clientY/(window.innerHeight||1);Mh(a,r)}),e.addEventListener("pointerup",()=>{i=!1,dn=!1,Cs()}),e.addEventListener("pointerleave",()=>{i=!1,dn=!1,Cs()}),e.addEventListener("pointercancel",()=>{i=!1,dn=!1,Cs()}),{overlay:e,canvas:t}}function xr(o){if(ei=!1,bs&&(clearTimeout(bs),bs=0),ys&&(clearTimeout(ys),ys=0),Vo&&(clearTimeout(Vo),Vo=0),fs&&(cancelAnimationFrame(fs),fs=0),o&&o.state!=="closed"&&o.close().catch(()=>{}),vs&&(document.removeEventListener("keydown",vs),vs=null),Cs(),_s=null,dn=!1,ti){ti.style.opacity="0";let e=ti;ti=null,Vo=setTimeout(()=>{e.remove()},800)}}async function Tr(o={}){if(ei)return;ei=!0;let e=!!o.visualOnly,t=null;try{let n=20,i=[0,3,6,9,12,15,18];if(!e){let c=window.AudioContext||window.webkitAudioContext;t=new c;let d=t.createDynamicsCompressor();d.threshold.setValueAtTime(-12,t.currentTime),d.knee.setValueAtTime(10,t.currentTime),d.ratio.setValueAtTime(6,t.currentTime),d.attack.setValueAtTime(.003,t.currentTime),d.release.setValueAtTime(.15,t.currentTime);let h=t.createGain();h.gain.setValueAtTime(.7,t.currentTime),d.connect(h).connect(t.destination),_s=t;let m=(qo[rh]||qo.electroacoustic)(t,d);n=m.totalDurationSec,i=m.burstTimes;let g=t.currentTime+n-1.5;h.gain.setValueAtTime(.7,g),h.gain.linearRampToValueAtTime(0,g+1.5)}let s=n*1e3,{overlay:a,canvas:r}=Ph(s);ti=a;let l=kh();Ah(r,l,s,a),ys=setTimeout(()=>{ys=0,ti&&ti.addEventListener("dblclick",()=>xr(t),{once:!0})},600),vs=c=>{c.key==="Escape"&&xr(t)},document.addEventListener("keydown",vs),bs=setTimeout(()=>{bs=0,ei&&xr(t)},(n+Rr/1e3+1.5)*1e3)}catch(n){console.error("[EasterEgg] Error:",n),ei=!1}}var gs=[0,1,0,1,0,1,0,1],Oh=300,Ih=10,Nh=2e3,Dh=!1;function Fc(o={}){let e=o.isDirtyFn||(()=>!1),t=o.markCleanFn||null,n=document.querySelector("#joystick-left"),i=document.querySelector("#joystick-right");if(!n||!i)return;let s=[n,i],a=0,r=0,l=!1,c=0,d=0,h=0,p=-1,m=-1,g=null;function _(E){y();let w=document.createElement("div");w.className="easter-egg-countdown",w.textContent=E,Object.assign(w.style,{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%) scale(0.3)",zIndex:"99999",fontSize:"18vw",fontWeight:"900",fontFamily:"system-ui, sans-serif",color:"rgba(200, 140, 255, 0.85)",textShadow:"0 0 40px rgba(130, 50, 200, 0.7), 0 0 80px rgba(50, 130, 220, 0.4)",pointerEvents:"none",userSelect:"none",opacity:"0",transition:"none"}),document.body.appendChild(w),g=w,w.offsetHeight,Object.assign(w.style,{transition:"opacity 0.15s ease-out, transform 0.3s cubic-bezier(0.2, 1.4, 0.4, 1)",opacity:"1",transform:"translate(-50%, -50%) scale(1)"}),setTimeout(()=>{g===w&&(Object.assign(w.style,{transition:"opacity 0.4s ease-in, transform 0.4s ease-in",opacity:"0",transform:"translate(-50%, -50%) scale(1.8)"}),setTimeout(()=>w.remove(),400))},600)}function y(){g&&(g.remove(),g=null)}let f=()=>{a=0,r=0,l=!1,y()};function b(E){for(let w=0;w<s.length;w++)if(s[w].contains(E))return w;return-1}document.addEventListener("pointerdown",E=>{let w=b(E.target);if(w===-1){f();return}if(!ei){if(m!==-1){f();return}a===0&&(l=e()),c=performance.now(),d=E.clientX,h=E.clientY,p=w,m=E.pointerId}},!0),document.addEventListener("pointerup",E=>{if(ei||E.pointerId!==m)return;let w=performance.now(),S=w-c,T=E.clientX-d,A=E.clientY-h,C=Math.sqrt(T*T+A*A),x=p;if(m=-1,p=-1,S>Oh||C>Ih){f();return}if(a>0&&w-r>Nh&&(f(),x===gs[0]&&(l=e())),x!==gs[a]){f(),x===gs[0]&&(l=e(),a=1,r=w);return}a++,r=w;let R=gs.length-a;if(R>0&&R<=3&&_(R),a>=gs.length){let M=Dh&&l;f(),!M&&t&&t(),Tr({visualOnly:M})}},!0),document.addEventListener("pointercancel",E=>{E.pointerId===m&&(m=-1,p=-1,f())},!0)}Oe();var Vc=!1;function Gc(){let o=document.getElementById("portraitBlocker");if(!o)return;let e=o.querySelector(".portrait-blocker__close"),t=o.querySelector(".portrait-blocker__message"),n=()=>{t&&(t.textContent=u("orientation.blocker")),e&&e.setAttribute("aria-label",u("orientation.blocker.dismiss"))};n(),Pe(n),e?.addEventListener("click",()=>{Vc=!0,o.classList.remove("portrait-blocker--visible"),o.setAttribute("aria-hidden","true")});let i=window.matchMedia("(orientation: portrait)"),s=()=>{i.matches&&!Vc?(o.classList.add("portrait-blocker--visible"),o.setAttribute("aria-hidden","false")):(o.classList.remove("portrait-blocker--visible"),o.setAttribute("aria-hidden","true"))};i.addEventListener("change",s),s()}Xn();po();Oe();Te();Xn();be();var Es=W("MenuBridge"),qc=!1,Bh=["app.windowTitle","menu.file","menu.file.patches","menu.file.language","menu.file.reload","menu.file.quit","menu.file.reload.confirm","menu.file.quit.confirm","common.cancel","menu.view","menu.view.quickbar","menu.view.fullscreen","menu.view.zoomIn","menu.view.zoomOut","menu.view.zoomReset","menu.view.inactivePins","menu.view.tooltipVoltage","menu.view.tooltipAudioRate","menu.view.linearFaders","menu.view.sharpRasterize","menu.view.devTools","menu.preferences","menu.preferences.settings","menu.audio","menu.audio.mute","menu.audio.unmute","menu.audio.record","menu.audio.stopRecording","menu.audio.preventSleep","menu.audio.audioSettings","menu.audio.dsp","menu.panels","menu.panels.detachHeader","menu.panels.detachAll","menu.panels.attachAll","menu.panels.lockPan","menu.panels.lockZoom","menu.panels.rememberVisualLayout","menu.panels.singleFingerPan","menu.panels.multitouchControls","menu.advanced","menu.advanced.debugGlobal","menu.advanced.dormancy","menu.advanced.dormancyDebug","menu.advanced.filterBypass","menu.advanced.filterBypassDebug","menu.advanced.softClip","menu.advanced.pinTolerance","menu.advanced.thermalDrift","menu.advanced.telemetry","menu.advanced.resetSynth","menu.advanced.settings","menu.osc","menu.osc.enable","menu.osc.sendToSC","menu.osc.receiveFromSC","menu.osc.showLog","menu.osc.settings","menu.help","menu.help.about","menu.help.repository","menu.help.reportBug","menu.help.checkUpdates"];function Re(o,e){let t=localStorage.getItem(o);return t===null?e:t==="true"}function zh(){let o=Kn(),e={};return["panel-1","panel-2","panel-3","panel-4","panel-5","panel-6","panel-output"].forEach(t=>{e[t]=o.includes(t)}),{muted:!1,recording:!1,dspEnabled:Re(v.DSP_ENABLED,!0),quickbarVisible:Re(v.QUICKBAR_VISIBLE??"synthigme-quickbar-visible",!0),inactivePins:Re(v.SHOW_INACTIVE_PINS,!1),tooltipVoltage:Re(v.TOOLTIP_SHOW_VOLTAGE,!0),tooltipAudioRate:Re(v.TOOLTIP_SHOW_AUDIO_VALUES,!0),linearFaders:Re(v.FADER_LINEAR_RESPONSE,!0),sharpRasterize:Re(v.SHARP_RASTERIZE_ENABLED,!1),lockPan:!!window.__synthNavLocks?.panLocked,lockZoom:!!window.__synthNavLocks?.zoomLocked,rememberVisualLayout:Re(v.REMEMBER_VISUAL_LAYOUT,!1),singleFingerPan:Re(v.SINGLE_FINGER_PAN,!0),multitouchControls:Re(v.MULTITOUCH_CONTROLS,!1),pipPanels:e,preventSleep:Re(v.WAKE_LOCK_ENABLED,!0),debugGlobal:Re(v.OPTIMIZATIONS_DEBUG,!1),dormancy:Re(v.DORMANCY_ENABLED,!0),dormancyDebug:Re(v.DORMANCY_DEBUG,!1),filterBypass:Re(v.FILTER_BYPASS_ENABLED,!0),filterBypassDebug:Re(v.FILTER_BYPASS_DEBUG,!1),softClip:Re(v.VOLTAGE_SOFT_CLIP_ENABLED,!0),pinTolerance:Re(v.VOLTAGE_PIN_TOLERANCE_ENABLED,!0),thermalDrift:Re(v.VOLTAGE_THERMAL_DRIFT_ENABLED,!0),telemetryEnabled:Re(v.TELEMETRY_ENABLED,!1),oscEnabled:Re(v.OSC_ENABLED,!1),oscSendToSC:Re(v.OSC_SUPERCOLLIDER_SEND,!1),oscReceiveFromSC:Re(v.OSC_SUPERCOLLIDER_RECEIVE,!1),oscShowLog:Re(v.OSC_LOG_VISIBLE,!1)}}function $c(){if(!window.menuAPI)return;let o={};Bh.forEach(e=>{o[e]=u(e)}),o._locale=Xi(),o._locales=hi(),hi().forEach(e=>{o[`settings.language.${e}`]=u(`settings.language.${e}`)}),window.menuAPI.syncTranslations(o)}function Ft(o){window.menuAPI&&window.menuAPI.syncMenuState(o||zh())}function Fh({action:o,data:e}){switch(Es.info(`Menu action: ${o}`,e),o){case"togglePatches":document.dispatchEvent(new CustomEvent("synth:togglePatches"));break;case"toggleQuickbar":document.dispatchEvent(new CustomEvent("synth:toggleQuickbar",{detail:e}));break;case"setInactivePins":localStorage.setItem(v.SHOW_INACTIVE_PINS,String(e.enabled)),document.dispatchEvent(new CustomEvent("synth:showInactivePinsChange",{detail:{show:e.enabled}}));break;case"setTooltipVoltage":localStorage.setItem(v.TOOLTIP_SHOW_VOLTAGE,String(e.enabled)),document.dispatchEvent(new CustomEvent("synth:settingChanged",{detail:{key:"tooltipShowVoltage",value:e.enabled}}));break;case"setTooltipAudioRate":localStorage.setItem(v.TOOLTIP_SHOW_AUDIO_VALUES,String(e.enabled)),document.dispatchEvent(new CustomEvent("synth:settingChanged",{detail:{key:"tooltipShowAudioValues",value:e.enabled}}));break;case"setLinearFaders":localStorage.setItem(v.FADER_LINEAR_RESPONSE,String(e.enabled)),document.dispatchEvent(new CustomEvent("synth:faderResponseChanged",{detail:{linear:e.enabled}}));break;case"setSharpRasterize":localStorage.setItem(v.SHARP_RASTERIZE_ENABLED,String(e.enabled)),document.dispatchEvent(new CustomEvent("synth:sharpRasterizeChange",{detail:{enabled:e.enabled}}));break;case"toggleMute":document.dispatchEvent(new CustomEvent("synth:toggleMute"));break;case"toggleRecording":document.dispatchEvent(new CustomEvent("synth:toggleRecording"));break;case"toggleDSP":document.dispatchEvent(new CustomEvent("synth:toggleDSP",{detail:{enabled:e?.enabled}}));break;case"setPreventSleep":localStorage.setItem(v.WAKE_LOCK_ENABLED,String(e.enabled)),document.dispatchEvent(new CustomEvent("synth:wakeLockChange",{detail:{enabled:e.enabled}}));break;case"togglePip":{let{togglePip:t}=Uo();t&&t(e.panelId);break}case"detachAllPips":{let{openAllPips:t}=Uo();t&&t();break}case"attachAllPips":{let{closeAllPips:t}=Uo();t&&t();break}case"setRememberVisualLayout":localStorage.setItem(v.REMEMBER_VISUAL_LAYOUT,String(e.enabled));break;case"setLockPan":{let t=window.__synthNavLocks||(window.__synthNavLocks={zoomLocked:!1,panLocked:!1});t.panLocked=!!e.enabled,document.dispatchEvent(new CustomEvent("synth:panLockChange",{detail:{enabled:t.panLocked}}));break}case"setLockZoom":{let t=window.__synthNavLocks||(window.__synthNavLocks={zoomLocked:!1,panLocked:!1});t.zoomLocked=!!e.enabled,document.dispatchEvent(new CustomEvent("synth:zoomLockChange",{detail:{enabled:t.zoomLocked}}));break}case"setSingleFingerPan":localStorage.setItem(v.SINGLE_FINGER_PAN,String(e.enabled)),document.dispatchEvent(new CustomEvent("synth:singleFingerPanChange",{detail:{enabled:e.enabled}}));break;case"setMultitouchControls":localStorage.setItem(v.MULTITOUCH_CONTROLS,String(e.enabled)),document.dispatchEvent(new CustomEvent("synth:multitouchControlsChange",{detail:{enabled:e.enabled}}));break;case"setDebugGlobal":localStorage.setItem(v.OPTIMIZATIONS_DEBUG,String(e.enabled)),document.dispatchEvent(new CustomEvent("synth:optimizationsDebugChange",{detail:{enabled:e.enabled}}));break;case"setDormancy":localStorage.setItem(v.DORMANCY_ENABLED,String(e.enabled)),document.dispatchEvent(new CustomEvent("synth:dormancyEnabledChange",{detail:{enabled:e.enabled}}));break;case"setDormancyDebug":localStorage.setItem(v.DORMANCY_DEBUG,String(e.enabled)),document.dispatchEvent(new CustomEvent("synth:dormancyDebugChange",{detail:{enabled:e.enabled}}));break;case"setFilterBypass":localStorage.setItem(v.FILTER_BYPASS_ENABLED,String(e.enabled)),document.dispatchEvent(new CustomEvent("synth:filterBypassEnabledChange",{detail:{enabled:e.enabled}}));break;case"setFilterBypassDebug":localStorage.setItem(v.FILTER_BYPASS_DEBUG,String(e.enabled)),document.dispatchEvent(new CustomEvent("synth:filterBypassDebugChange",{detail:{enabled:e.enabled}}));break;case"setSoftClip":localStorage.setItem(v.VOLTAGE_SOFT_CLIP_ENABLED,String(e.enabled)),document.dispatchEvent(new CustomEvent("synth:voltageSoftClipChange",{detail:{enabled:e.enabled}}));break;case"setPinTolerance":localStorage.setItem(v.VOLTAGE_PIN_TOLERANCE_ENABLED,String(e.enabled)),document.dispatchEvent(new CustomEvent("synth:voltagePinToleranceChange",{detail:{enabled:e.enabled}}));break;case"setThermalDrift":localStorage.setItem(v.VOLTAGE_THERMAL_DRIFT_ENABLED,String(e.enabled)),document.dispatchEvent(new CustomEvent("synth:voltageThermalDriftChange",{detail:{enabled:e.enabled}}));break;case"setTelemetry":localStorage.setItem(v.TELEMETRY_ENABLED,String(e.enabled)),Promise.resolve().then(()=>(Pn(),al)).then(({setEnabled:t})=>t(e.enabled)),document.dispatchEvent(new CustomEvent("synth:telemetryEnabledChange",{detail:{enabled:e.enabled}}));break;case"resetSynth":document.dispatchEvent(new CustomEvent("synth:resetToDefaults"));break;case"toggleOsc":document.dispatchEvent(new CustomEvent("osc:toggle"));break;case"setOscSendToSC":localStorage.setItem(v.OSC_SUPERCOLLIDER_SEND,String(e.enabled)),document.dispatchEvent(new CustomEvent("synth:settingChanged",{detail:{key:"oscSendToSC",value:e.enabled}}));break;case"setOscReceiveFromSC":localStorage.setItem(v.OSC_SUPERCOLLIDER_RECEIVE,String(e.enabled)),document.dispatchEvent(new CustomEvent("synth:settingChanged",{detail:{key:"oscReceiveFromSC",value:e.enabled}}));break;case"toggleOscLog":localStorage.setItem(v.OSC_LOG_VISIBLE,String(e.visible)),window.dispatchEvent(new CustomEvent("osc:log-visibility",{detail:{visible:e.visible}}));break;case"toggleFullscreen":try{document.fullscreenElement?(typeof window.__synthPrepareForFullscreen=="function"&&window.__synthPrepareForFullscreen(!1),document.exitFullscreen()):(typeof window.__synthPrepareForFullscreen=="function"&&window.__synthPrepareForFullscreen(!0),document.documentElement.requestFullscreen())}catch(t){Es.error("Fullscreen toggle failed:",t)}break;case"zoomIn":window.__synthFocusedPip&&window.__synthZoomFocusedPip?window.__synthZoomFocusedPip("in"):document.dispatchEvent(new CustomEvent("synth:zoomIn"));break;case"zoomOut":window.__synthFocusedPip&&window.__synthZoomFocusedPip?window.__synthZoomFocusedPip("out"):document.dispatchEvent(new CustomEvent("synth:zoomOut"));break;case"zoomReset":window.__synthFocusedPip&&window.__synthZoomFocusedPip?window.__synthZoomFocusedPip("reset"):document.dispatchEvent(new CustomEvent("synth:zoomReset"));break;case"openSettings":document.dispatchEvent(new CustomEvent("synth:toggleSettings",{detail:{tabId:e?.tab}}));break;case"setLocale":e?.locale&&Promise.resolve().then(()=>(Oe(),Ul)).then(({setLocale:t})=>{t(e.locale)});break;case"openUrl":window.open(e?.url,"_blank");break;case"checkUpdates":break;default:Es.warn(`Unknown menu action: ${o}`)}}var Ai=null;function Uo(){return Ai||(Ai={togglePip:null,openAllPips:null,closeAllPips:null},Promise.resolve().then(()=>(Xn(),vc)).then(o=>{Ai.togglePip=o.togglePip,Ai.openAllPips=o.openAllPips,Ai.closeAllPips=o.closeAllPips})),Ai}function Vh(){document.addEventListener("synth:muteChanged",e=>{Ft({muted:e.detail?.muted??!1})}),document.addEventListener("synth:recordingChanged",e=>{Ft({recording:e.detail?.recording??!1})}),document.addEventListener("synth:dspChanged",e=>{Ft({dspEnabled:e.detail?.enabled??!0})}),document.addEventListener("osc:statusChanged",e=>{Ft({oscEnabled:e.detail?.enabled??!1})}),document.addEventListener("synth:patchBrowserChanged",e=>{Ft({patchBrowserOpen:e.detail?.open??!1})}),window.addEventListener("pip:open",()=>{let e=Kn(),t={};["panel-1","panel-2","panel-3","panel-4","panel-5","panel-6","panel-output"].forEach(n=>{t[n]=e.includes(n)}),Ft({pipPanels:t})}),window.addEventListener("pip:close",()=>{let e=Kn(),t={};["panel-1","panel-2","panel-3","panel-4","panel-5","panel-6","panel-output"].forEach(n=>{t[n]=e.includes(n)}),Ft({pipPanels:t})});let o={"synth:showInactivePinsChange":e=>({inactivePins:e.detail?.show??!1}),"synth:faderResponseChanged":e=>({linearFaders:e.detail?.linear??!0}),"synth:sharpRasterizeChange":e=>({sharpRasterize:e.detail?.enabled??!1}),"synth:optimizationsDebugChange":e=>({debugGlobal:e.detail?.enabled??!1}),"synth:dormancyEnabledChange":e=>({dormancy:e.detail?.enabled??!0}),"synth:dormancyDebugChange":e=>({dormancyDebug:e.detail?.enabled??!1}),"synth:filterBypassEnabledChange":e=>({filterBypass:e.detail?.enabled??!0}),"synth:filterBypassDebugChange":e=>({filterBypassDebug:e.detail?.enabled??!1}),"synth:voltageSoftClipChange":e=>({softClip:e.detail?.enabled??!0}),"synth:voltagePinToleranceChange":e=>({pinTolerance:e.detail?.enabled??!0}),"synth:voltageThermalDriftChange":e=>({thermalDrift:e.detail?.enabled??!0}),"synth:telemetryEnabledChange":e=>({telemetryEnabled:e.detail?.enabled??!1}),"synth:panLockChange":e=>({lockPan:e.detail?.enabled??!1}),"synth:zoomLockChange":e=>({lockZoom:e.detail?.enabled??!1}),"synth:singleFingerPanChange":e=>({singleFingerPan:e.detail?.enabled??!0}),"synth:multitouchControlsChange":e=>({multitouchControls:e.detail?.enabled??!1}),"synth:wakeLockChange":e=>({preventSleep:e.detail?.enabled??!0})};for(let[e,t]of Object.entries(o))document.addEventListener(e,n=>Ft(t(n)));document.addEventListener("synth:settingChanged",e=>{let{key:t,value:n}=e.detail||{},s={tooltipShowVoltage:"tooltipVoltage",tooltipShowAudioValues:"tooltipAudioRate",rememberVisualLayout:"rememberVisualLayout",oscSendToSC:"oscSendToSC",oscReceiveFromSC:"oscReceiveFromSC",oscLogVisible:"oscShowLog"}[t];s&&Ft({[s]:n})}),document.addEventListener("synth:quickbarVisibilityChanged",e=>{Ft({quickbarVisible:e.detail?.visible??!0})})}function Uc(){if(!qc){if(!window.menuAPI){Es.info("Not in Electron, menu bridge disabled");return}qc=!0,Es.info("Initializing Electron menu bridge"),Uo(),$c(),Ft(),window.menuAPI.onMenuAction(Fh),Vh(),Pe(()=>{$c()})}}function An(o,e,t={}){!o||!o.element||(t.row&&(o.element.style.setProperty("--panel-row",t.row),o.element.dataset.panelRow=t.row),t.col&&(o.element.style.setProperty("--panel-col",t.col),o.element.dataset.panelCol=t.col))}var Ho={knobSize:40,knobInnerPct:76,knobGap:[8],knobRowOffsetX:0,knobRowOffsetY:0,knobOffsets:[0,0]},Ss={knobSize:42,knobInnerPct:78,knobGap:[8,8,8,8,8,8],knobRowOffsetX:0,knobRowOffsetY:-6,knobOffsets:[0,0,0,0,0,0,0],switchOffset:{leftPercent:36,topPx:6},slotOffset:{x:0,y:0}};function Hc(){let o=at?.layout?.oscillators||{},e=o.oscSize||{width:370,height:110},t=o.gap||{x:0,y:0},n=o.airOuter??0,i=o.airOuterY??0,s=o.rowsPerColumn??6,a=o.topOffset??10,r=o.reservedHeight??e.height,l={...Ss,...at?.oscillatorUI};return{oscSize:e,padding:6,gap:t,airOuter:n,airOuterY:i,rowsPerColumn:s,topOffset:a,reservedHeight:r,oscUIDefaults:l}}function Wc(o,e){return e?{...o,...e,switchOffset:{...o.switchOffset||Ss.switchOffset,...e.switchOffset||{}},slotOffset:{...o.slotOffset||Ss.slotOffset,...e.slotOffset||{}},knobOffsets:e.knobOffsets||o.knobOffsets||Ss.knobOffsets,knobGap:e.knobGap||o.knobGap||Ss.knobGap}:{...o}}function jc(){return{...Ho,...at?.noiseUI}}function Yc(){return{...Ho,...at?.randomCVUI}}function Wo(o,e){return e?{...o,...e,knobOffsets:e.knobOffsets||o.knobOffsets||Ho.knobOffsets,knobGap:e.knobGap||o.knobGap||Ho.knobGap}:{...o}}Oe();var jo="0.7.0-20260227.092510";function Kc(o){let e=document.getElementById("splashVersion");e&&(e.textContent=o),document.querySelectorAll(".panel-build-version").forEach(n=>{n.textContent=`Versi\xF3n ${o}`})}async function Xc(){if(jo&&jo!=="__BUILD_VERSION__"){window.__synthBuildVersion=jo,Kc(jo);return}try{let o=await fetch("../package.json",{cache:"no-store"});if(o&&o.ok){let e=await o.json();if(e&&e.version){let t=`${e.version}-src`;window.__synthBuildVersion=t,Kc(t)}}}catch{}}Ms();Pn();Te();Oe();Te();be();var Mr=W("OSCLogWindow"),Gh="./assets/icons/ui-sprite.svg",Pr=o=>`
  <svg viewBox="0 0 24 24" width="16" height="16" aria-hidden="true" focusable="false"
    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <use href="${Gh}#${o}"></use>
  </svg>
`,Zc=200,Ri=null,Or=class{constructor(){if(Ri)return Ri;Ri=this,this.element=null,this.logContainer=null,this.isVisible=!1,this.isDragging=!1,this.dragOffset={x:0,y:0},this.entries=[],this.filter="all",this.isPaused=!1,this._boundOnMessage=this._onMessage.bind(this),this._boundOnDrag=this._onDrag.bind(this),this._boundOnDragEnd=this._onDragEnd.bind(this),this._createDOM(),this._setupListeners()}_createDOM(){this.element=document.createElement("div"),this.element.className="osc-log-window",this.element.setAttribute("data-prevent-pan","true");let e=document.createElement("div");e.className="osc-log-window__header";let t=document.createElement("span");t.className="osc-log-window__title",t.textContent=u("osc.log.title");let n=document.createElement("div");n.className="osc-log-window__controls",this.pauseBtn=document.createElement("button"),this.pauseBtn.type="button",this.pauseBtn.className="osc-log-window__btn",this.pauseBtn.title=u("osc.log.pause"),this.pauseBtn.innerHTML=Pr("ti-player-pause"),this.pauseBtn.addEventListener("click",()=>this.togglePause());let i=document.createElement("button");i.type="button",i.className="osc-log-window__btn",i.title=u("osc.log.clear"),i.innerHTML=Pr("ti-trash"),i.addEventListener("click",()=>this.clear());let s=document.createElement("button");s.type="button",s.className="osc-log-window__btn osc-log-window__btn--close",s.title=u("osc.log.close"),s.innerHTML="\xD7",s.addEventListener("click",()=>this.hide()),n.appendChild(this.pauseBtn),n.appendChild(i),n.appendChild(s),e.appendChild(t),e.appendChild(n);let a=document.createElement("div");a.className="osc-log-window__filters",["all","in","out"].forEach(l=>{let c=document.createElement("button");c.type="button",c.className="osc-log-window__filter",c.dataset.filter=l,c.textContent=u(`osc.log.filter.${l}`),l===this.filter&&c.classList.add("is-active"),c.addEventListener("click",()=>this.setFilter(l)),a.appendChild(c)}),this.logContainer=document.createElement("div"),this.logContainer.className="osc-log-window__log";let r=document.createElement("div");r.className="osc-log-window__empty",r.textContent=u("osc.log.noMessages"),this.logContainer.appendChild(r),this.element.appendChild(e),this.element.appendChild(a),this.element.appendChild(this.logContainer),e.addEventListener("mousedown",l=>this._onDragStart(l)),e.addEventListener("touchstart",l=>this._onDragStart(l),{passive:!1}),this.element.hidden=!0,document.body.appendChild(this.element),this._loadPosition()}_setupListeners(){window.addEventListener("osc:log-visibility",e=>{e.detail.visible?(this.show(),Mr.info("Log window visibility requested: showing")):this.hide(e.detail.updateCheckbox!==!1)}),window.addEventListener("osc:message",e=>{e.detail&&this._onMessage(e.detail)})}_onMessage(e){if(this.isPaused)return;let{address:t,args:n,direction:i="in",source:s}=e;this._addEntry({time:new Date,direction:i,address:t,args:n,source:s})}_addEntry(e){this.entries.push(e),this.entries.length>Zc&&this.entries.shift(),this._renderEntry(e)}_renderEntry(e){let t=this.logContainer.querySelector(".osc-log-window__empty");if(t&&t.remove(),this.filter!=="all"&&this.filter!==e.direction)return;let n=document.createElement("div");n.className=`osc-log-window__entry osc-log-window__entry--${e.direction}`;let i=e.time.toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit",second:"2-digit",fractionalSecondDigits:3}),s=e.direction==="in"?"\u2190":"\u2192",a=e.args?.map(r=>typeof r=="number"?Number.isInteger(r)?r:r.toFixed(4):JSON.stringify(r)).join(" ")||"";for(n.textContent=`${i} ${s} ${e.address||"(no addr)"} ${a}`,this.logContainer.appendChild(n),this.logContainer.scrollTop=this.logContainer.scrollHeight;this.logContainer.children.length>Zc;)this.logContainer.firstChild.remove()}setFilter(e){this.filter=e,this.element.querySelectorAll(".osc-log-window__filter").forEach(t=>{t.classList.toggle("is-active",t.dataset.filter===e)}),this._rerenderLog()}_rerenderLog(){this.logContainer.innerHTML="";let e=this.entries.filter(t=>this.filter==="all"||this.filter===t.direction);if(e.length===0){let t=document.createElement("div");t.className="osc-log-window__empty",t.textContent=u("osc.log.empty","No hay mensajes OSC"),this.logContainer.appendChild(t);return}e.forEach(t=>this._renderEntry(t))}togglePause(){this.isPaused=!this.isPaused,this.pauseBtn.innerHTML=Pr(this.isPaused?"ti-player-play":"ti-player-pause"),this.pauseBtn.title=u(this.isPaused?"osc.log.resume":"osc.log.pause"),this.pauseBtn.classList.toggle("is-active",this.isPaused)}clear(){this.entries=[],this.logContainer.innerHTML="";let e=document.createElement("div");e.className="osc-log-window__empty",e.textContent=u("osc.log.noMessages"),this.logContainer.appendChild(e)}show(){if(this.isVisible)return;this.isVisible=!0,this.element.hidden=!1,localStorage.setItem(v.OSC_LOG_VISIBLE,"true");let e=document.getElementById("osc-log-checkbox");e&&(e.checked=!0),document.dispatchEvent(new CustomEvent("synth:settingChanged",{detail:{key:"oscLogVisible",value:!0}})),Mr.info("Log window shown")}hide(e=!0){if(this.isVisible=!1,this.element.hidden=!0,e){localStorage.setItem(v.OSC_LOG_VISIBLE,"false");let t=document.getElementById("osc-log-checkbox");t&&(t.checked=!1),document.dispatchEvent(new CustomEvent("synth:settingChanged",{detail:{key:"oscLogVisible",value:!1}}))}Mr.info("Log window hidden")}toggle(){this.isVisible?this.hide():this.show()}_onDragStart(e){if(e.target.closest("button"))return;this.isDragging=!0,this.element.classList.add("is-dragging");let t=e.touches?e.touches[0].clientX:e.clientX,n=e.touches?e.touches[0].clientY:e.clientY,i=this.element.getBoundingClientRect();this.dragOffset={x:t-i.left,y:n-i.top},document.addEventListener("mousemove",this._boundOnDrag),document.addEventListener("mouseup",this._boundOnDragEnd),document.addEventListener("touchmove",this._boundOnDrag,{passive:!1}),document.addEventListener("touchend",this._boundOnDragEnd),e.preventDefault()}_onDrag(e){if(!this.isDragging)return;let t=e.touches?e.touches[0].clientX:e.clientX,n=e.touches?e.touches[0].clientY:e.clientY,i=t-this.dragOffset.x,s=n-this.dragOffset.y,a=this.element.getBoundingClientRect();i=Math.max(0,Math.min(window.innerWidth-a.width,i)),s=Math.max(0,Math.min(window.innerHeight-a.height,s)),this.element.style.left=`${i}px`,this.element.style.top=`${s}px`,this.element.style.right="auto",this.element.style.bottom="auto",e.preventDefault()}_onDragEnd(){this.isDragging=!1,this.element.classList.remove("is-dragging"),document.removeEventListener("mousemove",this._boundOnDrag),document.removeEventListener("mouseup",this._boundOnDragEnd),document.removeEventListener("touchmove",this._boundOnDrag),document.removeEventListener("touchend",this._boundOnDragEnd),this._savePosition()}_savePosition(){let e=this.element.getBoundingClientRect();localStorage.setItem("synthigme:osc-log-position",JSON.stringify({x:e.left,y:e.top}))}_loadPosition(){try{let e=localStorage.getItem("synthigme:osc-log-position");if(e){let{x:t,y:n}=JSON.parse(e);this.element.style.left=`${t}px`,this.element.style.top=`${n}px`,this.element.style.right="auto",this.element.style.bottom="auto"}}catch{}}logOutgoing(e,t){this._onMessage({address:e,args:t,direction:"out"})}logIncoming(e,t,n){this._onMessage({address:e,args:t,direction:"in",source:n})}};function qh(){return Ri||(Ri=new Or),Ri}function Jc(){return typeof window.oscAPI>"u"?null:qh()}var Qc={osc:{indexed:!0,count:12,parameters:{range:{type:"enum",values:["lo","hi"]},frequency:{type:"float",min:0,max:10},pulselevel:{type:"float",min:0,max:10},pulseshape:{type:"float",min:-5,max:5},sinelevel:{type:"float",min:0,max:10},sinesymmetry:{type:"float",min:-5,max:5},trianglelevel:{type:"float",min:0,max:10},sawtoothlevel:{type:"float",min:0,max:10}}},audio:{indexed:!1,parameters:{_dynamic:{type:"matrix",valueType:"string",values:["WHITE","GREY","GREEN","RED","BLUE","YELLOW","CYAN","PURPLE",0]}}},cv:{indexed:!1,parameters:{_dynamic:{type:"matrix",valueType:"string",values:["WHITE","GREY","GREEN","RED","BLUE","YELLOW","CYAN","PURPLE",0]}}},out:{indexed:!0,count:8,parameters:{level:{type:"float",min:0,max:10},filter:{type:"float",min:-5,max:5},on:{type:"int",values:[0,1]},pan:{type:"float",min:0,max:10}}},in:{indexed:!0,count:8,parameters:{level:{type:"float",min:0,max:10}}},return:{indexed:!0,count:2,parameters:{level:{type:"float",min:0,max:10}}},env:{indexed:!0,count:3,parameters:{delay:{type:"float",min:0,max:10},attack:{type:"float",min:0,max:10},decay:{type:"float",min:0,max:10},sustain:{type:"float",min:0,max:10},release:{type:"float",min:0,max:10},envelopeLevel:{type:"float",min:-5,max:5},signalLevel:{type:"float",min:-5,max:5},gate:{type:"trigger"},selector:{type:"enum"}}},ring:{indexed:!0,count:3,parameters:{level:{type:"float",min:0,max:10}}},noise:{indexed:!0,count:2,parameters:{colour:{type:"float",min:0,max:10},level:{type:"float",min:0,max:10}}},random:{indexed:!1,parameters:{mean:{type:"float",min:-5,max:5},variance:{type:"float",min:-5,max:5},voltage1:{type:"float",min:0,max:10},voltage2:{type:"float",min:0,max:10},key:{type:"float",min:-5,max:5}}},slew:{indexed:!0,count:3,parameters:{rate:{type:"float",min:0,max:10}}},filter:{indexed:!0,count:3,parameters:{frequency:{type:"float",min:0,max:10},response:{type:"float",min:0,max:10},level:{type:"float",min:0,max:10}}},filterBank:{indexed:!1,parameters:{63:{type:"float",min:0,max:10},125:{type:"float",min:0,max:10},250:{type:"float",min:0,max:10},500:{type:"float",min:0,max:10},1e3:{type:"float",min:0,max:10},2e3:{type:"float",min:0,max:10},4e3:{type:"float",min:0,max:10},8e3:{type:"float",min:0,max:10}}},reverb:{indexed:!1,parameters:{mix:{type:"float",min:0,max:10},level:{type:"float",min:0,max:10}}},echo:{indexed:!1,parameters:{delay:{type:"float",min:0,max:10},mix:{type:"float",min:0,max:10},feedback:{type:"float",min:0,max:10},level:{type:"float",min:0,max:10}}},oscilloscope:{indexed:!1,parameters:{sensCH1:{type:"float",min:0,max:10},sensCH2:{type:"float",min:0,max:10},mode:{type:"float",min:0,max:10}}},keyboard:{indexed:!0,count:2,parameters:{midiEvent:{type:"array"},pitch:{type:"float",min:0,max:10},velocity:{type:"float",min:-5,max:5},gate:{type:"float",min:-5,max:5},retrigger:{type:"int"}}},invertor:{indexed:!1,parameters:{gain:{type:"float",min:-5,max:5},offset:{type:"float",min:-5,max:5}}},joy:{indexed:!0,count:2,parameters:{positionX:{type:"float",min:-1,max:1},positionY:{type:"float",min:-1,max:1},rangeX:{type:"float",min:0,max:10},rangeY:{type:"float",min:0,max:10}}}};function Yo(o,e,t){let n=Qc[e];if(!n)return o;let i=n.parameters[t];return!i||i.type!=="float"?o:i.min+o*(i.max-i.min)}function Ko(o,e,t){let n=Qc[e];if(!n)return o;let i=n.parameters[t];return!i||i.type!=="float"?o:(o-i.min)/(i.max-i.min)}var $h={0:"pulselevel",1:"pulseshape",2:"sinelevel",3:"sinesymmetry",4:"trianglelevel",5:"sawtoothlevel",6:"frequency"},eu={pulselevel:0,pulseshape:1,sinelevel:2,sinesymmetry:3,trianglelevel:4,sawtoothlevel:5,frequency:6},Ir=class{constructor(){this._unsubscribers=new Map,this._app=null,this._ignoreOSCUpdates=!1,this._lastSentValues=new Map}init(e){this._app=e,this._setupListeners(),console.log("[OscillatorOSCSync] Inicializado para 12 osciladores")}sendKnobChange(e,t,n){if(!J.connected)return;let i=$h[t];if(!i)return;let s=i==="frequency"?n:Yo(n,"osc",i),a=`osc/${e+1}/${i}`,r=a,l=this._lastSentValues.get(r);l!==void 0&&Math.abs(l-s)<1e-4||(this._lastSentValues.set(r,s),J.send(a,s))}sendRangeChange(e,t){if(!J.connected)return;let n=`osc/${e+1}/range`,i=n;this._lastSentValues.get(i)!==t&&(this._lastSentValues.set(i,t),J.send(n,t))}_setupListeners(){this._unsubscribers.forEach(e=>e()),this._unsubscribers.clear();for(let e=1;e<=12;e++){Object.keys(eu).forEach(i=>{let s=`osc/${e}/${i}`,a=J.on(s,(r,l,c)=>{this._handleIncomingKnob(e-1,i,r)});this._unsubscribers.set(`osc-${e}-${i}`,a)});let t=`osc/${e}/range`,n=J.on(t,(i,s,a)=>{this._handleIncomingRange(e-1,i)});this._unsubscribers.set(`osc-${e}-range`,n)}}_handleIncomingKnob(e,t,n){if(this._ignoreOSCUpdates||!this._app)return;let i=eu[t];if(i===void 0)return;let s=t==="frequency"?n:Ko(n,"osc",t);this._ignoreOSCUpdates=!0;try{let a=`panel3-osc-${e+1}`,r=this._app._oscillatorUIs?.[a];r&&r.knobs[i]&&(r.knobs[i].setValue(s),this._applyToAudio(e,i,s,r))}finally{setTimeout(()=>{this._ignoreOSCUpdates=!1},10)}}_handleIncomingRange(e,t){if(this._ignoreOSCUpdates||!this._app)return;let n=t==="lo"||t==="LO"?"lo":"hi";this._ignoreOSCUpdates=!0;try{let i=`panel3-osc-${e+1}`,s=this._app._oscillatorUIs?.[i];if(s){s.rangeState=n;let a=document.querySelector(`#${i} .output-channel__switch`);a&&(s._renderRange(a),Ae(a)),this._app._onOscRangeChange&&this._app._onOscRangeChange(3,e,n)}}finally{setTimeout(()=>{this._ignoreOSCUpdates=!1},10)}}_applyToAudio(e,t,n,i){if(!this._app)return;let s=3;switch(t){case 0:this._app._updatePanelPulseVolume?.(s,e,n);break;case 1:this._app._updatePanelPulseWidth?.(s,e,n);break;case 2:this._app._updatePanelOscVolume?.(s,e,n);break;case 3:this._app._updatePanelSineSymmetry?.(s,e,n);break;case 4:this._app._updatePanelTriVolume?.(s,e,n);break;case 5:this._app._updatePanelSawVolume?.(s,e,n);break;case 6:let a=i?.rangeState==="lo";this._app._updatePanelOscFreq?.(s,e,n,a);break}}shouldIgnoreOSC(){return this._ignoreOSCUpdates}destroy(){this._unsubscribers.forEach(e=>e()),this._unsubscribers.clear(),this._app=null}},Ye=new Ir;var Nr=class{constructor(){this._unsubscribers=new Map,this._app=null,this._ignoreOSCUpdates=!1,this._lastSentValues=new Map}init(e){this._app=e,this._setupListeners(),console.log("[InputAmplifierOSCSync] Inicializado para 8 canales")}sendLevelChange(e,t){if(!J.connected)return;let n=Yo(t,"in","level"),i=`in/${e+1}/level`,s=this._lastSentValues.get(i);s!==void 0&&Math.abs(s-n)<1e-4||(this._lastSentValues.set(i,n),J.send(i,n))}_setupListeners(){this._unsubscribers.forEach(e=>e()),this._unsubscribers.clear();for(let e=1;e<=8;e++){let t=`in/${e}/level`,n=J.on(t,i=>{this._handleIncomingLevel(e-1,i)});this._unsubscribers.set(`in-${e}-level`,n)}}_handleIncomingLevel(e,t){if(this._ignoreOSCUpdates||!this._app)return;let n=Ko(t,"in","level");this._ignoreOSCUpdates=!0;try{this._app.inputAmplifiers&&this._app.inputAmplifiers.setLevel(e,n);let i=this._app._inputAmplifierUIs?.["input-amplifiers"];i&&i.knobs?.[e]&&i.knobs[e].setValue(n)}finally{setTimeout(()=>{this._ignoreOSCUpdates=!1},10)}}shouldIgnoreOSC(){return this._ignoreOSCUpdates}destroy(){this._unsubscribers.forEach(e=>e()),this._unsubscribers.clear(),this._app=null}},Xo=new Nr;var Dr=class{constructor(){this._unsubscribers=new Map,this._app=null,this._ignoreOSCUpdates=!1,this._lastSentValues=new Map}init(e){this._app=e,this._setupListeners(),console.log("[NoiseGeneratorOSCSync] Inicializado para 2 generadores")}sendColourChange(e,t){if(!J.connected)return;let n=`noise/${e+1}/colour`,i=this._lastSentValues.get(n);i!==void 0&&Math.abs(i-t)<1e-4||(this._lastSentValues.set(n,t),J.send(n,t))}sendLevelChange(e,t){if(!J.connected)return;let n=`noise/${e+1}/level`,i=this._lastSentValues.get(n);i!==void 0&&Math.abs(i-t)<1e-4||(this._lastSentValues.set(n,t),J.send(n,t))}_setupListeners(){this._unsubscribers.forEach(t=>t()),this._unsubscribers.clear();let e=["colour","level"];for(let t=1;t<=2;t++)for(let n of e){let i=`noise/${t}/${n}`,s=J.on(i,a=>{this._handleIncoming(t-1,n,a)});this._unsubscribers.set(`noise-${t}-${n}`,s)}}_handleIncoming(e,t,n){if(!(this._ignoreOSCUpdates||!this._app)){this._ignoreOSCUpdates=!0;try{let i=e===0?"noise1":"noise2",a=this._app._panel3LayoutData?.noiseAudioModules?.[i],r=`panel3-noise-${e+1}`,l=this._app._noiseUIs?.[r];t==="colour"?(a&&a.setColour(n),l?.knobs?.colour&&l.knobs.colour.setValue(n)):t==="level"&&(a&&a.setLevel(n),l?.knobs?.level&&l.knobs.level.setValue(n))}finally{setTimeout(()=>{this._ignoreOSCUpdates=!1},10)}}}shouldIgnoreOSC(){return this._ignoreOSCUpdates}destroy(){this._unsubscribers.forEach(e=>e()),this._unsubscribers.clear(),this._app=null}},Qt=new Dr;var Br=class{constructor(){this._unsubscribers=new Map,this._app=null,this._ignoreOSCUpdates=!1,this._lastSentValues=new Map}init(e){this._app=e,this._setupListeners(),console.log("[JoystickOSCSync] Inicializado para 2 joysticks")}sendPositionChange(e,t,n){if(!J.connected)return;let i=e+1,s=`joy/${i}/positionX`,a=this._lastSentValues.get(s);(a===void 0||Math.abs(a-t)>=.001)&&(this._lastSentValues.set(s,t),J.send(s,t));let r=`joy/${i}/positionY`,l=this._lastSentValues.get(r);(l===void 0||Math.abs(l-n)>=.001)&&(this._lastSentValues.set(r,n),J.send(r,n))}sendRangeYChange(e,t){if(!J.connected)return;let n=`joy/${e+1}/rangeY`,i=this._lastSentValues.get(n);i!==void 0&&Math.abs(i-t)<1e-4||(this._lastSentValues.set(n,t),J.send(n,t))}sendRangeXChange(e,t){if(!J.connected)return;let n=`joy/${e+1}/rangeX`,i=this._lastSentValues.get(n);i!==void 0&&Math.abs(i-t)<1e-4||(this._lastSentValues.set(n,t),J.send(n,t))}_setupListeners(){this._unsubscribers.forEach(t=>t()),this._unsubscribers.clear();let e=["positionX","positionY","rangeX","rangeY"];for(let t=1;t<=2;t++)for(let n of e){let i=`joy/${t}/${n}`,s=J.on(i,a=>{this._handleIncoming(t-1,n,a)});this._unsubscribers.set(`joy-${t}-${n}`,s)}}_handleIncoming(e,t,n){if(!(this._ignoreOSCUpdates||!this._app)){this._ignoreOSCUpdates=!0;try{let i=e===0?"left":"right",s=this._app._joystickModules?.[i],a=this._app._joystickUIs?.[`joystick-${i}`],r=this._app._joystickKnobs?.[i];if(!s)return;switch(t){case"positionX":case"positionY":{let l=s.x||0,c=s.y||0,d=t==="positionX"?n:l,h=t==="positionY"?n:c;if(s.setPosition(d,h),a?.padEl){let p=a.padEl.querySelector(".joystick-handle");if(p){let g=(d*.83+1)/2,_=(1-h*.83)/2;p.style.left=g*100+"%",p.style.top=_*100+"%",p.style.transform="translate(-50%, -50%)"}Ae(a.padEl)}break}case"rangeY":{let c=a?.config?.knobs?.rangeY?.max||10;s.setRangeY(n),r?.rangeY&&r.rangeY.knob.setValue(n/c);break}case"rangeX":{let c=a?.config?.knobs?.rangeX?.max||10;s.setRangeX(n),r?.rangeX&&r.rangeX.knob.setValue(n/c);break}}}finally{setTimeout(()=>{this._ignoreOSCUpdates=!1},10)}}}shouldIgnoreOSC(){return this._ignoreOSCUpdates}destroy(){this._unsubscribers.forEach(e=>e()),this._unsubscribers.clear(),this._app=null}},Lt=new Br;function Uh(o){if(!o||!o.kind)return null;switch(o.kind){case"inputAmp":return`in/${(o.channel??0)+1}`;case"outputBus":return`bus/${o.bus}`;case"noiseGen":return`noise/${(o.index??0)+1}`;case"panel3Osc":{let e=(o.oscIndex??0)+1,t=o.channelId==="triPulse"?"triPul":"sinSaw";return`osc/${e}/${t}`}case"joystick":return`joy/${o.side==="right"?"R":"L"}/${o.axis||"y"}`;default:return null}}function Hh(o){if(!o||!o.kind)return null;switch(o.kind){case"outputBus":return`Out/${o.bus}`;case"oscSync":return`Sync/${(o.oscIndex??0)+1}`;case"oscilloscope":return`Scope/${o.channel||"Y"}`;case"oscFreqCV":return`Freq/${(o.oscIndex??0)+1}`;case"oscPWM":return`PWM/${(o.oscIndex??0)+1}`;case"outputLevelCV":return`Level/${(o.busIndex??0)+1}`;default:return null}}function Wh(o){if(!o.length)return null;let e=o[0];if(e==="in"&&o.length>=2){let t=parseInt(o[1],10);if(!isNaN(t))return{source:{kind:"inputAmp",channel:t-1},remainingParts:o.slice(2)}}if(e==="bus"&&o.length>=2){let t=parseInt(o[1],10);if(!isNaN(t))return{source:{kind:"outputBus",bus:t},remainingParts:o.slice(2)}}if(e==="noise"&&o.length>=2){let t=parseInt(o[1],10);if(!isNaN(t))return{source:{kind:"noiseGen",index:t-1},remainingParts:o.slice(2)}}if(e==="osc"&&o.length>=3){let t=parseInt(o[1],10),n=o[2];if(!isNaN(t)&&(n==="sinSaw"||n==="triPul")){let i=n==="triPul"?"triPulse":"sineSaw";return{source:{kind:"panel3Osc",oscIndex:t-1,channelId:i},remainingParts:o.slice(3)}}}if(e==="joy"&&o.length>=3){let t=o[1],n=o[2];if((t==="L"||t==="R")&&(n==="x"||n==="y"))return{source:{kind:"joystick",side:t==="R"?"right":"left",axis:n},remainingParts:o.slice(3)}}return null}function jh(o,e){if(!o.length)return null;let t=o[0];if(t==="Out"&&o.length>=2){let n=parseInt(o[1],10);if(!isNaN(n))return{kind:"outputBus",bus:n}}if(t==="Sync"&&o.length>=2&&e==="audio"){let n=parseInt(o[1],10);if(!isNaN(n))return{kind:"oscSync",oscIndex:n-1}}if(t==="Scope"&&o.length>=2){let n=o[1];if(n==="Y"||n==="X")return{kind:"oscilloscope",channel:n}}if(t==="Freq"&&o.length>=2&&e==="cv"){let n=parseInt(o[1],10);if(!isNaN(n))return{kind:"oscFreqCV",oscIndex:n-1}}if(t==="PWM"&&o.length>=2&&e==="audio"){let n=parseInt(o[1],10);if(!isNaN(n))return{kind:"oscPWM",oscIndex:n-1}}if(t==="Level"&&o.length>=2&&e==="cv"){let n=parseInt(o[1],10);if(!isNaN(n))return{kind:"outputLevelCV",busIndex:n-1}}return null}function Yh(o,e){if(!o||!e)return null;for(let[t,n]of o.entries())if(n.kind===e.kind)switch(n.kind){case"inputAmp":if(n.channel===e.channel)return t;break;case"outputBus":if(n.bus===e.bus)return t;break;case"noiseGen":if(n.index===e.index)return t;break;case"panel3Osc":if(n.oscIndex===e.oscIndex&&n.channelId===e.channelId)return t;break;case"joystick":if(n.side===e.side&&n.axis===e.axis)return t;break}return null}function Kh(o,e){if(!o||!e)return null;for(let[t,n]of o.entries())if(n.kind===e.kind)switch(n.kind){case"outputBus":if(n.bus===e.bus)return t;break;case"oscSync":if(n.oscIndex===e.oscIndex)return t;break;case"oscilloscope":if(n.channel===e.channel)return t;break;case"oscFreqCV":if(n.oscIndex===e.oscIndex)return t;break;case"oscPWM":if(n.oscIndex===e.oscIndex)return t;break;case"outputLevelCV":if(n.busIndex===e.busIndex)return t;break}return null}var Xh=new Set(["WHITE","GREY","GREEN","RED","BLUE","YELLOW","CYAN","PURPLE"]);function Zh(o){if(o===0||o==="0")return{action:"disconnect",pinColor:null,gain:null,tolerance:null};if(typeof o=="string"){let e=o.toUpperCase();if(Xh.has(e))return{action:"connect",pinColor:e,gain:null,tolerance:null}}if(Array.isArray(o)&&o.length>=2){let e=parseFloat(o[0]),t=parseFloat(o[1]);if(!isNaN(e)&&!isNaN(t))return e===0?{action:"disconnect",pinColor:null,gain:null,tolerance:null}:{action:"connect",pinColor:Qh(e),gain:e,tolerance:t}}return typeof o=="number"&&o>0?{action:"connect",pinColor:"WHITE",gain:null,tolerance:null}:{action:"disconnect",pinColor:null,gain:null,tolerance:null}}var Jh={PURPLE:.1,CYAN:.4,WHITE:1,GREY:1,GREEN:1.47,YELLOW:4.5,BLUE:10,RED:37};function Qh(o){let e="WHITE",t=1/0;for(let[n,i]of Object.entries(Jh)){let s=Math.abs(Math.log(o)-Math.log(i));s<t&&(t=s,e=n)}return e}var zr=class{constructor(){this._unsubscribers=new Map,this._app=null,this._ignoreOSCUpdates=!1,this._lastSentValues=new Map}init(e){this._app=e,this._setupListeners(),console.log("[MatrixOSCSync] Inicializado para matrices audio y control")}sendAudioPinChange(e,t,n,i){this._sendPinChange("audio",e,t,n,i)}sendControlPinChange(e,t,n,i){this._sendPinChange("cv",e,t,n,i)}_sendPinChange(e,t,n,i,s){if(!J.connected)return;let a=e==="audio"?this._app?._panel3Routing:this._app?._panel6Routing;if(!a?.sourceMap||!a?.destMap)return;let r=a.sourceMap.get(t),l=a.destMap.get(n);if(!r||!l)return;let c=Uh(r),d=Hh(l);if(!c||!d)return;let h=`${e}/${c}/${d}`,p=i?s||"WHITE":0,m=h,g=this._lastSentValues.get(m),_=String(p);g!==_&&(this._lastSentValues.set(m,_),J.send(h,p))}shouldIgnoreOSC(){return this._ignoreOSCUpdates}_setupListeners(){this._unsubscribers.forEach(n=>n()),this._unsubscribers.clear();let e=J.on("audio/*",(n,i,s)=>{this._handleIncoming("audio",i,n)});this._unsubscribers.set("audio-wildcard",e);let t=J.on("cv/*",(n,i,s)=>{this._handleIncoming("cv",i,n)});this._unsubscribers.set("cv-wildcard",t)}_handleIncoming(e,t,n){if(this._ignoreOSCUpdates||!this._app)return;let i=J.getFormattedPrefix(),s=t;if(s.startsWith(i)&&(s=s.slice(i.length)),s.startsWith(e+"/"))s=s.slice(e.length+1);else return;let a=s.split("/"),r=e==="audio"?this._app._panel3Routing:this._app._panel6Routing;if(!r?.sourceMap||!r?.destMap)return;let l=null,c=null;if(a.length===2&&!isNaN(parseInt(a[0],10))&&!isNaN(parseInt(a[1],10))){let h=parseInt(a[0],10),p=parseInt(a[1],10),m=this._synthCoordsToIndices(e,h,p);m&&(l=m.rowIndex,c=m.colIndex)}else{let h=Wh(a);if(!h)return;let p=jh(h.remainingParts,e);if(!p)return;l=Yh(r.sourceMap,h.source),c=Kh(r.destMap,p)}if(l===null||c===null)return;let d=Zh(n);this._applyPinChange(e,l,c,d)}_synthCoordsToIndices(e,t,n){let i=e==="audio"?this._app?._panel3Routing:this._app?._panel6Routing;if(!i)return null;let s=i.rowBase??67,a=i.colBase??1,r=i.hiddenRows??[],l=i.hiddenCols??[],c=t-s,d=n-a;if(c<0||d<0)return null;let h=new Set(r),p=new Set(l),m=63,g=67,_=[];for(let E=0;E<m;E++)h.has(E)||_.push(E);let y=[];for(let E=0;E<g;E++)p.has(E)||y.push(E);let f=_[c]??null,b=y[d]??null;return f===null||b===null||!i.sourceMap?.has(f)||!i.destMap?.has(b)?null:{rowIndex:f,colIndex:b}}_applyPinChange(e,t,n,i){if(this._app){this._ignoreOSCUpdates=!0;try{let s=e==="audio"?this._app.largeMatrixAudio:this._app.largeMatrixControl;if(!s||!s.table)return;let a=`${t}:${n}`,r=e==="audio"?this._app._panel3Routing:this._app._panel6Routing,l=!!r?.connections?.[a],c=i.action==="connect",d=s.table.querySelector(`button.pin-btn[data-row="${t}"][data-col="${n}"]`);if(!d||d.disabled||d.classList.contains("is-hidden-pin"))return;if(c&&!l){i.pinColor&&s._pinColors.set(a,i.pinColor);let h=s._getEffectivePinColor(t,n);s.onToggle&&s.onToggle(t,n,!0,d,h)!==!1&&(d.classList.add("active"),s._applyPinColorClass(d,h),Cn(d))}else c&&l?r.connections[a]?.pinColor!==i.pinColor&&i.pinColor&&(s._pinColors.set(a,i.pinColor),s._applyPinColorClass(d,i.pinColor),s.onPinColorChange&&s.onPinColorChange(t,n,i.pinColor,d)):!c&&l&&(s.onToggle&&s.onToggle(t,n,!1,d),d.classList.remove("active"),s._removePinColorClasses(d))}finally{setTimeout(()=>{this._ignoreOSCUpdates=!1},10)}}}destroy(){this._unsubscribers.forEach(e=>e()),this._unsubscribers.clear(),this._app=null}},tt=new zr;Te();be();var ep=W("SignalFlowHighlighter"),_e={SOURCE_GLOW:"signal-flow-source",DEST_GLOW:"signal-flow-dest",BOTH_GLOW:"signal-flow-both",SOURCE_PIN:"signal-flow-pin-source",DEST_PIN:"signal-flow-pin-dest",ACTIVE:"signal-flow-active"};function Zo(o){if(!o||!o.kind)return[];switch(o.kind){case"panel3Osc":return[`panel3-osc-${(o.oscIndex??0)+1}`];case"noiseGen":return[`panel3-noise-${(o.index??0)+1}`];case"inputAmp":return["input-amplifiers"];case"outputBus":return[`output-channel-${o.bus??1}`];case"joystick":return[`joystick-${o.side==="right"?"right":"left"}`];case"oscilloscope":return["oscilloscope-module"];case"oscSync":return[`panel3-osc-${(o.oscIndex??0)+1}`];case"oscFreqCV":return[`panel3-osc-${(o.oscIndex??0)+1}`];case"oscPWM":return[`panel3-osc-${(o.oscIndex??0)+1}`];case"outputLevelCV":return[`output-channel-${(o.busIndex??0)+1}`];default:return[]}}function ks(o){return o.closest(".synth-module, .sgme-osc, .noise-generator, .random-voltage, .output-channel-module, .panel7-joystick, .panel7-sequencer, .input-amplifier-module, .panel1-placeholder, .panel2-placeholder")}function tp(o){return o?.id||null}var Jo=class{constructor({panel5Routing:e,panel6Routing:t,matrixAudio:n,matrixControl:i}){this._panel5Routing=e,this._panel6Routing=t,this._matrixAudio=n,this._matrixControl=i,this._isActive=!1,this._modifierKeyPressed=!1,this._highlightedElements=new Set,this._highlightedPins=new Set,this._hoveredElement=null,this._enabled=!0,this._requireModifier=!1,this._modifierKey="Control";let s=localStorage.getItem(v.SIGNAL_FLOW_ENABLED);s!==null&&(this._enabled=s!=="false");let a=localStorage.getItem(v.SIGNAL_FLOW_REQUIRE_MODIFIER);a!==null&&(this._requireModifier=a==="true"),this._onKeyDown=this._handleKeyDown.bind(this),this._onKeyUp=this._handleKeyUp.bind(this),this._onMouseOver=this._handleMouseOver.bind(this),this._onMouseOut=this._handleMouseOut.bind(this),this._onClick=this._handleClick.bind(this),this._onBlur=this._handleBlur.bind(this)}init(){document.addEventListener("keydown",this._onKeyDown),document.addEventListener("keyup",this._onKeyUp),window.addEventListener("blur",this._onBlur),document.addEventListener("mouseover",this._onMouseOver),document.addEventListener("mouseout",this._onMouseOut),document.addEventListener("click",this._onClick),ep.info("Signal flow highlighter inicializado")}destroy(){document.removeEventListener("keydown",this._onKeyDown),document.removeEventListener("keyup",this._onKeyUp),window.removeEventListener("blur",this._onBlur),document.removeEventListener("mouseover",this._onMouseOver),document.removeEventListener("mouseout",this._onMouseOut),document.removeEventListener("click",this._onClick),this._clearAllHighlights()}setRequireModifier(e){this._requireModifier=e,localStorage.setItem(v.SIGNAL_FLOW_REQUIRE_MODIFIER,String(e)),e&&(this._modifierKeyPressed=!1,this._clearAllHighlights())}getRequireModifier(){return this._requireModifier}setModifierKey(e){this._modifierKey=e}setEnabled(e){this._enabled=e,localStorage.setItem(v.SIGNAL_FLOW_ENABLED,String(e)),e||(this._modifierKeyPressed=!1,this._clearAllHighlights())}getEnabled(){return this._enabled}_handleKeyDown(e){if(!(!this._enabled||!this._requireModifier)&&e.key===this._modifierKey&&!e.repeat&&(this._modifierKeyPressed=!0,this._hoveredElement)){let t=this._hoveredElement.closest?.("button.pin-btn");if(t)this._highlightPin(t);else{let n=ks(this._hoveredElement);n&&this._highlightModule(n)}}}_handleKeyUp(e){!this._enabled||!this._requireModifier||e.key===this._modifierKey&&(this._modifierKeyPressed=!1,this._clearAllHighlights())}_handleBlur(){this._modifierKeyPressed=!1,this._hoveredElement=null,this._clearAllHighlights()}_handleMouseOver(e){if(this._hoveredElement=e.target,!this._enabled||this._requireModifier&&!this._modifierKeyPressed)return;let t=e.target?.closest?.("button.pin-btn");if(t){this._highlightPin(t);return}let n=ks(e.target);if(n){this._highlightModule(n);return}}_handleMouseOut(e){let t=e.relatedTarget,n=ks(e.target),i=t?ks(t):null;if((!i||i!==n)&&(this._hoveredElement=t||null),!this._enabled||this._requireModifier&&!this._modifierKeyPressed)return;let s=e.target?.closest?.("button.pin-btn"),a=n;if(s||a){if(s&&s.contains(t)||a&&a.contains(t))return;this._clearAllHighlights()}}_handleClick(e){if(!this._enabled||this._requireModifier)return;let t=e.target?.closest?.("button.pin-btn");if(t){t.classList.contains(_e.SOURCE_PIN)||t.classList.contains(_e.DEST_PIN)?this._clearAllHighlights():(this._clearAllHighlights(),this._highlightPin(t));return}let n=ks(e.target);if(n){if(e.target.closest(".knob, .output-channel__slider-wrap, .synth-toggle, button")&&!t)return;n.classList.contains(_e.SOURCE_GLOW)||n.classList.contains(_e.DEST_GLOW)?this._clearAllHighlights():(this._clearAllHighlights(),this._highlightModule(n));return}(this._highlightedElements.size>0||this._highlightedPins.size>0)&&this._clearAllHighlights()}_highlightModule(e){let t=tp(e);if(!t)return;this._clearAllHighlights();let n={isSource:!1,isDest:!1,hasConnections:!1};this._findAndHighlightForModule(t,this._panel5Routing,this._matrixAudio,n),this._findAndHighlightForModule(t,this._panel6Routing,this._matrixControl,n),n.hasConnections&&(e.classList.add(_e.ACTIVE),this._highlightedElements.add(e),n.isSource&&n.isDest?e.classList.add(_e.BOTH_GLOW):n.isSource?e.classList.add(_e.SOURCE_GLOW):n.isDest&&e.classList.add(_e.DEST_GLOW))}_findAndHighlightForModule(e,t,n,i){if(!t||!t.connections||!t.sourceMap||!t.destMap)return;let s=t.connections,a=t.sourceMap,r=t.destMap;for(let l of Object.keys(s)){let[c,d]=l.split(":"),h=parseInt(c,10),p=parseInt(d,10),m=a.get(h),g=r.get(p);if(!m||!g)continue;let _=Zo(m),y=Zo(g),f=_.includes(e),b=y.includes(e);f&&(i.isSource=!0,i.hasConnections=!0,y.forEach(E=>this._applyGlowToModule(E,_e.DEST_GLOW)),this._applyGlowToPin(n,h,p,_e.DEST_PIN)),b&&(i.isDest=!0,i.hasConnections=!0,_.forEach(E=>this._applyGlowToModule(E,_e.SOURCE_GLOW)),this._applyGlowToPin(n,h,p,_e.SOURCE_PIN))}}_highlightPin(e){let t=parseInt(e.dataset.row,10),n=parseInt(e.dataset.col,10);if(isNaN(t)||isNaN(n))return;this._clearAllHighlights();let i=e.closest("table");if(!i)return;let s,a;if(this._matrixAudio?.table===i)s=this._panel5Routing,a=this._matrixAudio;else if(this._matrixControl?.table===i)s=this._panel6Routing,a=this._matrixControl;else return;if(!s?.sourceMap||!s?.destMap)return;let r=s.sourceMap.get(t),l=s.destMap.get(n);r&&Zo(r).forEach(d=>this._applyGlowToModule(d,_e.SOURCE_GLOW)),l&&Zo(l).forEach(d=>this._applyGlowToModule(d,_e.DEST_GLOW)),e.classList.add(_e.ACTIVE),this._highlightedPins.add(e)}_applyGlowToModule(e,t){let n=document.getElementById(e);if(!n)return;let i=n.classList.contains(_e.SOURCE_GLOW),s=n.classList.contains(_e.DEST_GLOW);i&&t===_e.DEST_GLOW||s&&t===_e.SOURCE_GLOW?(n.classList.remove(_e.SOURCE_GLOW,_e.DEST_GLOW),n.classList.add(_e.BOTH_GLOW)):n.classList.contains(_e.BOTH_GLOW)||n.classList.add(t),this._highlightedElements.add(n)}_applyGlowToPin(e,t,n,i){if(!e?.table)return;let s=e.table.querySelector(`button.pin-btn[data-row="${t}"][data-col="${n}"]`);s&&(s.classList.add(i),this._highlightedPins.add(s))}_clearAllHighlights(){for(let e of this._highlightedElements)e.classList.remove(_e.SOURCE_GLOW,_e.DEST_GLOW,_e.BOTH_GLOW,_e.ACTIVE);this._highlightedElements.clear();for(let e of this._highlightedPins)e.classList.remove(_e.SOURCE_PIN,_e.DEST_PIN,_e.ACTIVE);this._highlightedPins.clear()}};var L=W("App");function Vt(o,e,t){let n=e.modules?.[t];n&&n.visible===!1&&(o.style.visibility="hidden",o.style.pointerEvents="none")}var sp=8,Fr=class{constructor(){this.engine=new Gs,this.panelManager=new Hs(document.getElementById("viewportInner")),this._panel3Audio={nodes:[]},this._panel3Routing={connections:{},rowMap:null,colMap:null},this.placeholderPanels={},localStorage.getItem(v.DSP_START_ENABLED)==="false"&&(this.engine.dspEnabled=!1,localStorage.setItem(v.DSP_ENABLED,"false")),$e.setSerializeCallback(()=>this._serializeCurrentState()),$e.setRestoreCallback(i=>this._applyPatch(i)),this.panel1=this.panelManager.createPanel({id:"panel-1"}),An(this.panel1,null,{row:1,col:1}),this._panel1Audio={nodes:[]},this.panel2=this.panelManager.createPanel({id:"panel-2"}),An(this.panel2,null,{row:1,col:2}),this.panel3=this.panelManager.createPanel({id:"panel-3"}),An(this.panel3,null,{row:1,col:3}),this.panel4=this.panelManager.createPanel({id:"panel-4"}),An(this.panel4,null,{row:1,col:4}),this._panel4Audio={nodes:[]},this.panel5=this.panelManager.createPanel({id:"panel-5"}),An(this.panel5,null,{row:2,col:1}),this.panel6=this.panelManager.createPanel({id:"panel-6"}),An(this.panel6,null,{row:2,col:3}),co("panel-5","./assets/panels/panel5_bg.svg"),co("panel-6","./assets/panels/panel6_bg.svg"),co("panel-3","./assets/panels/panel_3.svg"),Jl(),jt(),this.outputPanel=this.panelManager.createPanel({id:"panel-output"}),ts("panel-1","./assets/panels/panel_1.jpg"),ts("panel-2","./assets/panels/panel_2.jpg"),ts("panel-4","./assets/panels/panel_4.jpg"),ts("panel-output","./assets/panels/panel_7.jpg"),An(this.outputPanel,null,{row:2,col:4}),this.outputChannelsSection=this.outputPanel.addSection({id:"outputChannelsSection",type:"custom",className:"output-channels-section"}),this._heightSyncScheduled=!1,this.largeMatrixAudio=null,this.largeMatrixControl=null,this._oscillatorUIs={},this._noiseUIs={},this._randomVoltageUIs={},this._inputAmplifierUIs={},this._outputFadersModule=null,this._buildPanel1(),this._buildPanel2(),this._buildOscillatorPanel(3,this.panel3,this._panel3Audio),this._setupOutputFaders(),this._buildLargeMatrices(),this._setupPanel5AudioRouting(),this._setupPanel6ControlRouting(),this._initSignalFlowHighlighter(),this._setupUI(),this._schedulePanelSync(),Ye.init(this),Xo.init(this),It.init(this),Qt.init(this),Lt.init(this),tt.init(this);let t=null,n=()=>{this._schedulePanelSync(),this._resizeLargeMatrices()};window.addEventListener("resize",()=>{if(window.__synthFullscreenTransition){n();return}t&&clearTimeout(t),t=setTimeout(()=>{if(t=null,window.__synthNavGestureActive){t=setTimeout(()=>{t=null,window.__synthNavGestureActive||n()},180);return}n()},120)},{passive:!0}),document.addEventListener("synth:fullscreenComplete",()=>{this._schedulePanelSync(),this._resizeLargeMatrices()})}async ensureAudio(){return this.engine.dspEnabled?this._ensureAudioPromise?this._ensureAudioPromise:(this._ensureAudioPromise=(async()=>{try{let e=localStorage.getItem(v.LATENCY_MODE),t=Bi()?"playback":"interactive",n=e||t;this.engine.start({latencyHint:n}),await this.engine.ensureWorkletReady();let i=localStorage.getItem(v.WAKE_LOCK_ENABLED);return(i===null||i==="true")&&window.powerAPI?.preventSleep(),await this._restoreMultichannelIfSaved(),this._ensurePanel2ScopeStarted(),this.engine.workletReady}finally{this._ensureAudioPromise=null}})(),this._ensureAudioPromise):!1}async _restoreMultichannelIfSaved(){if(this._multichannelRestored)return;if(this._multichannelRestored=!0,this.audioSettingsModal?.outputMode==="multichannel"){L.info("\u{1F50A} Restoring multichannel output from saved mode...");let t=await this._activateMultichannelOutput();if(t.success){L.info("\u{1F50A} Multichannel output restored (12ch)"),this.audioSettingsModal.updatePhysicalChannels(12,["Pan 1-4 L","Pan 1-4 R","Pan 5-8 L","Pan 5-8 R","Out 1","Out 2","Out 3","Out 4","Out 5","Out 6","Out 7","Out 8"]),this._applyAllRoutingToEngine();let n=await this._activateMultichannelInput();n.success?L.info("\u{1F3A4} Multichannel input restored (8ch)"):L.warn("\u{1F3A4} Multichannel input failed (output still active):",n.error)}else L.error("\u{1F50A} Failed to restore multichannel:",t.error),this.audioSettingsModal.setOutputMode("stereo",!1)}}_setupOutputFaders(){let e=Zl,t=e.layout||{},n=e.layout.upperRow||{},i=e.layout.lowerRow||{},s=i.slider||{},a=e.outputChannelUI||{},r=e.modules||{},l=(X,fe=0)=>{let de=Number(X);return Number.isFinite(de)?de:fe},c=(X,fe={x:0,y:0})=>({x:l(X?.x,fe.x),y:l(X?.y,fe.y)}),d=(X,fe,de={x:0,y:0})=>{if(!X)return;let Fe=c(fe,de);(Fe.x!==0||Fe.y!==0)&&(X.style.transform=`translate(${Fe.x}px, ${Fe.y}px)`)},h=(X,fe={})=>({...X,...fe,offset:c(fe.offset,X.offset||{x:0,y:0}),padOffset:c(fe.padOffset,X.padOffset||{x:0,y:0}),knobsOffset:c(fe.knobsOffset,X.knobsOffset||{x:0,y:0}),switchesOffset:c(fe.switchesOffset,X.switchesOffset||{x:0,y:0}),buttonsOffset:c(fe.buttonsOffset,X.buttonsOffset||{x:0,y:0}),knobOffsets:Array.isArray(fe.knobOffsets)?fe.knobOffsets:X.knobOffsets||[],switchOffsets:Array.isArray(fe.switchOffsets)?fe.switchOffsets:X.switchOffsets||[],buttonOffsets:Array.isArray(fe.buttonOffsets)?fe.buttonOffsets:X.buttonOffsets||[]});e.showFrames===!1&&this.outputPanel.element.classList.add("hide-frames");let p=document.createElement("div");p.className="panel7-layout";let m=t.padding||{top:0,right:10,bottom:10,left:10};p.style.cssText=`
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      box-sizing: border-box;
      display: flex;
      flex-direction: column;
      justify-content: flex-end;
      padding: ${m.top}px ${m.right}px ${m.bottom}px ${m.left}px;
      z-index: 1;
    `;let g=t.offset||{x:0,y:0};p.style.transform=`translate(${g.x}px, ${g.y}px)`,this.outputPanel.element.insertBefore(p,this.outputChannelsSection),p.appendChild(this.outputChannelsSection);let _=document.createElement("div");_.className="panel7-upper-row",_.style.gap=`${n.gap??8}px`;let y=n.padding||{top:0,right:0,bottom:0,left:0};_.style.padding=`${y.top}px ${y.right}px ${y.bottom}px ${y.left}px`,d(_,n.offset);let f=n.joystickSize||{width:160,height:180},b=n.sequencerSize||{width:420,height:180},E=n.joystickLeft||{knobs:["Range Horizontal","Range Vertical"],knobSize:"sm"},w=n.joystickRight||{knobs:["Range Horizontal","Range Vertical"],knobSize:"sm"},S=n.sequencer||{switches:[],buttons:[]},T=X=>({...X,offset:{x:0,y:0},layoutGap:X.layoutGap??6,knobsGap:X.knobsGap??8,padSize:l(X.padSize,100),knobsOffset:c(X.knobsOffset,{x:0,y:0}),padOffset:c(X.padOffset,{x:0,y:0}),knobOffsets:Array.isArray(X.knobOffsets)?X.knobOffsets:[]}),A=T(E),C=T(w),x={...S,offset:{x:0,y:0},contentPadding:S.contentPadding||{top:4,right:4,bottom:4,left:4},rowsGap:S.rowsGap??8,switchesGap:S.switchesGap??4,buttonsGap:S.buttonsGap??4,switchesOffset:c(S.switchesOffset,{x:0,y:0}),buttonsOffset:c(S.buttonsOffset,{x:0,y:0}),clockRateOffset:c(S.clockRateOffset,S.clockRate?.rowOffset||{x:0,y:0}),clockRateKnobOffset:c(S.clockRateKnobOffset,S.clockRate?.knobOffset||{x:0,y:0}),switchOffsets:Array.isArray(S.switchOffsets)?S.switchOffsets:[],buttonOffsets:Array.isArray(S.buttonOffsets)?S.buttonOffsets:[],clockRate:{label:S.clockRate?.label||"Clock Rate",knobSize:S.clockRate?.knobSize||"sm",rowOffset:c(S.clockRate?.rowOffset,{x:0,y:0}),knobOffset:c(S.clockRate?.knobOffset,{x:0,y:0})}},R=h(A,r.joystickLeft?.ui),M=h(C,r.joystickRight?.ui),I=h(x,r.sequencer?.ui),B=r.sequencer?.ui?.clockRate||{};I.clockRateOffset=c(r.sequencer?.ui?.clockRateOffset,x.clockRateOffset),I.clockRateKnobOffset=c(r.sequencer?.ui?.clockRateKnobOffset,x.clockRateKnobOffset),I.clockRate={...x.clockRate,...B,rowOffset:c(B.rowOffset,x.clockRate.rowOffset),knobOffset:c(B.knobOffset,x.clockRate.knobOffset)};let Y=bt.defaults?.ramps||{position:.01,range:.05};this._joystickModules={left:new ji(this.engine,"joystick-left",{ramps:Y}),right:new ji(this.engine,"joystick-right",{ramps:Y})};let P=new Ve({id:"joystick-left",title:null,className:"panel7-placeholder panel7-joystick",size:f}),F=P.createElement();F.dataset.moduleName=bt.left.title;let z=document.createElement("div");z.className="panel7-joystick-layout",z.style.gap=`${l(R.layoutGap,6)}px`;let $=document.createElement("div");$.className="panel7-joystick-knobs",$.style.gap=`${l(R.knobsGap,8)}px`,d($,R.knobsOffset);let N=bt.left.knobs.rangeY,K=Wt({size:R.knobSize||"sm",centerColor:Ui,showValue:!1,initial:N.initial/N.max,scaleMin:N.min,scaleMax:N.max,pixelsForFullRange:N.pixelsForFullRange,getTooltipInfo:this._getJoystickRangeTooltipInfo(this._joystickModules.left,"y"),onChange:X=>{this.ensureAudio(),this._joystickModules.left.setRangeY(X*N.max),Lt.shouldIgnoreOSC()||Lt.sendRangeYChange(0,X*N.max)}});K.wrapper.dataset.knob="rangeY",d(K.wrapper,R.knobOffsets?.[0]),$.appendChild(K.wrapper);let te=bt.left.knobs.rangeX,Q=Wt({size:R.knobSize||"sm",centerColor:Ui,showValue:!1,initial:te.initial/te.max,scaleMin:te.min,scaleMax:te.max,pixelsForFullRange:te.pixelsForFullRange,getTooltipInfo:this._getJoystickRangeTooltipInfo(this._joystickModules.left,"x"),onChange:X=>{this.ensureAudio(),this._joystickModules.left.setRangeX(X*te.max),Lt.shouldIgnoreOSC()||Lt.sendRangeXChange(0,X*te.max)}});Q.wrapper.dataset.knob="rangeX",d(Q.wrapper,R.knobOffsets?.[1]),$.appendChild(Q.wrapper),z.appendChild($);let ge=document.createElement("div");ge.className="panel7-joystick-pad",Number.isFinite(R.padSize)&&R.padSize>0&&(ge.style.width=`${R.padSize}px`,ge.style.height=`${R.padSize}px`,ge.style.maxWidth=`${R.padSize}px`,ge.style.maxHeight=`${R.padSize}px`,ge.style.flex="0 0 auto"),d(ge,R.padOffset),this._setupJoystickPad(ge,this._joystickModules.left,0),z.appendChild(ge),P.appendToContent(z),d(F,R.offset),_.appendChild(F);let Se=new Ve({id:"sequencer-control",title:null,className:"panel7-placeholder panel7-sequencer",size:b}),ne=Se.createElement(),ce=document.createElement("div");ce.className="panel7-sequencer-layout";let ue=I.contentPadding||{top:4,right:4,bottom:4,left:4};ce.style.padding=`${l(ue.top)}px ${l(ue.right)}px ${l(ue.bottom)}px ${l(ue.left)}px`,ce.style.gap=`${l(I.rowsGap,8)}px`;let Ne=document.createElement("div");Ne.className="panel7-sequencer-switches",Ne.style.gap=`${l(I.switchesGap,4)}px`,d(Ne,I.switchesOffset);for(let[X,fe]of S.switches.entries()){let de=document.createElement("div");de.className="panel7-seq-switch",d(de,I.switchOffsets?.[X]);let Fe=document.createElement("div");Fe.className="panel7-seq-switch-toggle",de.appendChild(Fe),Ne.appendChild(de)}ce.appendChild(Ne);let ke=document.createElement("div");ke.className="panel7-sequencer-buttons",ke.style.gap=`${l(I.buttonsGap,4)}px`,d(ke,I.buttonsOffset);for(let[X,fe]of S.buttons.entries()){let de=document.createElement("button");de.className="panel7-seq-button",de.type="button",d(de,I.buttonOffsets?.[X]),ke.appendChild(de)}ce.appendChild(ke);let O=document.createElement("div");O.className="panel7-sequencer-clock",d(O,I.clockRateOffset||I.clockRate?.rowOffset);let q=Wt({label:I.clockRate?.label||"Clock Rate",size:I.clockRate?.knobSize||"sm",showValue:!1,initial:.5,onChange:()=>{}});q.wrapper.classList.add("panel7-seq-clock-knob"),q.wrapper.dataset.knob="clockRate",d(q.wrapper,I.clockRateKnobOffset||I.clockRate?.knobOffset),O.appendChild(q.wrapper),ce.appendChild(O),Se.appendToContent(ce),d(ne,I.offset),Vt(ne,e,"sequencer"),_.appendChild(ne);let Z=new Ve({id:"joystick-right",title:null,className:"panel7-placeholder panel7-joystick panel7-joystick-right",size:f}),De=Z.createElement();De.dataset.moduleName=bt.right.title;let Be=document.createElement("div");Be.className="panel7-joystick-layout",Be.style.gap=`${l(M.layoutGap,6)}px`;let ze=document.createElement("div");ze.className="panel7-joystick-knobs",ze.style.gap=`${l(M.knobsGap,8)}px`,d(ze,M.knobsOffset);let xe=bt.right.knobs.rangeY,At=Wt({size:M.knobSize||"sm",centerColor:Ui,showValue:!1,initial:xe.initial/xe.max,scaleMin:xe.min,scaleMax:xe.max,pixelsForFullRange:xe.pixelsForFullRange,getTooltipInfo:this._getJoystickRangeTooltipInfo(this._joystickModules.right,"y"),onChange:X=>{this.ensureAudio(),this._joystickModules.right.setRangeY(X*xe.max),Lt.shouldIgnoreOSC()||Lt.sendRangeYChange(1,X*xe.max)}});At.wrapper.dataset.knob="rangeY",d(At.wrapper,M.knobOffsets?.[0]),ze.appendChild(At.wrapper);let nt=bt.right.knobs.rangeX,j=Wt({size:M.knobSize||"sm",centerColor:Ui,showValue:!1,initial:nt.initial/nt.max,scaleMin:nt.min,scaleMax:nt.max,pixelsForFullRange:nt.pixelsForFullRange,getTooltipInfo:this._getJoystickRangeTooltipInfo(this._joystickModules.right,"x"),onChange:X=>{this.ensureAudio(),this._joystickModules.right.setRangeX(X*nt.max),Lt.shouldIgnoreOSC()||Lt.sendRangeXChange(1,X*nt.max)}});j.wrapper.dataset.knob="rangeX",d(j.wrapper,M.knobOffsets?.[1]),ze.appendChild(j.wrapper),Be.appendChild(ze);let Ce=document.createElement("div");if(Ce.className="panel7-joystick-pad",Number.isFinite(M.padSize)&&M.padSize>0&&(Ce.style.width=`${M.padSize}px`,Ce.style.height=`${M.padSize}px`,Ce.style.maxWidth=`${M.padSize}px`,Ce.style.maxHeight=`${M.padSize}px`,Ce.style.flex="0 0 auto"),d(Ce,M.padOffset),this._setupJoystickPad(Ce,this._joystickModules.right,1),Be.appendChild(Ce),Z.appendToContent(Be),d(De,M.offset),_.appendChild(De),this._joystickKnobs={left:{rangeY:K,rangeX:Q},right:{rangeY:At,rangeX:j}},this._joystickUIs={"joystick-left":{module:this._joystickModules.left,knobs:this._joystickKnobs.left,padEl:ge,config:bt.left},"joystick-right":{module:this._joystickModules.right,knobs:this._joystickKnobs.right,padEl:Ce,config:bt.right}},p.insertBefore(_,this.outputChannelsSection),this.outputChannelsSection){let X=i.padding||{top:8,right:8,bottom:12,left:8},fe=a.contentPadding||{top:6,right:4,bottom:8,left:4},de=i.channelSize||{width:80,height:350},Fe=a.sliderSize||{},ie=a.buttonSize||{},Ke=Array.isArray(a.knobGap)?l(a.knobGap[0],8):l(a.knobGap,8);d(this.outputChannelsSection,i.offset),this.outputChannelsSection.style.setProperty("--oc-slider-height",`${Fe.height??s.height??250}px`),this.outputChannelsSection.style.setProperty("--oc-slider-shell-height",`${Fe.shellHeight??s.shellHeight??270}px`),this.outputChannelsSection.style.setProperty("--oc-slider-width",`${Fe.width??s.width??24}px`),this.outputChannelsSection.style.setProperty("--oc-channel-width",`${de.width??80}px`),this.outputChannelsSection.style.setProperty("--oc-channel-height",`${de.height??350}px`),this.outputChannelsSection.style.setProperty("--oc-channel-gap",`${i.gap??8}px`),this.outputChannelsSection.style.setProperty("--oc-knob-button-gap",`${l(a.knobButtonGap,2)}px`),this.outputChannelsSection.style.setProperty("--oc-button-slider-gap",`${l(a.buttonSliderGap,2)}px`),this.outputChannelsSection.style.setProperty("--oc-button-width",`${l(ie.width,18)}px`),this.outputChannelsSection.style.setProperty("--oc-button-height",`${l(ie.height,30)}px`),this.outputChannelsSection.style.setProperty("--oc-button-indicator-size",`${l(ie.indicator,8)}px`),this.outputChannelsSection.style.setProperty("--oc-knob-size",`${l(a.knobSize,42)}px`),this.outputChannelsSection.style.setProperty("--oc-knob-inner-pct",`${l(a.knobInnerPct,78)}%`),this.outputChannelsSection.style.setProperty("--oc-knob-gap",`${Ke}px`),this.outputChannelsSection.style.setProperty("--oc-knob-row-offset-x",`${l(a.knobRowOffsetX,0)}px`),this.outputChannelsSection.style.setProperty("--oc-knob-row-offset-y",`${l(a.knobRowOffsetY,0)}px`),this.outputChannelsSection.style.setProperty("--oc-row-padding",`${X.top}px ${X.right}px ${X.bottom}px ${X.left}px`),this.outputChannelsSection.style.setProperty("--oc-content-padding",`${fe.top}px ${fe.right}px ${fe.bottom}px ${fe.left}px`)}this._outputChannelsPanel=new Ks(this.engine),this._outputChannelsPanel.createPanel(this.outputChannelsSection),this._outputFadersModule=this._outputChannelsPanel}_formatSignedValue(e,t=2){let n=Math.abs(e).toFixed(t);return Object.is(e,-0)||e<0?`-${n}`:e>0?`+${n}`:n}_getJoystickAxisSnapshot(e,t){let n=t==="x",i=n?e.getX():e.getY(),s=n?e.getRangeX():e.getRangeY(),a=Math.max(0,Math.min(1,s/10)),r=i*a*sp;return{padGain:i,rangeDial:s,rangeGain:a,outputVoltage:r}}_getJoystickRangeTooltipInfo(e,t){let n=t.toUpperCase();return()=>{let i=[],s=this._getJoystickAxisSnapshot(e,t);return Hi()&&i.push(`${n} out: ${Vn(s.outputVoltage,2)}`),ci()&&(i.push(`Range ${ui(s.rangeGain)}`),i.push(`Pad \xD7${this._formatSignedValue(s.padGain,2)}`)),i.length>0?i.join(" \xB7 "):null}}_getJoystickPadTooltipContent(e){let t=this._getJoystickAxisSnapshot(e,"x"),n=this._getJoystickAxisSnapshot(e,"y"),i=Hi(),s=ci(),a=i?`X ${Vn(t.outputVoltage,2)} \xB7 Y ${Vn(n.outputVoltage,2)}`:`X \xD7${this._formatSignedValue(t.padGain,2)} \xB7 Y \xD7${this._formatSignedValue(n.padGain,2)}`,r=[];return s&&(r.push(`Range X ${ui(t.rangeGain)} \xB7 Range Y ${ui(n.rangeGain)}`),r.push(`Pad X \xD7${this._formatSignedValue(t.padGain,2)} \xB7 Pad Y \xD7${this._formatSignedValue(n.padGain,2)}`)),r.length>0?`<div class="knob-tooltip__main">${a}</div><div class="knob-tooltip__info">${r.join("<br>")}</div>`:`<div class="knob-tooltip__main">${a}</div>`}_setupJoystickPad(e,t,n=0){let i=document.createElement("div");i.className="joystick-handle",e.appendChild(i);let s=null,a=null,r=()=>{s||(_n(a),s=document.createElement("div"),s.className="knob-tooltip",s.innerHTML=this._getJoystickPadTooltipContent(t),document.body.appendChild(s),l(),s.offsetHeight,s.classList.add("is-visible"))},l=()=>{if(!s)return;let N=e.getBoundingClientRect(),K=s.getBoundingClientRect(),te=N.left+N.width/2-K.width/2,Q=N.top-K.height-8;te<4&&(te=4),te+K.width>window.innerWidth-4&&(te=window.innerWidth-K.width-4),Q<4&&(Q=N.bottom+8),s.style.left=`${te}px`,s.style.top=`${Q}px`},c=()=>{s&&(s.innerHTML=this._getJoystickPadTooltipContent(t),l())},d=()=>{if(!s)return;let N=s;N.classList.remove("is-visible"),setTimeout(()=>{N.parentNode&&N.parentNode.removeChild(N)},150),s=null},h=!1,p=!1,m=null,g=3e3,_=()=>"ontouchstart"in window||navigator.maxTouchPoints>0,y=()=>{m&&clearTimeout(m),m=setTimeout(()=>{m=null,d(),h=!1,b()},g)},f=()=>{m&&(clearTimeout(m),m=null)},b=()=>{e.classList.toggle("is-tooltip-active",h||p||!!m)};a=()=>{f(),d(),h=!1,b()},vn(a);let E=.83,w=(N,K)=>{let te=(N*E+1)/2,Q=(1-K*E)/2;i.style.left=te*100+"%",i.style.top=Q*100+"%",i.style.transform="translate(-50%, -50%)"},S=!1,T=0,A=0,C=!1,x=0,R=0,M=8,I=6,B=N=>{let K=e.getBoundingClientRect(),te=(N.clientX-K.left)/K.width,Q=(N.clientY-K.top)/K.height;return{nx:Math.max(-1,Math.min(1,te*2-1)),ny:Math.max(-1,Math.min(1,1-Q*2))}},Y=N=>{let K=i.getBoundingClientRect(),te=K.left+K.width/2,Q=K.top+K.height/2,ge=K.width/2+M,Se=N.clientX-te,ne=N.clientY-Q;return Se*Se+ne*ne<=ge*ge},P=(N,K)=>{let te=Math.max(-1,Math.min(1,N/E)),Q=Math.max(-1,Math.min(1,K/E));t.setPosition(te,Q),w(te,Q),c(),Lt.shouldIgnoreOSC()||Lt.sendPositionChange(n,te,Q)},F=new Set,z=null,$=null;e.addEventListener("pointerdown",N=>{if(N.button!==2){if(F.add(N.pointerId),F.size>1){if(S=!1,$&&(clearTimeout($),$=null),z!==null){try{e.releasePointerCapture(z)}catch{}z=null}h=!1,b(),d();return}if(N.stopPropagation(),N.preventDefault(),this.ensureAudio(),f(),h=!0,b(),N.pointerType==="touch"?($&&clearTimeout($),$=setTimeout(()=>{$=null,F.size<=1&&!window.__synthNavGestureActive&&!window.__synthPipGestureActive&&r()},120)):r(),t.isStarted||t.start(),S=Y(N),S){e.setPointerCapture(N.pointerId),z=N.pointerId;let K=B(N);T=K.nx-t.getX()*E,A=K.ny-t.getY()*E,x=N.clientX,R=N.clientY,C=N.pointerType!=="touch"}}}),e.addEventListener("pointermove",N=>{if(!S||N.buttons===0||N.buttons===2)return;if(F.size>1||window.__synthNavGestureActive||window.__synthPipGestureActive){if(S=!1,z!==null){try{e.releasePointerCapture(z)}catch{}z=null}$&&(clearTimeout($),$=null),h=!1,b(),d();return}if(N.stopPropagation(),N.preventDefault(),!C){let te=N.clientX-x,Q=N.clientY-R;if(te*te+Q*Q<I*I)return;C=!0}let K=B(N);P(K.nx-T,K.ny-A)}),e.addEventListener("pointerup",N=>{if(F.delete(N.pointerId),z===N.pointerId){try{e.releasePointerCapture(N.pointerId)}catch{}z=null}S=!1,N.pointerType!=="touch"&&(h=!1,b()),document.dispatchEvent(new CustomEvent("synth:userInteraction"));let K=!!$;$&&(clearTimeout($),$=null),K&&F.size===0&&r(),_()?y():p||d()}),e.addEventListener("pointercancel",N=>{F.delete(N.pointerId),$&&(clearTimeout($),$=null),S=!1,f(),h=!1,b(),p||d()}),e.addEventListener("pointerenter",N=>{N.pointerType==="mouse"&&(p=!0,f(),b(),r(),c())}),document.addEventListener("synth:dismissTooltips",()=>{if($&&(clearTimeout($),$=null),S=!1,z!==null){try{e.releasePointerCapture(z)}catch{}z=null}f(),d(),h=!1,b()}),e.addEventListener("pointerleave",N=>{if(N.pointerType==="mouse"&&(p=!1,N.buttons===0)){b(),d();return}if(N.buttons!==0){try{e.releasePointerCapture(N.pointerId)}catch{}h=!1,b(),p||d()}}),e._joystickUpdateHandle=w,w(0,0)}_setupUI(){document.addEventListener("synth:toggleDSP",async e=>{let t=e.detail?.enabled;if(t!==void 0?t:!this.engine.dspEnabled){await this.engine.resumeDSP(),this.engine.audioCtx||await this.ensureAudio();let i=this._serializeCurrentState();i&&await this._applyPatch(i),se(u("toast.dspEnabled"))}else this._recordingEngine?.isRecording&&await this._recordingEngine.toggle(),this._panel2Data?.scopeModule?.isRunning&&(this._panel2Data.scopeModule.stop(),this._panel2ScopeStarted=!1),await this.engine.suspendDSP(),se(u("toast.dspDisabled"));document.dispatchEvent(new CustomEvent("synth:dspChanged",{detail:{enabled:this.engine.dspEnabled}}))}),document.addEventListener("synth:toggleMute",()=>{if(!this.engine.dspEnabled)return;this.ensureAudio(),this.engine.audioCtx&&this.engine.audioCtx.state==="suspended"&&this.engine.audioCtx.resume(),this.engine.toggleMute();let e=this.engine.muted;document.dispatchEvent(new CustomEvent("synth:muteChanged",{detail:{muted:e}})),se(u(e?"toast.mute":"toast.unmute"))}),this._setupAudioSettingsModal()}_setupAudioSettingsModal(){let e=this.engine.getPhysicalChannelInfo?.()||{count:2,labels:["L","R"]};this.audioSettingsModal=new Ro({outputCount:this.engine.outputChannels,inputCount:8,physicalChannels:e.count,channelLabels:e.labels,physicalInputChannels:2,inputChannelLabels:["L","R"],onRoutingChange:(n,i)=>this.engine.setOutputRouting(n,i),onInputRoutingChange:(n,i)=>{this._applyInputRouting(n,i)},onOutputDeviceChange:async n=>{await this._deactivateMultichannelOutput();let i=await this.engine.setOutputDevice(n);i.success&&L.info(` Output device changed. Channels: ${i.channels}`)},onOutputModeChange:async n=>{if(n==="multichannel"){let i=!this.engine.dspEnabled;if(i&&(L.info("\u{1F50A} DSP disabled, enabling for multichannel activation..."),await this.engine.resumeDSP()),!await this.ensureAudio()){L.error("\u{1F50A} Cannot activate multichannel: audio engine failed to start"),this.audioSettingsModal.setOutputMode("stereo",!1);return}if(i){let r=this._serializeCurrentState();r&&await this._applyPatch(r),document.dispatchEvent(new CustomEvent("synth:dspChanged",{detail:{enabled:!0}}))}let a=await this._activateMultichannelOutput();if(a.success){L.info("\u{1F50A} Multichannel output activated (12ch)"),this.audioSettingsModal.updatePhysicalChannels(12,["Pan 1-4 L","Pan 1-4 R","Pan 5-8 L","Pan 5-8 R","Out 1","Out 2","Out 3","Out 4","Out 5","Out 6","Out 7","Out 8"]),this._applyAllRoutingToEngine();let r=await this._activateMultichannelInput();r.success?L.info("\u{1F3A4} Multichannel input activated (8ch)"):L.warn("\u{1F3A4} Multichannel input failed (output still active):",r.error)}else L.error("\u{1F50A} Failed to activate multichannel:",a.error),this.audioSettingsModal.setOutputMode("stereo",!1)}else{await this._deactivateMultichannelInput(),await this._deactivateMultichannelOutput();let i=this.audioSettingsModal.selectedOutputDevice;if(i){let s=await this.engine.setOutputDevice(i);s.success&&L.info(`\u{1F50A} Stereo mode restored. Device: ${i}, Channels: ${s.channels}`)}}},onInputDeviceChange:async n=>{L.info(" Input device selected:",n),await this._reconnectSystemAudioInput(n)},onStereoBusRoutingChange:(n,i)=>{this.engine.setStereoBusRouting(n,i)}}),this.audioSettingsModal.updatePhysicalChannels(e.count,e.labels),this.engine.onPhysicalChannelsChange&&this.engine.onPhysicalChannelsChange((n,i)=>{L.info(` Physical channels changed: ${n}`,i),this.audioSettingsModal.updatePhysicalChannels(n,i),this._applyAllRoutingToEngine()});let t=this.engine.start.bind(this.engine);this.engine.start=()=>{t(),this._outputChannelsPanel?.channels&&(L.info(" Syncing output channel mute states to engine..."),this._outputChannelsPanel.channels.forEach((a,r)=>{let l=!a.values.power;this.engine.setOutputMute(r,l)})),L.info(" Applying saved audio routing to engine...");let n=this.audioSettingsModal.applyRoutingToEngine((a,r)=>this.engine.setOutputRouting(a,r));n.warnings&&n.warnings.length>0&&L.warn(" Routing warnings:",n.warnings),L.info(" Applying stereo bus routing to engine..."),this.audioSettingsModal.applyStereoBusRoutingToEngine((a,r)=>{this.engine.setStereoBusRouting(a,r)});let i=this.audioSettingsModal.selectedOutputDevice,s=this.audioSettingsModal.outputMode==="multichannel";i&&i!=="default"&&!s&&this.engine.setOutputDevice(i)},document.addEventListener("synth:toggleAudioSettings",()=>{this.audioSettingsModal.toggle()}),document.addEventListener("synth:resetToDefaults",async()=>{await this._resetToDefaults()}),document.addEventListener("synth:resetContext",n=>{this._handleContextReset(n.detail)}),document.addEventListener("synth:userInteraction",()=>{$e.markDirty(),an.commitInteraction(),this.engine.dspEnabled&&this.engine.audioCtx&&this.engine.audioCtx.state==="suspended"&&this.engine.audioCtx.resume()}),document.addEventListener("synth:undo",()=>{an.undo()}),document.addEventListener("synth:redo",()=>{an.redo()}),this._setupRecording(),this._setupSettingsModal(),this._setupDormancyManager(),this._setupFilterBypass(),this._setupPatchBrowser(),this._setupUndoRedo()}_setupPatchBrowser(){this.patchBrowser=new Fo({onLoad:async e=>{L.info(" Loading patch:",e),await this._applyPatch(e),$e.clearLastState(),an.clear()},onSave:()=>{let e=this._serializeCurrentState();return L.info(" Serialized state:",e),$e.clearLastState(),e}}),document.addEventListener("synth:togglePatches",()=>{this.patchBrowser.toggle()})}_setupUndoRedo(){an.init(()=>this._serializeCurrentState(),e=>this._applyPatch(e)),L.info("Undo/redo system initialized")}_serializeCurrentState(){let e={modules:{}};if(this._oscillatorUIs){e.modules.oscillators={};for(let[t,n]of Object.entries(this._oscillatorUIs))n&&typeof n.serialize=="function"&&(e.modules.oscillators[t]=n.serialize())}if(this._noiseUIs){e.modules.noise={};for(let[t,n]of Object.entries(this._noiseUIs))n&&typeof n.serialize=="function"&&(e.modules.noise[t]=n.serialize())}if(this._randomVoltageUIs){e.modules.randomVoltage={};for(let[t,n]of Object.entries(this._randomVoltageUIs))n&&typeof n.serialize=="function"&&(e.modules.randomVoltage[t]=n.serialize())}if(this._outputFadersModule&&typeof this._outputFadersModule.serialize=="function"&&(e.modules.outputFaders=this._outputFadersModule.serialize()),this._inputAmplifierUIs){e.modules.inputAmplifiers={};for(let[t,n]of Object.entries(this._inputAmplifierUIs))n&&typeof n.serialize=="function"&&(e.modules.inputAmplifiers[t]=n.serialize())}if(this.largeMatrixAudio&&typeof this.largeMatrixAudio.serialize=="function"&&(e.modules.matrixAudio=this.largeMatrixAudio.serialize()),this.largeMatrixControl&&typeof this.largeMatrixControl.serialize=="function"&&(e.modules.matrixControl=this.largeMatrixControl.serialize()),this._joystickModules){e.modules.joysticks={};for(let[t,n]of Object.entries(this._joystickModules))e.modules.joysticks[t]={x:n.getX(),y:n.getY(),rangeX:n.getRangeX(),rangeY:n.getRangeY()}}if(this._panel2Data){let{timeKnob:t,ampKnob:n,levelKnob:i,modeToggle:s}=this._panel2Data;e.modules.oscilloscope={timeScale:t?.knobInstance?.getValue()??1,ampScale:n?.knobInstance?.getValue()??1,triggerLevel:i?.knobInstance?.getValue()??0,mode:s?.getState()??"a"}}return e}async _applyPatch(e){if(L.info(" _applyPatch called with:",e),!e||!e.modules){L.warn(" Invalid patch data - missing modules");return}this.engine.dspEnabled&&await this.ensureAudio(),$e.applyingPatch(!0);let{modules:t}=e;if(L.info(" Modules to restore:",Object.keys(t)),t.oscillators&&this._oscillatorUIs){L.info(" Restoring oscillators:",Object.keys(t.oscillators)),L.info(" Available oscillator UIs:",Object.keys(this._oscillatorUIs));for(let[n,i]of Object.entries(t.oscillators)){let s=this._oscillatorUIs[n];s&&typeof s.deserialize=="function"?(L.info(` Deserializing oscillator ${n}:`,i),s.deserialize(i)):L.warn(` Oscillator UI not found for ${n}`)}}if(t.noise&&this._noiseUIs)for(let[n,i]of Object.entries(t.noise)){let s=this._noiseUIs[n];s&&typeof s.deserialize=="function"&&s.deserialize(i)}if(t.randomVoltage&&this._randomVoltageUIs)for(let[n,i]of Object.entries(t.randomVoltage)){let s=this._randomVoltageUIs[n];s&&typeof s.deserialize=="function"&&s.deserialize(i)}if(t.outputFaders&&this._outputFadersModule&&typeof this._outputFadersModule.deserialize=="function"&&this._outputFadersModule.deserialize(t.outputFaders),t.inputAmplifiers&&this._inputAmplifierUIs)for(let[n,i]of Object.entries(t.inputAmplifiers)){let s=this._inputAmplifierUIs[n];s&&typeof s.deserialize=="function"&&s.deserialize(i)}if(t.matrixAudio&&this.largeMatrixAudio&&typeof this.largeMatrixAudio.deserialize=="function"&&this.largeMatrixAudio.deserialize(t.matrixAudio),t.matrixControl&&this.largeMatrixControl&&typeof this.largeMatrixControl.deserialize=="function"&&this.largeMatrixControl.deserialize(t.matrixControl),t.oscilloscope&&this._panel2Data){let n=t.oscilloscope,{timeKnob:i,ampKnob:s,levelKnob:a,modeToggle:r,display:l,scopeModule:c}=this._panel2Data;if(typeof n.timeScale=="number"&&i?.knobInstance&&i.knobInstance.setValue(n.timeScale),typeof n.ampScale=="number"&&s?.knobInstance&&s.knobInstance.setValue(n.ampScale),typeof n.triggerLevel=="number"&&a?.knobInstance&&a.knobInstance.setValue(n.triggerLevel),n.mode&&r){r.setState(n.mode);let d=n.mode==="a"?"yt":"xy";l&&l.setMode(d),c?.setMode&&c.setMode(d)}}if(t.joysticks&&this._joystickModules)for(let[n,i]of Object.entries(t.joysticks)){let s=this._joystickModules[n];if(s&&i){i.rangeX!==void 0&&s.setRangeX(i.rangeX),i.rangeY!==void 0&&s.setRangeY(i.rangeY),i.x!==void 0&&i.y!==void 0&&s.setPosition(i.x,i.y);let a=Object.values(this._joystickUIs||{}).find(l=>l.module===s);a?.padEl?._joystickUpdateHandle&&(a.padEl._joystickUpdateHandle(s.getX(),s.getY()),(i.x!==void 0||i.y!==void 0)&&Ae(a.padEl));let r=this._joystickKnobs?.[n];r&&(i.rangeX!==void 0&&r.rangeX?.knobInstance&&r.rangeX.knobInstance.setValue(i.rangeX/10),i.rangeY!==void 0&&r.rangeY?.knobInstance&&r.rangeY.knobInstance.setValue(i.rangeY/10))}}$e.applyingPatch(!1),this.dormancyManager?.flushPendingUpdate(),L.info(" Patch applied successfully")}async _resetToDefaults(){L.info(" Resetting to defaults..."),$e.applyingPatch(!0);let e=this._defaultValues;if(this._oscillatorUIs)for(let t of Object.values(this._oscillatorUIs))t&&typeof t.deserialize=="function"&&t.deserialize(e.oscillator);if(this._noiseUIs)for(let t of Object.values(this._noiseUIs))t&&typeof t.deserialize=="function"&&t.deserialize(e.noise);if(this._randomVoltageUIs)for(let t of Object.values(this._randomVoltageUIs))t&&typeof t.deserialize=="function"&&t.deserialize(e.randomVoltage);if(this._inputAmplifierUIs)for(let t of Object.values(this._inputAmplifierUIs))t&&typeof t.deserialize=="function"&&t.deserialize(e.inputAmplifiers);if(this._outputFadersModule&&typeof this._outputFadersModule.deserialize=="function"&&this._outputFadersModule.deserialize(e.outputChannels),this.largeMatrixAudio&&typeof this.largeMatrixAudio.deserialize=="function"&&this.largeMatrixAudio.deserialize({connections:[]}),this.largeMatrixControl&&typeof this.largeMatrixControl.deserialize=="function"&&this.largeMatrixControl.deserialize({connections:[]}),this._panel2Data){let{timeKnob:t,ampKnob:n,levelKnob:i,modeToggle:s,display:a,scopeModule:r}=this._panel2Data,l=e.oscilloscope;if(t?.knobInstance&&t.knobInstance.setValue(l.timeScale),n?.knobInstance&&n.knobInstance.setValue(l.ampScale),i?.knobInstance&&i.knobInstance.setValue(l.triggerLevel),s){s.setState(l.mode);let c=l.mode==="a"?"yt":"xy";a&&a.setMode(c),r?.setMode&&r.setMode(c)}}if(this._joystickModules)for(let[t,n]of Object.entries(this._joystickModules)){let i=bt[t],s=i?.knobs?.rangeX?.initial??5,a=i?.knobs?.rangeY?.initial??5,r=n.getX()===0&&n.getY()===0;n.setPosition(0,0),n.setRangeX(s),n.setRangeY(a);let l=this._joystickKnobs?.[t];l&&(l.rangeX?.knobInstance&&l.rangeX.knobInstance.setValue(s/10),l.rangeY?.knobInstance&&l.rangeY.knobInstance.setValue(a/10));let c=`joystick-${t}`,d=this._joystickUIs?.[c]?.padEl;d?._joystickUpdateHandle&&(d._joystickUpdateHandle(0,0),r||Ae(d))}$e.applyingPatch(!1),this.dormancyManager?.flushPendingUpdate(),$e.clearLastState(),an.clear(),se(u("toast.reset")),L.info(" Reset to defaults complete")}get _defaultValues(){let e=qe.defaults.knobs,t=["pulseLevel","pulseWidth","sineLevel","sineSymmetry","triangleLevel","sawtoothLevel","frequency"],n=qe.defaults.switches?.range?.initial??"hi",i=ft.noise1.knobs,s=Gi.knobs,a=$t.knobs,r=$t.count,l=Ze.knobs,c=Ze.faders,d=Ze.switches,h=Ze.count,p=Ut.knobs,m=Ut.audio.mode==="xy"?"b":"a";return{oscillator:{knobs:t.map(g=>e[g].initial),rangeState:n},oscilloscope:{timeScale:p.timeScale.initial,ampScale:p.ampScale.initial,triggerLevel:p.triggerLevel.initial,mode:m},noise:{colour:i.colour.initial,level:i.level.initial},randomVoltage:{mean:s.mean.initial,variance:s.variance.initial,voltage1:s.voltage1.initial,voltage2:s.voltage2.initial,key:s.key.initial},inputAmplifiers:{levels:Array(r).fill(a.level.initial)},outputChannels:{channels:Array(h).fill(null).map(()=>({level:c.level.initial,filter:l.filter.initial,pan:l.pan.initial,power:d.power.initial}))}}}_getModulesForPanel(e){let t=[];switch(e){case"panel-3":{for(let[n,i]of Object.entries(this._oscillatorUIs))n.startsWith("panel3-osc-")&&t.push({type:"oscillator",id:n,ui:i});for(let[n,i]of Object.entries(this._noiseUIs))n.startsWith("panel3-noise-")&&t.push({type:"noise",id:n,ui:i});for(let[n,i]of Object.entries(this._randomVoltageUIs))n.startsWith("panel3-random")&&t.push({type:"randomVoltage",id:n,ui:i});break}case"panel-2":{this._panel2Data&&t.push({type:"oscilloscope",id:"oscilloscope-module",ui:this._panel2Data});for(let[n,i]of Object.entries(this._inputAmplifierUIs))t.push({type:"inputAmplifiers",id:n,ui:i});break}case"panel-output":{this._outputFadersModule&&t.push({type:"outputChannels",id:"output-channels",ui:this._outputFadersModule});for(let[n,i]of Object.entries(this._joystickUIs||{}))t.push({type:"joystick",id:n,ui:i});break}case"panel-5":{this.largeMatrixAudio&&t.push({type:"matrixAudio",id:"matrix-audio",ui:this.largeMatrixAudio});break}case"panel-6":{this.largeMatrixControl&&t.push({type:"matrixControl",id:"matrix-control",ui:this.largeMatrixControl});break}}return t}_findModuleById(e){if(this._oscillatorUIs[e])return{type:"oscillator",ui:this._oscillatorUIs[e]};if(this._noiseUIs[e])return{type:"noise",ui:this._noiseUIs[e]};if(this._randomVoltageUIs[e])return{type:"randomVoltage",ui:this._randomVoltageUIs[e]};if(e==="oscilloscope-module"&&this._panel2Data)return{type:"oscilloscope",ui:this._panel2Data};if(this._inputAmplifierUIs[e])return{type:"inputAmplifiers",ui:this._inputAmplifierUIs[e]};if(this._outputFadersModule&&e.startsWith("output-channel-")){let t=parseInt(e.replace("output-channel-",""),10)-1,n=this._outputFadersModule.getChannel(t);if(n)return{type:"outputChannel",ui:n}}return this._joystickUIs?.[e]?{type:"joystick",ui:this._joystickUIs[e]}:null}_resetModule(e,t){if(!t)return;if(e==="joystick"){let{module:i,knobs:s,padEl:a,config:r}=t,l=r?.knobs?.rangeX?.initial??0,c=r?.knobs?.rangeY?.initial??0,d=r?.knobs?.rangeX?.max||10,h=r?.knobs?.rangeY?.max||10,p=i.getX()===0&&i.getY()===0;i.setPosition(0,0),i.setRangeX(l),i.setRangeY(c),s?.rangeX?.knobInstance&&s.rangeX.knobInstance.setValue(l/d),s?.rangeY?.knobInstance&&s.rangeY.knobInstance.setValue(c/h),a?._joystickUpdateHandle&&(a._joystickUpdateHandle(0,0),p||Ae(a));return}let n=this._defaultValues;if(e==="oscilloscope"){let{timeKnob:i,ampKnob:s,levelKnob:a,modeToggle:r,display:l,scopeModule:c}=t,d=n.oscilloscope;if(i?.knobInstance&&i.knobInstance.setValue(d.timeScale),s?.knobInstance&&s.knobInstance.setValue(d.ampScale),a?.knobInstance&&a.knobInstance.setValue(d.triggerLevel),r){r.setState(d.mode);let h=d.mode==="a"?"yt":"xy";l&&l.setMode(h),c?.setMode&&c.setMode(h)}return}if(typeof t.deserialize=="function")switch(e){case"oscillator":t.deserialize(n.oscillator);break;case"noise":t.deserialize(n.noise);break;case"randomVoltage":t.deserialize(n.randomVoltage);break;case"inputAmplifiers":t.deserialize(n.inputAmplifiers);break;case"outputChannels":t.deserialize(n.outputChannels);break;case"outputChannel":{let i=n.outputChannels.channels[0];t.deserialize(i);break}case"matrixAudio":t.deserialize({connections:[]});break;case"matrixControl":t.deserialize({connections:[]});break}}_resetControl(e,t,n={}){let i=this._findModuleById(e);if(!i)return;let{type:s,ui:a}=i,{controlType:r,controlKey:l}=n;if(s==="outputChannel"){let d=this._defaultValues.outputChannels.channels[0];r==="slider"?a.deserialize({level:d.level}):r==="knob"&&l?a.deserialize({[l]:d[l]}):r==="switch"&&a.deserialize({power:d.power});return}if(s==="oscilloscope"){let{timeKnob:c,ampKnob:d,levelKnob:h,modeToggle:p,display:m,scopeModule:g}=a,_=this._defaultValues.oscilloscope,y={0:c,1:d,2:h};if(r==="toggle"||r==="switch"){if(p){p.setState(_.mode);let f=_.mode==="a"?"yt":"xy";m&&m.setMode(f),g?.setMode&&g.setMode(f)}}else y[t]?.knobInstance&&y[t].knobInstance.resetToDefault();return}if(s==="joystick"){let{module:c,knobs:d,padEl:h,config:p}=a;if(r==="pad"){let m=c.getX()===0&&c.getY()===0;c.setPosition(0,0),h?._joystickUpdateHandle&&(h._joystickUpdateHandle(0,0),m||Ae(h))}else if(r==="knob"&&l){let m=p?.knobs?.[l]?.initial??0,g=p?.knobs?.[l]?.max||10;l==="rangeX"?c.setRangeX(m):l==="rangeY"&&c.setRangeY(m),d?.[l]?.knobInstance&&d[l].knobInstance.setValue(m/g)}return}if(s==="oscillator"){let c=a.knobs[t];c&&typeof c.resetToDefault=="function"&&c.resetToDefault();return}if(a.knobs&&typeof a.knobs=="object"){let d=Object.keys(a.knobs)[t];d&&a.knobs[d]&&typeof a.knobs[d].resetToDefault=="function"&&a.knobs[d].resetToDefault()}}_handleContextReset(e){let{level:t,panelId:n,moduleId:i,knobIndex:s,controlType:a,controlKey:r}=e;L.info(`Context reset: level=${t}, panel=${n}, module=${i}, knob=${s}, controlType=${a}`),$e.applyingPatch(!0);try{switch(t){case"panel":{let l=this._getModulesForPanel(n);for(let c of l)this._resetModule(c.type,c.ui);break}case"module":{let l=this._findModuleById(i);l&&this._resetModule(l.type,l.ui);break}case"control":{this._resetControl(i,s,{controlType:a,controlKey:r});break}}}finally{$e.applyingPatch(!1),this.dormancyManager?.flushPendingUpdate()}}_setupRecording(){this._recordingEngine=new ai(this.engine),this._recordingSettingsModal=new To({recordingEngine:this._recordingEngine,outputCount:this.engine.outputChannels}),this._recordingOverlay=new Mo,this._recordingEngine.onRecordingStart=()=>{document.dispatchEvent(new CustomEvent("synth:recordingChanged",{detail:{recording:!0}})),se(u("toast.recordingStarted"),{level:"success"})},this._recordingEngine.onRecordingStop=e=>{document.dispatchEvent(new CustomEvent("synth:recordingChanged",{detail:{recording:!1}})),e?se(u("toast.recordingSaved",{filename:e}),{level:"success"}):se(u("toast.recordingEmpty"),{level:"warning"})},document.addEventListener("synth:toggleRecording",async()=>{if(!this.engine.dspEnabled){se(u("toast.dspRequired"),{level:"warning"});return}this.ensureAudio();try{await this._recordingEngine.toggle()}catch(e){L.error(" Recording error:",e),se(u("toast.recordingError"),{level:"error"})}}),document.addEventListener("synth:toggleRecordingSettings",()=>{this._recordingSettingsModal.toggle()})}_setupSettingsModal(){this.wakeLockManager=new Qn({storageKey:v.WAKE_LOCK_ENABLED,onStateChange:e=>{L.info(` Wake lock ${e?"acquired":"released"}`)}}),this.settingsModal=new Po({onResolutionChange:e=>{L.info(` Resolution changed: ${e}\xD7`)},onAutoSaveIntervalChange:(e,t)=>{$e.configureAutoSave(e),L.info(` Autosave interval changed: ${t} (${e}ms)`)},onSaveOnExitChange:e=>{this._saveOnExit=e,L.info(` Save on exit: ${e}`)},onRestoreOnStartChange:e=>{L.info(` Restore on start: ${e}`)},onWakeLockChange:e=>{e?(this.wakeLockManager.enable(),window.powerAPI?.preventSleep()):(this.wakeLockManager.disable(),window.powerAPI?.allowSleep()),document.dispatchEvent(new CustomEvent("synth:wakeLockChange",{detail:{enabled:e}})),L.info(` Wake lock ${e?"enabled":"disabled"}`)},audioSettingsModal:this.audioSettingsModal,recordingSettingsModal:this._recordingSettingsModal}),this._saveOnExit=this.settingsModal.getSaveOnExit(),$e.configureAutoSave(this.settingsModal.getAutoSaveIntervalMs()),window.addEventListener("beforeunload",()=>{this._saveOnExit&&$e.saveOnExit()}),document.addEventListener("synth:toggleSettings",e=>{let t=e.detail?.tabId;this.settingsModal.isOpen?this.settingsModal.close():this.settingsModal.open(t)}),Jc(),document.addEventListener("osc:toggle",async()=>{if(!(this._oscEnabled||!1)){if(!await J.start()){se(u("quickbar.oscError","Error al activar OSC"),{level:"error"});return}this._oscEnabled=!0;try{let s=JSON.parse(localStorage.getItem(v.OSC_UNICAST_TARGETS)||"[]");for(let r of s)await window.oscAPI.addTarget(r.ip,r.port);if(localStorage.getItem(v.OSC_SUPERCOLLIDER_SEND)==="true"){let r=parseInt(localStorage.getItem(v.OSC_SUPERCOLLIDER_PORT)||"57120",10);await window.oscAPI.addTarget("127.0.0.1",r)}}catch(s){console.warn("[App] Error restaurando targets OSC:",s)}localStorage.getItem(v.OSC_LOG_VISIBLE)==="true"&&window.dispatchEvent(new CustomEvent("osc:log-visibility",{detail:{visible:!0}}))}else await J.stop(),this._oscEnabled=!1,window.dispatchEvent(new CustomEvent("osc:log-visibility",{detail:{visible:!1,updateCheckbox:!1}}));document.dispatchEvent(new CustomEvent("osc:statusChanged",{detail:{enabled:this._oscEnabled}})),se(u(this._oscEnabled?"quickbar.oscOn":"quickbar.oscOff"))}),this._oscEnabled=!1,J.isAvailable()&&document.dispatchEvent(new CustomEvent("osc:statusChanged",{detail:{enabled:!1}})),document.addEventListener("osc:statusChanged",e=>{this._oscEnabled=e.detail?.enabled??!1})}_setupDormancyManager(){this.dormancyManager=new $s(this),document.addEventListener("synth:dormancyEnabledChange",e=>{this.dormancyManager.setEnabled(e.detail.enabled),L.info(` Dormancy system ${e.detail.enabled?"enabled":"disabled"}`)}),document.addEventListener("synth:dormancyDebugChange",e=>{this.dormancyManager.setDebugIndicators(e.detail.enabled),L.info(` Dormancy debug indicators ${e.detail.enabled?"enabled":"disabled"}`)})}_setupFilterBypass(){document.addEventListener("synth:filterBypassEnabledChange",e=>{let t=e.detail.enabled;this.engine.setFilterBypassEnabled(t);let n=this._panel3LayoutData?.noiseAudioModules;n&&(n.noise1.setFilterBypassEnabled(t),n.noise2.setFilterBypassEnabled(t)),L.info(`\u26A1 Filter bypass ${t?"enabled":"disabled"}`)}),document.addEventListener("synth:filterBypassDebugChange",e=>{this.engine.setFilterBypassDebug(e.detail.enabled),L.info(`\u{1F527} Filter bypass debug ${e.detail.enabled?"enabled":"disabled"}`)}),document.addEventListener("synth:optimizationsDebugChange",e=>{e.detail.enabled&&(this.dormancyManager.setDebugIndicators(!0),this.engine.setFilterBypassDebug(!0),L.info("\u{1F527} Global optimizations debug enabled"))})}async triggerRestoreLastState(){try{await this.ensureAudio(),this.settingsModal.getRestoreOnStart()&&$e.maybeRestoreLastState({getAskBeforeRestore:()=>this.settingsModal.getAskBeforeRestore(),setAskBeforeRestore:e=>this.settingsModal.setAskBeforeRestore(e),getRememberedChoice:e=>Ie.getRememberedChoice(e),showConfirmDialog:()=>Ie.show({title:u("patches.lastSession"),confirmText:u("patches.lastSession.yes"),cancelText:u("patches.lastSession.no"),rememberKey:"restore-last-session",rememberText:u("patches.lastSession.remember")})})}catch(e){L.error("Error al restaurar estado previo:",e),se(u("toast.restoreError","Error al restaurar estado previo"),{level:"error",duration:3e3})}}_buildPanel1(){if(!this.panel1)return;let e=Kl,t=(I,B=0)=>{let Y=Number(I);return Number.isFinite(Y)?Y:B},n=(I,B={x:0,y:0})=>({x:t(I?.x,B.x),y:t(I?.y,B.y)}),i=(I,B,Y={x:0,y:0})=>{if(!I)return;let P=n(B,Y);(P.x!==0||P.y!==0)&&(I.style.transform=`translate(${P.x}px, ${P.y}px)`)},s=({knobSize:I="sm",knobInnerPct:B=78})=>{let P=Wt({size:typeof I=="string"?I:"",showValue:!1});typeof I=="number"&&Number.isFinite(I)&&I>0&&(P.knobEl.style.width=`${I}px`,P.knobEl.style.height=`${I}px`);let F=P.knobEl.querySelector(".knob-inner");if(F){let z=t(B,78);F.style.width=`${z}%`,F.style.height=`${z}%`}return P};e.showFrames===!1&&this.panel1.element.classList.add("hide-frames");let a=document.createElement("div");a.id="panel1Layout",a.className="panel1-layout";let r=e.layout.offset||{x:0,y:0};a.style.cssText=`
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      box-sizing: border-box;
      padding: ${e.layout.padding.top}px ${e.layout.padding.right}px 
               ${e.layout.padding.bottom}px ${e.layout.padding.left}px;
      display: flex;
      flex-direction: column;
      gap: ${e.layout.gap??4}px;
      transform: translate(${r.x}px, ${r.y}px);
    `,this.panel1.appendElement(a);let l=e.layout.filtersRow,c=document.createElement("div");c.className="panel1-filters-row",c.style.cssText=`
      display: flex;
      gap: ${l.gap}px;
      height: ${l.height}px;
      flex: 0 0 auto;
      width: 100%;
    `,i(c,l.offset),a.appendChild(c);let d=["flp1","flp2","flp3","flp4","fhp1","fhp2","fhp3","fhp4"],h={};for(let I of d){let B=e.modules?.[I]?.ui||{},Y=new Ve({id:`${I}-module`,title:null,className:"panel1-placeholder panel1-filter"}),P=Y.createElement();P.style.cssText="flex: 1 1 0; min-width: 0; height: 100%;";let F=document.createElement("div");F.className="panel1-filter-knobs",F.style.gap=`${t(B.knobGap,t(l.knobGap,2))}px`,i(F,B.knobsOffset,l.knobsOffset||{x:0,y:0});for(let z of l.knobs){let $=s({knobSize:B.knobSize??l.knobSize,knobInnerPct:B.knobInnerPct??l.knobInnerPct});F.appendChild($.wrapper)}Y.appendToContent(F),i(P,B.offset,l.moduleOffset||{x:0,y:0}),Vt(P,e,I),c.appendChild(P),h[I]=Y}let p=e.layout.envelopeShapers,m={};for(let I=1;I<=p.count;I++){let B=`envelopeShaper${I}`,Y=new Ve({id:`${B}-module`,title:null,className:"panel1-placeholder panel1-envelope"}),P=Y.createElement(),F=e.modules?.[B]?.ui||{};P.style.cssText=`
        width: 100%;
        height: ${p.height}px;
        flex: 0 0 auto;
      `;let z=document.createElement("div");z.className="panel1-envelope-knobs",z.style.gap=`${t(F.knobGap,t(p.knobGap,2))}px`,i(z,F.knobsOffset,p.knobsOffset||{x:0,y:0});for(let $ of p.knobs){let N=s({knobSize:F.knobSize??p.knobSize,knobInnerPct:F.knobInnerPct??p.knobInnerPct});z.appendChild(N.wrapper)}Y.appendToContent(z),i(P,F.offset,p.moduleOffset||{x:0,y:0}),Vt(P,e,B),a.appendChild(P),m[B]=Y}let g=e.layout.bottomRow,_=document.createElement("div");_.className="panel1-bottom-row",_.style.cssText=`
      display: flex;
      gap: ${g.gap}px;
      height: ${g.height}px;
      flex: 0 0 auto;
      width: 100%;
    `,i(_,g.offset),a.appendChild(_);let y={},f=g.ringModulator;for(let I=1;I<=f.count;I++){let B=`ringModulator${I}`,Y=new Ve({id:`${B}-module`,title:null,className:"panel1-placeholder panel1-ring-mod"}),P=Y.createElement(),F=e.modules?.[B]?.ui||{};P.style.cssText="flex: 1 1 0; min-width: 0; height: 100%;";let z=document.createElement("div");z.className="panel1-bottom-knobs",z.style.gap=`${t(F.knobGap,t(f.knobGap,6))}px`,i(z,F.knobsOffset,f.knobsOffset||{x:0,y:0});for(let $ of f.knobs){let N=s({knobSize:F.knobSize??f.knobSize,knobInnerPct:F.knobInnerPct??f.knobInnerPct});z.appendChild(N.wrapper)}Y.appendToContent(z),i(P,F.offset,f.moduleOffset||{x:0,y:0}),Vt(P,e,B),_.appendChild(P),y[B]=Y}let b=g.reverberation,E=new Ve({id:"reverberation1-module",title:null,className:"panel1-placeholder panel1-reverb"}),w=E.createElement(),S=e.modules?.reverberation1?.ui||{};w.style.cssText="flex: 1 1 0; min-width: 0; height: 100%;";let T=document.createElement("div");T.className="panel1-bottom-knobs",T.style.gap=`${t(S.knobGap,t(b.knobGap,6))}px`,i(T,S.knobsOffset,b.knobsOffset||{x:0,y:0});for(let I of b.knobs){let B=s({knobSize:S.knobSize??b.knobSize,knobInnerPct:S.knobInnerPct??b.knobInnerPct});T.appendChild(B.wrapper)}E.appendToContent(T),i(w,S.offset,b.moduleOffset||{x:0,y:0}),Vt(w,e,"reverberation1"),_.appendChild(w),y.reverberation1=E;let A=g.echo,C=new Ve({id:"echoADL-module",title:null,className:"panel1-placeholder panel1-echo"}),x=C.createElement(),R=e.modules?.echoADL?.ui||{};x.style.cssText="flex: 2 1 0; min-width: 0; height: 100%;";let M=document.createElement("div");M.className="panel1-bottom-knobs",M.style.gap=`${t(R.knobGap,t(A.knobGap,6))}px`,i(M,R.knobsOffset,A.knobsOffset||{x:0,y:0});for(let I of A.knobs){let B=s({knobSize:R.knobSize??A.knobSize,knobInnerPct:R.knobInnerPct??A.knobInnerPct});M.appendChild(B.wrapper)}C.appendToContent(M),i(x,R.offset,A.moduleOffset||{x:0,y:0}),Vt(x,e,"echoADL"),_.appendChild(x),y.echoADL=C,this._panel1Data={host:a,filtersRow:c,filterFrames:h,envFrames:m,bottomRow:_,bottomFrames:y}}_buildPanel2(){if(!this.panel2)return;let e=Xl,t=(ie,Ke=0)=>{let Gt=Number(ie);return Number.isFinite(Gt)?Gt:Ke},n=(ie,Ke={x:0,y:0})=>({x:t(ie?.x,Ke.x),y:t(ie?.y,Ke.y)}),i=(ie,Ke,Gt={x:0,y:0})=>{if(!ie)return;let mt=n(Ke,Gt);(mt.x!==0||mt.y!==0)&&(ie.style.transform=`translate(${mt.x}px, ${mt.y}px)`)};e.showFrames===!1&&this.panel2.element.classList.add("hide-frames");let s=document.createElement("div");s.id="panel2Layout",s.className="panel2-layout";let a=e.layout.offset||{x:0,y:0};s.style.cssText=`
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      box-sizing: border-box;
      padding: ${e.layout.padding.top}px ${e.layout.padding.right}px 
               ${e.layout.padding.bottom}px ${e.layout.padding.left}px;
      transform: translate(${a.x}px, ${a.y}px);
    `,this.panel2.appendElement(s);let r=e.layout.oscilloscope,l=r.size,c=r.offset||{x:0,y:0},d=document.createElement("div");d.className="panel2-oscilloscope-section",d.style.cssText=`
      width: ${l.width}px;
      height: ${l.height}px;
      box-sizing: border-box;
      margin-bottom: ${e.layout.gap??6}px;
    `,i(d,c),s.appendChild(d);let h=new oo(this.engine,"oscilloscope"),p=Ut.audio;h.setBufferSize(p.bufferSize),h.setTriggerHysteresis(p.triggerHysteresis),h.setSchmittHysteresis(p.schmittHysteresis),p.inputSensitivity&&h.setInputSensitivity(p.inputSensitivity),this.engine.addModule(h),this.oscilloscope=h;let m=r.frame,g=new Ve({id:"oscilloscope-module",title:null,className:"synth-module--oscilloscope"}),_=g.createElement();_.style.cssText=`
      width: 100%;
      height: 100%;
      border-radius: ${m.borderRadius}px;
      padding: ${m.padding.top}px ${m.padding.right}px 
               ${m.padding.bottom}px ${m.padding.left}px;
    `,d.appendChild(_);let y=r.display,f=y.size||{width:200,height:150},b=y.offset||{x:0,y:0},E=document.createElement("div");E.className="oscilloscope-main",E.style.cssText=`
      position: relative;
      width: 100%;
      height: 100%;
    `,g.appendToContent(E);let w=document.createElement("div");w.className="oscilloscope-display-container",w.style.cssText=`
      position: absolute;
      left: ${b.x}px;
      top: ${b.y}px;
      width: ${f.width}px;
      height: ${f.height}px;
      border-radius: 4px;
      overflow: hidden;
    `,E.appendChild(w);let S=Ut.display,T=y.transparent===!0,A=y.beamOffsets||{beam1Y:0,beam2Y:0},C=y.centerOffset||{x:0,y:0},x=new ao({container:w,internalWidth:S.internalWidth,internalHeight:S.internalHeight,useDevicePixelRatio:S.useDevicePixelRatio,mode:Ut.audio.mode,lineColor:S.lineColor,bgColor:T?"transparent":S.bgColor,gridColor:S.gridColor,centerColor:S.centerColor,lineWidth:S.lineWidth,showGrid:T?!1:S.showGrid,showTriggerIndicator:S.showTriggerIndicator,beam1OffsetY:A.beam1Y||0,beam2OffsetY:A.beam2Y||0,centerOffsetX:C.x||0,centerOffsetY:C.y||0}),R=Ut.knobs,M=document.createElement("div");M.className="oscilloscope-knobs",E.appendChild(M);let I=Wt({label:"TIME",size:"sm",...R.timeScale,onChange:ie=>x.setTimeScale(ie)});M.appendChild(I.wrapper);let B=Wt({label:"AMP",size:"sm",...R.ampScale,onChange:ie=>x.setAmpScale(ie)});M.appendChild(B.wrapper);let Y=Wt({label:"LEVEL",size:"sm",...R.triggerLevel,onChange:ie=>h.setTriggerLevel(ie)});M.appendChild(Y.wrapper);let P=new ro({id:"scope-mode-toggle",labelA:"Y-T",labelB:"X-Y",initial:Ut.audio.mode==="xy"?"b":"a",onChange:ie=>{let Ke=ie==="a"?"yt":"xy";x.setMode(Ke),h.setMode&&h.setMode(Ke)}});g.appendToControls(P.createElement()),x.startRenderLoop(),h.onData(ie=>x.draw(ie));let F=e.layout.frequencyMeter,z=F.size,$=new Ve({id:"frequency-meter",title:"Frequency Meter",className:"panel2-placeholder"}),N=$.createElement();N.style.cssText=`
      width: ${z.width}px;
      height: ${z.height}px;
      box-sizing: border-box;
      margin-bottom: ${e.layout.gap??6}px;
    `,i(N,F.offset),Vt(N,e,"frequencyMeter"),s.appendChild(N);let K=e.layout.octaveFilterBank,te=K.size,Q=new Ve({id:"octave-filter-bank",title:"Octave Filter Bank",className:"panel2-placeholder"}),ge=Q.createElement();ge.style.cssText=`
      width: ${te.width}px;
      height: ${te.height}px;
      box-sizing: border-box;
      margin-bottom: ${e.layout.gap??6}px;
    `,i(ge,K.offset),Vt(ge,e,"octaveFilterBank"),s.appendChild(ge);let Se=e.layout.inputAmplifierLevel||{},ne=e.modules?.inputAmplifierLevel?.ui||{},ce=Array.isArray(Se.knobGap)?t(Se.knobGap[0],t(Se.knobsGap,8)):t(Se.knobGap,t(Se.knobsGap,8)),ue={offset:n(Se.offset,{x:0,y:0}),knobGap:ce,knobSize:Se.knobSize??"sm",knobInnerPct:t(Se.knobInnerPct,78),knobsRowOffset:n(Se.knobsRowOffset,{x:0,y:0}),knobOffsets:Array.isArray(Se.knobOffsets)?Se.knobOffsets:[]},Ne=Array.isArray(ne.knobGap)?t(ne.knobGap[0],ue.knobGap):t(ne.knobGap,ue.knobGap),ke={...ue,...ne,offset:n(ne.offset,ue.offset),knobGap:Ne,knobSize:ne.knobSize??ue.knobSize,knobInnerPct:t(ne.knobInnerPct,ue.knobInnerPct),knobsRowOffset:n(ne.knobsRowOffset,ue.knobsRowOffset),knobOffsets:Array.isArray(ne.knobOffsets)?ne.knobOffsets:ue.knobOffsets},O=document.createElement("div");O.className="panel2-input-amp-section";let q=Se.size||{width:730,height:90};O.style.cssText=`
      width: ${q.width}px;
      height: ${q.height}px;
      box-sizing: border-box;
      margin-bottom: ${e.layout.gap??6}px;
    `,i(O,ke.offset),s.appendChild(O);let Z=new Xs(this.engine,"input-amplifiers",{channels:$t.count,initialLevel:$t.knobs.level.initial,levelSmoothingTime:$t.audio.levelSmoothingTime});this.engine.addModule(Z),this.inputAmplifiers=Z;let De=new io({id:"input-amplifiers",title:"Input Amplifier Level",channels:$t.count,knobConfig:$t.knobs.level,layout:{knobGap:ke.knobGap,knobSize:ke.knobSize,knobInnerPct:ke.knobInnerPct,knobsRowOffset:ke.knobsRowOffset,knobOffsets:ke.knobOffsets},onLevelChange:(ie,Ke)=>{Z.setLevel(ie,Ke),Xo.shouldIgnoreOSC()||Xo.sendLevelChange(ie,Ke)}});O.appendChild(De.createElement()),this._inputAmplifierUIs["input-amplifiers"]=De;let Be=e.layout.externalTreatmentRow,ze=t(Be?.gap,6),xe=document.createElement("div");xe.className="panel2-ext-treatment-row",xe.style.cssText=`
      display: flex;
      gap: ${ze}px;
      box-sizing: border-box;
    `,s.appendChild(xe);let At=Be?.extTreatmentSend||{},nt=At.size||{width:362,height:60},j=new Ve({id:"ext-treatment-send",title:"Send Level",className:"panel2-placeholder"}),Ce=j.createElement();Ce.style.cssText=`
      width: ${nt.width}px;
      height: ${nt.height}px;
      box-sizing: border-box;
    `,i(Ce,At.offset),Vt(Ce,e,"extTreatmentSend"),xe.appendChild(Ce);let X=Be?.extTreatmentReturn||{},fe=X.size||{width:362,height:60},de=new Ve({id:"ext-treatment-return",title:"Return Level",className:"panel2-placeholder"}),Fe=de.createElement();Fe.style.cssText=`
      width: ${fe.width}px;
      height: ${fe.height}px;
      box-sizing: border-box;
    `,i(Fe,X.offset),Vt(Fe,e,"extTreatmentReturn"),xe.appendChild(Fe),this._panel2Data={host:s,scopeSection:d,moduleFrame:g,displayContainer:w,scopeModule:h,display:x,modeToggle:P,timeKnob:I,ampKnob:B,levelKnob:Y,inputAmpSection:O,inputAmpModule:Z,inputAmpUI:De,freqMeterFrame:$,octaveFilterFrame:Q,extSendFrame:j,extReturnFrame:de},this._panel2ScopeStarted=!1,x.drawEmpty()}async _ensurePanel2ScopeStarted(){this._panel2ScopeStarted||!this._panel2Data?.scopeModule||(this._panel2ScopeStarted=!0,await this._panel2Data.scopeModule.start())}async _ensureSystemAudioInput(e=null){if(this._systemAudioConnected&&!e)return;if(this.audioSettingsModal?.isMicrophonePermissionDenied?.()){L.info(" Microphone permission previously denied, skipping getUserMedia");return}if(!this.inputAmplifiers?.isStarted){L.warn(" Input amplifiers not ready for system audio");return}let t=this.engine.audioCtx;if(t)try{let n={echoCancellation:!1,noiseSuppression:!1,autoGainControl:!1};e&&e!=="default"&&(n.deviceId={exact:e});let i=await navigator.mediaDevices.getUserMedia({audio:n});this.audioSettingsModal?.clearMicrophonePermissionDenied&&this.audioSettingsModal.clearMicrophonePermissionDenied();let s=t.createMediaStreamSource(i),a=s.channelCount||2;L.info(` System audio input: ${a} channels`);let r=t.createChannelSplitter(Math.max(a,2));s.connect(r),this._inputRoutingGains=[];for(let c=0;c<a;c++){let d=[];for(let h=0;h<8;h++){let p=t.createGain();p.gain.value=0,r.connect(p,c);let m=this.inputAmplifiers.getInputNode(h);m&&p.connect(m),d.push(p)}this._inputRoutingGains.push(d)}this._systemAudioStream=i,this._systemAudioSource=s,this._systemAudioSplitter=r,this._systemAudioChannelCount=a,this._systemAudioConnected=!0;let l=this._generateInputLabels(a);this.audioSettingsModal&&(this.audioSettingsModal.updatePhysicalInputChannels(a,l),this.audioSettingsModal.applyInputRoutingToEngine()),L.info(` Input routing matrix created: ${a}\xD78`)}catch(n){L.warn(" Could not access system audio input:",n.message),(n.name==="NotAllowedError"||n.name==="PermissionDeniedError")&&(localStorage.setItem(v.MIC_PERMISSION_DENIED,"true"),L.info(" Microphone permission denied, flag saved to prevent retry loop"))}}_applyAllRoutingToEngine(){L.info(" Re-applying output routing to engine after channel rebuild...");let e=this.audioSettingsModal.applyRoutingToEngine((t,n)=>this.engine.setOutputRouting(t,n));e.warnings?.length>0&&L.warn(" Routing warnings:",e.warnings),L.info(" Re-applying stereo bus routing to engine..."),this.audioSettingsModal.applyStereoBusRoutingToEngine((t,n)=>{this.engine.setStereoBusRouting(t,n)})}async _activateMultichannelOutput(){if(this._multichannelActive)return L.info("\u{1F39B}\uFE0F Multichannel output already active, skipping"),{success:!0};if(!window.multichannelAPI)return L.info("\u{1F39B}\uFE0F multichannelAPI not available (browser mode)"),{success:!1,error:"multichannelAPI no disponible"};if(!this.engine.audioCtx)return L.error("\u{1F39B}\uFE0F Cannot activate multichannel: AudioContext is null"),{success:!1,error:"AudioContext no inicializado"};let e=["1","2","3","4","5","6","7","8","9","10","11","12"];this.engine.forcePhysicalChannels(12,e,!0);let t=this.audioSettingsModal?.getConfiguredLatencyMs?.()||42;L.info("\u{1F39B}\uFE0F Using configured latency:",t,"ms"),window.multichannelAPI.setLatency&&window.multichannelAPI.setLatency(t);let n=this.engine.audioCtx?.sampleRate||48e3,i=await window.multichannelAPI.open({sampleRate:n,channels:12});if(!i.success)return this.engine.forcePhysicalChannels(2,["L","R"],!1),{success:!1,error:i.error};L.info("\u{1F39B}\uFE0F Multichannel stream opened:",i.info);let s=this.engine.audioCtx,a=8192,r=12,l=null;if(console.warn("[SAB Debug] typeof SharedArrayBuffer:",typeof SharedArrayBuffer),console.warn("[SAB Debug] crossOriginIsolated:",window.crossOriginIsolated),typeof SharedArrayBuffer<"u"){console.warn("[SAB Debug] SharedArrayBuffer disponible, intentando crear...");try{let h=8+a*r*4;l=new SharedArrayBuffer(h),console.warn("[SAB Debug] SharedArrayBuffer creado:",h,"bytes");let p=new Int32Array(l,0,2);p[0]=0,p[1]=0,console.warn("[SAB Debug] Llamando attachSharedBuffer...");let m=window.multichannelAPI.attachSharedBuffer(l,a);console.warn("[SAB Debug] attachSharedBuffer resultado:",m),m?(this._sharedAudioBuffer=l,this._sharedBufferFrames=a,L.info("\u{1F39B}\uFE0F SharedArrayBuffer creado y adjuntado:",a,"frames - LOCK-FREE MODE!")):(L.warn("\u{1F39B}\uFE0F No se pudo adjuntar SharedArrayBuffer, usando fallback"),l=null)}catch(h){L.warn("\u{1F39B}\uFE0F Error creando SharedArrayBuffer:",h.message),l=null}}else L.warn("\u{1F39B}\uFE0F SharedArrayBuffer no disponible (requiere COOP/COEP headers)");try{await s.audioWorklet.addModule("./assets/js/worklets/multichannelCapture.worklet.js"),L.info("\u{1F39B}\uFE0F MultichannelCapture worklet loaded")}catch(h){L.error("\u{1F39B}\uFE0F Failed to load worklet:",h);try{return await this._activateMultichannelOutputFallback()}catch(p){return L.error("\u{1F39B}\uFE0F Fallback also failed:",p),await window.multichannelAPI.close(),this.engine.forcePhysicalChannels(2,["L","R"],!1),{success:!1,error:"Worklet y fallback fallaron"}}}let c=2048;this._multichannelWorklet=new AudioWorkletNode(s,"multichannel-capture",{numberOfInputs:1,numberOfOutputs:1,channelCount:12,channelCountMode:"explicit",channelInterpretation:"discrete",processorOptions:{channels:12,chunkSize:c}}),We(this._multichannelWorklet,"multichannel-capture"),this._mcWorkletChunks=0,this._multichannelWorklet.port.onmessage=h=>{let{type:p}=h.data;if(p==="ready")this._sharedAudioBuffer&&(this._multichannelWorklet.port.postMessage({type:"init",sharedBuffer:this._sharedAudioBuffer,bufferFrames:this._sharedBufferFrames}),L.info("\u{1F39B}\uFE0F SharedArrayBuffer enviado al worklet"));else if(p==="initialized")L.info("\u{1F39B}\uFE0F Worklet inicializado con SharedArrayBuffer - LOCK-FREE activo!");else if(p==="audioData"){let{buffer:m,frames:g}=h.data,_=new Float32Array(m);window.multichannelAPI.write(_),this._mcWorkletChunks++,this._mcWorkletChunks%200===1&&L.info(`\u{1F39B}\uFE0F [Fallback] Chunk #${this._mcWorkletChunks}, ${g} frames`)}},this._multichannelSilencer=s.createGain(),this._multichannelSilencer.gain.value=0,this._multichannelActive=!0;try{this.engine.merger.disconnect(),L.info("\u{1F39B}\uFE0F Merger disconnected")}catch(h){L.warn("\u{1F39B}\uFE0F Merger disconnect failed:",h.message)}this.engine.merger.connect(this._multichannelWorklet),this._multichannelWorklet.connect(this._multichannelSilencer),this._multichannelSilencer.connect(s.destination);let d=this._sharedAudioBuffer?"LOCK-FREE (SharedArrayBuffer)":"FALLBACK (MessagePort)";return L.info(`\u{1F39B}\uFE0F Multichannel active - ${d}`),{success:!0}}async _activateMultichannelOutputFallback(){L.warn("\u{1F39B}\uFE0F Using ScriptProcessor fallback (may have UI-related audio glitches)");let e=this.engine.audioCtx;if(!e)throw new Error("AudioContext is null - cannot create ScriptProcessor fallback");let t=512,n=12,i=2;this._multichannelProcessor=e.createScriptProcessor(t,n,i),this._multichannelSilencer=e.createGain(),this._multichannelSilencer.gain.value=0,this._multichannelProcessor.onaudioprocess=s=>{let a=s.inputBuffer,r=s.outputBuffer,l=a.length,c=a.numberOfChannels;for(let h=0;h<r.numberOfChannels;h++){let p=r.getChannelData(h);for(let m=0;m<p.length;m++)p[m]=0}let d=new Float32Array(l*c);for(let h=0;h<l;h++)for(let p=0;p<c;p++)d[h*c+p]=a.getChannelData(p)[h];window.multichannelAPI.write(d.buffer)},this._multichannelActive=!0;try{this.engine.merger.disconnect()}catch{}return this.engine.merger.connect(this._multichannelProcessor),this._multichannelProcessor.connect(this._multichannelSilencer),this._multichannelSilencer.connect(e.destination),{success:!0}}async _deactivateMultichannelOutput(){if(!this._multichannelActive)return;L.info("\u{1F39B}\uFE0F Deactivating multichannel output..."),window.multichannelAPI&&await window.multichannelAPI.close();let e=this.engine.audioCtx;if(this._multichannelWorklet){try{this._multichannelWorklet.port.postMessage({type:"stop"}),this.engine.merger.disconnect(this._multichannelWorklet),this._multichannelWorklet.disconnect(),this._multichannelWorklet.port.close()}catch{}this._multichannelWorklet=null}if(this._multichannelProcessor){try{this.engine.merger.disconnect(this._multichannelProcessor),this._multichannelProcessor.disconnect(),this._multichannelProcessor.onaudioprocess=null}catch{}this._multichannelProcessor=null}if(this._multichannelSilencer){try{this._multichannelSilencer.disconnect()}catch{}this._multichannelSilencer=null}this.engine.merger&&e&&(this.engine._skipDestinationConnect=!1,this.engine.merger.connect(e.destination)),this._multichannelActive=!1,L.info("\u{1F39B}\uFE0F Multichannel output deactivated, normal audio restored")}async _activateMultichannelInput(){if(this._multichannelInputActive)return L.info("\u{1F3A4} Multichannel input already active, skipping"),{success:!0};if(!window.multichannelInputAPI)return L.info("\u{1F3A4} multichannelInputAPI not available (browser mode)"),{success:!1,error:"multichannelInputAPI no disponible"};if(!this.inputAmplifiers?.isStarted)return L.warn("\u{1F3A4} Input amplifiers not ready for multichannel input"),{success:!1,error:"Input amplifiers not ready"};this._disconnectSystemAudioInput();let e=this.engine.audioCtx,t=e?.sampleRate||48e3,n=await window.multichannelInputAPI.open({sampleRate:t,channels:8});if(!n.success)return{success:!1,error:n.error};L.info("\u{1F3A4} Multichannel input stream opened:",n.info);let i=8192,s=8,a=null;if(typeof SharedArrayBuffer<"u")try{let l=8+i*s*4;a=new SharedArrayBuffer(l);let c=new Int32Array(a,0,2);c[0]=0,c[1]=0,window.multichannelInputAPI.attachSharedBuffer(a,i)?(this._sharedInputBuffer=a,this._sharedInputBufferFrames=i,L.info("\u{1F3A4} Input SharedArrayBuffer creado y adjuntado:",i,"frames")):(L.warn("\u{1F3A4} No se pudo adjuntar SharedArrayBuffer de input"),a=null)}catch(l){L.warn("\u{1F3A4} Error creando Input SharedArrayBuffer:",l.message),a=null}if(!a)return await window.multichannelInputAPI.close(),{success:!1,error:"SharedArrayBuffer no disponible"};try{await e.audioWorklet.addModule("./assets/js/worklets/multichannelPlayback.worklet.js"),L.info("\u{1F3A4} MultichannelPlayback worklet loaded")}catch(l){return L.error("\u{1F3A4} Failed to load playback worklet:",l),await window.multichannelInputAPI.close(),{success:!1,error:"Failed to load worklet"}}this._multichannelInputWorklet=new AudioWorkletNode(e,"multichannel-playback",{numberOfInputs:0,numberOfOutputs:1,outputChannelCount:[8],channelCount:8,channelCountMode:"explicit",channelInterpretation:"discrete",processorOptions:{channels:8}}),We(this._multichannelInputWorklet,"multichannel-playback"),this._multichannelInputWorklet.port.onmessage=l=>{let{type:c}=l.data;c==="ready"?this._sharedInputBuffer&&(this._multichannelInputWorklet.port.postMessage({type:"init",sharedBuffer:this._sharedInputBuffer,bufferFrames:this._sharedInputBufferFrames}),L.info("\u{1F3A4} Input SharedArrayBuffer enviado al worklet")):c==="initialized"&&L.info("\u{1F3A4} Input worklet inicializado con SharedArrayBuffer")};let r=e.createChannelSplitter(8);this._multichannelInputWorklet.connect(r);for(let l=0;l<8;l++){let c=this.inputAmplifiers.getInputNode(l);c&&r.connect(c,l)}return this._multichannelInputSplitter=r,this._multichannelInputActive=!0,L.info("\u{1F3A4} Multichannel input active - 8ch PipeWire \u2192 Input Amplifiers"),{success:!0}}async _deactivateMultichannelInput(){if(!this._multichannelInputActive)return;if(L.info("\u{1F3A4} Deactivating multichannel input..."),window.multichannelInputAPI&&await window.multichannelInputAPI.close(),this._multichannelInputWorklet){try{this._multichannelInputWorklet.port.postMessage({type:"stop"}),this._multichannelInputWorklet.disconnect(),this._multichannelInputWorklet.port.close()}catch{}this._multichannelInputWorklet=null}if(this._multichannelInputSplitter){try{this._multichannelInputSplitter.disconnect()}catch{}this._multichannelInputSplitter=null}this._sharedInputBuffer=null,this._multichannelInputActive=!1,L.info("\u{1F3A4} Multichannel input deactivated");let e=this.audioSettingsModal?.selectedInputDevice;e&&await this._ensureSystemAudioInput(e)}_disconnectSystemAudioInput(){if(this._systemAudioStream&&(this._systemAudioStream.getTracks().forEach(e=>e.stop()),this._systemAudioStream=null),this._systemAudioSource&&(this._systemAudioSource.disconnect(),this._systemAudioSource=null),this._inputRoutingGains&&(this._inputRoutingGains.forEach(e=>e.forEach(t=>t.disconnect())),this._inputRoutingGains=null),this._systemAudioSplitter){try{this._systemAudioSplitter.disconnect()}catch{}this._systemAudioSplitter=null}this._systemAudioConnected=!1,L.info("\u{1F3A4} System audio input disconnected")}async _reconnectSystemAudioInput(e){this._systemAudioStream&&(this._systemAudioStream.getTracks().forEach(t=>t.stop()),this._systemAudioStream=null),this._systemAudioSource&&(this._systemAudioSource.disconnect(),this._systemAudioSource=null),this._inputRoutingGains&&(this._inputRoutingGains.forEach(t=>t.forEach(n=>n.disconnect())),this._inputRoutingGains=null),this._systemAudioConnected=!1,await this._ensureSystemAudioInput(e)}_applyInputRouting(e,t){if(!this._inputRoutingGains||!this._inputRoutingGains[e])return;let i=this.engine.audioCtx?.currentTime??0,s=.03,a=this._inputRoutingGains[e];t.forEach((r,l)=>{a[l]&&(a[l].gain.cancelScheduledValues(i),a[l].gain.setTargetAtTime(r,i,s))})}_generateInputLabels(e){return e===1?["Mono"]:e===2?["L","R"]:Array.from({length:e},(t,n)=>`In ${n+1}`)}_buildOscillatorPanel(e,t,n){if(!t)return;let i=document.createElement("div");i.id=`panel${e}Layout`,i.className="panel3-layout";let s=at?.layout?.offset||{x:0,y:0};(s.x!==0||s.y!==0)&&(i.style.transform=`translate(${s.x}px, ${s.y}px)`),at?.showFrames===!1&&i.classList.add("hide-frames"),t.appendElement(i);let a=Hc(),{oscSize:r,gap:l,rowsPerColumn:c}=a,d;if(Array.isArray(at?.oscillatorSlots))d=at.oscillatorSlots.map(f=>({index:f.oscIndex+1,col:f.col,row:f.row,slotUI:f.ui||null}));else{d=[];for(let f=0;f<c;f+=1)d.push({index:f+1,col:0,row:f});for(let f=0;f<c;f+=1)d.push({index:f+7,col:1,row:f})}let h=d.map(f=>{let b=f.index-1,E=this._getPanelKnobOptions(e,b),w=`panel${e}-osc-${f.index}`,S=Wc(a.oscUIDefaults,f.slotUI),T=new to({id:w,title:`Osc ${f.index}`,size:r,knobGap:S.knobGap,switchOffset:S.switchOffset,knobSize:S.knobSize,knobRowOffsetX:S.knobRowOffsetX,knobRowOffsetY:S.knobRowOffsetY,knobInnerPct:S.knobInnerPct,knobOffsets:S.knobOffsets,knobOptions:E,onRangeChange:C=>this._onOscRangeChange(e,b,C)}),A=T.createElement();return e===3&&(A.dataset.oscIndex=String(f.index-1)),i.appendChild(A),this._oscillatorUIs[w]=T,{osc:T,element:A,slot:f,oscIndex:b}});h.forEach(({osc:f,oscIndex:b})=>{this._syncOscillatorStateFromUI(e,b,f)});let p=null,m=null,g=null;if(e===3){p=document.createElement("div"),p.className="panel3-reserved-row panel3-modules-row";let f=ft.defaults||{},b=ft.noise1||{},E=ft.noise2||{},w=Gi||{},S=new Wi(this.engine,b.id||"noise-1",{initialColour:b.knobs?.colour?.initial??5,initialLevel:b.knobs?.level?.initial??0,levelSmoothingTime:b.audio?.levelSmoothingTime??f.levelSmoothingTime??.03,colourSmoothingTime:b.audio?.colourSmoothingTime??f.colourSmoothingTime??.01,colourFilter:ft.colourFilter,levelCurve:ft.levelCurve,ramps:f.ramps}),T=new Wi(this.engine,E.id||"noise-2",{initialColour:E.knobs?.colour?.initial??5,initialLevel:E.knobs?.level?.initial??0,levelSmoothingTime:E.audio?.levelSmoothingTime??f.levelSmoothingTime??.03,colourSmoothingTime:E.audio?.colourSmoothingTime??f.colourSmoothingTime??.01,colourFilter:ft.colourFilter,levelCurve:ft.levelCurve,ramps:f.ramps});g={noise1:S,noise2:T};let A=localStorage.getItem(v.FILTER_BYPASS_ENABLED),C=A===null?!0:A==="true";S.setFilterBypassEnabled(C),T.setFilterBypassEnabled(C);let x=ft.colourFilter||{},R=(x.potResistance||1e4)*(x.capacitance||33e-9),M=1/(Math.PI*R),I=kl(M),B=ft.levelCurve||{},Y=wl(3,B.logBase||100),P=jc(),F=at?.modules?.noise1?.ui||{},z=at?.modules?.noise2?.ui||{},$=Wo(P,F),N=Wo(P,z),K=b.id||"panel3-noise-1",te=new Ji({id:K,title:b.title||"Noise 1",knobOptions:{colour:{...b.knobs?.colour,onChange:O=>{S.setColour(O),Qt.shouldIgnoreOSC()||Qt.sendColourChange(0,O)},getTooltipInfo:I},level:{...b.knobs?.level,onChange:O=>{S.setLevel(O),Qt.shouldIgnoreOSC()||Qt.sendLevelChange(0,O)},getTooltipInfo:Y}},...$});p.appendChild(te.createElement()),this._noiseUIs[K]=te;let Q=E.id||"panel3-noise-2",ge=new Ji({id:Q,title:E.title||"Noise 2",knobOptions:{colour:{...E.knobs?.colour,onChange:O=>{T.setColour(O),Qt.shouldIgnoreOSC()||Qt.sendColourChange(1,O)},getTooltipInfo:I},level:{...E.knobs?.level,onChange:O=>{T.setLevel(O),Qt.shouldIgnoreOSC()||Qt.sendLevelChange(1,O)},getTooltipInfo:Y}},...N});p.appendChild(ge.createElement()),this._noiseUIs[Q]=ge;let Se=Yc(),ne=at?.modules?.randomCV?.ui||{},ce=Wo(Se,ne),ue=w.id||"panel3-random-cv",Ne=new no({id:ue,title:w.title||"Random Voltage",knobOptions:w.knobs||{},...ce});this._randomVoltageUIs[ue]=Ne;let ke=Ne.createElement();Vt(ke,at,"randomCV"),p.appendChild(ke),i.appendChild(p),m={noise1:te,noise2:ge,randomCV:Ne}}else p=document.createElement("div"),p.className="panel3-reserved-row",p.textContent="Reserved strip for future modules",i.appendChild(p);let _=`_panel${e}LayoutData`,y=`_panel${e}LayoutRaf`;this[_]={host:i,layout:a,oscillatorSlots:d,oscComponents:h,reserved:p,noiseModules:m,noiseAudioModules:g},n.nodes=new Array(h.length).fill(null),this[y]=null,this._reflowOscillatorPanel(e)}_reflowOscillatorPanel(e){let t=`_panel${e}LayoutData`,n=`_panel${e}LayoutRaf`,i=this[t];i&&(this[n]&&cancelAnimationFrame(this[n]),this[n]=requestAnimationFrame(()=>{this[n]=null;let{host:s,layout:a,oscillatorSlots:r,oscComponents:l,reserved:c,noiseModules:d}=i;if(!s||!s.isConnected)return;let{oscSize:h,gap:p,airOuter:m=0,airOuterY:g=0,topOffset:_,rowsPerColumn:y}=a,f=s.clientWidth,b=s.clientHeight,E=h.width,w=E*2+p.x+m*2,S=Math.max(0,(f-w)/2)+m,T=y*(h.height+p.y)-p.y,A=T+a.reservedHeight+p.y,x=(b-g*2-A)/2+g+_;if(l.forEach(({element:R,slot:M})=>{let I=M.col,B=M.row,Y=M.slotUI?.slotOffset||a.oscUIDefaults?.slotOffset||{x:0,y:0},P=S+I*(E+p.x)+(Y.x||0),F=x+B*(h.height+p.y)+(Y.y||0);R.style.transform=`translate(${P}px, ${F}px)`}),c){let R=x+T+p.y;if(c.style.transform=`translate(${S}px, ${R}px)`,c.style.width=`${E*2+p.x}px`,e===3){let M=at?.layout?.modulesRow||{},I=M.gap??4;if(c.style.setProperty("--modules-row-gap",`${I}px`),d){let B=M.noiseSize||{width:80,height:110},Y=M.randomCVSize||{width:210,height:110},P=M.padding||{top:0,right:4,bottom:0,left:4},F=`${P.top}px ${P.right}px ${P.bottom}px ${P.left}px`;for(let $ of[d.noise1,d.noise2])$?.element&&($.element.style.width=`${B.width}px`,$.element.style.height=`${B.height}px`,$.element.style.padding=F,$.element.style.flex="none");d.randomCV?.element&&(d.randomCV.element.style.width=`${Y.width}px`,d.randomCV.element.style.height=`${Y.height}px`,d.randomCV.element.style.padding=F,d.randomCV.element.style.flex="none");let z=Math.max(B.height,Y.height);c.style.height=`${z}px`}}else c.style.height=`${a.reservedHeight}px`}}))}_scheduleWorkletRetry(e,t){let n=`${e}-${t}`;this._pendingWorkletRetries||(this._pendingWorkletRetries=new Set),!this._pendingWorkletRetries.has(n)&&(this._pendingWorkletRetries.add(n),this.engine.ensureWorkletReady().then(i=>{if(this._pendingWorkletRetries.delete(n),i){L.info(`Worklet ready - retrying oscillator ${t} on panel ${e}`);let s=this._getPanelAudio(e);if(s.nodes[t]&&(s.nodes[t]=null),this._ensurePanelNodes(e,t)&&this._oscillatorUIs){let r=`osc${e===3?t+1:e===1?t+7:t+10}`,l=this._oscillatorUIs[r];if(l&&typeof l.serialize=="function"){let c=l.serialize();l.deserialize(c)}}}}).catch(i=>{L.error(`Failed to retry oscillator ${t}:`,i),this._pendingWorkletRetries.delete(n)}))}_getPanelAudio(e){return this._panelAudios||(this._panelAudios={}),this._panelAudios[e]||(this._panelAudios[e]={nodes:[],state:[]}),this._panelAudios[e]}_ensurePanelNodes(e,t){if(e===1||e===4)return null;this.engine.start({latencyHint:localStorage.getItem(v.LATENCY_MODE)||(Bi()?"playback":"interactive")});let n=this.engine.audioCtx;if(!n)return null;let i=this._getPanelAudio(e);i.nodes=i.nodes||[],i.state=i.state||[];let s=i.nodes[t];if(s&&s.multiOsc&&s.sineSawOut&&s.triPulseOut&&s.freqCVInput){if(!s.cvThermalSlew&&this.engine.workletReady){let F=this._getOscConfig(t)?.thermalSlew??qe.defaults?.thermalSlew??{};if(F.enabled!==!1){L.info(`[FM] Osc ${t}: cvThermalSlew missing, creating now...`);try{let z=new AudioWorkletNode(n,"cv-thermal-slew",{numberOfInputs:1,numberOfOutputs:1,outputChannelCount:[1],channelCount:1,channelCountMode:"explicit",processorOptions:{riseTimeConstant:F.riseTimeConstant??.15,fallTimeConstant:F.fallTimeConstant??.5}});We(z,`cv-thermal-slew[osc ${t} retry]`);let $=z.parameters?.get("threshold");$&&($.value=F.threshold??.5);let N=s.multiOsc.parameters?.get("detune");if(N){try{s.freqCVInput.disconnect()}catch{}s.freqCVInput.connect(z);let K=z;s.cvSoftClip&&(K.connect(s.cvSoftClip),K=s.cvSoftClip),K.connect(N),s.cvThermalSlew=z,L.info(`[FM] Osc ${t}: cvThermalSlew CREATED and chain reconnected \u2713`)}}catch(z){L.warn(`[FM] Failed to create cvThermalSlew for osc ${t}:`,z)}}}return s}let a=Bn(i,t);if(!this.engine.workletReady)return L.warn(`MultiOscillator requires worklet support - scheduling retry for osc ${t}`),this._scheduleWorkletRetry(e,t),null;let l=this._getOscConfig(t),c=l?.sineShape??qe.defaults?.sineShape??{},d=l?.audio??qe.defaults?.audio??{},h=l?.moduleSlew??qe.defaults?.moduleSlew??{},p=this.engine.createMultiOscillator({frequency:a.freq||10,pulseWidth:a.pulseWidth||.5,symmetry:a.sineSymmetry||.5,sineLevel:a.oscLevel||0,sawLevel:a.sawLevel||0,triLevel:a.triLevel||0,pulseLevel:a.pulseLevel||0,sineShapeAttenuation:c.attenuation??1,sinePurity:c.purity??.7,saturationK:c.saturationK??1.55,maxOffset:c.maxOffset??.85,smoothingTime:d.smoothingTime??.01,moduleSlewCutoff:h.cutoffHz??2e4,moduleSlewEnabled:h.enabled??!0});if(!p)return null;let m=n.createGain();m.gain.value=1,p.connect(m,0);let g=n.createGain();g.gain.value=1,p.connect(g,1);let _=m;if(e!==3){let P=this.engine.getOutputBusNode(0);P&&_.connect(P)}let y=4,f=1200,E=f/y,w=f*y,S=n.createGain();S.gain.value=w;let T=l?.thermalSlew??qe.defaults?.thermalSlew??{},A=null;if(L.info(`[FM] Osc ${t}: thermalSlew.enabled=${T.enabled}, workletReady=${this.engine.workletReady}`),T.enabled!==!1&&this.engine.workletReady)try{A=new AudioWorkletNode(n,"cv-thermal-slew",{numberOfInputs:1,numberOfOutputs:1,outputChannelCount:[1],channelCount:1,channelCountMode:"explicit",processorOptions:{riseTimeConstant:T.riseTimeConstant??.15,fallTimeConstant:T.fallTimeConstant??.5}}),We(A,`cv-thermal-slew[osc ${t}]`);let P=A.parameters?.get("threshold");P&&(P.value=T.threshold??.5),L.info(`[FM] Osc ${t}: cvThermalSlew CREATED \u2713`)}catch(P){L.warn(` Failed to create CVThermalSlew for osc ${t}:`,P),A=null}else L.info(`[FM] Osc ${t}: cvThermalSlew SKIPPED (disabled or worklet not ready)`);let C=l?.softClip??qe.defaults?.softClip??{},x=C.coefficient??1e-4,R=C.enabled!==!1,M=null;if(R&&On.softClipEnabled&&this.engine.workletReady)try{M=new AudioWorkletNode(n,"cv-soft-clip",{numberOfInputs:1,numberOfOutputs:1,outputChannelCount:[1],channelCount:1,channelCountMode:"explicit",processorOptions:{coefficient:x}}),We(M,`cv-soft-clip[osc ${t}]`),L.info(`[FM] Osc ${t}: cvSoftClip CREATED (coefficient=${x})`)}catch(P){L.warn(`[FM] Osc ${t}: Failed to create cvSoftClip:`,P),M=null}let I=p.parameters?.get("detune"),B=null;if(I){B=n.createGain(),B.gain.value=1;let P=B;A&&(L.info(`[FM] Osc ${t}: Connecting cvChainInput \u2192 cvThermalSlew`),P.connect(A),P=A),M&&(L.info(`[FM] Osc ${t}: Connecting \u2192 cvSoftClip`),P.connect(M),P=M),L.info(`[FM] Osc ${t}: Connecting \u2192 freqCVInput (\xD7${w} cents)`),P.connect(S),L.info(`[FM] Osc ${t}: Connecting \u2192 detune`),S.connect(I),L.info(`[FM] Osc ${t}: CV chain complete \u2713`)}else L.error(`[FM] Osc ${t}: DETUNE PARAM IS NULL - FM WILL NOT WORK!`);return s={multiOsc:p,sineSawOut:m,triPulseOut:g,moduleOut:_,freqCVInput:S,_cvChainInput:B,cvThermalSlew:A,cvSoftClip:M,_freqInitialized:!0,_useWorklet:!0,_isMultiOsc:!0,_cvChainConnected:!!I,osc:p,gain:null,sawOsc:null,sawGain:null,triOsc:null,triGain:null,pulseOsc:null,pulseGain:null},s._isDormant=!1,s.setDormant=P=>{if(s._isDormant===P)return;s._isDormant=P;try{p.port.postMessage({type:"setDormant",dormant:P}),console.log(`[Dormancy] Oscillator ${t} on panel ${e}: ${P?"DORMANT":"ACTIVE"}`)}catch(z){console.warn("[Dormancy] Failed to send message to worklet:",z)}let F=.01;if(P)try{p.setSineLevel(0,F),p.setSawLevel(0,F),p.setTriLevel(0,F),p.setPulseLevel(0,F)}catch{}else{let z=i.state?.[t];if(z)try{Number.isFinite(z.oscLevel)&&p.setSineLevel(z.oscLevel,F),Number.isFinite(z.sawLevel)&&p.setSawLevel(z.sawLevel,F),Number.isFinite(z.triLevel)&&p.setTriLevel(z.triLevel,F),Number.isFinite(z.pulseLevel)&&p.setPulseLevel(z.pulseLevel,F)}catch{}}},i.nodes[t]=s,i.sources=i.sources||[],i.sources[t]=s,s}_syncOscillatorStateFromUI(e,t,n=null){if(!n){let p=`panel${e}-osc-${t+1}`;n=this._oscillatorUIs?.[p]}if(!n||!n.knobs)return;let i=this._getPanelAudio(e),s=e===3?this._getOscConfig(t):qe.defaults,a=s?.knobs||{},r=s?.tracking||{},l=n.rangeState==="lo",c=Bn(i,t,{knobsConfig:a,rangeLow:l}),d=n.knobs.map(p=>p.getValue());c.pulseLevel=d[0]??0,c.pulseWidth=.01+(d[1]??.5)*.98,c.oscLevel=d[2]??0,c.sineSymmetry=d[3]??.5,c.triLevel=d[4]??0,c.sawLevel=d[5]??0;let h=d[6]??5;c.freq=Dn(h,{rangeLow:l,trackingConfig:{alpha:r.alpha??.01,linearHalfRange:r.linearHalfRange??2.5}})}_updatePanelVoiceVolume(e,t,n,i){let s=this._getPanelAudio(e),a=Bn(s,t),l={osc:{stateKey:"oscLevel",setMethod:"setSineLevel"},saw:{stateKey:"sawLevel",setMethod:"setSawLevel"},tri:{stateKey:"triLevel",setMethod:"setTriLevel"},pulse:{stateKey:"pulseLevel",setMethod:"setPulseLevel"}}[n];if(!l||(a[l.stateKey]=i,this.ensureAudio(),!this.engine.audioCtx))return;let d=this._ensurePanelNodes(e,t);!d||!d.multiOsc||d.multiOsc[l.setMethod]&&d.multiOsc[l.setMethod](i)}_updatePanelOscVolume(e,t,n){this._updatePanelVoiceVolume(e,t,"osc",n)}_updatePanelSawVolume(e,t,n){this._updatePanelVoiceVolume(e,t,"saw",n)}_updatePanelTriVolume(e,t,n){this._updatePanelVoiceVolume(e,t,"tri",n)}_updatePanelPulseVolume(e,t,n){this._updatePanelVoiceVolume(e,t,"pulse",n)}_updatePanelPulseWidth(e,t,n){let i=this._getPanelAudio(e),s=Bn(i,t),a=.01+n*.98;if(s.pulseWidth=a,this.ensureAudio(),!this.engine.audioCtx)return;let l=this._ensurePanelNodes(e,t);!l||!l.multiOsc||l.multiOsc.setPulseWidth&&l.multiOsc.setPulseWidth(a)}_updatePanelSineSymmetry(e,t,n){let i=this._getPanelAudio(e),s=Bn(i,t);if(s.sineSymmetry=n,this.ensureAudio(),!this.engine.audioCtx)return;let r=this._ensurePanelNodes(e,t);!r||!r.multiOsc||r.multiOsc.setSymmetry&&r.multiOsc.setSymmetry(n)}_getOscConfig(e){let t=qe.defaults||{},n=e+1,i=qe.oscillators?.[n]||{};return Ka(t,i)}_applyCurve(e,t){let{min:n,max:i,curve:s="linear",curveExponent:a=2,curveK:r=3}=t,l=Math.max(0,Math.min(1,(e-n)/(i-n))),c;switch(s){case"quadratic":c=Math.pow(l,a);break;case"exponential":c=(Math.exp(r*l)-1)/(Math.exp(r)-1);break;case"logarithmic":c=Math.log(l+1)/Math.log(2);break;default:c=l}return c*(i-n)+n}_updatePanelOscFreq(e,t,n,i=void 0,s={}){let{ramp:a=0}=s,l=(e===3?this._getOscConfig(t):qe.defaults)?.tracking||{},c=`panel${e}-osc-${t+1}`,d=this._oscillatorUIs?.[c],h=i!==void 0?i:d?.rangeState==="lo",m=Dn(n,{rangeLow:h,trackingConfig:{alpha:l.alpha??.01,linearHalfRange:l.linearHalfRange??2.5}}),g=this._getPanelAudio(e),_=Bn(g,t);if(_.freq=m,this.ensureAudio(),!this.engine.audioCtx)return;let f=this._ensurePanelNodes(e,t);!f||!f.multiOsc||f.multiOsc.setFrequency&&f.multiOsc.setFrequency(m,a)}_onOscRangeChange(e,t,n){let i=`panel${e}-osc-${t+1}`,s=this._oscillatorUIs?.[i];if(!s||!s.knobs[6])return;let a=s.knobs[6].getValue(),r=n==="lo";this._updatePanelOscFreq(e,t,a,r),e===3&&!Ye.shouldIgnoreOSC()&&Ye.sendRangeChange(t,n)}_getPanelKnobOptions(e,t){let n=e===3?this._getOscConfig(t):qe.defaults,i=n?.knobs||{},s=n?.audio||{},a=8,r=[],l=()=>localStorage.getItem(v.TOOLTIP_SHOW_VOLTAGE)!=="false",c=()=>localStorage.getItem(v.TOOLTIP_SHOW_AUDIO_VALUES)!=="false",d=x=>x<=0?"-\u221E dB":`${(20*Math.log10(x)).toFixed(1)} dB`,h=x=>(R,M)=>{let I=[];if(l()){let B=(R*x).toFixed(2);I.push(`${B} Vp-p`)}return c()&&(I.push(`\xD7${R.toFixed(2)}`),I.push(d(R))),I.length>0?I.join(" \xB7 "):null},p=i.pulseLevel||{},m=a;r[0]={min:p.min??0,max:p.max??1,initial:p.initial??0,pixelsForFullRange:p.pixelsForFullRange??900,onChange:x=>{this._updatePanelPulseVolume(e,t,x),e===3&&!Ye.shouldIgnoreOSC()&&Ye.sendKnobChange(t,0,x)},getTooltipInfo:h(m)};let g=i.pulseWidth||{};r[1]={min:g.min??0,max:g.max??1,initial:g.initial??.5,pixelsForFullRange:g.pixelsForFullRange??900,angleOffset:-150,onChange:x=>{this._updatePanelPulseWidth(e,t,x),e===3&&!Ye.shouldIgnoreOSC()&&Ye.sendKnobChange(t,1,x)},getTooltipInfo:x=>{let R=[];if(l()&&R.push((x*10).toFixed(2)+" V"),c()){let M=`Duty: ${Math.round(x*100)}%`;this._hasOscillatorPWMCV(t)&&(M+=" + CV"),R.push(M)}return R.length>0?R.join(" \xB7 "):null}};let _=i.sineLevel||{},y=a;r[2]={min:_.min??0,max:_.max??1,initial:_.initial??0,pixelsForFullRange:_.pixelsForFullRange??900,onChange:x=>{this._updatePanelOscVolume(e,t,x),e===3&&!Ye.shouldIgnoreOSC()&&Ye.sendKnobChange(t,2,x)},getTooltipInfo:h(y)};let f=i.sineSymmetry||{};r[3]={min:f.min??0,max:f.max??1,initial:f.initial??.5,pixelsForFullRange:f.pixelsForFullRange??900,angleOffset:-150,onChange:x=>{this._updatePanelSineSymmetry(e,t,x),e===3&&!Ye.shouldIgnoreOSC()&&Ye.sendKnobChange(t,3,x)},getTooltipInfo:x=>{if(!c())return null;let R=Math.round((x-.5)*200);return R===0?"Puro":`Offset: ${R>0?"+":""}${R}%`}};let b=i.triangleLevel||{},E=a;r[4]={min:b.min??0,max:b.max??1,initial:b.initial??0,pixelsForFullRange:b.pixelsForFullRange??900,onChange:x=>{this._updatePanelTriVolume(e,t,x),e===3&&!Ye.shouldIgnoreOSC()&&Ye.sendKnobChange(t,4,x)},getTooltipInfo:h(E)};let w=i.sawtoothLevel||{},S=a;r[5]={min:w.min??0,max:w.max??1,initial:w.initial??0,pixelsForFullRange:w.pixelsForFullRange??900,onChange:x=>{this._updatePanelSawVolume(e,t,x),e===3&&!Ye.shouldIgnoreOSC()&&Ye.sendKnobChange(t,5,x)},getTooltipInfo:h(S)};let T=i.frequency||{},A=n?.tracking||{},C=(x,R)=>{let M=[];if(l()&&M.push(x.toFixed(3)+" V"),c()){let I=`panel${e}-osc-${t+1}`,Y=this._oscillatorUIs?.[I]?.rangeState==="lo",P=Dn(x,{rangeLow:Y,trackingConfig:{alpha:A.alpha??.01,linearHalfRange:A.linearHalfRange??2.5}}),F;P>=1e3?F=(P/1e3).toFixed(2)+" kHz":F=P.toFixed(2)+" Hz",this._hasOscillatorFreqCV(t)&&(F+=" + CV"),M.push(F)}return M.length>0?M.join(" \xB7 "):null};return r[6]={min:T.min??0,max:T.max??10,initial:T.initial??5,pixelsForFullRange:T.pixelsForFullRange??1e4,scaleDecimals:T.scaleDecimals??3,onChange:x=>{let R=s.frequencyRampTime??.2;this._updatePanelOscFreq(e,t,x,void 0,{ramp:R}),e===3&&!Ye.shouldIgnoreOSC()&&Ye.sendKnobChange(t,6,x)},getTooltipInfo:C},r}_ensurePanel3Nodes(e){return this._ensurePanelNodes(3,e)}_physicalRowToSynthRow(e){return Nn(mi).rowBase+e}_physicalColToSynthCol(e){return Nn(mi).colBase+e}_getPanel5PinGain(e,t,n=null,i=null){let s=yt?.audio||{},a=s.matrixGain??1,r=s.gainRange||{min:0,max:2},l=this._physicalRowToSynthRow(e),c=this._physicalColToSynthCol(t),d=`${l}:${c}`,h=yt?.pinGains||{};if(d in h){let x=h[d];return Math.max(r.min,Math.min(r.max,x))*a}let p=yt?.pinTypes||{},m=i||p[d]||On.defaultPinType||"WHITE",g=si;n?.rf&&(g=n.rf);let _=On.applyPinTolerance??!1,y=l*1e3+c,f=Ea(m,g,{applyTolerance:_,seed:y}),b=yt?.rowGains||{},E=yt?.colGains||{},w=b[l]??1,S=E[c]??1,T=Math.max(r.min,Math.min(r.max,w)),A=Math.max(r.min,Math.min(r.max,S)),C=f*T*A*a;return Math.max(r.min,Math.min(r.max*40,C))}_setupPanel5AudioRouting(){this._panel3Routing=this._panel3Routing||{connections:{},rowMap:null,colMap:null,destMap:null,channelMap:null,sourceMap:null},this._panel3Routing.connections={};let e=Nn(mi);this._panel3Routing.rowMap=e.rowMap,this._panel3Routing.colMap=e.colMap,this._panel3Routing.destMap=e.destMap,this._panel3Routing.channelMap=e.channelMap,this._panel3Routing.sourceMap=e.sourceMap,this._panel3Routing.hiddenCols=e.hiddenCols,this.largeMatrixAudio&&this.largeMatrixAudio.setToggleHandler&&this.largeMatrixAudio.setToggleHandler((t,n,i,s,a)=>this._handlePanel5AudioToggle(t,n,i,a))}getScopeConnectionCount(){let e=0;if(this._panel3Routing?.connections&&this._panel3Routing?.destMap)for(let t of Object.keys(this._panel3Routing.connections)){let n=parseInt(t.split(":")[1],10);this._panel3Routing.destMap.get(n)?.kind==="oscilloscope"&&e++}if(this._panel6Routing?.connections&&this._panel6Routing?.destMap)for(let t of Object.keys(this._panel6Routing.connections)){let n=parseInt(t.split(":")[1],10);this._panel6Routing.destMap.get(n)?.kind==="oscilloscope"&&e++}return e}async _handlePanel5AudioToggle(e,t,n,i=null){let s=this._panel3Routing?.sourceMap?.get(e),a=this._panel3Routing?.destMap?.get(t),r=`${e}:${t}`;if(!s||!a)return!0;if(n){if(!this.engine.dspEnabled)return!0;this.ensureAudio();let c=this.engine.audioCtx;if(!c)return!1;let d=null;if(s.kind==="panel3Osc"){let y=s.oscIndex,f=s.channelId||"sineSaw",b=this._ensurePanel3Nodes(y);d=f==="triPulse"?b?.triPulseOut:b?.sineSawOut;let E=this._panel3Audio?.state?.[y];xa(b,E,c)}else if(s.kind==="noiseGen"){let y=s.index,b=this._panel3LayoutData?.noiseAudioModules;if(!b)return L.warn(" Noise audio modules not initialized"),!1;let E=y===0?b.noise1:b.noise2;E&&!E.isStarted&&E.start(),d=E?.getOutputNode?.(),d||(L.warn(" NoiseModule output node not available, retrying init"),E?.start?.(),d=E?.getOutputNode?.())}else if(s.kind==="inputAmp"){let y=s.channel;if(!this.inputAmplifiers)return L.warn(" Input amplifiers module not initialized"),!1;if(this.inputAmplifiers.isStarted||await this.inputAmplifiers.start(),await this._ensureSystemAudioInput(),d=this.inputAmplifiers.getOutputNode(y),!d)return L.warn(" InputAmplifier output node not available for channel",y),!1}else if(s.kind==="outputBus"){let y=s.bus-1,f=this.engine.outputBuses?.[y];if(!f?.postVcaNode)return L.warn(" Output bus postVcaNode not available for bus",s.bus),!1;d=f.postVcaNode}if(!d)return L.warn(" No output node for source",s),!1;let h=null;if(a.kind==="outputBus"){let y=a.bus-1;h=this.engine.getOutputBusNode(y)}else if(a.kind==="oscilloscope"){if(!this.oscilloscope)return L.warn(" Oscilloscope module not ready yet"),!1;h=a.channel==="X"?this.oscilloscope.inputX:this.oscilloscope.inputY,L.info(` Connecting to oscilloscope ${a.channel}`)}else if(a.kind==="oscSync"){let y=a.oscIndex;if(h=this._ensurePanel3Nodes(y)?.multiOsc,!h)return L.warn(" multiOsc not available for hard sync, osc",y),!1;L.info(` Hard sync \u2192 Osc ${y+1}`)}else if(a.kind==="oscPWM"){let y=a.oscIndex,b=this._ensurePanel3Nodes(y)?.multiOsc;if(!b)return L.warn(" multiOsc not available for PWM, osc",y),!1;let E=b.parameters?.get("pulseWidth");if(!E)return L.warn(" pulseWidth AudioParam not available for osc",y),!1;h=null,L.info(` PWM \u2192 Osc ${y+1}`);let w=yt?.pinFiltering?.filterQ??.5,S=Fs(c,i||"GREY",w),T=c.createGain(),A=this._getPanel5PinGain(e,t,a,i),x=this._getOscConfig(y)?.knobs?.pulseWidth??qe.defaults?.knobs?.pulseWidth??{},R=x.min??.01,I=((x.max??.99)-R)/2;return T.gain.value=A*I,d.connect(S),S.connect(T),T.connect(E),this._panel3Routing.connections[r]={filter:S,gain:T,pinColor:i||"GREY"},this.dormancyManager?.onConnectionChange(),tt.shouldIgnoreOSC()||tt.sendAudioPinChange(e,t,!0,i),!0}if(!h)return L.warn(" No destination node for",a),!1;let p=yt?.pinFiltering?.filterQ??.5,m=Fs(c,i||"GREY",p),g=c.createGain(),_=this._getPanel5PinGain(e,t,a,i);return g.gain.value=_,d.connect(m),m.connect(g),a.kind==="oscSync"?g.connect(h,0,0):g.connect(h),this._panel3Routing.connections[r]={filter:m,gain:g,pinColor:i||"GREY"},this.dormancyManager?.onConnectionChange(),tt.shouldIgnoreOSC()||tt.sendAudioPinChange(e,t,!0,i),!0}let l=this._panel3Routing.connections?.[r];return l&&(on(l.filter),on(l.gain),delete this._panel3Routing.connections[r],a?.kind==="oscilloscope"&&this.oscilloscope&&(this.getScopeConnectionCount?this.getScopeConnectionCount():0)===0&&this.oscilloscope._notifyNoSignal?.()),this.dormancyManager?.onConnectionChange(),tt.shouldIgnoreOSC()||tt.sendAudioPinChange(e,t,!1,null),!0}_hasOscillatorFreqCV(e){let t=this._panel6Routing;if(!t?.connections||!t?.destMap)return!1;for(let n of Object.keys(t.connections)){let i=parseInt(n.split(":")[1],10),s=t.destMap.get(i);if(s?.kind==="oscFreqCV"&&s?.oscIndex===e)return!0}return!1}_hasOscillatorPWMCV(e){let t=this._panel3Routing;if(!t?.connections||!t?.destMap)return!1;for(let n of Object.keys(t.connections)){let i=parseInt(n.split(":")[1],10),s=t.destMap.get(i);if(s?.kind==="oscPWM"&&s?.oscIndex===e)return!0}return!1}_setupPanel6ControlRouting(){this._panel6Routing=this._panel6Routing||{connections:{},rowMap:null,colMap:null,destMap:null,channelMap:null,sourceMap:null},this._panel6Routing.connections={};let e=Nn(gi);this._panel6Routing.rowMap=e.rowMap,this._panel6Routing.colMap=e.colMap,this._panel6Routing.destMap=e.destMap,this._panel6Routing.channelMap=e.channelMap,this._panel6Routing.sourceMap=e.sourceMap,this._panel6Routing.hiddenCols=e.hiddenCols,this.largeMatrixControl&&this.largeMatrixControl.setToggleHandler&&this.largeMatrixControl.setToggleHandler((t,n,i,s,a)=>this._handlePanel6ControlToggle(t,n,i,a))}_initSignalFlowHighlighter(){let e=ve.get("signalFlow");this._signalFlowHighlighter=new Jo({panel5Routing:this._panel3Routing,panel6Routing:this._panel6Routing,matrixAudio:this.largeMatrixAudio,matrixControl:this.largeMatrixControl}),e?.key&&this._signalFlowHighlighter.setModifierKey(e.key),this._signalFlowHighlighter.init(),document.addEventListener("synth:signalFlowKeyChanged",t=>{t.detail?.key&&this._signalFlowHighlighter.setModifierKey(t.detail.key)}),document.addEventListener("synth:signalFlowModeChanged",t=>{typeof t.detail?.requireModifier=="boolean"&&this._signalFlowHighlighter.setRequireModifier(t.detail.requireModifier)}),document.addEventListener("synth:signalFlowEnabledChanged",t=>{typeof t.detail?.enabled=="boolean"&&this._signalFlowHighlighter.setEnabled(t.detail.enabled)})}_getPanel6PinGain(e,t,n=null,i=null){let s=Vs||{},a=s.control||{},r=a.matrixGain??1,l=a.gainRange||{min:0,max:2},c=s.rowGains||{},d=s.colGains||{},h=s.pinGains||{},p=e+(gi?.grid?.coordSystem?.rowBase||67),m=t+(gi?.grid?.coordSystem?.colBase||1),g=`${p}:${m}`;if(g in h)return h[g]*r;let _=s.pinTypes||{},y=i||_[g]||"GREY",f=si;n?.rf&&(f=n.rf);let b=On.applyPinTolerance??!1,E=p*1e3+m,w=Ea(y,f,{applyTolerance:b,seed:E}),S=c[p]??1,T=d[m]??1;return w*S*T*r}async _handlePanel6ControlToggle(e,t,n,i=null){let s=this._panel6Routing?.sourceMap?.get(e),a=this._panel6Routing?.destMap?.get(t),r=`${e}:${t}`;if(!s||!a)return!0;if(n){this.ensureAudio();let c=this.engine.audioCtx;if(!c)return!1;let d=null;if(s.kind==="panel3Osc"){let f=s.oscIndex,b=s.channelId||"sineSaw",E=this._ensurePanel3Nodes(f);d=b==="triPulse"?E?.triPulseOut:E?.sineSawOut;let w=this._panel3Audio?.state?.[f];xa(E,w,c)}else if(s.kind==="inputAmp"){let f=s.channel;if(!this.inputAmplifiers)return L.warn(" Input amplifiers module not initialized"),!1;if(this.inputAmplifiers.isStarted||await this.inputAmplifiers.start(),await this._ensureSystemAudioInput(),d=this.inputAmplifiers.getOutputNode(f),!d)return L.warn(" InputAmplifier output node not available for channel",f),!1}else if(s.kind==="outputBus"){let f=s.bus-1,b=this.engine.outputBuses?.[f];if(!b?.postVcaNode)return L.warn(" Output bus postVcaNode not available for bus",s.bus),!1;d=b.postVcaNode}else if(s.kind==="joystick"){let f=s.side,b=s.axis,E=this._joystickModules?.[f];if(!E)return L.warn(" Joystick module not found for side:",f),!1;if(E.isStarted||E.start(),d=b==="x"?E.getOutputNodeX():E.getOutputNodeY(),!d)return L.warn(` Joystick ${f} output node not available for axis ${b}`),!1}if(!d)return L.warn(" No output node for control source",s),!1;let h=null;if(a.kind==="oscFreqCV"){let f=a.oscIndex,b=this._ensurePanel3Nodes(f);if(h=b?._cvChainInput||b?.freqCVInput,b?.multiOsc&&b?.freqCVInput&&!b._cvChainConnected){let E=b.multiOsc.parameters?.get("detune");if(E){L.info(`[FM] Osc ${f}: Reconnecting freqCVInput \u2192 detune`);try{b.freqCVInput.disconnect()}catch{}b.freqCVInput.connect(E),b._cvChainConnected=!0}}if(!h)return L.warn(" freqCVInput not available for osc",f),!1}else if(a.kind==="oscilloscope"){if(!this.oscilloscope)return L.warn(" Oscilloscope module not ready yet"),!1;h=a.channel==="X"?this.oscilloscope.inputX:this.oscilloscope.inputY,L.info(` Panel 6: Connecting to oscilloscope ${a.channel}`)}else if(a.kind==="outputLevelCV"){let f=a.busIndex;if(!this.engine||!this.engine.workletReady)L.warn(" Engine or worklets not ready for audio-rate CV"),h=c.createGain(),h.gain.value=0;else{let b=c.createGain();b.gain.value=1,this.engine.connectOutputLevelCV(f,b)?(h=b,this._outputLevelCVData={cvPassthrough:b,busIndex:f,disconnect:()=>{this.engine?.disconnectOutputLevelCV(f,b)}},L.info(` Panel 6: Audio-rate CV connected to output level bus ${f+1}`)):(L.warn(" Failed to connect CV to VCA worklet"),h=c.createGain(),h.gain.value=0)}}else if(a.kind==="outputBus"){let f=a.bus-1;if(h=this.engine.getOutputBusNode(f),!h)return L.warn(" Output bus input not available for bus",a.bus),!1;L.info(` Panel 6: Voltage input connected to output channel ${a.bus}`)}if(!h)return L.warn(" No destination node for control dest",a),!1;let p=yt?.pinFiltering?.filterQ??.5,m=Fs(c,i||"GREY",p),g=c.createGain(),_=this._getPanel6PinGain(e,t,a,i);g.gain.value=_,d.connect(m),m.connect(g),g.connect(h);let y={filter:m,gain:g,pinColor:i||"GREY",...this._outputLevelCVData||{}};return delete this._outputLevelCVData,this._panel6Routing.connections[r]=y,L.info(` Panel 6: Connected ${s.kind}[${s.oscIndex??s.channel??""}] \u2192 ${a.kind}[${a.oscIndex??a.busIndex??""}] (gain: ${_}, fc: ${fn[i||"GREY"]?.toFixed(0)} Hz)`),this.dormancyManager?.onConnectionChange(),tt.shouldIgnoreOSC()||tt.sendControlPinChange(e,t,!0,i),!0}let l=this._panel6Routing.connections?.[r];return l&&(on(l.filter),on(l.gain),l.disconnect&&l.disconnect(),l.cvPassthrough&&on(l.cvPassthrough),l.stopSampling&&l.stopSampling(),l.cvSampler&&on(l.cvSampler),l.analyser&&on(l.analyser),l.silencer&&on(l.silencer),delete this._panel6Routing.connections[r],L.info(` Panel 6: Disconnected ${r}`),a?.kind==="oscilloscope"&&this.oscilloscope&&(this.getScopeConnectionCount?this.getScopeConnectionCount():0)===0&&this.oscilloscope._notifyNoSignal?.()),this.dormancyManager?.onConnectionChange(),tt.shouldIgnoreOSC()||tt.sendControlPinChange(e,t,!1,null),!0}_buildLargeMatrices(){this.panel5MatrixEl=this.panel5.addSection({id:"panel5Matrix",type:"matrix"}),this.panel6MatrixEl=this.panel6.addSection({id:"panel6Matrix",type:"matrix"});let e=mi?.ui?.frame||{squarePercent:90,translateSteps:{x:5.1,y:0},marginsSteps:{left:-7.47,right:-3,top:4.7,bottom:2.7},clip:!0,overflowPercent:{left:25,top:25,right:200,bottom:80},maxSizePercent:300},t=gi?.ui?.frame||e;e.clip===!1?(this.panel5?.element?.classList.add("matrix-adjust"),this.panel6?.element?.classList.add("matrix-adjust")):(this.panel5?.element?.classList.remove("matrix-adjust"),this.panel6?.element?.classList.remove("matrix-adjust"));let n=Nn(mi),i=Nn(gi),{hiddenCols:s,hiddenRows:a}=n,{hiddenCols:r,hiddenRows:l}=i,c=(m,g)=>n.destMap.get(g)?.kind==="oscilloscope"?"RED":null,d=(m,g)=>i.destMap.get(g)?.kind==="oscilloscope"?"RED":null;this.largeMatrixAudio=new Zi(this.panel5MatrixEl,{rows:63,cols:67,frame:e,hiddenCols:s,hiddenRows:a,sourceMap:n.sourceMap,destMap:n.destMap,panelId:"panel-5",defaultPinColor:"WHITE",getDefaultPinColor:c}),this.largeMatrixControl=new Zi(this.panel6MatrixEl,{rows:63,cols:67,frame:t,hiddenCols:r,hiddenRows:l,sourceMap:i.sourceMap,destMap:i.destMap,panelId:"panel-6",defaultPinColor:"GREEN",getDefaultPinColor:d}),this.largeMatrixAudio.build(),this.largeMatrixControl.build(),this.largeMatrixAudio.getPinContext=(m,g)=>n.destMap.get(g)?.kind==="oscilloscope"?"oscilloscope":"audio",this.largeMatrixControl.getPinContext=(m,g)=>i.destMap.get(g)?.kind==="oscilloscope"?"oscilloscope":"control",this.largeMatrixAudio.onPinColorChange=(m,g,_,y)=>{let f=`${m}:${g}`,b=this._panel3Routing?.connections?.[f];if(b){let E=this._panel3Routing?.destMap?.get(g),w=this.engine.audioCtx.currentTime;Sa(b.filter,_,w),b.pinColor=_;let S=this._getPanel5PinGain(m,g,E,_);b.gain.gain.setValueAtTime(S,w),L.info(` Panel 5: Pin color changed [${m}:${g}] \u2192 ${_} (gain: ${S.toFixed(3)}, fc: ${fn[_]?.toFixed(0)} Hz)`),tt.shouldIgnoreOSC()||tt.sendAudioPinChange(m,g,!0,_)}},this.largeMatrixControl.onPinColorChange=(m,g,_,y)=>{let f=`${m}:${g}`,b=this._panel6Routing?.connections?.[f];if(b){let E=this._panel6Routing?.destMap?.get(g),w=this.engine.audioCtx.currentTime;Sa(b.filter,_,w),b.pinColor=_;let S=this._getPanel6PinGain(m,g,E,_);b.gain.gain.setValueAtTime(S,w),L.info(` Panel 6: Pin color changed [${m}:${g}] \u2192 ${_} (gain: ${S.toFixed(3)}, fc: ${fn[_]?.toFixed(0)} Hz)`),tt.shouldIgnoreOSC()||tt.sendControlPinChange(m,g,!0,_)}};let h=localStorage.getItem(v.SHOW_INACTIVE_PINS)==="true";this.largeMatrixAudio.setShowInactivePins(h),this.largeMatrixControl.setShowInactivePins(h),document.addEventListener("synth:showInactivePinsChange",m=>{let g=m.detail?.show??!1;this.largeMatrixAudio?.setShowInactivePins(g),this.largeMatrixControl?.setShowInactivePins(g)});let p=jl();p.attachToMatrix(this.panel5MatrixEl,{sourceMap:n.sourceMap,destMap:n.destMap,rowBase:n.rowBase,colBase:n.colBase}),p.attachToMatrix(this.panel6MatrixEl,{sourceMap:i.sourceMap,destMap:i.destMap,rowBase:i.rowBase,colBase:i.colBase})}_resizeLargeMatrices(){this.largeMatrixAudio&&this.largeMatrixAudio.resizeToFit(),this.largeMatrixControl&&this.largeMatrixControl.resizeToFit()}_schedulePanelSync(){this._heightSyncScheduled||(this._heightSyncScheduled=!0,requestAnimationFrame(()=>{this._heightSyncScheduled=!1,this._reflowOscillatorPanel(1),this._reflowOscillatorPanel(2),this._reflowOscillatorPanel(3),this._reflowOscillatorPanel(4),this._syncPanelHeights(),jt()}))}_syncPanelHeights(){document.querySelectorAll("#viewportInner .panel").forEach(t=>{t.style.height=""})}},op=2e3;function tu(){let o=document.getElementById("splash");o&&(o.classList.add("splash--hidden"),setTimeout(()=>{o.remove(),typeof window.__synthAnimateToPanel=="function"&&(localStorage.getItem("synthigme-remember-visual-layout")==="true"&&localStorage.getItem("synthigme-viewport-state")||window.__synthAnimateToPanel(null,0)),window._synthApp&&window._synthApp.triggerRestoreLastState&&window._synthApp.triggerRestoreLastState(),ap()},800))}async function ap(){try{if(localStorage.getItem(v.TELEMETRY_ENABLED)!==null)return}catch{}await new Promise(e=>setTimeout(e,1500));let o=await Ie.show({title:u("telemetry.consent.title"),message:u("telemetry.consent.message"),confirmText:u("telemetry.consent.accept"),cancelText:u("telemetry.consent.decline")});Vi(o.confirmed),o.confirmed&&ut("first_run")}Zr();zs();window.addEventListener("DOMContentLoaded",async()=>{let o=Date.now();try{await Ga();let n=document.querySelector(".splash__loader-text");n&&(n.textContent=u("splash.loading")),bl(),await Xc(),Gc(),screen.orientation&&screen.orientation.lock&&screen.orientation.lock("landscape").catch(()=>{}),window._synthApp=new Fr,window._synthApp&&window._synthApp.ensureAudio&&window._synthApp.ensureAudio().catch(i=>{L.error("Error al inicializar audio:",i),se("Error al inicializar audio. Recarga la p\xE1gina.",{level:"error",duration:5e3}),ut("audio_fail",{message:i?.message||String(i)})}),window.channelBypass=i=>{let s=window._synthApp;s&&s.engine?s.engine.setChannelBypassDebug(i):console.warn("Engine no disponible")},Fc({isDirtyFn:()=>$e.isDirty(),markCleanFn:()=>$e.markClean()}),window.egg=Tr,Cc(),ur(),gr(),sc(),Ac(),Mc(),kc(),wc(),Uc()}catch(n){L.error("Error cr\xEDtico durante la inicializaci\xF3n:",n);try{se("Error cr\xEDtico al iniciar la aplicaci\xF3n. Recarga la p\xE1gina.",{level:"error",duration:1e4})}catch{let s=document.createElement("div");s.style.cssText="position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:#c0392b;color:#fff;padding:24px;border-radius:8px;z-index:99999;font-size:18px;text-align:center;",s.textContent="Error cr\xEDtico al iniciar. Recarga la p\xE1gina.",document.body?.appendChild(s)}}let e=Date.now()-o,t=Math.max(0,op-e);t>0?setTimeout(tu,t):tu()});
